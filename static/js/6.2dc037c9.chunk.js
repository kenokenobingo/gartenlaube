(this.webpackJsonpgartenlaube=this.webpackJsonpgartenlaube||[]).push([[6],{984:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return R}));var r=a(6),n=a(127),s=a(35),c=a(50),o=a(13),i=a(27),d=a(2),l=a.n(d),b=a(3),p=a(8),u=a(4),j=a(1),O=a(16),f=a(59),h=a(18),m=a(30),x=a(61),g=a(15),I=a(44),N=a(5),y=a(70),w=a(55),D=a(21),P=a(40),A=a(0),F={skipIsActiveMemberCheck:!0};function S(t){var e=t.disabled,a=t.proposal.snapshotProposal,r=Object(j.useState)(),n=Object(u.a)(r,2),s=n[0],c=n[1],o=Object(O.c)((function(t){return t.contracts})),d=Object(O.c)((function(t){return t.contracts.DaoRegistryContract})),S=Object(g.e)(),v=S.account,E=S.web3Instance,L=Object(g.a)(),k=L.txEtherscanURL,R=L.txIsPromptOpen,_=L.txSend,C=L.txStatus,G=Object(I.f)(F),W=G.isDisabled,M=G.openWhyDisabledModal,T=G.WhyDisabledModal,V=Object(g.b)().fast,U=Object(O.b)(),J=C===N.f.AWAITING_CONFIRM||C===N.f.PENDING,q=C===N.f.FULFILLED,z=J||q||R,B=W||z||e;function H(){return(H=Object(p.a)(l.a.mark((function t(){var e,r,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,d){t.next=3;break}throw new Error("No DAO Registry contract was found.");case 3:if(a){t.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:if(v){t.next=7;break}throw new Error("No account found.");case 7:if(E){t.next=9;break}throw new Error("No Web3 instance was found.");case 9:return e=Object(m.e)(a.actionId,o),r=[d.contractAddress,a.idInDAO],n=Object(b.a)({from:v||""},V?{gasPrice:V}:null),t.next=14,_("processProposal",e.instance.methods,r,n);case 14:if(!t.sent){t.next=18;break}return t.next=18,U(Object(h.y)({account:v,daoRegistryContract:d,web3Instance:E}));case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),c(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))).apply(this,arguments)}return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsxs)("div",{children:[Object(A.jsx)("button",{className:"proposaldetails__button",disabled:B,onClick:B?function(){}:function(){return H.apply(this,arguments)},children:J?Object(A.jsx)(P.a,{}):q?"Done":"Process"}),Object(A.jsx)(i.a,{error:s,renderText:"Something went wrong"}),z&&Object(A.jsx)("div",{className:"form__submit-status-container",children:function(){switch(C){case N.f.AWAITING_CONFIRM:return Object(A.jsxs)(A.Fragment,{children:["Awaiting your confirmation",Object(A.jsx)(f.a,{})]});case N.f.PENDING:return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(y.a,{intervalMs:2e3,messages:x.b,useFirstItemStart:!0,render:function(t){return Object(A.jsx)(D.a,{children:t},t)}}),Object(A.jsx)(w.a,{url:k,isPending:!0})]});case N.f.FULFILLED:return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("div",{children:"Proposal submitted!"}),Object(A.jsx)(w.a,{url:k})]});default:return null}}()}),W&&Object(A.jsx)("button",{className:"button--help-centered",onClick:M,children:"Why is processing disabled?"})]}),Object(A.jsx)(T,{title:"Why is processing disabled?"})]})}var v=a(20);function E(t){var e=t.proposal,a=e.snapshotDraft,r=e.refetchProposalOrDraft,n=Object(j.useState)(),s=Object(u.a)(n,2),o=s[0],d=s[1],f=Object(O.c)((function(t){return t.contracts})),h=Object(O.c)((function(t){var e;return null===(e=t.contracts.DaoRegistryContract)||void 0===e?void 0:e.contractAddress})),F=Object(g.e)(),S=F.account,E=F.web3Instance,L=Object(g.a)(),k=L.txEtherscanURL,R=L.txIsPromptOpen,_=L.txSend,C=L.txStatus,G=Object(I.f)(),W=G.isDisabled,M=G.openWhyDisabledModal,T=G.WhyDisabledModal,V=Object(c.g)(),U=V.proposalSignAndSendStatus,J=V.signAndSendProposal,q=Object(g.b)().fast,z=C===N.f.AWAITING_CONFIRM||C===N.f.PENDING||U===N.f.AWAITING_CONFIRM||U===N.f.PENDING,B=C===N.f.FULFILLED&&U===N.f.FULFILLED,H=z||B||R;function K(){return(K=Object(p.a)(l.a.mark((function t(){var e,n,s,c,o,i,p,u,j,O,x,g,I;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,h){t.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){t.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return e=Object(m.e)(a.actionId,f),n=a.msg,s=n.payload,c=s.name,o=s.body,i=s.metadata,p=n.timestamp,t.next=9,J({partialProposalData:{name:c,body:o,metadata:i,timestamp:p},adapterAddress:e.contractAddress,type:v.SnapshotType.proposal});case 9:return u=t.sent,j=u.data,O=u.signature,x=Object(v.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},E),g=[h,a.idInDAO,x],I=Object(b.a)({from:S||""},q?{gasPrice:q}:null),t.next=17,_("sponsorProposal",e.instance.methods,g,I);case 17:r(),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),d(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))).apply(this,arguments)}return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsxs)("div",{children:[Object(A.jsx)("button",{className:"proposaldetails__button",disabled:W||H,onClick:W||H?function(){}:function(){return K.apply(this,arguments)},children:z?Object(A.jsx)(P.a,{}):B?"Done":"Sponsor"}),Object(A.jsx)(i.a,{error:o,renderText:"Something went wrong"}),H&&Object(A.jsx)("div",{className:"form__submit-status-container",children:function(){if(C===N.f.AWAITING_CONFIRM||U===N.f.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(C){case N.f.PENDING:return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(y.a,{intervalMs:2e3,messages:x.b,useFirstItemStart:!0,render:function(t){return Object(A.jsx)(D.a,{children:t},t)}}),Object(A.jsx)(w.a,{url:k,isPending:!0})]});case N.f.FULFILLED:return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("div",{children:"Proposal submitted!"}),Object(A.jsx)(w.a,{url:k})]});default:return null}}()}),W&&Object(A.jsx)("button",{className:"button--help-centered",onClick:M,children:"Why is sponsoring disabled?"})]}),Object(A.jsx)(T,{title:"Why is sponsoring disabled?"})]})}var L=a(31);function k(t){var e=t.proposal,a=e.snapshotDraft,r=e.refetchProposalOrDraft,n=Object(j.useState)(),s=Object(u.a)(n,2),o=s[0],d=s[1],f=Object(O.c)((function(t){return t.contracts})),h=Object(O.c)((function(t){var e;return null===(e=t.contracts.DaoRegistryContract)||void 0===e?void 0:e.contractAddress})),F=Object(g.e)(),S=F.account,E=F.web3Instance,k=Object(g.a)(),R=k.txEtherscanURL,_=k.txIsPromptOpen,C=k.txSend,G=k.txStatus,W=Object(I.f)(),M=W.isDisabled,T=W.openWhyDisabledModal,V=W.WhyDisabledModal,U=Object(c.g)(),J=U.proposalSignAndSendStatus,q=U.signAndSendProposal,z=Object(g.b)().fast,B=G===N.f.AWAITING_CONFIRM||G===N.f.PENDING||J===N.f.AWAITING_CONFIRM||J===N.f.PENDING,H=G===N.f.FULFILLED&&J===N.f.FULFILLED,K=B||H||_;function Q(){return(Q=Object(p.a)(l.a.mark((function t(){var e,n,s,c,o,i,p,u,j,O,x,g,I;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,h){t.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){t.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return e=Object(m.e)(a.actionId,f),n=a.msg,s=n.payload,c=s.name,o=s.body,i=s.metadata,p=n.timestamp,t.next=9,q({partialProposalData:{name:c,body:o,metadata:i,timestamp:p},adapterAddress:e.contractAddress,type:v.SnapshotType.proposal});case 9:return u=t.sent,j=u.data,O=u.signature,x=Object(v.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},E),g=[h,a.idInDAO].concat(Object(L.a)(i.submitActionArgs||[]),[x]),I=Object(b.a)({from:S||""},z?{gasPrice:z}:null),t.next=17,C("submitProposal",e.instance.methods,g,I);case 17:r(),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),d(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))).apply(this,arguments)}return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsxs)("div",{children:[Object(A.jsx)("button",{className:"proposaldetails__button",disabled:M||K,onClick:M||K?function(){}:function(){return Q.apply(this,arguments)},children:B?Object(A.jsx)(P.a,{}):H?"Done":"Sponsor"}),Object(A.jsx)(i.a,{error:o,renderText:"Something went wrong"}),K&&Object(A.jsx)("div",{className:"form__submit-status-container",children:function(){if(G===N.f.AWAITING_CONFIRM||J===N.f.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(G){case N.f.PENDING:return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(y.a,{intervalMs:2e3,messages:x.b,useFirstItemStart:!0,render:function(t){return Object(A.jsx)(D.a,{children:t},t)}}),Object(A.jsx)(w.a,{url:R,isPending:!0})]});case N.f.FULFILLED:return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("div",{children:"Proposal submitted!"}),Object(A.jsx)(w.a,{url:R})]});default:return null}}()}),M&&Object(A.jsx)("button",{className:"button--help-centered",onClick:T,children:"Why is sponsoring disabled?"})]}),Object(A.jsx)(V,{title:"Why is sponsoring disabled?"})]})}function R(t){var e=t.adapterName,a=t.proposal,d=t.renderAction,l=Object(c.c)(a),b=l.daoProposalVoteResult,p=l.daoProposalVotes,u=l.proposalFlowStatusError,j=l.status,O=p&&j===s.c.OffchainVotingGracePeriod?1e3*Number(p.gracePeriodStartingTime)||Date.now():0,f=d&&d(Object(r.a)({},o.c.OffchainVotingContract,{adapterName:e,daoProposalVoteResult:b,daoProposalVotes:p,gracePeriodStartMs:O,proposal:a,status:j}));return Object(A.jsxs)(A.Fragment,{children:[(j===s.c.OffchainVoting||j===s.c.OffchainVotingSubmitResult||j===s.c.OffchainVotingGracePeriod||j===s.c.Process||j===s.c.Completed)&&Object(A.jsx)(n.c,{countdownGracePeriodStartMs:O,proposal:a}),Object(A.jsx)("div",{className:"proposaldetails__button-container",children:f||(j===s.c.Submit?Object(A.jsx)(k,{proposal:a}):j===s.c.Sponsor?Object(A.jsx)(E,{proposal:a}):j===s.c.OffchainVoting?Object(A.jsx)(n.b,{adapterName:e,proposal:a}):j===s.c.OffchainVotingSubmitResult?Object(A.jsx)(n.a,{adapterName:e,proposal:a}):j===s.c.Process||j===s.c.OffchainVotingGracePeriod?Object(A.jsx)(S,{disabled:j===s.c.OffchainVotingGracePeriod,proposal:a}):void 0)}),Object(A.jsx)(i.a,{error:u,renderText:"Something went wrong while getting the proposal's status"})]})}}}]);
//# sourceMappingURL=6.2dc037c9.chunk.js.map