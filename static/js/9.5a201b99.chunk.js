(this.webpackJsonpgartenlaube=this.webpackJsonpgartenlaube||[]).push([[9],{977:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T}));var r=n(7),s=n(4),a=n(1),o=n(136),c=n(39),i=n(45),d=n(9),u=n(8),l=n(59),b=n(36),j=n(16),p=n(30),f=n(2),O=n.n(f),h=n(3),x=n(5),g=n(14),m=n(20),w=n(32),v=n(57),N=n(15),P=n(69),I=n(50),S=n(24),E=n(40),F=n(0),V={skipIsActiveMemberCheck:!0};function k(e){var t=e.disabled,n=e.proposal.snapshotProposal,r=Object(a.useState)(),o=Object(s.a)(r,2),c=o[0],i=o[1],d=Object(g.c)((function(e){return e.contracts})),j=Object(g.c)((function(e){return e.contracts.DaoRegistryContract})),f=Object(N.f)(),k=f.account,M=f.web3Instance,D=Object(N.a)(),R=D.txEtherscanURL,y=D.txIsPromptOpen,A=D.txSend,C=D.txStatus,G=Object(b.g)(V),L=G.isDisabled,_=G.openWhyDisabledModal,T=G.WhyDisabledModal,W=Object(N.b)().fast,U=Object(g.b)(),J=C===u.f.AWAITING_CONFIRM||C===u.f.PENDING,B=C===u.f.FULFILLED,Y=J||B||y,q=L||Y||t;function z(){return(z=Object(x.a)(O.a.mark((function e(){var t,r,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,j){e.next=3;break}throw new Error("No DAO Registry contract was found.");case 3:if(n){e.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:if(k){e.next=7;break}throw new Error("No account found.");case 7:if(M){e.next=9;break}throw new Error("No Web3 instance was found.");case 9:return t=Object(w.e)(n.actionId,d),r=[j.contractAddress,n.idInDAO],s=Object(h.a)({from:k||""},W?{gasPrice:W}:null),e.next=14,A("processProposal",t.instance.methods,r,s);case 14:if(!e.sent){e.next=18;break}return e.next=18,U(Object(m.B)({account:k,daoRegistryContract:j,web3Instance:M}));case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),i(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)("div",{children:[Object(F.jsx)("button",{className:"proposaldetails__button",disabled:q,onClick:q?function(){}:function(){return z.apply(this,arguments)},children:J?Object(F.jsx)(E.a,{}):B?"Done":"Process"}),Object(F.jsx)(p.a,{error:c,renderText:"Something went wrong"}),Y&&Object(F.jsx)("div",{className:"form__submit-status-container",children:function(){switch(C){case u.f.AWAITING_CONFIRM:return Object(F.jsxs)(F.Fragment,{children:["Awaiting your confirmation",Object(F.jsx)(l.a,{})]});case u.f.PENDING:return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(P.a,{intervalMs:2e3,messages:v.b,useFirstItemStart:!0,render:function(e){return Object(F.jsx)(S.a,{children:e},e)}}),Object(F.jsx)(I.a,{url:R,isPending:!0})]});case u.f.FULFILLED:return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("div",{children:"Proposal submitted!"}),Object(F.jsx)(I.a,{url:R})]});default:return null}}()}),L&&Object(F.jsx)("button",{className:"button--help-centered",onClick:_,children:"Why is processing disabled?"})]}),Object(F.jsx)(T,{title:"Why is processing disabled?"})]})}var M=n(205),D=c.c.Completed,R=c.c.OffchainVotingGracePeriod,y=c.c.OffchainVotingSubmitResult,A=c.c.OffchainVoting,C=c.c.Process,G=c.c.Submit,L=d.a.FULFILLED,_=[u.b.offchainVotingVotingPeriod,u.b.offchainVotingGracePeriod];function T(e){var t,n=e.adapterName,c=e.proposal,d=e.renderAction,u=Object(b.d)(_),f=Object(s.a)(u.daoConfigurations,2),O=f[0],h=f[1],x=Object(i.e)(Object(a.useMemo)((function(){return{proposal:c}}),[c])),g=x.daoProposalVoteResult,m=x.daoProposalVote,w=x.proposalFlowStatusError,v=x.status,N=x.stopPollingForStatus,P=Object(i.c)(c.snapshotProposal),I=P.offchainVotingResults,S=P.offchainVotingResultsStatus,E=1e3*Number((null===m||void 0===m?void 0:m.gracePeriodStartingTime)||0),V=E+1e3*Number(h||0),T=1e3*Number((null===m||void 0===m?void 0:m.startingTime)||0),W=T+1e3*Number(O||0),U=null===(t=I[0])||void 0===t?void 0:t[1],J=(null===U||void 0===U?void 0:U.Yes.units)||0,B=(null===U||void 0===U?void 0:U.No.units)||0,Y=d&&d(Object(r.a)({},j.c.OffchainVotingContract,{adapterName:n,daoProposalVote:m,daoProposalVoteResult:g,gracePeriodEndMs:V,gracePeriodStartMs:E,proposal:c,status:v}));return Object(a.useEffect)((function(){v===y&&S===L&&J<=B&&N()}),[B,S,v,N,J]),Object(F.jsxs)(F.Fragment,{children:[(v===A||v===y||v===R||v===C||v===D)&&Object(F.jsx)(o.c,{countdownGracePeriodEndMs:V,countdownGracePeriodStartMs:E,countdownVotingEndMs:W,countdownVotingStartMs:T,renderStatus:function(e){if(e.hasGracePeriodEnded&&v===R)return Object(F.jsxs)("span",{children:["Grace period ended ",Object(F.jsx)("br",{})," ",Object(F.jsxs)("span",{style:{textTransform:"lowercase"},children:["Awaiting contract status",Object(F.jsx)(l.a,{})]})]})},votingResult:U}),Object(F.jsx)("div",{className:"proposaldetails__button-container",children:Y||(v===G?Object(F.jsx)(M.a,{proposal:c}):v===A?Object(F.jsx)(o.b,{adapterName:n,proposal:c}):v===y?S!==L||J<=B?null:Object(F.jsx)(o.a,{adapterName:n,proposal:c}):v===C||v===R?Object(F.jsx)(k,{disabled:v===R,proposal:c}):void 0)}),Object(F.jsx)(p.a,{error:w,renderText:"Something went wrong while getting the proposal's status"})]})}}}]);
//# sourceMappingURL=9.5a201b99.chunk.js.map