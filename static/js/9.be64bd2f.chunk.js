(this.webpackJsonpgartenlaube=this.webpackJsonpgartenlaube||[]).push([[9],{1007:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return L}));var r=a(7),n=a(132),s=a(37),c=a(41),o=a(17),i=a(27),d=a(2),l=a.n(d),b=a(3),p=a(9),u=a(4),j=a(1),f=a(15),O=a(61),h=a(19),x=a(29),m=a(60),g=a(14),I=a(39),w=a(5),N=a(69),P=a(48),y=a(23),D=a(40),v=a(0),S={skipIsActiveMemberCheck:!0};function F(e){var t=e.disabled,a=e.proposal.snapshotProposal,r=Object(j.useState)(),n=Object(u.a)(r,2),s=n[0],c=n[1],o=Object(f.c)((function(e){return e.contracts})),d=Object(f.c)((function(e){return e.contracts.DaoRegistryContract})),F=Object(g.f)(),A=F.account,k=F.web3Instance,E=Object(g.a)(),L=E.txEtherscanURL,R=E.txIsPromptOpen,C=E.txSend,G=E.txStatus,_=Object(I.f)(S),M=_.isDisabled,W=_.openWhyDisabledModal,V=_.WhyDisabledModal,T=Object(g.b)().fast,U=Object(f.b)(),J=G===w.f.AWAITING_CONFIRM||G===w.f.PENDING,B=G===w.f.FULFILLED,q=J||B||R,z=M||q||t;function H(){return(H=Object(p.a)(l.a.mark((function e(){var t,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d){e.next=3;break}throw new Error("No DAO Registry contract was found.");case 3:if(a){e.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:if(A){e.next=7;break}throw new Error("No account found.");case 7:if(k){e.next=9;break}throw new Error("No Web3 instance was found.");case 9:return t=Object(x.e)(a.actionId,o),r=[d.contractAddress,a.idInDAO],n=Object(b.a)({from:A||""},T?{gasPrice:T}:null),e.next=14,C("processProposal",t.instance.methods,r,n);case 14:if(!e.sent){e.next=18;break}return e.next=18,U(Object(h.B)({account:A,daoRegistryContract:d,web3Instance:k}));case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),c(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{className:"proposaldetails__button",disabled:z,onClick:z?function(){}:function(){return H.apply(this,arguments)},children:J?Object(v.jsx)(D.a,{}):B?"Done":"Process"}),Object(v.jsx)(i.a,{error:s,renderText:"Something went wrong"}),q&&Object(v.jsx)("div",{className:"form__submit-status-container",children:function(){switch(G){case w.f.AWAITING_CONFIRM:return Object(v.jsxs)(v.Fragment,{children:["Awaiting your confirmation",Object(v.jsx)(O.a,{})]});case w.f.PENDING:return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(N.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(e){return Object(v.jsx)(y.a,{children:e},e)}}),Object(v.jsx)(P.a,{url:L,isPending:!0})]});case w.f.FULFILLED:return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("div",{children:"Proposal submitted!"}),Object(v.jsx)(P.a,{url:L})]});default:return null}}()}),M&&Object(v.jsx)("button",{className:"button--help-centered",onClick:W,children:"Why is processing disabled?"})]}),Object(v.jsx)(V,{title:"Why is processing disabled?"})]})}var A=a(20);function k(e){var t=e.proposal,a=t.snapshotDraft,r=t.refetchProposalOrDraft,n=Object(j.useState)(),s=Object(u.a)(n,2),o=s[0],d=s[1],O=Object(f.c)((function(e){return e.contracts})),h=Object(f.c)((function(e){var t;return null===(t=e.contracts.DaoRegistryContract)||void 0===t?void 0:t.contractAddress})),S=Object(g.f)(),F=S.account,k=S.web3Instance,E=Object(g.a)(),L=E.txEtherscanURL,R=E.txIsPromptOpen,C=E.txSend,G=E.txStatus,_=Object(I.f)(),M=_.isDisabled,W=_.openWhyDisabledModal,V=_.WhyDisabledModal,T=Object(c.h)(),U=T.proposalSignAndSendStatus,J=T.signAndSendProposal,B=Object(g.b)().fast,q=G===w.f.AWAITING_CONFIRM||G===w.f.PENDING||U===w.f.AWAITING_CONFIRM||U===w.f.PENDING,z=G===w.f.FULFILLED&&U===w.f.FULFILLED,H=q||z||R;function K(){return(K=Object(p.a)(l.a.mark((function e(){var t,n,s,c,o,i,p,u,j,f,m,g,I;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,h){e.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){e.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return t=Object(x.e)(a.actionId,O),n=a.msg,s=n.payload,c=s.name,o=s.body,i=s.metadata,p=n.timestamp,e.next=9,J({partialProposalData:{name:c,body:o,metadata:i,timestamp:p},adapterAddress:t.contractAddress,type:A.SnapshotType.proposal});case 9:return u=e.sent,j=u.data,f=u.signature,m=Object(A.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:f,space:j.space,timestamp:parseInt(j.timestamp)},k),g=[h,a.idInDAO,m],I=Object(b.a)({from:F||""},B?{gasPrice:B}:null),e.next=17,C("sponsorProposal",t.instance.methods,g,I);case 17:r(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),d(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{className:"proposaldetails__button",disabled:M||H,onClick:M||H?function(){}:function(){return K.apply(this,arguments)},children:q?Object(v.jsx)(D.a,{}):z?"Done":"Sponsor"}),Object(v.jsx)(i.a,{error:o,renderText:"Something went wrong"}),H&&Object(v.jsx)("div",{className:"form__submit-status-container",children:function(){if(G===w.f.AWAITING_CONFIRM||U===w.f.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(G){case w.f.PENDING:return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(N.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(e){return Object(v.jsx)(y.a,{children:e},e)}}),Object(v.jsx)(P.a,{url:L,isPending:!0})]});case w.f.FULFILLED:return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("div",{children:"Proposal submitted!"}),Object(v.jsx)(P.a,{url:L})]});default:return null}}()}),M&&Object(v.jsx)("button",{className:"button--help-centered",onClick:W,children:"Why is sponsoring disabled?"})]}),Object(v.jsx)(V,{title:"Why is sponsoring disabled?"})]})}var E=a(199);function L(e){var t=e.adapterName,a=e.proposal,d=e.renderAction,l=Object(c.d)(a),b=l.daoProposalVoteResult,p=l.daoProposalVotes,u=l.proposalFlowStatusError,j=l.status,f=p&&j===s.c.OffchainVotingGracePeriod?1e3*Number(p.gracePeriodStartingTime)||Date.now():0,O=d&&d(Object(r.a)({},o.c.OffchainVotingContract,{adapterName:t,daoProposalVoteResult:b,daoProposalVotes:p,gracePeriodStartMs:f,proposal:a,status:j}));return Object(v.jsxs)(v.Fragment,{children:[(j===s.c.OffchainVoting||j===s.c.OffchainVotingSubmitResult||j===s.c.OffchainVotingGracePeriod||j===s.c.Process||j===s.c.Completed)&&Object(v.jsx)(n.c,{countdownGracePeriodStartMs:f,proposal:a}),Object(v.jsx)("div",{className:"proposaldetails__button-container",children:O||(j===s.c.Submit?Object(v.jsx)(E.a,{proposal:a}):j===s.c.Sponsor?Object(v.jsx)(k,{proposal:a}):j===s.c.OffchainVoting?Object(v.jsx)(n.b,{adapterName:t,proposal:a}):j===s.c.OffchainVotingSubmitResult?Object(v.jsx)(n.a,{adapterName:t,proposal:a}):j===s.c.Process||j===s.c.OffchainVotingGracePeriod?Object(v.jsx)(F,{disabled:j===s.c.OffchainVotingGracePeriod,proposal:a}):void 0)}),Object(v.jsx)(i.a,{error:u,renderText:"Something went wrong while getting the proposal's status"})]})}}}]);
//# sourceMappingURL=9.be64bd2f.chunk.js.map