(this.webpackJsonpgartenlaube=this.webpackJsonpgartenlaube||[]).push([[8],{1106:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return _}));var s=a(7),r=a(161),n=a(53),o=a(67),c=a(15),i=a(46),d=a(3),l=a.n(d),p=a(4),b=a(11),u=a(5),j=a(1),O=a(18),f=a(75),h=a(45),m=a(82),x=a(19),g=a(71),I=a(6),N=a(94),y=a(77),w=a(22),D=a(62),P=a(0),A={skipIsActiveMemberCheck:!0};function v(t){var e=t.disabled,a=t.proposal.snapshotProposal,s=Object(j.useState)(),r=Object(u.a)(s,2),n=r[0],o=r[1],c=Object(O.c)((function(t){return t.contracts})),d=Object(O.c)((function(t){var e;return null===(e=t.contracts.DaoRegistryContract)||void 0===e?void 0:e.contractAddress})),v=Object(x.e)().account,F=Object(x.a)(),S=F.txEtherscanURL,L=F.txIsPromptOpen,E=F.txSend,_=F.txStatus,G=Object(g.e)(A),R=G.isDisabled,k=G.openWhyDisabledModal,C=G.WhyDisabledModal,M=Object(x.b)(),W=_===I.f.AWAITING_CONFIRM||_===I.f.PENDING,T=_===I.f.FULFILLED,V=W||T||L,U=R||V||e;function J(){return(J=Object(b.a)(l.a.mark((function t(){var e,s,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,d){t.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){t.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:return e=Object(h.e)(a.actionId,c),s=[d,a.idInDAO],r=Object(p.a)({from:v||""},M?{gasPrice:M.fast}:null),t.next=10,E("processProposal",e.instance.methods,s,r);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),o(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("button",{className:"proposaldetails__button",disabled:U,onClick:U?function(){}:function(){return J.apply(this,arguments)},children:W?Object(P.jsx)(D.a,{}):T?"Done":"Process"}),Object(P.jsx)(i.a,{error:n,renderText:"Something went wrong"}),V&&Object(P.jsx)("div",{className:"form__submit-status-container",children:function(){switch(_){case I.f.AWAITING_CONFIRM:return Object(P.jsxs)(P.Fragment,{children:["Awaiting your confirmation",Object(P.jsx)(f.a,{})]});case I.f.PENDING:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(N.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(t){return Object(P.jsx)(w.a,{children:t},t)}}),Object(P.jsx)(y.a,{url:S,isPending:!0})]});case I.f.FULFILLED:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{children:"Proposal submitted!"}),Object(P.jsx)(y.a,{url:S})]});default:return null}}()}),R&&Object(P.jsx)("button",{className:"button--help-centered",onClick:k,children:"Why is processing disabled?"})]}),Object(P.jsx)(C,{title:"Why is processing disabled?"})]})}var F=a(20);function S(t){var e=t.proposal,a=e.snapshotDraft,s=e.refetchProposalOrDraft,r=Object(j.useState)(),n=Object(u.a)(r,2),c=n[0],d=n[1],f=Object(O.c)((function(t){return t.contracts})),A=Object(O.c)((function(t){var e;return null===(e=t.contracts.DaoRegistryContract)||void 0===e?void 0:e.contractAddress})),v=Object(x.e)(),S=v.account,L=v.web3Instance,E=Object(x.a)(),_=E.txEtherscanURL,G=E.txIsPromptOpen,R=E.txSend,k=E.txStatus,C=Object(g.e)(),M=C.isDisabled,W=C.openWhyDisabledModal,T=C.WhyDisabledModal,V=Object(o.g)(),U=V.proposalSignAndSendStatus,J=V.signAndSendProposal,q=Object(x.b)(),z=k===I.f.AWAITING_CONFIRM||k===I.f.PENDING||U===I.f.AWAITING_CONFIRM||U===I.f.PENDING,B=k===I.f.FULFILLED&&U===I.f.FULFILLED,H=z||B||G;function K(){return(K=Object(b.a)(l.a.mark((function t(){var e,r,n,o,c,i,b,u,j,O,m,x,g;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,A){t.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){t.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return e=Object(h.e)(a.actionId,f),r=a.msg,n=r.payload,o=n.name,c=n.body,i=n.metadata,b=r.timestamp,t.next=9,J({partialProposalData:{name:o,body:c,metadata:i,timestamp:b},adapterAddress:e.contractAddress,type:F.SnapshotType.proposal});case 9:return u=t.sent,j=u.data,O=u.signature,m=Object(F.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},L),x=[A,a.idInDAO,m],g=Object(p.a)({from:S||""},q?{gasPrice:q.fast}:null),t.next=17,R("sponsorProposal",e.instance.methods,x,g);case 17:s(),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),d(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))).apply(this,arguments)}return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("button",{className:"proposaldetails__button",disabled:M||H,onClick:M||H?function(){}:function(){return K.apply(this,arguments)},children:z?Object(P.jsx)(D.a,{}):B?"Done":"Sponsor"}),Object(P.jsx)(i.a,{error:c,renderText:"Something went wrong"}),H&&Object(P.jsx)("div",{className:"form__submit-status-container",children:function(){if(k===I.f.AWAITING_CONFIRM||U===I.f.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(k){case I.f.PENDING:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(N.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(t){return Object(P.jsx)(w.a,{children:t},t)}}),Object(P.jsx)(y.a,{url:_,isPending:!0})]});case I.f.FULFILLED:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{children:"Proposal submitted!"}),Object(P.jsx)(y.a,{url:_})]});default:return null}}()}),M&&Object(P.jsx)("button",{className:"button--help-centered",onClick:W,children:"Why is sponsoring disabled?"})]}),Object(P.jsx)(T,{title:"Why is sponsoring disabled?"})]})}var L=a(52);function E(t){var e=t.proposal,a=e.snapshotDraft,s=e.refetchProposalOrDraft,r=Object(j.useState)(),n=Object(u.a)(r,2),c=n[0],d=n[1],f=Object(O.c)((function(t){return t.contracts})),A=Object(O.c)((function(t){var e;return null===(e=t.contracts.DaoRegistryContract)||void 0===e?void 0:e.contractAddress})),v=Object(x.e)(),S=v.account,E=v.web3Instance,_=Object(x.a)(),G=_.txEtherscanURL,R=_.txIsPromptOpen,k=_.txSend,C=_.txStatus,M=Object(g.e)(),W=M.isDisabled,T=M.openWhyDisabledModal,V=M.WhyDisabledModal,U=Object(o.g)(),J=U.proposalSignAndSendStatus,q=U.signAndSendProposal,z=Object(x.b)(),B=C===I.f.AWAITING_CONFIRM||C===I.f.PENDING||J===I.f.AWAITING_CONFIRM||J===I.f.PENDING,H=C===I.f.FULFILLED&&J===I.f.FULFILLED,K=B||H||R;function Q(){return(Q=Object(b.a)(l.a.mark((function t(){var e,r,n,o,c,i,b,u,j,O,m,x,g;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,A){t.next=3;break}throw new Error("No DAO Registry address was found.");case 3:if(a){t.next=5;break}throw new Error("No Snapshot draft was found.");case 5:return e=Object(h.e)(a.actionId,f),r=a.msg,n=r.payload,o=n.name,c=n.body,i=n.metadata,b=r.timestamp,t.next=9,q({partialProposalData:{name:o,body:c,metadata:i,timestamp:b},adapterAddress:e.contractAddress,type:F.SnapshotType.proposal});case 9:return u=t.sent,j=u.data,O=u.signature,m=Object(F.prepareVoteProposalData)({payload:{name:j.payload.name,body:j.payload.body,choices:j.payload.choices,snapshot:j.payload.snapshot.toString(),start:j.payload.start,end:j.payload.end},sig:O,space:j.space,timestamp:parseInt(j.timestamp)},E),x=[A,a.idInDAO].concat(Object(L.a)(i.submitActionArgs||[]),[m]),g=Object(p.a)({from:S||""},z?{gasPrice:z.fast}:null),t.next=17,k("submitProposal",e.instance.methods,x,g);case 17:s(),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),d(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))).apply(this,arguments)}return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("button",{className:"proposaldetails__button",disabled:W||K,onClick:W||K?function(){}:function(){return Q.apply(this,arguments)},children:B?Object(P.jsx)(D.a,{}):H?"Done":"Sponsor"}),Object(P.jsx)(i.a,{error:c,renderText:"Something went wrong"}),K&&Object(P.jsx)("div",{className:"form__submit-status-container",children:function(){if(C===I.f.AWAITING_CONFIRM||J===I.f.AWAITING_CONFIRM)return"Awaiting your confirmation\u2026";switch(C){case I.f.PENDING:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(N.a,{intervalMs:2e3,messages:m.b,useFirstItemStart:!0,render:function(t){return Object(P.jsx)(w.a,{children:t},t)}}),Object(P.jsx)(y.a,{url:G,isPending:!0})]});case I.f.FULFILLED:return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{children:"Proposal submitted!"}),Object(P.jsx)(y.a,{url:G})]});default:return null}}()}),W&&Object(P.jsx)("button",{className:"button--help-centered",onClick:T,children:"Why is sponsoring disabled?"})]}),Object(P.jsx)(V,{title:"Why is sponsoring disabled?"})]})}function _(t){var e=t.adapterName,a=t.proposal,d=t.renderAction,l=Object(o.c)(a),p=l.daoProposalVoteResult,b=l.daoProposalVotes,u=l.proposalFlowStatusError,j=l.status,O=b&&j===n.c.OffchainVotingGracePeriod?1e3*Number(b.gracePeriodStartingTime)||Date.now():0,f=d&&d(Object(s.a)({},c.c.OffchainVotingContract,{adapterName:e,daoProposalVoteResult:p,daoProposalVotes:b,gracePeriodStartMs:O,proposal:a,status:j}));return Object(P.jsxs)(P.Fragment,{children:[(j===n.c.OffchainVoting||j===n.c.OffchainVotingSubmitResult||j===n.c.OffchainVotingGracePeriod||j===n.c.Process||j===n.c.Completed)&&Object(P.jsx)(r.c,{countdownGracePeriodStartMs:O,proposal:a}),Object(P.jsx)("div",{className:"proposaldetails__button-container",children:f||(j===n.c.Submit?Object(P.jsx)(E,{proposal:a}):j===n.c.Sponsor?Object(P.jsx)(S,{proposal:a}):j===n.c.OffchainVoting?Object(P.jsx)(r.b,{adapterName:e,proposal:a}):j===n.c.OffchainVotingSubmitResult?Object(P.jsx)(r.a,{adapterName:e,proposal:a}):j===n.c.Process||j===n.c.OffchainVotingGracePeriod?Object(P.jsx)(v,{disabled:j===n.c.OffchainVotingGracePeriod,proposal:a}):void 0)}),Object(P.jsx)(i.a,{error:u,renderText:"Something went wrong while getting the proposal's status"})]})}}}]);
//# sourceMappingURL=8.f718f035.chunk.js.map