{"version":3,"sources":["config.ts","assets/svg/TimesSVG.tsx","util/helpers/chooseRandom.ts","util/helpers/disableReactDevTools.ts","util/helpers/dontCloseWindowWarning.ts","util/helpers/formatDecimal.ts","util/helpers/formatNumber.ts","util/helpers/getValidationError.ts","util/helpers/normalizeString.ts","util/helpers/isPossibleContractWallet.ts","util/helpers/numberRangeArray.ts","util/helpers/stripFormatNumber.ts","components/proposals/voting/OffchainOpRollupVotingSubmitResultAction.tsx","components/proposals/voting/OffchainVotingAction.tsx","components/proposals/ProposalPeriod.tsx","assets/svg/StopwatchSVG.tsx","components/proposals/voting/VotingStatus.tsx","components/proposals/voting/OffchainVotingStatus.tsx","assets/svg/CheckSVG.tsx","components/proposals/voting/SquareRootVotingBar.tsx","components/proposals/voting/VotingActionButtons.tsx","components/common/Modal.tsx","hooks/useRedeemCoupon.ts","components/web3/hooks/useContractSend.ts","components/web3/hooks/useETHGasPrice.ts","components/web3/hooks/useInitContracts.ts","components/web3/hooks/useIsDefaultChain.ts","components/web3/hooks/useMaybeContractWallet.ts","store/connectedMember/actions.ts","store/connectModal/actions.ts","components/web3/hooks/useWeb3ModalManager.ts","components/adapters-extensions/enums.ts","store/contracts/actions.ts","util/helpers/truncateEthAddress.ts","components/web3/helpers/getExtensionAddress.ts","store/subgraphNetworkStatus/actions.ts","components/feedback/CycleEllipsis.tsx","components/proposals/SubmitAction.tsx","components/web3/Web3ModalManager.tsx","components/common/FadeIn.tsx","components/common/ErrorMessageWithDetails.tsx","components/web3/helpers/contractSend.ts","components/web3/helpers/getAdapterAddress.ts","components/web3/helpers/getAdapterAddressFromContracts.ts","components/web3/helpers/getDaoState.ts","components/web3/helpers/getContractByAddress.ts","components/web3/helpers/getDAOConfigEntry.ts","components/web3/helpers/getVotingAdapterName.ts","components/web3/helpers/hasFlag.ts","components/web3/helpers/multicall.ts","util/enums.ts","components/proposals/types.ts","hooks/useAbortController.ts","hooks/useCounter.ts","hooks/useDao.ts","hooks/useDaoTotalUnits.ts","hooks/useIsMounted.ts","hooks/useMemberActionDisabled.tsx","components/proposals/hooks/useCheckApplicant.ts","components/proposals/hooks/useDaoProposals.ts","components/proposals/hooks/useOffchainVotingResults.ts","components/proposals/hooks/useProposalsVotingAdapter.ts","components/proposals/hooks/useProposalOrDraft.ts","components/proposals/hooks/useProposals.ts","components/proposals/hooks/useProposalsVotes.ts","components/proposals/hooks/useProposalsVotingState.ts","components/proposals/hooks/useProposalWithOffchainVoteStatus.ts","components/proposals/hooks/useSignAndSendVote.ts","components/proposals/hooks/useSignAndSubmitProposal.ts","components/proposals/hooks/useVotingTimeStartEnd.ts","components/feedback/Loader.tsx","components/web3/WalletIcon.tsx","components/web3/EtherscanURL.tsx","components/web3/types.ts","components/proposals/voting/types.ts","util/constants.ts","components/proposals/helpers/getOffchainVotingProof.ts","components/proposals/helpers/getVoteChosen.ts","components/proposals/helpers/getVotingAdapterABI.ts","components/proposals/helpers/proposalHasFlag.ts","components/proposals/helpers/proposalHasVotingState.ts","components/proposals/helpers/submitOffchainVotingProof.ts","components/web3/config.ts","components/feedback/index.ts","components/feedback/CycleMessage.tsx","components/feedback/LoaderLarge.tsx","util/validation.ts","gql/queryDao.ts","gql/queryAdaptersAndExtensions.ts","gql/queryMembers.ts","gql/queryTokenHolderBalances.ts","gql/handleSubgraphError.ts","util/types.ts","store/subgraphNetworkStatus/types.ts","store/connectedMember/reducers.ts","store/connectModal/reducers.ts","store/contracts/reducers.ts","store/subgraphNetworkStatus/reducers.ts","store/reducers.ts","store/index.ts","components/Footer.tsx","GlobalConnectWalletModal.tsx","Head.tsx","components/logo/Logo.tsx","components/logo/index.tsx","components/web3/Web3ModalButton.tsx","components/dao-token/hooks/useDaoTokenDetails.ts","components/dao-token/DaoTokenHolder.tsx","components/dao-token/hooks/useTokenHolderBalances.ts","components/Nav.tsx","components/Header.tsx","components/adapters-extensions/helpers.ts","components/adapters-extensions/config.ts","components/adapters-extensions/hooks/useAdaptersOrExtensions.ts","components/adapters-extensions/hooks/useValidation.ts","components/adapters-extensions/AdapterOrExtensionSelectTarget.tsx","components/common/InputError.tsx","components/adapters-extensions/ConfigurationForm.tsx","components/adapters-extensions/ConfigurationModal.tsx","components/common/Checkbox.tsx","components/adapters-extensions/FinalizeModal.tsx","components/adapters-extensions/AdapterOrExtensionManager.tsx","components/common/Wrap.tsx","components/adapters-extensions/hooks/useInitAdapterExtensionContracts.ts","pages/governance/CreateGovernanceProposal.tsx","components/common/PreviewInputMarkdown.tsx","pages/membership/CreateMembershipProposal.tsx","pages/transfers/CreateTransferProposal.tsx","pages/tributes/CreateTributeProposal.tsx","assets/images/compost.jpg","pages/start/GetStarted.tsx","components/governance/GovernanceActions.tsx","pages/subpages/NotFound.tsx","components/proposals/ProposalDetails.tsx","pages/governance/GovernanceProposalDetails.tsx","components/proposals/ProposalCard.tsx","components/governance/GovernanceProposalsList.tsx","components/governance/hooks/useGovernanceProposals.ts","pages/governance/GovernanceProposals.tsx","pages/members/hooks/useMembers.ts","pages/members/Delegation.tsx","assets/svg/CopySVG.tsx","assets/svg/WalletSVG.tsx","components/dao-token/DaoToken.tsx","assets/svg/UserSVG.tsx","pages/members/MemberProfile.tsx","pages/members/MemberCard.tsx","pages/members/Members.tsx","components/proposals/Proposals.tsx","pages/membership/Membership.tsx","components/proposals/ProcessActionMembership.tsx","components/proposals/ProposalActions.tsx","components/proposals/ProposalAmount.tsx","pages/membership/MembershipDetails.tsx","components/feedback/LoaderWithEmoji.tsx","pages/redeem/RedeemManager.tsx","pages/redeem/Redeem.tsx","components/proposals/PostProcessActionTransfer.tsx","pages/transfers/TransferDetails.tsx","pages/transfers/Transfers.tsx","components/proposals/ProcessActionTribute.tsx","pages/tributes/TributeDetails.tsx","pages/tributes/Tributes.tsx","pages/water/Water.tsx","Routes.tsx","Init.tsx","App.tsx","InitError.tsx","reportWebVitals.ts","index.tsx","components/web3/hooks/useWeb3Modal.ts"],"names":["dotenvConfig","path","resolve","__dirname","process","REACT_APP_DAO_REGISTRY_CONTRACT_ADDRESS","REACT_APP_DEFAULT_CHAIN_NAME_LOCAL","REACT_APP_ENVIRONMENT","REACT_APP_GRAPH_API_URL","REACT_APP_INFURA_PROJECT_ID_DEV","REACT_APP_INFURA_PROJECT_ID_LOCAL","REACT_APP_INFURA_PROJECT_ID_PROD","REACT_APP_MULTICALL_CONTRACT_ADDRESS","REACT_APP_SNAPSHOT_HUB_API_URL","REACT_APP_COUPON_API_URL","REACT_APP_SNAPSHOT_SPACE","ENVIRONMENT","SNAPSHOT_HUB_API_URL","COUPON_API_URL","GRAPH_API_URL","CHAINS","MAINNET","ROPSTEN","RINKEBY","GOERLI","KOVAN","GANACHE","CHAIN_NAME_FULL","DEFAULT_CHAIN","ETHERSCAN_URLS","INFURA_WS_URLS","INFURA_PROJECT_ID","ETHEREUM_PROVIDER_URL","WALLETCONNECT_PROVIDER_OPTIONS","injected","display","name","description","package","walletconnect","WalletConnectProvider","options","infuraId","qrcodeModalOptions","mobileLinks","DAO_REGISTRY_CONTRACT_ADDRESS","DAO_FACTORY_CONTRACT_ADDRESS","BANK_FACTORY_CONTRACT_ADDRESS","VOTING_CONTRACT_ADDRESS","WATER_CONTRACT_ADDRESS","CONFIGURATION_CONTRACT_ADDRESS","RAGEQUIT_CONTRACT_ADDRESS","MANAGING_CONTRACT_ADDRESS","FINANCING_CONTRACT_ADDRESS","ONBOARDING_CONTRACT_ADDRESS","GUILDKICK_CONTRACT_ADDRESS","DAO_REGISTRY_ADAPTER_CONTRACT_ADDRESS","BANK_ADAPTER_CONTRACT_ADDRESS","NFT_ADAPTER_CONTRACT_ADDRESS","COUPONONBOARDING_CONTRACT_ADDRESS","TRIBUTE_CONTRACT_ADDRESS","DISTRIBUTE_CONTRACT_ADDRESS","TRIBUTE_NFT_CONTRACT_ADDRESS","OFFCHAINVOTING_CONTRACT_ADDRESS","MULTICALL_CONTRACT_ADDRESS","GUILD_ADDRESS","TOTAL_ADDRESS","UNITS_ADDRESS","MEMBER_COUNT_ADDRESS","ETH_TOKEN_ADDRESS","SPACE","GQL_QUERY_POLLING_INTERVAL","TimesSVG","xmlns","viewBox","fill","d","chooseRandom","array","doNotChooseItem","arrayToUse","undefined","filter","a","Math","floor","random","length","disableReactDevTools","noop","DEV_TOOLS","window","__REACT_DEVTOOLS_GLOBAL_HOOK__","Object","entries","key","value","dontCloseWindowWarning","callback","event","preventDefault","returnValue","addEventListener","removeEventListener","formatDecimal","n","toFixed","formatNumber","regEx","RegExp","toString","replace","getValidationError","field","errors","message","normalizeString","stringToNormalize","toLowerCase","trim","isPossibleContractWallet","address","provider","getCode","bytecode","addressIsExernallyOwnedAccount","numberRangeArray","size","startAt","adjustedSize","Array","map","_","i","stripFormatNumber","OffchainOpRollupVotingSubmitResultAction","props","adapterName","proposal","daoProposalVotingAdapter","snapshotProposal","useState","Web3TxStatus","STANDBY","signatureStatus","setSignatureStatus","submitError","setSubmitError","bankExtensionAddress","useSelector","s","contracts","BankExtensionContract","contractAddress","bankExtensionMethods","instance","methods","getPriorAmountABI","abi","find","ai","daoRegistryAddress","DaoRegistryContract","getMemberAddressABI","useWeb3Modal","account","web3Instance","useContractSend","txEtherscanURL","txIsPromptOpen","txSend","txStatus","useMemberActionDisabled","isDisabled","openWhyDisabledModal","WhyDisabledModal","fastGasPrice","useETHGasPrice","fast","votingAdapterMethods","getWeb3VotingAdapterContract","isInProcess","AWAITING_CONFIRM","PENDING","isDone","FULFILLED","isInProcessOrDone","Error","votes","proposalHash","idInDAO","snapshot","msg","payload","adapterAddress","getAdapterAddressFromContracts","getPriorAmount","call","numberOfDAOMembersAtSnapshot","getMemberAddressCalls","Number","memberIndex","multicall","calls","memberAddresses","memberBalanceCalls","m","memberBalancesAtSnapshot","memberAddress","voteData","values","v","metadata","createVote","proposalId","sig","timestamp","voteYes","choice","VoteChoicesIndex","Yes","weight","prepareVoteResult","actionId","chainId","daoAddress","voteResultTree","result","voteResultTreeHexRoot","getHexRoot","getVoteResultRootDomainDefinition","domain","types","messageParams","JSON","stringify","root","primaryType","PRIMARY_TYPE_ERC712","signMessage","signature","getOffchainVotingProof","merkle_root","submitOffchainVotingProof","steps","merkleRoot","verifyingContract","submitVoteResultArguments","txArguments","from","gasPrice","REJECTED","className","disabled","onClick","Loader","ErrorMessageWithDetails","error","renderText","CycleMessage","intervalMs","messages","TX_CYCLE_MESSAGES","useFirstItemStart","render","FadeIn","EtherscanURL","url","isPending","renderSubmitStatus","title","OffchainVotingAction","voteChoiceClicked","setVoteChoiceClicked","votingDisabledReasonsRef","useRef","addressIsDelegatedMessage","alreadyVotedMessage","delegateAddress","connectedMember","delegateKey","isAddressDelegated","useSignAndSendVote","signAndSendVote","voteDataStatus","voteChosen","getVoteChosen","setOtherDisabledReasons","snapshotProposalId","idInSnapshot","isSubmitDisabled","voteChoiceProgress","VoteChoices","partialVoteData","proposalIdInDAO","proposalIdInSnapshot","refetchProposalOrDraft","useEffect","truncateEthAddress","current","VotingActionButtons","buttonProps","voteProgress","ProposalPeriod","startLabel","startPeriodMs","endLabel","endedLabel","endPeriodMs","proposalPeriod","setProposalPeriod","displayCountdownCached","useCallback","countdown","showDaysOnly","endtime","t","Date","parse","seconds","minutes","hours","total","days","getTimeRemaining","formatTimePeriod","time","period","formattedPeriod","interval","setInterval","currentDate","startDate","endDate","start","end","clearInterval","StopwatchSVG","width","height","version","id","stroke","strokeWidth","fillRule","xlinkHref","VotingStatus","hasVotingEnded","noUnits","renderStatus","renderTimer","showPercentages","totalUnits","yesUnits","renderedStatus","role","SquareRootVotingBar","votingExpired","gracePeriodEndLabel","gracePeriodEndedLabel","style","textTransform","cycleEllipsisFadeInProps","duration","OffchainVotingStatus","countdownGracePeriodStartMs","votingResult","daoRegistryInstance","didVotePass","setDidVotePass","gracePeriodEndMs","setGracePeriodEndMs","useVotingTimeStartEnd","hasVotingTimeStarted","hasVotingTimeEnded","votingTimeStartEndInitReady","offchainVotingResults","useOffchainVotingResults","votingResultToUse","votingStartSeconds","votingEndSeconds","units","No","getDAOConfigEntry","ContractDAOConfigKeys","offchainVotingGracePeriod","then","r","catch","ProposalPeriodComponent","ariaLabel","fadeInProps","CheckSVG","xmlnsXlink","getUnitsPercent","percentYes","percentNo","getVotedClass","getARIALabel","getVotingText","handleClick","Modal","children","isOpen","isOpenHandler","keyProp","modalClassNames","styleProps","ariaHideApp","onRequestClose","overlayClassName","overlay","zIndex","FetchStatus","useRedeemCoupon","daoRegistryContract","couponOnboardingContract","CouponOnboardingContract","submitStatus","setSubmitStatus","defaultChainError","useIsDefaultChain","txError","dispatch","useDispatch","redeemableCoupon","erc20Details","applicantAddressToChecksum","toChecksumAddress","recipient","redeemCouponArguments","String","amount","nonce","fetch","method","body","headers","getConnectedMember","addTokenToWallet","ethereum","request","params","type","console","log","redeemCoupon","setTxError","setTxEtherscanURL","setTxIsPromptOpen","txReceipt","setTxReceipt","setTxStatus","networkId","handleOnTxProcess","txHash","unsubscribeDontCloseWindow","contractSendParams","contractSend","receipt","convertGasToWEI","gasStationPrice","toWei","BigNumber","INITIAL_GAS_PRICES","average","fastest","safeLow","ignoreEnvironment","gasPrices","setGasPrices","gasPriceError","setGasPriceError","AsyncStatus","gasPriceStatus","setGasPriceStatus","useAbortController","abortController","isMountedRef","shouldExitIfNotProduction","signal","response","ok","json","jsonResponse","abort","useInitContracts","initContractDaoRegistry","initContractDaoFactory","initContractBankFactory","initContractConfiguration","initContractFinancing","initContractGuildKick","initContractManaging","initContractRagequit","initContractBankAdapter","initContractBankExtension","initContractOnboarding","initContractTribute","initContractDistribute","initRegisteredVotingAdapter","initContractTributeNFT","initContractNFTExtension","initContractNFTAdapter","initContractCouponOnboarding","initContractDaoRegistryAdapter","initContractERC20Extension","connected","setDefaultChainError","defaultChain","isDefaultChain","INITIAL_MAYBE_CONTRACT_WALLET_STATE","useMaybeContractWallet","web3Provider","maybeContractWallet","setMaybeContractWallet","useIsMounted","handleIsPossibleContractWalletCached","Web3Provider","SET_CONNECTED_MEMBER","CLEAR_CONNECTED_MEMBER","daoRegistryMethods","getAddressIfDelegatedABI","membersABI","isActiveMemberABI","getCurrentDelegateKeyABI","clearConnectedMember","addressIfDelegated","memberFlag","isActiveMember","currentDelegateKey","doesMemberExist","hasFlag","MemberFlag","EXISTS","BURN_ADDRESS","CONNECT_MODAL_CLOSE","CONNECT_MODAL_OPEN","connectModalClose","connectModalOpen","DefaultTheme","ActionType","Web3ModalErrorType","INITIAL_STATE","reducer","state","CONNECT_WEB3MODAL","DEACTIVATE_PROVIDER_WEB3MODAL","ERROR_WEB3MODAL","INITIAL_CACHED_CONNECTOR_CHECK_STATUS","initialCachedConnectorCheckStatus","NEW_WEB3MODAL","web3Modal","UPDATE_ACCOUNT","useWeb3ModalManager","defaultTheme","onBeforeConnect","onBeforeDisconnect","providerOptions","useReducer","web3ModalTheme","web3ModalChain","connectWeb3ModalCached","connectWeb3Modal","chainChangedCallbackCached","_chainIdHex","cachedProvider","accountsChangedCallback","connectorId","connectCallback","statusAction","connectTo","Web3","eth","getAccounts","net","getId","CONNECT","close","clearCachedProvider","DISCONNECT","on","removeListener","Web3Modal","cacheProvider","network","NetworkNames","NetworkIDs","theme","attemptUpdateFromCachedConnector","disconnectWeb3Modal","DaoAdapterConstants","DaoExtensionConstants","VotingAdapterName","CLEAR_CONTRACTS","CONTRACT_BANK_ADAPTER","CONTRACT_BANK_EXTENSION","CONTRACT_BANK_FACTORY","CONTRACT_CONFIGURATION","CONTRACT_COUPON_ONBOARDING","CONTRACT_DAO_FACTORY","CONTRACT_DAO_REGISTRY","CONTRACT_DAO_REGISTRY_ADAPTER","CONTRACT_DISTRIBUTE","CONTRACT_ERC20_EXTENSION","CONTRACT_FINANCING","CONTRACT_GUILDKICK","CONTRACT_MANAGING","CONTRACT_NFT_ADAPTER","CONTRACT_NFT_EXTENSION","CONTRACT_ONBOARDING","CONTRACT_RAGEQUIT","CONTRACT_TRIBUTE","CONTRACT_TRIBUTE_NFT","CONTRACT_VOTING","CONTRACT_VOTING_OP_ROLLUP","CONTRACT_WATER","clearContracts","lazyBankFactoryABI","default","bankFactoryContract","Contract","createContractAction","lazyDaoFactoryABI","daoFactoryContract","lazyDaoRegistryABI","initContractVoting","initContractThunkFactory","actionType","adapterOrExtensionName","ContractAdapterNames","voting","adapterNameForRedux","VotingContract","lazyImport","initContractVotingOpRollup","OffchainVotingContract","ONBOARDING","onboarding","BANK","ContractExtensionNames","bank","isExtension","TRIBUTE","tribute","DISTRIBUTE","distribute","MANAGING","managing","NFT","nft","DAO_REGISTRY","dao_registry","RAGEQUIT","ragequit","GUILDKICK","guildkick","FINANCING","financing","CONFIGURATION","configuration","TRIBUTE_NFT","tribute_nft","COUPON_ONBOARDING","coupon_onboarding","ERC20","erc20","getState","warn","votingAdapterName","getVotingAdapterName","getAdapterAddress","lazyABI","contractABI","getExtensionAddress","addr","maxLength","isEthAddressValid","firstSegment","substring","secondPart","extensionName","daoContractInstance","utils","sha3","SET_SUBGRAPH_NETWORK_STATUS","setSubgraphNetworkStatus","MESSAGES","rootStyles","position","nbspStyles","CycleEllipsis","fadeInPropsMerged","inline","upToIndex","setUpToIndex","intervalId","prevIndex","SubmitAction","checkApplicant","snapshotDraft","actionDisabledReasonsRef","invalidApplicantMessage","useSignAndSubmitProposal","proposalSignAndSendStatus","signAndSendProposal","useCheckApplicant","checkApplicantError","checkApplicantInvalidMsg","checkApplicantStatus","isApplicantValid","contract","getContractByAddress","partialProposalData","SnapshotType","data","preparedVoteVerificationBytes","prepareVoteProposalData","choices","space","parseInt","submitArguments","submitActionArgs","Web3ModalContext","createContext","Web3ModalManager","DARK","defaultWeb3InstanceRef","providers","WebsocketProvider","defaultWeb3NetID","setDefaultWeb3NetID","web3ModalProviderArguments","currentProvider","web3ModalContext","Provider","defaultStyle","transition","opacity","transitionStyles","entering","entered","exiting","exited","appear","in","show","timeout","isExpanded","setIsExpanded","isWalletRejectedRequest","code","test","textToDisplay","areErrorMessageAndTextStringSame","detailsProps","cursor","outline","methodName","contractInstanceMethods","methodArguments","onProcess","Promise","reject","BN","estimateGas","gas","gastoBN","decimalPlaces","ROUND_DOWN","toNumber","send","getContractAddressOrThrow","DistributeContract","ManagingContract","OnboardingContract","TributeContract","TributeNFTContract","DaoState","c","configKey","getConfiguration","getDaoState","CREATION","READY","lazyIVotingABI","getAdapterName","flagToCheck","daoProposalFlag","log2","blockNumber","lazyMulticallABI","multicallMethods","aggregate","encodeFunctionCall","returnData","hexString","outputsABIItem","outputs","decodedOutputs","decodeParameters","__length__","FormFieldErrors","ProposalHeaderNames","ProposalFlag","ProposalFlowStatus","DistributionStatus","SnapshotMetadataType","setAbortController","AbortController","initialState","count","action","useCounter","useDao","useLazyQuery","GET_DAO","variables","getDao","called","loading","dao","setDao","gqlError","setGqlError","getDaoRegistryCallback","tributeDaos","useDaoTotalUnits","subgraphNetworkStatus","status","getDaoFromSubgraphResult","setTotalUnits","totalUnitsStatus","setTotalUnitsStatus","totalUnitsError","setTotalUnitsError","getTotalUnitsFromExtensionCached","getTotalUnitsFromSubgraphCached","balanceOf","SubgraphNetworkStatus","OK","skipIsActiveMemberCheck","otherDisabledReasons","shouldShowWhyModal","setShouldShowWhyModal","otherReasonNext","disabledReason","getDisabledReason","canShowDisabledReason","WhyDisabledModalCached","handleSetOtherDisabledReasonsCached","otherReasons","Boolean","setCheckApplicantError","setCheckApplicantInvalidMsg","setCheckApplicantStatus","setIsApplicantValid","prevAddress","usePreviousDistinct","checkApplicantValidityCached","truncatedAddress","daoRegistryABI","getIsNotReservedAddressABI","item","isNotReservedAddressCall","getIsNotZeroAddressABI","isNotZeroAddressCall","getGetAddressIfDelegatedABI","isNotReservedAddressResult","isNotZeroAddressResult","getAddressIfDelegatedResult","INITIAL_DAO_PROPOSAL_ENTRIES","useDaoProposals","proposalIds","proposalsAbi","registryAddress","daoProposals","setDaoProposals","daoProposalsStatus","setDaoProposalsStatus","daoProposalsError","setDaoProposalsError","safeProposalIds","isHexStrict","proposals","handleGetDaoProposals","bankABI","bankAddress","votingResults","setVotingResults","offchainVotingResultsStatus","setOffchainVotingResultsStatus","offchainVotingResultsError","setOffchainVotingResultsError","getUnitsPerChoiceCached","voterAddressesAndChoices","percentage","results","totalUnitsCall","unitsCalls","totalUnitsResult","forEach","proposalsToMap","isArray","votingResultPromises","p","voterEntries","vote","keys","fromEntries","all","INITIAL_VOTING_ADAPTERS","useProposalsVotingAdapter","registryABI","proposalsVotingAdapters","setProposalsVotingAdapters","proposalsVotingAdaptersError","setProposalsVotingAdaptersError","proposalsVotingAdaptersStatus","setProposalsVotingAdaptersStatus","getProposalsVotingAdaptersOnchainCached","votingAdapterABI","votingAdapterCalls","votingAdapterAddressResults","getAdapterNameABI","filteredProposalIds","_id","filteredVotingAdapterAddressResults","votingAdapterNameCalls","votingAdapterAddress","adapterNameResults","getVotingAdapterABI","votingAdaptersToSet","ERROR_PROPOSAL","ERROR_PROPOSAL_NOT_FOUND","useProposalOrDraft","daoProposal","setSnapshotDraft","setSnapshotProposal","proposalNotFound","setProposalNotFound","proposalError","setProposalError","proposalStatus","setProposalStatus","proposalVotingAdapterId","setProposalVotingAdapterId","proposalInclusiveStatus","setProposalInclusiveStatus","proposalInclusiveError","setProposalInclusiveError","refetchCount","updateRefetchCount","handleGetDraftCached","handleGetProposalCached","handleGetProposalOrDraftCached","snapshotType","draft","proposalData","getCommonSnapshotProposalData","responseJSON","idKey","erc712DraftHash","statuses","some","every","e","INITIAL_ARRAY","getSnapshotDraftsByAdapterAddress","baseURL","drafts","draftsJSON","draftEntries","sponsored","getSnapshotProposalsByAdapterAddress","proposalsJSON","proposalEntries","useProposals","includeProposalsExistingOnlyOffchain","setAdapterAddress","snapshotDraftAndProposals","setSnapshotDraftAndProposals","snapshotDraftAndProposalsStatus","setSnapshotDraftAndProposalsStatus","snapshotDraftAndProposalsError","setSnapshotDraftAndProposalsError","daoProposalIdsToUse","setDaoProposalIdsToUse","setProposals","proposalsInclusiveStatus","setProposalsInclusiveStatus","proposalsInclusiveError","setProposalsInclusiveError","useMemo","useProposalsVotingState","proposalsVotingState","proposalsVotingStateError","proposalsVotingStateStatus","proposalVotingAdapters","proposalsVotes","setProposalsVotes","proposalsVotesError","setProposalsVotesError","proposalsVotesStatus","setProposalsVotesStatus","getProposalsVotesOnchainCached","safeProposalVotingAdapters","getVotesDataABI","votesDataCalls","votesDataResults","offchainVotesDataABI","votingVotesDataABI","useProposalsVotes","snapshotDraftEntries","snapshotProposalEntries","mergedEntries","handleGetAllSnapshotDraftsAndProposals","flags","proposalsToSet","daoProposalId","snapshotId","snapshotDataId","snapshotData","isSnapshotDraft","proposalIdVotingAdapter","daoProposalVotingState","proposalIdVotingState","daoProposalVotes","proposalIdVotes","proposalsError","proposalsStatus","setProposaslsVotingState","setProposalsVotingStateError","setProposalsVotingStateStatus","getProposalsVotingStateOnchainCached","votingResultAbi","proposalsVotingStateResult","DEFAULT_POLL_INTERVAL_MS","useProposalWithOffchainVoteStatus","snapshotVotes","pollInterval","setDAOProposal","setDAOProposalVotes","daoProposalVoteResult","setDAOProposalVoteResult","proposalFlowStatusError","setProposalFlowStatusError","pollingIntervalIdRef","stopPollingRef","atExistsInDAO","proposalHasFlag","atSponsoredInDAO","SPONSORED","atProcessedInDAO","PROCESSED","offchainVotingAddress","offchainVotingABI","offchainResultSubmitted","isAddress","reporter","isInVotingGracePeriod","VotingState","GRACE_PERIOD","getStatusFromContractCached","getReturnData","proposalsABI","voteResultABI","votesABI","voteResult","Sponsor","OffchainVoting","OffchainVotingGracePeriod","Process","OffchainVotingSubmitResult","Completed","Submit","setVoteData","voteDataError","setVoteDataError","setVoteDataStatus","getSpace","snapshotSpace","voteProposalData","token","buildVoteMessage","erc712Message","prepareVoteMessage","getDomainDefinition","dataToSign","submitMessage","dataToReturn","uniqueId","setProposalData","proposalSignAndSendError","setProposalSignAndSendError","setProposalSignAndSendStatus","buildProposalMessageHelper","commonData","getBlockNumber","offchainVotingVotingPeriod","votingTimeSeconds","buildProposalMessage","buildDraftMessage","prepareDraftMessage","prepareProposalMessage","uniqueIdDraft","startSeconds","endSeconds","votingStartEndStatusRef","setHasVotingTimeStarted","setHasVotingTimeEnded","isInitReady","setVotingTimeStartEndInitReady","intervalID","hasStartedCheck","now","hasEndedCheck","ceil","Spinner","showAfterMs","text","textProps","loaderProps","showLoaderAfterMs","setShowLoaderAfterMs","timeoutId","setTimeout","clearTimeout","MetaMaskSVG","lazy","WalletConnectSVG","walletIconMap","WalletIcon","providerName","fallback","href","rel","target","merkleRootHex","voteEntry","ve","lazyOffchainVotingABI","lazyVotingABI","proposalHasVotingState","votingStateToCheck","votingState","INITIAL_ITEM","activeMessage","setActiveMessage","prevMessage","LoaderLarge","ethAddress","gql","GET_ADAPTERS_AND_EXTENSIONS","GET_MEMBERS","GET_TOKEN_HOLDER_BALANCES","handleSubgraphError","store","onError","networkError","ERR","setConnectedMemberReducer","clearConnectedMemberReducer","BankAdapterContract","BankFactoryContract","ConfigurationContract","DaoFactoryContract","DaoRegistryAdapterContract","ERC20ExtensionContract","FinancingContract","GuildBankContract","NFTAdapterContract","NFTExtensionContract","RagequitContract","WaterContract","contractBankFactory","contractDAOFactory","contractDAORegistry","contractDaoRegistryAdapter","contractBankExtension","contractConfiguration","contractDistribute","contractFinancing","contractGuildBank","contractOnboarding","contractRagequit","contractTribute","contractVoting","contractWater","contractManaging","contractBankAdapter","contractNFTAdapter","contractTributeNFT","contractCouponOnboarding","contractNFTExtension","contractERC20Extension","combineReducers","connectModal","createStore","rootReducer","composeWithDevTools","applyMiddleware","thunk","Footer","useLocation","pathname","ConnectWalletModal","GlobalConnectWalletModal","isConnectModalOpen","modalProps","setModalProps","prevState","Head","Helmet","content","Logo","LeftLogo","CenterLogo","ConnectWalletButton","customWalletText","showWalletETHBadge","isWrongNetwork","isMobile","useDaoTokenDetails","daoTokenDetails","setDaoTokenDetails","daoTokenDetailsStatus","setDaoTokenDetailsStatus","daoTokenDetailsError","setDaoTokenDetailsError","getDaoTokenDetailsCached","symbol","decimals","image","location","origin","DaoTokenHolder","customStyles","badgeStyles","tokenHolder","setTokenHolder","tokenImageUrl","setTokenImageURL","tokenEtherscanURL","setTokenEtherscanURL","tokenHolderBalances","erc20ExtensionContract","tokenAddress","getTokenHolderBalances","startPolling","stopPolling","setTokenHolderBalances","getTokenBalanceCallback","tokens","pollingTimeoutId","useTokenHolderBalances","getTokenImageCallback","blob","reader","FileReader","onloadend","onerror","readAsDataURL","dataUrl","holders","holderData","holder","member","balance","src","alt","NavLinks","tabIndex","to","Nav","query","_matches","border","Header","RenderLogo","getAdapterOrExtensionId","getAccessControlLayer","acl","accessFlags","SUBMIT_PROPOSAL","PROCESS_PROPOSAL","SPONSOR_PROPOSAL","SET_CONFIGURATION","INTERNAL_TRANSFER","EXECUTION","NEW_MEMBER","ADD_TO_BALANCE","REGISTER_NEW_TOKEN","SUB_FROM_BALANCE","JAIL_MEMBER","UNJAIL_MEMBER","REMOVE_ADAPTER","ADD_ADAPTER","OFFCHAINVOTING","UPDATE_DELEGATE_KEY","NONVOTING_ONBOARDING","VOTING","WATER","WITHDRAW","UPDATE_TOKEN","COLLECT_NFT","WITHDRAW_NFT","ADAPTER_ACCESS_FLAGS","ADD_EXTENSION","REMOVE_EXTENSION","EXTENSION_ACCESS_FLAGS","TRANSFER_NFT","idx","reduce","b","entry","defaultAdaptersAndExtensions","adapterId","abiFunctionName","displayName","setAclToExtensionForAdapter","optionDefaultTarget","useAdaptersOrExtensions","adapterExtensionContracts","getRegisteredAdaptersAndExtensions","registeredAdaptersOrExtensions","setRegisteredAdaptersOrExtensions","unRegisteredAdaptersOrExtensions","setUnRegisteredAdaptersOrExtensions","adapterExtensionStatus","setAdapterExtensionStatus","getAdaptersAndExtensionsCached","registeredDaoAdapters","registeredDaoExtensions","registeredList","unRegisteredList","getAdapterFromGql","adapter","getExtensionFromGql","extensionId","extension","adapterOrExtension","gqlExtension","push","maybeSomeAdapters","maybeSomeExtensions","shouldSkip","option","gqlAdapter","adapters","extensions","getAdapterOrExtensionFromRedux","ae","ParamType","useValidation","isParamInputValid","paramInput","paramType","parameter","ADDRESS","checkAddressChecksum","isAddressValid","BYTES32","isHex","isBytes32Valid","BYTES32_ARRAY","split","isBytes32ArrayValid","UINT256","isNaN","isUint256Valid","UINT256_ARRAY","isUint256ArrayValid","getFormFieldError","INVALID_ETHEREUM_ADDRESS","INVALID_BYTES32","INVALID_BYTES32_ARRAY","INVALID_NUMBER","INVALID_NUMBER_ARRAY","REQUIRED","formatInputByType","inputValue","inputType","AdapterExtensionSelectTarget","defaultTarget","renderActions","renderCheckboxAction","selectedTargetOption","setSelectedTargetOption","selectedTargetOptionProps","setSelectedTargetOptionProps","onChange","selectedTargetProps","selectedOption","toUpperCase","renderDescription","InputError","restProps","ConfigurationForm","abiConfigurationInputs","abiMethodName","closeHandler","configureAdapterStatus","setConfigureAdapterStatus","removeStatus","setRemoveStatus","form","useForm","mode","reValidateMode","formState","getValues","setValue","register","trigger","configureAdapterError","isConnected","adapterOrExtensionText","isValid","isConfigureInProcess","isRemoveInProcess","isConfigureDone","isRemoveDone","isConfigureInProcessOrDone","isRemoveInProcessOrDone","removeExtensionArgument","removeAdapterArguments","adapterConfigArguments","abiInput","formattedValue","onSubmit","input","placeholder","ref","validate","handleSubmit","handleRemove","ConfigurationModal","configurationInputs","CheckboxSize","Checkbox","checked","htmlFor","SMALL","label","FinalizeModal","finalizeError","finalizeDao","WhyDisableModalTitles","Wrap","rest","AdapterOrExtensionManager","setABIMethodName","daoState","setDaoState","setIsDone","inputParameters","setInputParameters","openConfigureModal","setOpenConfigureModal","openFinalizeModal","setOpenFinalizeModal","selectAll","setSelectAll","selectionCount","setSelectionCount","selections","setSelections","configureAdapterOrExtension","setConfigureAdapterOrExtension","setIsInProcess","whyDisabledReason","setWhyDisabledReason","initAdapterExtensionContract","adapterExtensionName","useInitAdapterExtensionContracts","isDAOExisting","isDAOReady","isUnavailable","isLoading","nothingToAdd","checkDaoStateCached","finalizedMessage","daoRegistryState","handleAddAdapter","addAdapterOrExtension","handleAddExtension","adapterOrExtensionAddress","adapterOrExtensionType","adapterOrExtensionId","addAdapterOrExtensionArguments","txSendMethod","errorMessage","adaptersArguments","adapterContractAddress","contractAddressFromRedux","addAdaptersArguments","checkboxesSelection","inputs","RenderWrapper","scrollTo","top","left","behavior","LARGE","handleSelectTargetChange","handleConfigure","CONFIGURATION_REASON","FINALIZED_REASON","Fields","PreviewInputMarkdown","marginTop","CreateGovernanceProposal","history","useHistory","watch","Governance","required","CreateMembershipProposal","userAccountBalance","setUserAccountBalance","ethAddressValue","createMemberError","getUserAccountBalanceCached","getBalance","accountBalanceInWei","fromWei","ethAmount","ethAddressToChecksum","ethAmountInWei","proposerAddressToChecksum","proposalAmountValues","tributeAmount","tributeAmountUnit","accountAuthorizedToProcessPassedProposal","isInteger","CreateTransferProposal","daoTokens","setDaoTokens","selectedTokenBalance","setSelectedTokenBalance","isTypeAllMembers","selectedTokenValue","createTransferError","erc20ABI","ERC20ABI","getDaoTokensCached","getSelectedTokenBalanceCached","bankMethods","nbTokens","parsedAndSortedTokens","getTokenABI","getTokenCalls","index","fetchedTokens","balanceOfABI","getDaoTokenBalanceCalls","daoTokenBalances","tokensArray","daoBalance","tokenObj","toBN","gt","ethToken","erc20Tokens","nameABI","nameCalls","symbolABI","symbolCalls","decimalsABI","decimalsCalls","erc20DetailsCalls","chunkedResults","splice","names","symbols","parsedAndSortedERC20Tokens","sort","localeCompare","selectedTokenObj","balanceBN","divisor","pow","beforeDecimal","div","afterDecimal","mod","balanceReadable","eq","selectedToken","notes","memberAddressToChecksum","amountArg","multiplier","amountWithDecimals","mul","bodyIntro","transferAmount","transferAmountUnit","returnSignature","memberAddressArg","transferArguments","isActiveMemberWithUnits","unitsBalance","amountToNumber","isSelectedTokenEth","CreateTributeProposal","userERC20Balance","setUserERC20Balance","setERC20Details","erc20Contract","setERC20Contract","erc20AddressValue","erc20Address","applicantAddressValue","applicantAddress","createTributeError","getERC20ContractCached","getERC20DetailsCached","getUserERC20BalanceCached","lazyERC20ABI","getRequestAmountUnit","requestAmount","tributeAmountWithDecimals","requestAmountArg","requestAmountUnit","CompostImg","React","memo","compost","GetStartedHeader","GetStarted","AOS","init","offset","delay","mirror","once","GovernanceActions","NotFound","textAlign","fontSize","ProposalDetails","renderAmountBadge","GovernanceProposalDetails","useParams","DEFAULT_BUTTON_TEXT","ResponsiveEllipsis","responsiveHOC","LinesEllipsis","ProposalCard","buttonText","proposalOnClickId","linkPath","maxLine","ellipsis","trimRight","basedOn","renderName","GovernanceProposalsList","onProposalClick","proposalLinkPath","renderProposalCard","proposalsForVotingResults","setProposalsForVotingResults","failedProposals","passedProposals","votingProposals","filteredProposals","setFilteredProposals","governanceProposals","setGovernanceProposals","governanceProposalsError","setGovernanceProposalsError","governanceProposalsStatus","setGovernanceProposalsStatus","handleGetProposalsCached","getSnapshotProposalsByActionId","useGovernanceProposals","renderProposalCards","proposalName","offchainResult","gp","filteredProposalsToSet","offchainVoteResult","didPass","flatMap","PASSED","FAILED","GovernanceProposals","useMembers","getMembersFromSubgraphResult","members","setMembers","membersStatus","setMembersStatus","membersError","setMembersError","getMembersFromRegistryCached","getMembersFromSubgraphCached","filteredMembersWithDetails","didFullyRagequit","createdAt","parsedMember","getNbMembers","nbMembers","memberAddressesByDelegatedKeyABI","memberAddressesByDelegatedKeyCalls","memberAddressesByDelegatedKey","unitsBalanceOfCalls","unitsBalances","membersWithDetails","isDelegated","reverse","DelegationStatus","DelegationStep","focusable","ArrowsSVG","DaoToken","copyText","document","createElement","appendChild","setAttribute","select","execCommand","removeChild","getElementById","innerHTML","onMouseLeave","UserSVG","DelegationModal","currentStep","daoRegistryAdapterContract","delegateError","delegateAddressValue","confirmDelegationValue","confirmDelegation","isFormFieldEmpty","setDelegation","includes","handleConfirmDelegation","revokeDelegation","handleRevokeDelegation","updateDelegateKeyArguments","parsedError","Delegation","SET_DELEGATION","setCurrentStep","delegationStatus","setDelegationStatus","showDelegationModal","setShowDelegationModal","fetchDelegationInfoCached","REVOKE_DELEGATION","DELEGATE_VOTES","MemberProfile","ethereumAddress","memberDetails","setMemberDetails","memberNotFound","setMemberNotFound","activeMember","isLoadingDone","isCurrentMemberConnected","votingWeight","renderMemberInfo","MemberCard","Members","renderMemberCards","Proposals","nonsponsoredProposals","voteState","votesData","noSnapshotVotes","offchainResultNotYetSubmitted","TIE","PASS","NOT_PASS","IN_PROGRESS","REQUESTS","Membership","useMemberActionDisabledProps","ProcessActionMembership","propsDisabled","membershipProposalAmount","setMembershipProposalAmount","notProposerMessage","areSomeDisabled","getMembershipProposalAmountCached","proposalDetails","processArguments","ProposalWithOffchainVoteActions","cycleEllipsisStyles","ProposalActions","renderAction","daoVotingAdapterName","ProposalAmount","amountUnit","amount2","amount2Unit","MembershipDetails","applicant","LoaderWithEmoji","emoji","RedeemManager","redeemables","RedeemCard","redeemable","isRedeemd","margin","RedeemCoupon","setReedemableCoupon","couponStatus","setCouponStatus","coupon","URLSearchParams","search","get","checkBySigOrAddrCached","coupons","PostProcessActionTransfer","alreadyCompletedMessage","toIndexArg","distributeArguments","distributions","distributeProposal","getActionDisabledReasons","TransferDetails","Transfers","ProcessActionTribute","tributeProposalDetails","setTributeProposalDetails","txEtherscanURLTokenApprove","txIsPromptOpenTokenApprove","txSendTokenApprove","txStatusTokenApprove","getTributeProposalDetailsCached","handleSubmitTokenApprove","erc20Instance","allowance","tributeAmountBN","allowanceBN","difference","sub","approveValue","add","tokenApproveArguments","PLACEHOLDER","TributeDetails","Tributes","web3","givenProvider","Water","waterContract","setWaterContract","irrigationStatus","setIrrigationStatus","setRenderStatus","waterAddressValue","getWaterContractCached","getIrrigationStatusCached","getIrrigationStatus","lazyWaterABI","getIrrigation","ProcessName","proposalIdParameter","Routes","exact","component","App","renderMainContent","mainContent","Init","setError","isInitComplete","setIsInitComplete","initSnapshotAPI","processReadyMap","setProcessReadyMap","initContracts","handleInitContractsCached","handleGetMemberCached","handleGetSnapshotAPIStatusCached","getSnapshotAPIStatus","fs","InitError","padding","maxWidth","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","autoRefreshOnNetworkChange","getApolloClient","ApolloClient","link","concat","HttpLink","uri","operationName","cache","InMemoryCache","typePolicies","Adapter","fields","merge","existing","incoming","Extension","ApolloProvider","client","useContext"],"mappings":"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","file":"static/js/main.a121cb8a.chunk.js","sourcesContent":["import {config as dotenvConfig} from 'dotenv';\nimport {resolve} from 'path';\nimport WalletConnectProvider from '@walletconnect/web3-provider';\n\nimport {EnvironmentName} from './util/types';\n\ndotenvConfig({path: resolve(__dirname, '../.env')});\n\n/**\n * Global DApp Config\n */\n\nconst {\n  REACT_APP_DAO_REGISTRY_CONTRACT_ADDRESS,\n  REACT_APP_DEFAULT_CHAIN_NAME_LOCAL,\n  REACT_APP_ENVIRONMENT,\n  REACT_APP_GRAPH_API_URL,\n  REACT_APP_INFURA_PROJECT_ID_DEV,\n  REACT_APP_INFURA_PROJECT_ID_LOCAL,\n  REACT_APP_INFURA_PROJECT_ID_PROD,\n  REACT_APP_MULTICALL_CONTRACT_ADDRESS,\n  REACT_APP_SNAPSHOT_HUB_API_URL,\n  REACT_APP_COUPON_API_URL,\n  REACT_APP_SNAPSHOT_SPACE,\n} = process.env;\n\nexport const ENVIRONMENT = REACT_APP_ENVIRONMENT as EnvironmentName | undefined;\n\n/**\n * SNAPSHOT_HUB_API_URL\n *\n * @note For `ENVIRONMENT=localhost` we need to use CRA's local proxy\n *   so that we can communicate with our develop Snapshot Hub API\n *   without any CORS issues.\n *\n * @see src/setupProxy.js\n */\nexport const SNAPSHOT_HUB_API_URL: string | undefined =\n  ENVIRONMENT === 'localhost'\n    ? '/snapshot-hub'\n    : REACT_APP_SNAPSHOT_HUB_API_URL;\n\nexport const COUPON_API_URL: string | undefined = REACT_APP_COUPON_API_URL;\n\n// The Graph API URL\nexport const GRAPH_API_URL = REACT_APP_GRAPH_API_URL;\n\n// Network IDs, when users change wallet networks\nexport const CHAINS = {\n  MAINNET: 1,\n  ROPSTEN: 3,\n  RINKEBY: 4,\n  GOERLI: 5,\n  KOVAN: 42,\n  GANACHE: 1337,\n};\n\n// Network names for modal messaging\nexport const CHAIN_NAME_FULL = {\n  [CHAINS.MAINNET]: 'Main Ethereum Network',\n  [CHAINS.ROPSTEN]: 'Ropsten Test Network',\n  [CHAINS.RINKEBY]: 'Rinkeby Test Network',\n  [CHAINS.GOERLI]: 'Grli Test Network',\n  [CHAINS.KOVAN]: 'Kovan Test Network',\n  [CHAINS.GANACHE]: 'Ganache Test Network',\n};\n\nexport const DEFAULT_CHAIN =\n  REACT_APP_ENVIRONMENT === 'production'\n    ? CHAINS.MAINNET\n    : REACT_APP_ENVIRONMENT === 'development'\n    ? CHAINS.RINKEBY\n    : REACT_APP_DEFAULT_CHAIN_NAME_LOCAL // Set this to change local development chain\n    ? CHAINS[REACT_APP_DEFAULT_CHAIN_NAME_LOCAL]\n    : CHAINS.GANACHE; // Defaults to a Ganache private network (1337)\n\nexport const ETHERSCAN_URLS: {[chainId: number]: string} = {\n  [CHAINS.MAINNET]: `https://etherscan.io`,\n  [CHAINS.ROPSTEN]: `https://ropsten.etherscan.io`,\n  [CHAINS.RINKEBY]: `https://rinkeby.etherscan.io`,\n  [CHAINS.GOERLI]: `https://goerli.etherscan.io`,\n  [CHAINS.KOVAN]: `https://kovan.etherscan.io`,\n};\n\nexport const INFURA_WS_URLS: {[chainId: number]: string} = {\n  [CHAINS.MAINNET]: `wss://mainnet.infura.io/ws/v3`,\n  [CHAINS.ROPSTEN]: `wss://ropsten.infura.io/ws/v3`,\n  [CHAINS.RINKEBY]: `wss://rinkeby.infura.io/ws/v3`,\n  [CHAINS.GOERLI]: `wss://goerli.infura.io/ws/v3`,\n  [CHAINS.KOVAN]: `wss://kovan.infura.io/ws/v3`,\n};\n\n// Infura Project Id\nexport const INFURA_PROJECT_ID =\n  REACT_APP_ENVIRONMENT === 'production'\n    ? REACT_APP_INFURA_PROJECT_ID_PROD\n    : REACT_APP_ENVIRONMENT === 'development'\n    ? REACT_APP_INFURA_PROJECT_ID_DEV\n    : REACT_APP_INFURA_PROJECT_ID_LOCAL;\n\n// Ethereum Provider URL\nexport const ETHEREUM_PROVIDER_URL: string = INFURA_WS_URLS[DEFAULT_CHAIN]\n  ? `${INFURA_WS_URLS[DEFAULT_CHAIN]}/${INFURA_PROJECT_ID}`\n  : DEFAULT_CHAIN === CHAINS.GANACHE\n  ? /**\n     * Ganache over WebSocket should work. @note Is not tested, yet.\n     * Attempting to be consistent with a WebSocket URL to avoid more logic.\n     *\n     * @link https://www.trufflesuite.com/docs/truffle/reference/configuration#networks\n     */\n    'ws://127.0.0.1:7545'\n  : '';\n\n/**\n * Wallet Connect config\n */\n\n/**\n * Tell Web3modal what providers we have available.\n *\n * The built-in web browser provider (only one can exist at a time),\n * MetaMask, Brave or Opera is added automatically by Web3modal\n */\nexport const WALLETCONNECT_PROVIDER_OPTIONS = {\n  // Injected providers\n  injected: {\n    display: {\n      name: 'MetaMask',\n      description: 'Connect with the provider in your Browser',\n    },\n    package: null,\n  },\n  // WalletConnect provider\n  walletconnect: {\n    display: {\n      name: 'WalletConnect',\n      description: 'Connect with your mobile wallet',\n    },\n    package: WalletConnectProvider,\n    options: {\n      infuraId: INFURA_PROJECT_ID, // required\n      qrcodeModalOptions: {\n        mobileLinks: ['rainbow', 'metamask', 'argent', 'trust'],\n      },\n    },\n  },\n};\n\n/**\n * CORE CONTRACTS\n * @note as per https://github.com/openlawteam/tribute-contracts#architecture\n *\n * - DAO Registry (@note uses dao address for the contract address)\n * - DAO Factory\n */\n\n// If developing locally, include your DaoRegistry contract address in your `.env` file.\nexport const DAO_REGISTRY_CONTRACT_ADDRESS =\n  REACT_APP_DAO_REGISTRY_CONTRACT_ADDRESS;\n\nexport const DAO_FACTORY_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x58F6db89F218aB8c24e9f5Dd51bFf8b8f3BA4147',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x482Af6a6258F172aDDBa02937eB11A8e5e4c6b89',\n};\n\nexport const BANK_FACTORY_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xe103D07971BbE7DE8F336bB3B56F47acce396a2e',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xdFa0436224Da291EB96fE9520243598e5B20a455',\n};\n\n// @todo\nexport const NFT_EXTENSION_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xF314Dc90b4413c63a1761ADE424e6A79c4D88f6C',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x9a5eFFb194c9ABdf3B283A3809F79c03324Ca8d7',\n};\n\n// @todo\nexport const NFT_COLLECTION_FACTORY_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xcA946D7c176De5C77122fc1e6dA7e96aB063D3Bc',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xC8Ac9A86deECBC3F75E33a5c33471AF35d81Ed74',\n};\n\n// @todo\nexport const ERC20_TOKEN_FACTORY_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xEa913Bb57b7DaA1B341dA3E357BaE06e78e55CfE',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x382f01F4fC9552aaf90dcF1976EED14f93B9cB7D',\n};\n\n/**\n * ADAPTER CONTRACTS\n * @note as per https://github.com/openlawteam/tribute-contracts#architecture\n *\n * - Configuration\n * - CouponOnboardingContract\n * - Managing\n * - Onboarding\n * - Voting\n * - Offchain voting\n * - Financing\n * - Tribute\n * - Distribute\n * - Rage quit\n * - Guild kick\n * - BankAdapter\n * - TributeNFT\n * - NFTAdapter\n * - DaoRegistryAdapter\n */\n\nexport const VOTING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x8e06B2dB2D9478Ce757f52E57386f38e1dA5c16C',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xc5A1d4d7FAA80F873D405563CEC7407437B16199',\n};\n\nexport const WATER_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xdb2F66eE4B778808A0d19363f2C87912fF45c7E0',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xEb98A92a844e37d301B18A926893de911Fc96936',\n};\n\nexport const CONFIGURATION_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xFbec8a284CDf5377d1DF298789Ef72BC711391A8',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x4B03B7C58f79c0DaE24E3474ED9371fAeb89131c',\n};\n\nexport const RAGEQUIT_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xc6c372432c26607fA8e13a8A199414436aFa167a',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x241Ab4bF884369a861138e25f4d566FDe1785B00',\n};\n\nexport const MANAGING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xD673C83d387892efe03574cE78E492bFf51F3996',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x4232509762484c7eb97CC36a37711b8db99FBdD3',\n};\n\nexport const FINANCING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xb17b4cefbD68a374C52058c4191ec29Ed0D121CC',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x9Dd84b9E90DF1a6eCD84af1eC186ECb7f714bAD1',\n};\n\nexport const ONBOARDING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x6bfC8A7Fd8Ac29fFe1590083e73E8AcA247531b9',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x79120e3ACf8E7FeFFd8EeA91A12e40bc04883Db5',\n};\n\nexport const GUILDKICK_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xbF3239B26892d5Ff723D9c82a2e36101bbe41C01',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x897f8240a50245a0C8BDd1570A59DbBABC249609',\n};\n\nexport const DAO_REGISTRY_ADAPTER_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x2213827c9B4f5bB8D2F8B5ef88eBD655bD73fa06',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x47f201c84fDCCBA4353f27Dd5C1d08D3214b26C2',\n};\n\nexport const BANK_ADAPTER_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xE42BA0b83104AC4b3a9a2556aD979e54958df45D',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x31F2A65Df461d72Bd6A298dcF4D6ec8E06B2eEe8',\n};\n\nexport const NFT_ADAPTER_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xb637c8eF50583357bbF3992052717e20393Fe168',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x3C431EeB5A80D5DEB1921b156F051c637b925900',\n};\n\nexport const COUPONONBOARDING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0xaa5aCdDEa4b7dE0c85704A1276Dcb5A40052a162',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x89B5FbBFa66CFbeD44Fc264cDF65159CD2F99648',\n};\n\nexport const TRIBUTE_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x43F5244BfD43f1489dcd9C86e2a704dc17aD2025',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0xDe2571E1dc48FE1bbAd6CD7Da66452aA20eB2eb9',\n};\n\nexport const DISTRIBUTE_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x4145173a3e11a32E435B4eaC5C0044308A99eE6a',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x5Fdf2F1A2Ed259433D7245Dbe3ab2F291aFEa644',\n};\n\nexport const TRIBUTE_NFT_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x9d69ca01b1e1c416e5966170D4D1aCaA7cE3acE4',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x7026Fda9828B6d4D8690D10a2C0eb61f0608343F',\n};\n\nexport const OFFCHAINVOTING_CONTRACT_ADDRESS = {\n  [CHAINS.MAINNET]: '',\n  [CHAINS.ROPSTEN]: '',\n  [CHAINS.RINKEBY]: '0x49D69a51ddd4D555668d178de69D0EFa037a70d5',\n  [CHAINS.GOERLI]: '',\n  [CHAINS.KOVAN]: '',\n  [CHAINS.GANACHE]: '0x44c8A80bee9Ad53062AB6d2bc99A1D620464978E',\n};\n\n// If developing locally, include your Multicall contract address in your `.env` file.\nexport const MULTICALL_CONTRACT_ADDRESS = REACT_APP_MULTICALL_CONTRACT_ADDRESS;\n\n/**\n * These addresses are important as the contracts use them in their configs.\n *\n * @todo Remove and get from the chain/subgraph?\n *\n * @see https://github.com/openlawteam/tribute-contracts/blob/9e0e03616a00e41e666351e146ee109b9fe37fb2/utils/DaoFactory.js\n */\nexport const GUILD_ADDRESS: string =\n  '0x000000000000000000000000000000000000dead';\nexport const TOTAL_ADDRESS: string =\n  '0x000000000000000000000000000000000000babe';\nexport const UNITS_ADDRESS: string =\n  '0x00000000000000000000000000000000000FF1CE';\nexport const LOOT_ADDRESS: string =\n  '0x00000000000000000000000000000000B105F00D';\nexport const MEMBER_COUNT_ADDRESS: string =\n  '0x00000000000000000000000000000000DECAFBAD';\nexport const ETH_TOKEN_ADDRESS: string =\n  '0x0000000000000000000000000000000000000000';\nexport const DAI_TOKEN_ADDRESS: string =\n  '0x95b58a6bff3d14b7db2f5cb5f0ad413dc2940658';\n\n/**\n * `SPACE` is used inside Snapshot Hub for matching a `space`\n * with its own proposals and votes.\n */\nexport const SPACE: string | undefined = REACT_APP_SNAPSHOT_SPACE;\n\n/**\n * POLLING INTERVAL FOR GQL QUERIES\n * localhost | development - ms, poll every 5sec = 5000\n * production - ms, poll every 10sec = 10000\n */\nexport const GQL_QUERY_POLLING_INTERVAL: number =\n  REACT_APP_ENVIRONMENT === 'production' ? 10000 : 5000;\n","export default function TimesSVG() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      aria-hidden=\"true\"\n      data-icon=\"times\"\n      data-prefix=\"fal\"\n      viewBox=\"0 0 320 512\">\n      <path\n        fill=\"currentColor\"\n        d=\"M193.94 256L296.5 153.44l21.15-21.15c3.12-3.12 3.12-8.19 0-11.31l-22.63-22.63c-3.12-3.12-8.19-3.12-11.31 0L160 222.06 36.29 98.34c-3.12-3.12-8.19-3.12-11.31 0L2.34 120.97c-3.12 3.12-3.12 8.19 0 11.31L126.06 256 2.34 379.71c-3.12 3.12-3.12 8.19 0 11.31l22.63 22.63c3.12 3.12 8.19 3.12 11.31 0L160 289.94 262.56 392.5l21.15 21.15c3.12 3.12 8.19 3.12 11.31 0l22.63-22.63c3.12-3.12 3.12-8.19 0-11.31L193.94 256z\"></path>\n    </svg>\n  );\n}\n","/**\n * chooseRandom\n *\n * Choose a random item from an array.\n *\n * @param {array} array - The array to choose from.\n * @param doNotChooseItem - An item to not choose (e.g. previously chosen item)\n */\nexport function chooseRandom<T>(array: T[], doNotChooseItem?: T) {\n  const arrayToUse =\n    doNotChooseItem !== undefined\n      ? array.filter((a) => a !== doNotChooseItem)\n      : array;\n\n  return arrayToUse[Math.floor(Math.random() * arrayToUse.length)];\n}\n","/**\n * disableReactDevTools\n *\n * Run before the app mounts to disable React dev tools.\n * Ideally, this is run conditionally based on environment.\n *\n * @see: https://github.com/facebook/react-devtools/issues/191#issuecomment-443607190\n */\nexport function disableReactDevTools() {\n  const noop = (): void => undefined;\n  const DEV_TOOLS = (window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__;\n\n  if (typeof DEV_TOOLS === 'object') {\n    for (const [key, value] of Object.entries(DEV_TOOLS)) {\n      DEV_TOOLS[key] = typeof value === 'function' ? noop : null;\n    }\n  }\n}\n","/**\n * dontCloseWindowWarning\n *\n * Warns user not to close the window.\n *\n * @returns {() => void} unsubscribe function to stop listening, and the callback from firing.\n */\nexport function dontCloseWindowWarning(): () => void {\n  // @see: https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload#Example\n  const callback = (event: BeforeUnloadEvent) => {\n    // Cancel the event\n    event.preventDefault();\n    // Chrome requires returnValue to be set\n    event.returnValue = '';\n  };\n\n  window.addEventListener('beforeunload', callback);\n\n  return function unsubscribe() {\n    window.removeEventListener('beforeunload', callback);\n  };\n}\n","/**\n * formatDecimal\n *\n * A simple formatter with respect for dynamic decimal places\n * from `toFixed(2)` to `toFixed(4)`. If the number provided\n * is less than `0.01`, then `toFixed(4)` is used, else `toFixed(2)`.\n *\n * This may not work for all cases where the number is tiny, as it could\n * result in `\"0.0000\"`.\n *\n * @param {number} n\n * @returns {string} A `.toFixed()` representation of the decimal number.\n */\nexport function formatDecimal(n: number): string {\n  return n < 0.01 ? n.toFixed(4) : n.toFixed(2);\n}\n","/**\n * formatNumber\n *\n * Formats a number (U.S. region) with commas (e.g. 1000 -> 1,000).\n *\n * @param {string | number} value\n * @returns {string}\n *\n * @todo maybe a more friendly way via Intl API in JS core?\n */\nexport const formatNumber = (value: number | string): string => {\n  const regEx = new RegExp(/(\\d)(?=(\\d{3})+(?:\\.\\d+)?$)/g);\n  return typeof value === 'number'\n    ? value.toString().replace(/,/g, '').replace(regEx, '$1,')\n    : value.replace(/,/g, '').replace(regEx, '$1,');\n};\n","/**\n * getValidationError\n *\n * Used with react-hook-form (mostly to solve a TS incorrect behavior)\n * Gets the associated error message with a field.\n *\n * @param {string} field\n * @param {Record<string, any>} errors\n * @returns string\n */\nexport function getValidationError(\n  field: string,\n  errors: Record<string, any>\n): string {\n  return errors[field] && 'message' in errors[field]\n    ? (errors[field].message as string)\n    : '';\n}\n","/**\n * normalizeString\n *\n * Converts string case to lowerCase and trims whitespace.\n *\n * @param {string} stringToNormalize\n * @returns {string} The normalized string lowercased and trimmed.\n */\nexport function normalizeString(stringToNormalize: string): string {\n  return stringToNormalize.toLowerCase().trim();\n}\n","import {providers} from 'ethers';\n\nimport {normalizeString} from './normalizeString';\n\n/**\n * isPossibleContractWallet\n *\n * When passing a connected ethereum address, if there is bytecode at the address,\n * there is a good chance that it's a contract wallet. This is not 100% accurate, but it's\n * good enough to make a guess and do something trivial in the UI.\n *\n * @param address\n * @param provider\n * @returns `boolean`\n */\nexport async function isPossibleContractWallet(\n  /**\n   * Ethereum wallet address to check\n   */\n  address: string,\n  /**\n   * Ethers provider\n   *\n   * E.g. `new JsonRpcProvider(...)`\n   */\n  provider: providers.Provider\n): Promise<boolean> {\n  try {\n    const bytecode = await provider.getCode(normalizeString(address));\n\n    // It's a bit easier to detect an EOA (typical public/private key crypto wallet)\n    const addressIsExernallyOwnedAccount: boolean =\n      !bytecode ||\n      bytecode === '0x' ||\n      bytecode === '0x0' ||\n      bytecode === '0x00';\n\n    return addressIsExernallyOwnedAccount === false;\n  } catch (error) {\n    throw error;\n  }\n}\n","/**\n * numberRangeArray\n *\n * Outputs an array sequence of numbers given a total size and starting offset.\n * e.g. Years 1920..2002\n *\n * @param {size} number - Maximum number and last value of array. Default is 1.\n * @param {startAt} number - Offset to begin from. Default is 0.\n * @returns {number[]}\n */\nexport function numberRangeArray(size = 1, startAt = 0): number[] {\n  const adjustedSize = size + 1 - startAt;\n\n  return [...Array(adjustedSize)].map((_, i) => startAt + i);\n}\n","/**\n * stripFormatNumber\n *\n * Strips a number string formatting (via `formatNumber`) (e.g. 10,000 -> 10000).\n *\n * @param {string} value Number string to strip formatting (via `formatNumber`) from.\n * @returns {string} A Number string without any formatting form `formatNumber`.\n *\n * @todo maybe a more friendly way via Intl API in JS core?\n */\nexport const stripFormatNumber = (value: string): string =>\n  value.toString().replace(/,/g, '');\n","import React, {useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {\n  createVote,\n  getVoteResultRootDomainDefinition,\n  prepareVoteResult,\n  signMessage,\n  VoteChoicesIndex,\n} from '@openlaw/snapshot-js-erc712';\nimport {\n  ToStepNodeResult,\n  VoteEntry,\n} from '@openlaw/snapshot-js-erc712/dist/types';\n\nimport {ContractAdapterNames, Web3TxStatus} from '../../web3/types';\nimport {\n  DEFAULT_CHAIN,\n  MEMBER_COUNT_ADDRESS,\n  TOTAL_ADDRESS,\n  UNITS_ADDRESS,\n} from '../../../config';\nimport {\n  getAdapterAddressFromContracts,\n  multicall,\n  MulticallTuple,\n} from '../../web3/helpers';\nimport {getOffchainVotingProof, submitOffchainVotingProof} from '../helpers';\nimport {normalizeString, numberRangeArray} from '../../../util/helpers';\nimport {PRIMARY_TYPE_ERC712, TX_CYCLE_MESSAGES} from '../../web3/config';\nimport {ProposalData} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useMemberActionDisabled} from '../../../hooks';\nimport {useWeb3Modal, useContractSend, useETHGasPrice} from '../../web3/hooks';\nimport CycleMessage from '../../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../../web3/EtherscanURL';\nimport FadeIn from '../../common/FadeIn';\nimport Loader from '../../feedback/Loader';\n\ntype OffchainVotingSubmitResultActionProps = {\n  adapterName: ContractAdapterNames;\n  proposal: ProposalData;\n};\n\ntype SubmitVoteResultArguments = [\n  daoAddress: string,\n  proposalId: string,\n  resultRoot: string,\n  lastResult: ToStepNodeResult,\n  rootSig: string\n];\n\nexport function OffchainOpRollupVotingSubmitResultAction(\n  props: OffchainVotingSubmitResultActionProps\n) {\n  const {\n    adapterName,\n    proposal: {daoProposalVotingAdapter, snapshotProposal},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [signatureStatus, setSignatureStatus] = useState<Web3TxStatus>(\n    Web3TxStatus.STANDBY\n  );\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Selectors\n   */\n\n  const bankExtensionAddress = useSelector(\n    (s: StoreState) => s.contracts.BankExtensionContract?.contractAddress\n  );\n  const bankExtensionMethods = useSelector(\n    (s: StoreState) => s.contracts.BankExtensionContract?.instance.methods\n  );\n  const getPriorAmountABI = useSelector((s: StoreState) =>\n    s.contracts.BankExtensionContract?.abi.find(\n      (ai) => ai.name === 'getPriorAmount'\n    )\n  );\n  const daoRegistryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n  const getMemberAddressABI = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.abi\n  )?.find((ai) => ai.name === 'getMemberAddress');\n\n  const contracts = useSelector((s: StoreState) => s.contracts);\n\n  /**\n   * Our hooks\n   */\n\n  const {account, provider, web3Instance} = useWeb3Modal();\n\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n\n  const {isDisabled, openWhyDisabledModal, WhyDisabledModal} =\n    useMemberActionDisabled();\n\n  const {fast: fastGasPrice} = useETHGasPrice();\n\n  /**\n   * Variables\n   */\n\n  const votingAdapterMethods =\n    daoProposalVotingAdapter?.getWeb3VotingAdapterContract().methods;\n\n  const isInProcess =\n    signatureStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    signatureStatus === Web3TxStatus.PENDING ||\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n\n  const isDone =\n    txStatus === Web3TxStatus.FULFILLED &&\n    signatureStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n\n  /**\n   * Functions\n   */\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryAddress) {\n        throw new Error('No DAO Registry address was found.');\n      }\n\n      if (!bankExtensionAddress) {\n        throw new Error('No Bank Extension address was found.');\n      }\n\n      if (!getMemberAddressABI) {\n        throw new Error('No ABI for `getMemberAddress` was found.');\n      }\n\n      if (!getPriorAmountABI) {\n        throw new Error('No ABI for `getPriorAmount` was found.');\n      }\n\n      if (!snapshotProposal) {\n        throw new Error('No Snapshot proposal was found.');\n      }\n\n      if (!snapshotProposal.votes) {\n        throw new Error('No Snapshot proposal votes Array was found.');\n      }\n\n      if (!votingAdapterMethods) {\n        throw new Error('No \"OffchainVotingContract\" methods were found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      setSignatureStatus(Web3TxStatus.AWAITING_CONFIRM);\n\n      const {idInDAO: proposalHash} = snapshotProposal;\n\n      const snapshot: string = snapshotProposal.msg.payload.snapshot.toString();\n\n      const adapterAddress = getAdapterAddressFromContracts(\n        adapterName,\n        contracts\n      );\n\n      // Get total number of potential and admitted members in the DAO at the snapshot\n      const numberOfDAOMembersAtSnapshot: string = await bankExtensionMethods\n        .getPriorAmount(TOTAL_ADDRESS, MEMBER_COUNT_ADDRESS, snapshot)\n        .call();\n\n      const getMemberAddressCalls: MulticallTuple[] = numberRangeArray(\n        Number(numberOfDAOMembersAtSnapshot) - 1,\n        0\n      ).map(\n        (memberIndex): MulticallTuple => [\n          daoRegistryAddress,\n          getMemberAddressABI,\n          [memberIndex.toString()],\n        ]\n      );\n\n      // Get all member addresses in the DAO based on the member count\n      const memberAddresses: string[] = await multicall({\n        calls: getMemberAddressCalls,\n        web3Instance,\n      });\n\n      const memberBalanceCalls: MulticallTuple[] = memberAddresses.map(\n        (m): MulticallTuple => [\n          bankExtensionAddress,\n          getPriorAmountABI,\n          [m, UNITS_ADDRESS, snapshot],\n        ]\n      );\n\n      // Get all member balances\n      const memberBalancesAtSnapshot: string[] = await multicall({\n        calls: memberBalanceCalls,\n        web3Instance,\n      });\n\n      // Create vote entries\n      const votes: VoteEntry[] = memberAddresses.map((memberAddress, i) => {\n        const voteData = Object.values(\n          snapshotProposal.votes?.find(\n            (v) =>\n              normalizeString(memberAddress) ===\n              normalizeString(\n                Object.values(v)[0].msg.payload.metadata.memberAddress\n              )\n          ) || {}\n        )[0];\n\n        // Create votes based on whether `voteData` was found for `memberAddress`\n        return createVote({\n          proposalId: proposalHash,\n          sig: voteData?.sig || '0x',\n          timestamp: voteData ? Number(voteData.msg.timestamp) : 0,\n          voteYes: voteData?.msg.payload.choice === VoteChoicesIndex.Yes,\n          weight: voteData ? memberBalancesAtSnapshot[i] : '0',\n        });\n      });\n\n      // Prepare vote Result\n      const {voteResultTree, result} = await prepareVoteResult({\n        actionId: adapterAddress,\n        chainId: DEFAULT_CHAIN,\n        daoAddress: daoRegistryAddress,\n        votes,\n      });\n\n      const voteResultTreeHexRoot: string = voteResultTree.getHexRoot();\n\n      const {domain, types} = getVoteResultRootDomainDefinition(\n        daoRegistryAddress,\n        adapterAddress,\n        DEFAULT_CHAIN\n      );\n\n      const messageParams: string = JSON.stringify({\n        domain,\n        message: {root: voteResultTreeHexRoot},\n        primaryType: PRIMARY_TYPE_ERC712,\n        types,\n      });\n\n      // Sign root hex result message\n      const signature: string = await signMessage(\n        provider,\n        account,\n        messageParams\n      );\n\n      // Check if off-chain proof has already been submitted\n      const snapshotOffchainProofExists: boolean =\n        ((await getOffchainVotingProof(voteResultTreeHexRoot))?.merkle_root\n          .length || '') > 0;\n\n      /**\n       * Send off-chain vote proof silently to Snapshot Hub for storage and later use.\n       *\n       * We're piggy-backing off of the signature async call's status, instead of setting another status.\n       * E.g. It may confuse the user if we were to display text saying we're \"submitting\n       * off-chain proof\", or something to this effect, for a second or two.\n       */\n      if (!snapshotOffchainProofExists) {\n        await submitOffchainVotingProof({\n          actionId: adapterAddress,\n          chainId: DEFAULT_CHAIN,\n          steps: result,\n          merkleRoot: voteResultTreeHexRoot,\n          verifyingContract: daoRegistryAddress,\n        });\n      }\n\n      setSignatureStatus(Web3TxStatus.FULFILLED);\n\n      const submitVoteResultArguments: SubmitVoteResultArguments = [\n        daoRegistryAddress,\n        proposalHash,\n        voteResultTreeHexRoot,\n        result[result.length - 1],\n        signature,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      // Send the tx\n      await txSend(\n        'submitVoteResult',\n        votingAdapterMethods,\n        submitVoteResultArguments,\n        txArguments\n      );\n    } catch (error) {\n      setSubmitError(error);\n      setSignatureStatus(Web3TxStatus.REJECTED);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    // Either Snapshot or chain tx\n    if (\n      txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n      signatureStatus === Web3TxStatus.AWAITING_CONFIRM\n    ) {\n      return 'Awaiting your confirmation\\u2026';\n    }\n\n    // Only for chain tx\n    switch (txStatus) {\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Result submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={isDisabled || isInProcessOrDone}\n          onClick={isDisabled || isInProcessOrDone ? () => {} : handleSubmit}>\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit Vote Result'}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is submitting disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is this disabled?\" />\n    </>\n  );\n}\n","import {useEffect, useRef, useState} from 'react';\n\nimport {truncateEthAddress} from '../../../util/helpers';\nimport {ContractAdapterNames, Web3TxStatus} from '../../web3/types';\nimport {getVoteChosen} from '../helpers';\nimport {ProposalData} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useMemberActionDisabled} from '../../../hooks';\nimport {useSelector} from 'react-redux';\nimport {useSignAndSendVote} from '../hooks';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VoteChoices} from '@openlaw/snapshot-js-erc712';\nimport {VotingActionButtons} from '.';\nimport ErrorMessageWithDetails from '../../common/ErrorMessageWithDetails';\n\ntype OffchainVotingActionProps = {\n  adapterName?: ContractAdapterNames;\n  proposal: ProposalData;\n};\n\ntype VotingDisabledReasons = {\n  addressIsDelegatedMessage: string;\n  alreadyVotedMessage: string;\n};\n\nconst getDelegatedAddressMessage = (a: string) =>\n  `Your member address is delegated to ${truncateEthAddress(\n    a,\n    7\n  )}. You must use that address to vote.`;\n\n/**\n * OffchainVotingAction\n *\n * An off-chain voting action component which facilitates submitting to Snapshot Hub.\n *\n * @returns {JSX.Element}\n */\nexport function OffchainVotingAction(\n  props: OffchainVotingActionProps\n): JSX.Element | null {\n  const {adapterName, proposal} = props;\n\n  /**\n   * State\n   */\n\n  const [voteChoiceClicked, setVoteChoiceClicked] = useState<VoteChoices>();\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Refs\n   */\n\n  const votingDisabledReasonsRef = useRef<VotingDisabledReasons>({\n    addressIsDelegatedMessage: '',\n    alreadyVotedMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const delegateAddress = useSelector(\n    (s: StoreState) => s.connectedMember?.delegateKey\n  );\n\n  const isAddressDelegated = useSelector(\n    (s: StoreState) => s.connectedMember?.isAddressDelegated\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account} = useWeb3Modal();\n  const {signAndSendVote, voteDataStatus} = useSignAndSendVote();\n  const voteChosen = getVoteChosen(\n    proposal.snapshotProposal?.votes,\n    account || ''\n  );\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    setOtherDisabledReasons,\n    WhyDisabledModal,\n  } = useMemberActionDisabled();\n\n  /**\n   * Variables\n   */\n\n  const proposalHash: string = proposal.snapshotProposal?.idInDAO || '';\n  const snapshotProposalId: string =\n    proposal.snapshotProposal?.idInSnapshot || '';\n\n  const isInProcess =\n    voteDataStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    voteDataStatus === Web3TxStatus.PENDING;\n\n  const isDone = voteDataStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone;\n\n  const isSubmitDisabled = isDisabled || isInProcessOrDone;\n\n  const voteChoiceProgress: VoteChoices | undefined = isInProcess\n    ? voteChoiceClicked\n    : undefined;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    // 1. Determine and set local reasons why voting would be disabled\n\n    // Reason: address is delegated\n    if (delegateAddress) {\n      // Set or unset\n      const addressIsDelegatedMessage = isAddressDelegated\n        ? getDelegatedAddressMessage(delegateAddress)\n        : '';\n\n      votingDisabledReasonsRef.current = {\n        ...votingDisabledReasonsRef.current,\n        addressIsDelegatedMessage,\n      };\n    }\n\n    // Reason: already voted\n    votingDisabledReasonsRef.current = {\n      ...votingDisabledReasonsRef.current,\n      alreadyVotedMessage: voteChosen ? 'You have already voted.' : '',\n    };\n\n    // 2. Set reasons\n    setOtherDisabledReasons(Object.values(votingDisabledReasonsRef.current));\n  }, [\n    delegateAddress,\n    isAddressDelegated,\n    setOtherDisabledReasons,\n    voteChosen,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function handleSubmitVote(choice: VoteChoices) {\n    try {\n      if (!proposalHash) {\n        throw new Error('No proposal hash was found.');\n      }\n      if (!snapshotProposalId) {\n        throw new Error('No proposal ID was found.');\n      }\n\n      setVoteChoiceClicked(VoteChoices[choice]);\n\n      await signAndSendVote({\n        ...(adapterName ? {adapterName} : undefined),\n        partialVoteData: {choice},\n        proposalIdInDAO: proposalHash,\n        proposalIdInSnapshot: snapshotProposalId,\n      });\n\n      // Refetch to show the vote the user submitted\n      await proposal.refetchProposalOrDraft();\n    } catch (error) {\n      setSubmitError(error);\n    }\n  }\n\n  return (\n    <>\n      <VotingActionButtons\n        onClick={isSubmitDisabled ? () => {} : handleSubmitVote}\n        buttonProps={{\n          disabled: isSubmitDisabled,\n          'aria-disabled': isSubmitDisabled,\n        }}\n        voteChosen={voteChosen}\n        voteProgress={voteChoiceProgress}\n      />\n\n      <ErrorMessageWithDetails\n        error={submitError}\n        renderText=\"Something went wrong\"\n      />\n\n      {isDisabled && (\n        <button\n          className=\"button--help-centered\"\n          onClick={openWhyDisabledModal}>\n          Why is voting disabled?\n        </button>\n      )}\n\n      <WhyDisabledModal title=\"Why is voting disabled?\" />\n    </>\n  );\n}\n","import React, {useCallback, useEffect, useState} from 'react';\n\ntype ProposalPeriodProps = {\n  startLabel?: React.ReactNode;\n  startPeriodMs: number;\n  endLabel?: React.ReactNode;\n  endedLabel?: React.ReactNode;\n  endPeriodMs: number;\n};\n\nexport default function ProposalPeriod(props: ProposalPeriodProps) {\n  const {startLabel, startPeriodMs, endLabel, endedLabel, endPeriodMs} = props;\n\n  /**\n   * Variables\n   */\n\n  const getTimeRemaining = (endtime: Date) => {\n    const t =\n      Date.parse(endtime.toString()) - Date.parse(new Date().toString());\n    const seconds = Math.floor((t / 1000) % 60);\n    const minutes = Math.floor((t / 1000 / 60) % 60);\n    const hours = Math.floor((t / (1000 * 60 * 60)) % 24);\n    const days = Math.floor(t / (1000 * 60 * 60 * 24));\n\n    return {\n      total: t,\n      days: days,\n      hours: hours,\n      minutes: minutes,\n      seconds: seconds,\n    };\n  };\n\n  /**\n   * State\n   */\n\n  const [proposalPeriod, setProposalPeriod] = useState<React.ReactNode>(null);\n\n  /**\n   * Cached callbacks\n   */\n\n  const displayCountdownCached = useCallback(displayCountdown, []);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const currentDate = new Date();\n      const startDate = new Date(startPeriodMs);\n      const endDate = new Date(endPeriodMs);\n\n      if (currentDate < startDate) {\n        const start = (\n          <span>\n            <span className=\"votingstatus\">{startLabel || 'Starts:'}</span>{' '}\n            <span className=\"votingstatus__timer\">\n              {displayCountdownCached(startDate, true)}\n            </span>\n          </span>\n        );\n\n        setProposalPeriod(start);\n      } else if (currentDate < endDate) {\n        const end = (\n          <span>\n            <span className=\"votingstatus\">{endLabel || 'Ends:'}</span>{' '}\n            <span className=\"votingstatus__timer\">\n              {displayCountdownCached(endDate)}\n            </span>\n          </span>\n        );\n\n        setProposalPeriod(end);\n      } else {\n        const ended = (\n          <span className=\"votingstatus\">{endedLabel || 'Ended'}</span>\n        );\n\n        setProposalPeriod(ended);\n        clearInterval(interval);\n      }\n    }, 1000);\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [\n    displayCountdownCached,\n    endLabel,\n    endPeriodMs,\n    endedLabel,\n    startLabel,\n    startPeriodMs,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function displayCountdown(\n    countdown: Date,\n    showDaysOnly?: boolean\n  ): string | React.ReactNode {\n    const {days, hours, minutes, seconds} = getTimeRemaining(countdown);\n\n    if (days > 2 && showDaysOnly) {\n      return `~${days} days`;\n    } else if (days > 0) {\n      return `${formatTimePeriod(days, 'day')} : ${formatTimePeriod(\n        hours,\n        'hr'\n      )} : ${formatTimePeriod(minutes, 'min')}`;\n    } else if (hours > 0) {\n      return `${formatTimePeriod(hours, 'hr')} : ${formatTimePeriod(\n        minutes,\n        'min'\n      )}`;\n    } else if (minutes > 0) {\n      return `${formatTimePeriod(minutes, 'min')} : ${formatTimePeriod(\n        seconds,\n        'sec'\n      )}`;\n    } else {\n      return (\n        <span className=\"color-brightsalmon\">\n          {formatTimePeriod(seconds, 'sec')}\n        </span>\n      );\n    }\n  }\n\n  function formatTimePeriod(time: number, period: string) {\n    const formattedPeriod = time === 0 || time > 1 ? `${period}s` : period;\n\n    return `${time} ${formattedPeriod}`;\n  }\n\n  /**\n   * Render\n   */\n\n  return <div>{proposalPeriod}</div>;\n}\n","import {SVGAttributes} from 'react';\n\nexport default function StopwatchSVG(props: SVGAttributes<HTMLOrSVGElement>) {\n  return (\n    <svg\n      width=\"20px\"\n      height=\"20px\"\n      viewBox=\"0 0 21 24\"\n      version=\"1.1\"\n      {...props}>\n      <defs>\n        <path\n          d=\"M17.6516,6.408 C19.8162,8.36 21,11.02 21,13.844 C21,19.458 16.303,24 10.5,24 C4.69616,24 0,19.457 0,13.844 C0,8.506 4.22802,4.197 9.53077,3.731 L9.53077,1.875 L6.68768,1.875 C6.15238,1.875 5.71845,1.455 5.71845,0.938 C5.71845,0.42 6.15238,0 6.68768,0 L14.3123,0 C14.8476,0 15.2815,0.42 15.2815,0.938 C15.2815,1.455 14.8476,1.875 14.3123,1.875 L11.46923,1.875 L11.46923,3.731 C13.1316,3.877 14.7126,4.398 16.1059,5.252 L17.4392,3.962 C17.8177,3.596 18.4314,3.596 18.8099,3.962 C19.1885,4.328 19.1885,4.922 18.8099,5.288 L17.6516,6.408 Z M10.5,22.125 C15.2208,22.125 19.0615,18.41 19.0615,13.844 C19.0615,9.277 15.2209,5.562 10.5,5.562 C5.77913,5.562 1.93846,9.277 1.93846,13.844 C1.93846,18.41 5.77917,22.125 10.5,22.125 Z M11.46923,8.312 L11.46923,13.844 C11.46923,14.362 11.03531,14.781 10.5,14.781 C9.96469,14.781 9.53077,14.362 9.53077,13.844 L9.53077,8.312 C9.53077,7.795 9.96469,7.375 10.5,7.375 C11.03531,7.375 11.46923,7.795 11.46923,8.312 Z\"\n          id=\"path-1\"></path>\n      </defs>\n      <g\n        id=\"Page-1\"\n        stroke=\"none\"\n        strokeWidth=\"1\"\n        fill=\"none\"\n        fillRule=\"evenodd\">\n        <g id=\"Group-70\">\n          <mask id=\"mask-2\" fill=\"white\">\n            <use xlinkHref=\"#path-1\"></use>\n          </mask>\n          <use id=\"Clip-69\" fill=\"currentColor\" xlinkHref=\"#path-1\"></use>\n        </g>\n      </g>\n    </svg>\n  );\n}\n","import React from 'react';\n\nimport {SquareRootVotingBar} from '.';\nimport ProposalPeriod from '../ProposalPeriod';\nimport StopwatchSVG from '../../../assets/svg/StopwatchSVG';\n\ntype VotingStatusProps = {\n  hasVotingEnded: boolean;\n  /**\n   * A render prop to display status to before / after the clock timer is shown.\n   */\n  renderStatus: () => React.ReactNode;\n  /**\n   * A render prop: display the `ProposalPeriod` timer.\n   * `renderTimer` Provides `ProposalPeriod` component as an argument.\n   *\n   * Passing the `ProposalPeriod` component via the render prop\n   * gives the opportunity to easily show a timer for voting, or grace period, for example,\n   * without adding more props.\n   */\n  renderTimer: (component: typeof ProposalPeriod) => React.ReactNode;\n  /**\n   * Set to `false` to hide percentage data under the voting progress bar.\n   * Defaults to `true`.\n   */\n  showPercentages?: boolean;\n  noUnits: Parameters<typeof SquareRootVotingBar>[0]['noUnits'];\n  totalUnits: Parameters<typeof SquareRootVotingBar>[0]['totalUnits'];\n  yesUnits: Parameters<typeof SquareRootVotingBar>[0]['yesUnits'];\n};\n\nexport function VotingStatus(props: VotingStatusProps) {\n  const {\n    hasVotingEnded,\n    noUnits,\n    renderStatus,\n    renderTimer,\n    showPercentages = true,\n    totalUnits,\n    yesUnits,\n  } = props;\n\n  const renderedStatus = renderStatus();\n\n  return (\n    <>\n      <div className=\"votingstatus-container\">\n        <StopwatchSVG aria-label=\"Counting down until voting ends\" role=\"img\" />\n\n        {renderedStatus && (\n          <span className=\"votingstatus\">{renderedStatus}</span>\n        )}\n\n        {renderTimer(ProposalPeriod)}\n      </div>\n\n      {/* VOTES */}\n      <SquareRootVotingBar\n        yesUnits={yesUnits}\n        noUnits={noUnits}\n        totalUnits={totalUnits}\n        votingExpired={hasVotingEnded}\n        showPercentages={showPercentages}\n      />\n    </>\n  );\n}\n","import {useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {ContractDAOConfigKeys} from '../../web3/types';\nimport {CycleEllipsis} from '../../feedback';\nimport {getDAOConfigEntry} from '../../web3/helpers';\nimport {ProposalData, VotingResult} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useOffchainVotingResults, useVotingTimeStartEnd} from '../hooks';\nimport {VotingStatus} from './VotingStatus';\n\ntype OffchainVotingStatusProps = {\n  /**\n   * When the offchain grace period seconds are provided the grace period timer\n   * will display. The end seconds will be determined inside the component.\n   *\n   * Be sure to unset this value (`0`, `undefined`) if the grace period should not show.\n   */\n  countdownGracePeriodStartMs?: number;\n  proposal: ProposalData;\n  /**\n   * If a fetched `VotingResult` is provided\n   * it will save the need to fetch inside of this component.\n   *\n   * e.g. Governance proposals listing may fetch all voting results\n   *   in order to filter the `ProposalCard`s and be able to provide the results.\n   */\n  votingResult?: VotingResult;\n};\n\n// Cached grace period label\nconst gracePeriodEndLabel = (\n  <span>\n    Grace period ends:\n    <br />\n  </span>\n);\n\n// Cached grace period ended label\nconst gracePeriodEndedLabel = (\n  <span>\n    Grace period ended <br />{' '}\n    <span style={{textTransform: 'none'}}>\n      Awaiting contract status&hellip;\n    </span>\n  </span>\n);\n\nconst cycleEllipsisFadeInProps = {duration: 150};\n\n/**\n * OffchainVotingStatus\n *\n * A read-only component to show voting status information.\n *\n * @param {OffchainVotingStatusProps} props\n * @returns {JSX.Element}\n */\nexport function OffchainVotingStatus({\n  countdownGracePeriodStartMs,\n  proposal,\n  votingResult,\n}: OffchainVotingStatusProps): JSX.Element {\n  const {snapshotProposal} = proposal;\n\n  /**\n   * Selectors\n   */\n\n  const daoRegistryInstance = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.instance\n  );\n\n  /**\n   * State\n   */\n\n  const [didVotePass, setDidVotePass] = useState<boolean>();\n  const [gracePeriodEndMs, setGracePeriodEndMs] = useState<number>(0);\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    hasVotingTimeStarted,\n    hasVotingTimeEnded,\n    votingTimeStartEndInitReady,\n  } = useVotingTimeStartEnd(\n    proposal.snapshotProposal?.msg.payload.start,\n    proposal.snapshotProposal?.msg.payload.end\n  );\n\n  const {offchainVotingResults} = useOffchainVotingResults(\n    votingResult ? undefined : proposal.snapshotProposal\n  );\n\n  /**\n   * Variables\n   */\n\n  // There is only one vote result entry as we only passed a single proposal\n  const votingResultToUse = votingResult\n    ? votingResult\n    : offchainVotingResults[0]?.[1];\n\n  const votingStartSeconds = snapshotProposal?.msg.payload.start || 0;\n  const votingEndSeconds = snapshotProposal?.msg.payload.end || 0;\n  const yesUnits = votingResultToUse?.Yes.units || 0;\n  const noUnits = votingResultToUse?.No.units || 0;\n  const totalUnits = votingResultToUse?.totalUnits;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!hasVotingTimeEnded) return;\n\n    setDidVotePass(yesUnits > noUnits);\n  }, [hasVotingTimeEnded, noUnits, yesUnits]);\n\n  // Determine grace period end\n  useEffect(() => {\n    if (!countdownGracePeriodStartMs || !daoRegistryInstance) return;\n\n    getDAOConfigEntry(\n      ContractDAOConfigKeys.offchainVotingGracePeriod,\n      daoRegistryInstance\n    )\n      .then((r) => r && setGracePeriodEndMs(Number(r) * 1000))\n      .catch(() => setGracePeriodEndMs(0));\n  }, [countdownGracePeriodStartMs, daoRegistryInstance]);\n\n  /**\n   * Functions\n   */\n\n  function renderStatus() {\n    // On loading\n    if (!votingTimeStartEndInitReady) {\n      return (\n        <CycleEllipsis\n          ariaLabel=\"Getting off-chain voting status\"\n          intervalMs={200}\n          fadeInProps={cycleEllipsisFadeInProps}\n        />\n      );\n    }\n\n    // Do not show a label as we provide one in addition to the timer.\n    if (countdownGracePeriodStartMs) {\n      return '';\n    }\n\n    // On voting ended\n    if (typeof didVotePass === 'boolean') {\n      return didVotePass ? 'Approved' : 'Failed';\n    }\n  }\n\n  function renderTimer(\n    ProposalPeriodComponent: Parameters<\n      Parameters<typeof VotingStatus>[0]['renderTimer']\n    >[0]\n  ) {\n    // Vote countdown timer\n    if (\n      votingTimeStartEndInitReady &&\n      hasVotingTimeStarted &&\n      !hasVotingTimeEnded\n    ) {\n      return (\n        <ProposalPeriodComponent\n          startPeriodMs={votingStartSeconds * 1000}\n          endPeriodMs={votingEndSeconds * 1000}\n        />\n      );\n    }\n\n    // Grace period countdown timer\n    if (countdownGracePeriodStartMs && gracePeriodEndMs) {\n      return (\n        <ProposalPeriodComponent\n          startPeriodMs={countdownGracePeriodStartMs}\n          endLabel={gracePeriodEndLabel}\n          endedLabel={gracePeriodEndedLabel}\n          endPeriodMs={countdownGracePeriodStartMs + gracePeriodEndMs}\n        />\n      );\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <VotingStatus\n      renderTimer={renderTimer}\n      renderStatus={renderStatus}\n      hasVotingEnded={hasVotingTimeEnded}\n      noUnits={noUnits}\n      totalUnits={totalUnits}\n      yesUnits={yesUnits}\n    />\n  );\n}\n","import {SVGAttributes} from 'react';\n\nexport default function CheckSVG(props: SVGAttributes<HTMLOrSVGElement>) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      width=\"18\"\n      height=\"18\"\n      viewBox=\"0 0 512 512\"\n      {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z\"></path>\n    </svg>\n  );\n}\n","import CheckSVG from '../../../assets/svg/CheckSVG';\n\ntype SquareRootVotingBarProps = {\n  /**\n   * Allow values to not be set as they may not be ready\n   */\n  yesUnits: number | undefined;\n  /**\n   * Allow values to not be set as they may not be ready\n   */\n  noUnits: number | undefined;\n  /**\n   * Allow values to not be set as they may not be ready\n   */\n  totalUnits: number | undefined;\n  votingExpired: boolean;\n  showPercentages: boolean;\n};\n\nfunction getUnitsPercent(units: number, totalUnits: number) {\n  return ((units / totalUnits) * 100).toFixed(0);\n}\n\nexport function SquareRootVotingBar({\n  yesUnits = 0,\n  noUnits = 0,\n  totalUnits,\n  votingExpired,\n  showPercentages,\n}: SquareRootVotingBarProps) {\n  /**\n   * Variables\n   */\n\n  const percentYes = totalUnits ? getUnitsPercent(yesUnits, totalUnits) : '0';\n  const percentNo = totalUnits ? getUnitsPercent(noUnits, totalUnits) : '0';\n\n  /**\n   * Render\n   */\n\n  return (\n    <div className=\"votingbar-container\">\n      <div className=\"votingbar\">\n        {/* YES */}\n        <div\n          className=\"votingbar__segment--yes\"\n          aria-label={`${percentYes}% yes votes`}\n          style={{\n            width: `${percentYes}%`,\n          }}\n        />\n\n        {/* NO */}\n        <div\n          className=\"votingbar__segment--no\"\n          aria-label={`${percentNo}% no votes`}\n          style={{\n            width: `${percentNo}%`,\n          }}\n        />\n      </div>\n\n      <div className=\"votingbar__percentages\">\n        {showPercentages && (\n          <>\n            {/* YES */}\n            {votingExpired && yesUnits > noUnits && (\n              <span className=\"yes-check\">\n                <CheckSVG aria-label=\"Vote has passed\" />\n              </span>\n            )}\n            <span className=\"yes-percent\">{percentYes}%</span>\n\n            {/* NO */}\n            <span className=\"no-percent\">{percentNo}%</span>\n            {votingExpired && yesUnits <= noUnits && (\n              <span className=\"no-check\">\n                <CheckSVG aria-label=\"Vote has failed\" />\n              </span>\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n","import React, {ButtonHTMLAttributes} from 'react';\nimport {VoteChoices} from '@openlaw/snapshot-js-erc712';\n\nimport Loader from '../../feedback/Loader';\n\ntype VotingActionButtonsProps = {\n  /**\n   * Common <button /> props for both buttons\n   */\n  buttonProps?: ButtonHTMLAttributes<HTMLButtonElement>;\n  onClick: (choice: VoteChoices) => void;\n  /**\n   * Which vote did the current connected user submit?\n   */\n  voteChosen?: VoteChoices;\n  /**\n   * Shows a loading spinner for a voting button.\n   */\n  voteProgress?: VoteChoices;\n};\n\n/**\n * @todo Implement vote chosen\n */\nexport function VotingActionButtons(\n  props: VotingActionButtonsProps\n): JSX.Element {\n  const {buttonProps, onClick, voteChosen, voteProgress} = props;\n\n  /**\n   * Functions\n   */\n\n  const getVotedClass = (choice: VoteChoices): string =>\n    voteChosen === choice ? 'votingbutton--voted' : '';\n\n  function getARIALabel(\n    choice: VoteChoices\n  ): Partial<React.HTMLAttributes<HTMLElement>> {\n    return voteProgress === choice\n      ? {'aria-label': `Voting ${choice} \\u2026`}\n      : {};\n  }\n\n  function getVotingText(choice: VoteChoices): React.ReactNode {\n    return voteProgress === choice ? (\n      <Loader aria-label={`Voting ${choice} spinner image`} role=\"img\" />\n    ) : voteChosen === choice ? (\n      `Voted ${choice}`\n    ) : (\n      `Vote ${choice}`\n    );\n  }\n\n  function handleClick(choice: VoteChoices) {\n    return () => {\n      onClick(choice);\n    };\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <button\n        {...buttonProps}\n        {...getARIALabel(VoteChoices.Yes)}\n        className={`proposaldetails__button ${getVotedClass(VoteChoices.Yes)}`}\n        onClick={handleClick(VoteChoices.Yes)}>\n        {getVotingText(VoteChoices.Yes)}\n      </button>\n      <button\n        {...buttonProps}\n        {...getARIALabel(VoteChoices.No)}\n        className={`proposaldetails__button ${getVotedClass(VoteChoices.No)}`}\n        onClick={handleClick(VoteChoices.No)}>\n        {getVotingText(VoteChoices.No)}\n      </button>\n    </>\n  );\n}\n","import ReactModal from 'react-modal';\n\nimport FadeIn from './FadeIn';\n\ntype ModalProps = {\n  children: React.ReactNode;\n  isOpen: boolean;\n  isOpenHandler: (isOpen: boolean) => void;\n  keyProp: string;\n  modalClassNames?: string;\n  styleProps?: Record<string, string>;\n};\n\nexport default function Modal({\n  children,\n  isOpen,\n  isOpenHandler,\n  keyProp,\n  modalClassNames,\n  styleProps,\n}: ModalProps) {\n  return (\n    <ReactModal\n      key={keyProp}\n      ariaHideApp={false}\n      className={`modal-container ${modalClassNames}`}\n      isOpen={isOpen}\n      onRequestClose={() => {\n        isOpenHandler(isOpen);\n      }}\n      overlayClassName=\"modal-overlay\"\n      role=\"dialog\"\n      style={\n        {\n          overlay: {zIndex: '99'},\n          ...styleProps,\n        } as any\n      }>\n      <FadeIn>\n        <div className=\"modal\">{children}</div>\n      </FadeIn>\n    </ReactModal>\n  );\n}\n","import {useState} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {toChecksumAddress} from 'web3-utils';\n\nimport {Web3TxStatus} from '../components/web3/types';\nimport {COUPON_API_URL} from '../config';\nimport {\n  useContractSend,\n  useETHGasPrice,\n  useIsDefaultChain,\n  useWeb3Modal,\n} from '../components/web3/hooks';\nimport {ERC20RegisterDetails} from '../components/dao-token/DaoToken';\nimport {getConnectedMember} from '../store/actions';\nimport {ReduxDispatch, StoreState} from '../store/types';\n\nexport enum FetchStatus {\n  STANDBY = 'STANDBY',\n  PENDING = 'PENDING',\n  FULFILLED = 'FULFILLED',\n  REJECTED = 'REJECTED',\n}\n\ntype RedeemCouponArguments = [\n  string, // `dao`\n  string, // `authorizedMember`\n  string, // `amount`\n  number, // `nonce`\n  string // `signature`\n];\n\ntype ReturnUseRedeemCoupon = {\n  isInProcessOrDone: boolean;\n  redeemCoupon: (\n    {redeemableCoupon}: Record<string, any>,\n    erc20Details?: ERC20RegisterDetails\n  ) => Promise<void>;\n  submitStatus: FetchStatus;\n  submitError: Error | undefined;\n  txStatus: Web3TxStatus;\n  txError: Error | undefined;\n  txEtherscanURL: string;\n  txIsPromptOpen: boolean;\n};\n\nexport function useRedeemCoupon(): ReturnUseRedeemCoupon {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n  const couponOnboardingContract = useSelector(\n    (s: StoreState) => s.contracts.CouponOnboardingContract\n  );\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n  const [submitStatus, setSubmitStatus] = useState<FetchStatus>(\n    FetchStatus.STANDBY\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {fast: fastGasPrice} = useETHGasPrice();\n  const {account, web3Instance} = useWeb3Modal();\n  const {defaultChainError} = useIsDefaultChain();\n  const {txError, txEtherscanURL, txIsPromptOpen, txSend, txStatus} =\n    useContractSend();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Variables\n   */\n\n  const isInProcessOrDone =\n    submitStatus === FetchStatus.PENDING ||\n    submitStatus === FetchStatus.FULFILLED;\n\n  /**\n   * Functions\n   */\n\n  async function handleRedeemCoupon(\n    redeemableCoupon: Record<string, any>,\n    erc20Details?: ERC20RegisterDetails\n  ) {\n    try {\n      if (defaultChainError) {\n        throw new Error('Wrong network connected.');\n      }\n\n      if (!redeemableCoupon) {\n        throw new Error('No coupon data was found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!couponOnboardingContract) {\n        throw new Error('No Coupon Onboarding contract was found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      setSubmitStatus(FetchStatus.PENDING);\n\n      const applicantAddressToChecksum = toChecksumAddress(\n        redeemableCoupon.recipient\n      );\n\n      // initiate tx\n      const redeemCouponArguments: RedeemCouponArguments = [\n        daoRegistryContract.contractAddress,\n        applicantAddressToChecksum,\n        String(redeemableCoupon.amount),\n        Number(redeemableCoupon.nonce),\n        redeemableCoupon.signature,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      // Execute contract call for `redeemCoupon`\n      const tx = await txSend(\n        'redeemCoupon',\n        couponOnboardingContract.instance.methods,\n        redeemCouponArguments,\n        txArguments\n      );\n\n      if (tx) {\n        // update the db and send email\n        await fetch(`${COUPON_API_URL}/api/coupon/redeem`, {\n          method: 'PATCH',\n          body: JSON.stringify({\n            // search by signature\n            signature: redeemableCoupon.signature,\n          }),\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n\n        setSubmitStatus(FetchStatus.FULFILLED);\n\n        // if connected account is the coupon recipient\n        if (\n          redeemableCoupon.recipient.toLowerCase() === account.toLowerCase()\n        ) {\n          // re-fetch member\n          await dispatch(\n            getConnectedMember({\n              account,\n              daoRegistryContract,\n              web3Instance,\n            })\n          );\n\n          // suggest adding DAO token to wallet\n          await addTokenToWallet(erc20Details);\n        }\n      }\n    } catch (error) {\n      setSubmitError(error);\n      setSubmitStatus(FetchStatus.REJECTED);\n    }\n  }\n\n  async function addTokenToWallet(erc20Details?: ERC20RegisterDetails) {\n    if (!erc20Details) return;\n\n    try {\n      await window.ethereum.request({\n        method: 'wallet_watchAsset',\n        params: {\n          type: 'ERC20',\n          options: erc20Details,\n        },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  return {\n    isInProcessOrDone,\n    redeemCoupon: handleRedeemCoupon,\n    submitError,\n    submitStatus,\n    txStatus,\n    txError,\n    txEtherscanURL,\n    txIsPromptOpen,\n  };\n}\n","import {useState} from 'react';\nimport {TransactionReceipt} from 'web3-core/types';\n\nimport {CHAINS, ETHERSCAN_URLS} from '../../../config';\nimport {contractSend} from '../helpers';\nimport {dontCloseWindowWarning} from '../../../util/helpers';\nimport {useWeb3Modal} from './useWeb3Modal';\nimport {Web3TxStatus} from '../types';\n\ntype UseContractSendReturn = {\n  txError: Error | undefined;\n  txEtherscanURL: string;\n  txIsPromptOpen: boolean;\n  txReceipt: TransactionReceipt | undefined;\n  txSend: (\n    ...p: Parameters<typeof contractSend>\n  ) => Promise<TransactionReceipt | undefined>;\n  txStatus: Web3TxStatus;\n};\n\n/**\n * useContractSend\n *\n * A React hook which encapsulates the call and related values of `contractSend`.\n *\n * @returns {UseContractSendReturn}\n */\nexport function useContractSend(): UseContractSendReturn {\n  const [txError, setTxError] = useState<Error>();\n  const [txEtherscanURL, setTxEtherscanURL] = useState<string>('');\n  const [txIsPromptOpen, setTxIsPromptOpen] = useState<boolean>(false);\n  const [txReceipt, setTxReceipt] = useState<TransactionReceipt>();\n  const [txStatus, setTxStatus] = useState<Web3TxStatus>(Web3TxStatus.STANDBY);\n\n  /**\n   * Our hooks\n   */\n\n  const {networkId} = useWeb3Modal();\n\n  /**\n   * Functions\n   */\n\n  function handleOnTxProcess(callback?: (txh: string) => void) {\n    return (txHash: string) => {\n      setTxStatus(Web3TxStatus.PENDING);\n      setTxIsPromptOpen(false);\n\n      // Ganache transactions do not show on Etherscan.\n      if (networkId && networkId !== CHAINS.GANACHE) {\n        setTxEtherscanURL(`${ETHERSCAN_URLS[networkId]}/tx/${txHash}`);\n      }\n\n      callback && callback(txHash);\n    };\n  }\n\n  async function txSend(\n    ...contractSendParams: Parameters<typeof contractSend>\n  ) {\n    // Activate \"don't close window\" warning\n    const unsubscribeDontCloseWindow = dontCloseWindowWarning();\n\n    try {\n      // Reset state in case trying again after error.\n      setTxError(undefined);\n      setTxEtherscanURL('');\n\n      setTxStatus(Web3TxStatus.AWAITING_CONFIRM);\n      setTxIsPromptOpen(true);\n\n      // Intercept the on process callback to allow us to set our internal state.\n      contractSendParams[4] = handleOnTxProcess(contractSendParams[4]);\n\n      const receipt = await contractSend(...contractSendParams);\n\n      setTxReceipt(receipt);\n      setTxStatus(Web3TxStatus.FULFILLED);\n\n      unsubscribeDontCloseWindow();\n\n      return receipt;\n    } catch (error) {\n      setTxError(error);\n      setTxStatus(Web3TxStatus.REJECTED);\n      setTxIsPromptOpen(false);\n\n      unsubscribeDontCloseWindow();\n\n      throw error;\n    }\n  }\n\n  return {\n    txError,\n    txEtherscanURL,\n    txIsPromptOpen,\n    txReceipt,\n    txSend,\n    txStatus,\n  };\n}\n","import {useEffect, useState} from 'react';\nimport {toWei} from 'web3-utils';\nimport BigNumber from 'bignumber.js';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {ENVIRONMENT} from '../../../config';\nimport {useAbortController} from '../../../hooks';\n\ntype GasStationResponse = {\n  average: number;\n  avgWait: number;\n  block_time: number;\n  blockNum: number;\n  fast: number;\n  fastest: number;\n  fastestWait: number;\n  fastWait: number;\n  gasPriceRange: Record<string, number>;\n  safeLow: number;\n  safeLowWait: number;\n  speed: number;\n};\n\ntype GasPrices = {\n  average: string | undefined;\n  fast: string | undefined;\n  fastest: string | undefined;\n  safeLow: string | undefined;\n};\n\ntype UseETHGasPriceReturn = GasPrices & {\n  gasPriceError: Error | undefined;\n  gasPriceStatus: AsyncStatus;\n};\n\nconst URL = 'https://ethgasstation.info/json/ethgasAPI.json';\n\n/**\n * To prepare the provided ETHGasStation values for conversion from Gwei->wei,\n * first divide by `10`, per the API docs.\n *\n * @see https://docs.ethgasstation.info/gas-price#gas-price\n */\nfunction convertGasToWEI(gasStationPrice: number) {\n  const gasPriceToWEI: string = toWei(\n    new BigNumber((gasStationPrice / 10).toFixed(4)).toString(),\n    'Gwei'\n  );\n\n  return gasPriceToWEI;\n}\n\nconst INITIAL_GAS_PRICES: GasPrices = {\n  average: undefined,\n  fast: undefined,\n  fastest: undefined,\n  safeLow: undefined,\n};\n\n/**\n * useETHGasPrice\n *\n * Returns the latest mainnet gas prices, converted to WEI string from ETHGasStation.\n *\n * @returns {UseETHGasPriceReturn}\n * @see https://ethgasstation.info/json/ethgasAPI.json\n */\nexport function useETHGasPrice(props?: {\n  ignoreEnvironment?: boolean;\n}): UseETHGasPriceReturn {\n  const {ignoreEnvironment = false} = props || {};\n\n  /**\n   * State\n   */\n\n  const [gasPrices, setGasPrices] = useState<GasPrices>(INITIAL_GAS_PRICES);\n  const [gasPriceError, setGasPriceError] = useState<Error>();\n\n  const [gasPriceStatus, setGasPriceStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {abortController, isMountedRef} = useAbortController();\n\n  /**\n   * Variables\n   */\n\n  /**\n   * Sometimes using mainnet gas prices for testnets won't work well with wallets.\n   */\n  const shouldExitIfNotProduction: boolean =\n    ignoreEnvironment === false && ENVIRONMENT !== 'production';\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!abortController?.signal) return;\n    if (shouldExitIfNotProduction) return;\n\n    setGasPriceError(undefined);\n    setGasPriceStatus(AsyncStatus.PENDING);\n\n    fetch(URL, {signal: abortController.signal})\n      .then((response) => {\n        if (!isMountedRef.current) return;\n\n        if (!response.ok) {\n          throw new Error(\n            'Something went wrong while getting the latest gas price.'\n          );\n        }\n\n        setGasPriceStatus(AsyncStatus.FULFILLED);\n\n        return response.json();\n      })\n      .then((jsonResponse: GasStationResponse) => {\n        if (!isMountedRef.current) return;\n\n        const {average, fast, fastest, safeLow} = jsonResponse;\n\n        setGasPrices({\n          average: convertGasToWEI(average),\n          fast: convertGasToWEI(fast),\n          fastest: convertGasToWEI(fastest),\n          safeLow: convertGasToWEI(safeLow),\n        });\n      })\n      .catch((error) => {\n        if (!isMountedRef.current) return;\n\n        setGasPriceError(error);\n        setGasPrices(INITIAL_GAS_PRICES);\n        setGasPriceStatus(AsyncStatus.REJECTED);\n      });\n\n    return () => {\n      abortController.abort();\n    };\n  }, [abortController, isMountedRef, shouldExitIfNotProduction]);\n\n  /**\n   * Result\n   */\n\n  return {...gasPrices, gasPriceError, gasPriceStatus};\n}\n","import {useCallback} from 'react';\nimport {useDispatch} from 'react-redux';\nimport Web3 from 'web3';\n\nimport {\n  initContractBankAdapter,\n  initContractBankExtension,\n  initContractBankFactory,\n  initContractConfiguration,\n  initContractCouponOnboarding,\n  initContractDaoFactory,\n  initContractDaoRegistry,\n  initContractDaoRegistryAdapter,\n  initContractDistribute,\n  initContractERC20Extension,\n  initContractFinancing,\n  initContractGuildKick,\n  initContractManaging,\n  initContractNFTAdapter,\n  initContractNFTExtension,\n  initContractOnboarding,\n  initContractRagequit,\n  initContractTribute,\n  initContractTributeNFT,\n  initRegisteredVotingAdapter,\n} from '../../../store/actions';\nimport {ReduxDispatch} from '../../../store/types';\n\n/**\n * useInitContracts\n *\n * Initiates all contracts used in the app.\n *\n * @todo Use subgraph to pass the address to each init function, so it skips chain calls.\n */\nexport function useInitContracts(): (data: {\n  web3Instance: Web3;\n}) => Promise<void> {\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const initContractsCached = useCallback(initContracts, [dispatch]);\n\n  /**\n   * Init contracts\n   */\n  async function initContracts({web3Instance}: {web3Instance: Web3}) {\n    try {\n      // Must init registry first\n      await dispatch(initContractDaoRegistry(web3Instance));\n\n      await dispatch(initContractDaoFactory(web3Instance));\n      await dispatch(initContractBankFactory(web3Instance));\n      await dispatch(initContractConfiguration(web3Instance));\n      await dispatch(initContractFinancing(web3Instance));\n      await dispatch(initContractGuildKick(web3Instance));\n      await dispatch(initContractManaging(web3Instance));\n      await dispatch(initContractRagequit(web3Instance));\n      await dispatch(initContractBankAdapter(web3Instance));\n      await dispatch(initContractBankExtension(web3Instance));\n      await dispatch(initContractManaging(web3Instance));\n      await dispatch(initContractOnboarding(web3Instance));\n      await dispatch(initContractTribute(web3Instance));\n      await dispatch(initContractDistribute(web3Instance));\n      await dispatch(initRegisteredVotingAdapter(web3Instance));\n      await dispatch(initContractTributeNFT(web3Instance));\n      await dispatch(initContractNFTExtension(web3Instance));\n      await dispatch(initContractNFTAdapter(web3Instance));\n      await dispatch(initContractCouponOnboarding(web3Instance));\n      await dispatch(initContractDaoRegistryAdapter(web3Instance));\n      await dispatch(initContractERC20Extension(web3Instance));\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  return initContractsCached;\n}\n","import {useEffect, useState} from 'react';\n\nimport {CHAIN_NAME_FULL, DEFAULT_CHAIN} from '../../../config';\nimport {useWeb3Modal} from './useWeb3Modal';\n\ntype UseIsDefaultChainReturn = {\n  /**\n   * The default chain of the app\n   */\n  defaultChain: number;\n  /**\n   * Any error derived from detecting the default chain\n   */\n  defaultChainError: Error | undefined;\n  /**\n   * Specifies if the curently connected chain matches the app's default chain\n   */\n  isDefaultChain: boolean;\n};\n\n/**\n * useIsDefaultChain\n *\n * Checks if the connected account it connected to the default chain.\n *\n * @returns UseIsDefaultChainReturn\n */\nexport function useIsDefaultChain(): UseIsDefaultChainReturn {\n  /**\n   * Our hooks\n   */\n\n  const {networkId, connected} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [defaultChainError, setDefaultChainError] = useState<Error>();\n\n  /**\n   * Effects\n   */\n\n  // Determine `defaultChainError`\n  useEffect(() => {\n    // User is already connected to a wallet, and chain is incorrect.\n    if (connected && networkId !== DEFAULT_CHAIN) {\n      setDefaultChainError(\n        new Error(`Please connect to the ${CHAIN_NAME_FULL[DEFAULT_CHAIN]}.`)\n      );\n\n      return;\n    }\n\n    // Reset error after successful checks.\n    setDefaultChainError(undefined);\n  }, [connected, networkId]);\n\n  return {\n    defaultChain: DEFAULT_CHAIN,\n    defaultChainError,\n    isDefaultChain: networkId === DEFAULT_CHAIN,\n  };\n}\n","import {provider} from 'web3-core/types';\nimport {useCallback, useEffect, useState} from 'react';\nimport {Web3Provider} from '@ethersproject/providers';\n\nimport {isPossibleContractWallet} from '../../../util/helpers';\nimport Web3 from 'web3';\nimport {useIsMounted} from '../../../hooks';\n\nconst INITIAL_MAYBE_CONTRACT_WALLET_STATE: boolean = false;\n\nexport function useMaybeContractWallet(\n  account: string | undefined,\n  web3Provider: Web3['currentProvider'] | undefined\n): boolean {\n  /**\n   * State\n   */\n\n  const [maybeContractWallet, setMaybeContractWallet] = useState<boolean>(\n    INITIAL_MAYBE_CONTRACT_WALLET_STATE\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {isMountedRef} = useIsMounted();\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleIsPossibleContractWalletCached = useCallback(\n    handleIsPossibleContractWallet,\n    [isMountedRef]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!web3Provider || !account) return;\n\n    handleIsPossibleContractWalletCached(account, web3Provider);\n  }, [account, handleIsPossibleContractWalletCached, web3Provider]);\n\n  /**\n   * Functions\n   */\n\n  async function handleIsPossibleContractWallet(\n    account: string,\n    web3Provider: provider\n  ): Promise<void> {\n    try {\n      const response = await isPossibleContractWallet(\n        account,\n        /**\n         * Web3 `provider` doesn't provide the correct types to satisfy `Web3Provider`,\n         * but this does work.\n         */\n        new Web3Provider(web3Provider as any)\n      );\n\n      if (!isMountedRef.current) return;\n\n      setMaybeContractWallet(response);\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setMaybeContractWallet(INITIAL_MAYBE_CONTRACT_WALLET_STATE);\n    }\n  }\n\n  /**\n   * Return\n   */\n\n  return maybeContractWallet;\n}\n","import {Dispatch} from 'redux';\nimport Web3 from 'web3';\n\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {ConnectedMemberState} from '../connectedMember/types';\nimport {ContractsStateEntry} from '../contracts/types';\nimport {hasFlag, multicall} from '../../components/web3/helpers';\nimport {MemberFlag} from '../../components/web3/types';\nimport {normalizeString} from '../../util/helpers';\n\nexport const SET_CONNECTED_MEMBER = 'SET_CONNECTED_MEMBER';\nexport const CLEAR_CONNECTED_MEMBER = 'CLEAR_CONNECTED_MEMBER';\n\n/**\n * getConnectedMember\n *\n * Gets information about a connected address from the DAO's `members`.\n * If the user is not a member, the defaults for a non-existent member of the DAO are returned (e.g. \"0x000000...\")\n * and `isActiveMember` will be `false`.\n *\n * The reason state is set for both a member and a non-member\n * is to ensure we're not too restrictive in our Dapp logic and\n * letting the contract do its job.\n */\nexport function getConnectedMember({\n  account,\n  daoRegistryContract,\n  web3Instance,\n}: {\n  account: string;\n  daoRegistryContract: ContractsStateEntry;\n  web3Instance: Web3;\n}) {\n  return async function (dispatch: Dispatch<any>) {\n    const daoRegistryMethods = daoRegistryContract?.instance.methods;\n    const daoRegistryAddress = daoRegistryContract?.contractAddress;\n\n    const getAddressIfDelegatedABI = daoRegistryContract?.abi.find(\n      (ai) => ai.name === 'getAddressIfDelegated'\n    );\n    const membersABI = daoRegistryContract?.abi.find(\n      (ai) => ai.name === 'members'\n    );\n    const isActiveMemberABI = daoRegistryContract?.abi.find(\n      (ai) => ai.name === 'isActiveMember'\n    );\n    const getCurrentDelegateKeyABI = daoRegistryContract?.abi.find(\n      (ai) => ai.name === 'getCurrentDelegateKey'\n    );\n\n    if (\n      !account ||\n      !daoRegistryAddress ||\n      !daoRegistryMethods ||\n      !getAddressIfDelegatedABI ||\n      !getCurrentDelegateKeyABI ||\n      !isActiveMemberABI ||\n      !membersABI\n    ) {\n      dispatch(clearConnectedMember());\n\n      return;\n    }\n\n    try {\n      /**\n       * @link https://github.com/openlawteam/tribute-contracts/blob/master/docs/core/DaoRegistry.md\n       */\n\n      const [\n        addressIfDelegated,\n        memberFlag,\n        isActiveMember,\n        currentDelegateKey,\n      ] = await multicall({\n        calls: [\n          [daoRegistryAddress, getAddressIfDelegatedABI, [account]],\n          [daoRegistryAddress, membersABI, [account]],\n          [\n            daoRegistryAddress,\n            isActiveMemberABI,\n            [daoRegistryAddress, account],\n          ],\n          [daoRegistryAddress, getCurrentDelegateKeyABI, [account]],\n        ],\n        web3Instance,\n      });\n\n      // A member can exist in the DAO, yet not be an active member (has units > 0)\n      const doesMemberExist: boolean = hasFlag(MemberFlag.EXISTS, memberFlag);\n\n      // Is this address known to the DAO?\n      const delegateKey: string =\n        isActiveMember || doesMemberExist ? currentDelegateKey : BURN_ADDRESS;\n\n      // Is this address known to the DAO?\n      const memberAddress: string =\n        isActiveMember || doesMemberExist ? addressIfDelegated : BURN_ADDRESS;\n\n      const isAddressDelegated: boolean =\n        normalizeString(account) === normalizeString(memberAddress) &&\n        normalizeString(account) !== normalizeString(delegateKey);\n\n      dispatch(\n        setConnectedMember({\n          delegateKey,\n          isAddressDelegated,\n          isActiveMember,\n          memberAddress,\n        })\n      );\n    } catch (error) {\n      dispatch(clearConnectedMember());\n\n      throw error;\n    }\n  };\n}\n\nexport function setConnectedMember(payload: ConnectedMemberState) {\n  return {type: SET_CONNECTED_MEMBER, ...payload};\n}\n\nexport function clearConnectedMember() {\n  return {type: CLEAR_CONNECTED_MEMBER};\n}\n","export const CONNECT_MODAL_CLOSE = 'CONNECT_MODAL_CLOSE';\nexport const CONNECT_MODAL_OPEN = 'CONNECT_MODAL_OPEN';\n\nexport function connectModalClose() {\n  return {type: CONNECT_MODAL_CLOSE};\n}\n\nexport function connectModalOpen() {\n  return {type: CONNECT_MODAL_OPEN};\n}\n","import {useReducer, useCallback, useEffect} from 'react';\nimport Web3 from 'web3';\nimport Web3Modal, {IProviderOptions} from 'web3modal';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {DEFAULT_CHAIN} from '../../../config';\nimport {NetworkNames, NetworkIDs} from '../../../util/enums';\n\nexport enum DefaultTheme {\n  DARK = 'dark',\n  LIGHT = 'light',\n}\n\nenum ActionType {\n  CONNECT_WEB3MODAL,\n  DEACTIVATE_PROVIDER_WEB3MODAL,\n  ERROR_WEB3MODAL,\n  INITIAL_CACHED_CONNECTOR_CHECK_STATUS,\n  NEW_WEB3MODAL,\n  UPDATE_ACCOUNT,\n}\n\ninterface Action {\n  type: ActionType;\n  payload?: Partial<Web3ModalManagerState>;\n}\n\nexport enum Web3ModalErrorType {\n  CONNECT = 'CONNECT',\n  DISCONNECT = 'DISCONNECT',\n}\n\nexport type Web3ModalError = {\n  connectorId: string;\n  error: Error;\n  type: Web3ModalErrorType;\n};\n\ntype Web3ModalManagerState = {\n  account?: undefined | string;\n  connected?: boolean;\n  error?: Web3ModalError;\n  initialCachedConnectorCheckStatus?: AsyncStatus;\n  networkId?: number;\n  provider?: any;\n  web3Instance?: Web3;\n  web3Modal?: Web3Modal;\n};\n\ninterface Web3ModalManagerInterface {\n  defaultChain?: number;\n  defaultTheme?: DefaultTheme;\n  onBeforeDisconnect?: () => void;\n  onBeforeConnect?: () => void;\n  providerOptions: IProviderOptions;\n}\n\ntype UseWeb3ModalManagerReturn = {\n  connectWeb3Modal: (connectorId: string) => Promise<void>;\n  disconnectWeb3Modal: () => Promise<void>;\n  providerOptions: Web3ModalManagerInterface['providerOptions'];\n} & Web3ModalManagerState;\n\nconst INITIAL_STATE = {};\n\nfunction reducer(\n  state: Web3ModalManagerState = INITIAL_STATE,\n  {type, payload}: Action\n): Web3ModalManagerState {\n  switch (type) {\n    case ActionType.CONNECT_WEB3MODAL: {\n      const {provider, networkId, account, connected, web3Instance} =\n        payload || {};\n\n      return {\n        ...state,\n        account,\n        connected,\n        networkId,\n        provider,\n        web3Instance,\n      };\n    }\n\n    case ActionType.DEACTIVATE_PROVIDER_WEB3MODAL: {\n      return INITIAL_STATE;\n    }\n\n    case ActionType.ERROR_WEB3MODAL: {\n      const {error} = payload || {};\n\n      return {\n        ...state,\n        error,\n      };\n    }\n\n    case ActionType.INITIAL_CACHED_CONNECTOR_CHECK_STATUS: {\n      const {initialCachedConnectorCheckStatus} = payload || {};\n\n      return {\n        ...state,\n        initialCachedConnectorCheckStatus,\n      };\n    }\n\n    case ActionType.NEW_WEB3MODAL: {\n      const {web3Modal} = payload || {};\n      return {web3Modal};\n    }\n\n    case ActionType.UPDATE_ACCOUNT: {\n      const {account} = payload || {};\n\n      return {\n        ...state,\n        account,\n      };\n    }\n\n    default:\n      return INITIAL_STATE;\n  }\n}\n\nexport default function useWeb3ModalManager({\n  defaultChain,\n  defaultTheme,\n  onBeforeConnect,\n  onBeforeDisconnect,\n  providerOptions,\n}: Web3ModalManagerInterface): UseWeb3ModalManagerReturn {\n  /**\n   * Reducers\n   */\n\n  const [state, dispatch] = useReducer<typeof reducer>(reducer, {\n    initialCachedConnectorCheckStatus: AsyncStatus.STANDBY,\n  });\n\n  /**\n   * Variables\n   */\n\n  const web3ModalTheme = defaultTheme;\n  const web3ModalChain: number = defaultChain || DEFAULT_CHAIN;\n\n  /**\n   * Cached callbacks\n   */\n\n  const connectWeb3ModalCached = useCallback(connectWeb3Modal, [\n    onBeforeConnect,\n    state.web3Modal,\n  ]);\n\n  const chainChangedCallbackCached = useCallback(chainChangedCallback, [\n    connectWeb3ModalCached,\n    state.web3Modal?.cachedProvider,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    const provider = state.provider;\n\n    // Subscribe to accounts change\n    provider?.on?.('accountsChanged', accountsChangedCallback);\n\n    // Subscribe to chainId change\n    provider?.on?.('chainChanged', chainChangedCallbackCached);\n\n    return () => {\n      // Remove listeners on unmount\n      provider?.removeListener?.('accountsChanged', accountsChangedCallback);\n      provider?.removeListener?.('chainChanged', chainChangedCallbackCached);\n    };\n  }, [chainChangedCallbackCached, state.provider]);\n\n  // Init Web3Modal\n  useEffect(() => {\n    if (state.web3Modal) return;\n\n    dispatch({\n      type: ActionType.NEW_WEB3MODAL,\n      payload: {\n        web3Modal: new Web3Modal({\n          cacheProvider: true, // optional\n          network: NetworkNames[NetworkIDs[web3ModalChain]], // optional\n          providerOptions, // required\n          theme: web3ModalTheme, // optional; `light` or `dark`. `dark` is default\n        }),\n      },\n    });\n  }, [providerOptions, state.web3Modal, web3ModalChain, web3ModalTheme]);\n\n  // Attempt to initialise connection to a cached provider\n  useEffect(() => {\n    // If the initial check has ran, or is running, exit.\n    if (\n      state.initialCachedConnectorCheckStatus === AsyncStatus.FULFILLED ||\n      state.initialCachedConnectorCheckStatus === AsyncStatus.PENDING\n    ) {\n      return;\n    }\n\n    attemptUpdateFromCachedConnector(\n      state.web3Modal?.cachedProvider,\n      connectWeb3ModalCached\n    );\n  }, [\n    connectWeb3ModalCached,\n    state.initialCachedConnectorCheckStatus,\n    state.web3Modal?.cachedProvider,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function accountsChangedCallback([account]: string[]) {\n    dispatch({\n      type: ActionType.UPDATE_ACCOUNT,\n      payload: {\n        account,\n      },\n    });\n  }\n\n  function chainChangedCallback(_chainIdHex: string) {\n    if (!state.web3Modal?.cachedProvider) return;\n\n    connectWeb3ModalCached(state.web3Modal?.cachedProvider);\n  }\n\n  /**\n   * attemptUpdateFromCachedConnector\n   *\n   * Will attempt to connect if a `connectorId` (e.g. `\"injected\"`)\n   * and cached provider (via `localStorage`) is available.\n   *\n   * @param connectorId `String | undefined`\n   * @param connectCallback `Function` callback which dispatches an action to connect\n   * @returns void\n   */\n  async function attemptUpdateFromCachedConnector(\n    connectorId: string | undefined,\n    connectCallback: (cid: string) => Promise<void>\n  ): Promise<void> {\n    const statusAction = ActionType.INITIAL_CACHED_CONNECTOR_CHECK_STATUS;\n\n    /**\n     * Wait for the `state.web3Modal` object to be available, as `cachedProvider`\n     * defaults to an empty `String` if not set.\n     */\n    if (typeof connectorId !== 'string') return;\n\n    dispatch({\n      type: statusAction,\n      payload: {initialCachedConnectorCheckStatus: AsyncStatus.PENDING},\n    });\n\n    if (connectorId) {\n      // @note Does not throw\n      await connectCallback(connectorId);\n    }\n\n    dispatch({\n      type: statusAction,\n      payload: {initialCachedConnectorCheckStatus: AsyncStatus.FULFILLED},\n    });\n  }\n\n  /**\n   * Connect to a specfic wallet; get account assets and\n   * subscribe to provider events\n   */\n  async function connectWeb3Modal(connectorId: string): Promise<void> {\n    try {\n      if (!state.web3Modal) return;\n\n      const provider = await state.web3Modal.connectTo(connectorId);\n\n      const web3Instance: Web3 = new Web3(provider);\n\n      // Get index `0` account\n      const [account] = await web3Instance.eth.getAccounts();\n\n      // Run callback if provided\n      await onBeforeConnect?.();\n\n      dispatch({\n        type: ActionType.CONNECT_WEB3MODAL,\n        payload: {\n          account,\n          connected: true,\n          networkId: await web3Instance.eth.net.getId(),\n          provider,\n          web3Instance,\n        },\n      });\n    } catch (error) {\n      dispatch({\n        type: ActionType.ERROR_WEB3MODAL,\n        payload: {\n          error: {\n            connectorId,\n            error: new Error(`Failed to connect to ${connectorId}.`),\n            type: Web3ModalErrorType.CONNECT,\n          },\n        },\n      });\n    }\n  }\n\n  /**\n   * Disconnect wallet button pressed.\n   */\n  async function disconnectWeb3Modal(): Promise<void> {\n    try {\n      await state.provider?.close?.();\n\n      // If the cached provider is not cleared,\n      // WalletConnect will default to the existing session\n      // and does not allow to re-scan the QR code with a new wallet.\n      // Depending on your use case you may want or want not his behaviour.\n      state.web3Modal && (await state.web3Modal.clearCachedProvider());\n\n      // Run callback if provided\n      await onBeforeDisconnect?.();\n\n      // Reset all state\n      dispatch({type: ActionType.DEACTIVATE_PROVIDER_WEB3MODAL});\n    } catch (error) {\n      const connectorId: string = state.web3Modal?.cachedProvider || '';\n\n      dispatch({\n        type: ActionType.ERROR_WEB3MODAL,\n        payload: {\n          error: {\n            connectorId,\n            error: new Error(\n              `Failed to disconnect from ${connectorId || 'provider'}.`\n            ),\n            type: Web3ModalErrorType.DISCONNECT,\n          },\n        },\n      });\n    }\n  }\n\n  return {\n    ...state,\n    connectWeb3Modal,\n    disconnectWeb3Modal,\n    providerOptions,\n  };\n}\n","/**\n * DaoConstants as defined in the solidity DaoConstants.sol contract\n * and the available adapters as detailed here:\n * https://github.com/openlawteam/tribute-contracts\n */\nexport enum DaoAdapterConstants {\n  BANK = 'bank',\n  CONFIGURATION = 'configuration',\n  COUPON_ONBOARDING = 'coupon-onboarding',\n  DAO_REGISTRY = 'daoRegistry',\n  DISTRIBUTE = 'distribute',\n  EXECUTION = 'execution',\n  FINANCING = 'financing',\n  GUILDKICK = 'guildkick',\n  MANAGING = 'managing',\n  NFT = 'nft',\n  NONVOTING_ONBOARDING = 'nonvoting-onboarding',\n  OFFCHAINVOTING = 'offchainvoting',\n  ONBOARDING = 'onboarding',\n  RAGEQUIT = 'ragequit',\n  TRIBUTE = 'tribute',\n  TRIBUTE_NFT = 'tribute-nft',\n  VOTING = 'voting',\n  WATER = 'water',\n}\n\nexport enum DaoExtensionConstants {\n  BANK = 'bank',\n  ERC20 = 'erc20-ext',\n  NFT = 'nft',\n}\n\n/**\n * Voting adapter names as defined in the solidity voting adapter contracts\n * i.e. `string public constant ADAPTER_NAME = \"VotingContract\"`.\n *\n * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting\n */\nexport enum VotingAdapterName {\n  OffchainVotingContract = 'OffchainVotingContract',\n  VotingContract = 'VotingContract',\n}\n","import Web3 from 'web3';\nimport {AbiItem} from 'web3-utils/types';\nimport {Dispatch} from 'redux';\n\nimport {\n  ContractAdapterNames,\n  ContractExtensionNames,\n} from '../../components/web3/types';\nimport {\n  DEFAULT_CHAIN,\n  BANK_FACTORY_CONTRACT_ADDRESS,\n  DAO_FACTORY_CONTRACT_ADDRESS,\n  DAO_REGISTRY_CONTRACT_ADDRESS,\n} from '../../config';\nimport {\n  getAdapterAddress,\n  getVotingAdapterName,\n} from '../../components/web3/helpers';\nimport {\n  DaoAdapterConstants,\n  DaoExtensionConstants,\n  VotingAdapterName,\n} from '../../components/adapters-extensions/enums';\nimport {ContractsStateEntry} from './types';\nimport {getExtensionAddress} from '../../components/web3/helpers/getExtensionAddress';\nimport {StoreState} from '../types';\n\ntype ContractAction =\n  | typeof CLEAR_CONTRACTS\n  | typeof CONTRACT_BANK_ADAPTER\n  | typeof CONTRACT_BANK_EXTENSION\n  | typeof CONTRACT_BANK_FACTORY\n  | typeof CONTRACT_CONFIGURATION\n  | typeof CONTRACT_COUPON_ONBOARDING\n  | typeof CONTRACT_DAO_FACTORY\n  | typeof CONTRACT_DAO_REGISTRY\n  | typeof CONTRACT_DAO_REGISTRY_ADAPTER\n  | typeof CONTRACT_DISTRIBUTE\n  | typeof CONTRACT_ERC20_EXTENSION\n  | typeof CONTRACT_FINANCING\n  | typeof CONTRACT_GUILDKICK\n  | typeof CONTRACT_MANAGING\n  | typeof CONTRACT_NFT_ADAPTER\n  | typeof CONTRACT_NFT_EXTENSION\n  | typeof CONTRACT_ONBOARDING\n  | typeof CONTRACT_RAGEQUIT\n  | typeof CONTRACT_TRIBUTE\n  | typeof CONTRACT_TRIBUTE_NFT\n  | typeof CONTRACT_VOTING\n  | typeof CONTRACT_VOTING_OP_ROLLUP\n  | typeof CONTRACT_WATER;\n\nexport const CLEAR_CONTRACTS = 'CLEAR_CONTRACTS';\nexport const CONTRACT_BANK_ADAPTER = 'CONTRACT_BANK_ADAPTER';\nexport const CONTRACT_BANK_EXTENSION = 'CONTRACT_BANK_EXTENSION';\nexport const CONTRACT_BANK_FACTORY = 'CONTRACT_BANK_FACTORY';\nexport const CONTRACT_CONFIGURATION = 'CONTRACT_CONFIGURATION';\nexport const CONTRACT_COUPON_ONBOARDING = 'CONTRACT_COUPON_ONBOARDING';\nexport const CONTRACT_DAO_FACTORY = 'CONTRACT_DAO_FACTORY';\nexport const CONTRACT_DAO_REGISTRY = 'CONTRACT_DAO_REGISTRY';\nexport const CONTRACT_DAO_REGISTRY_ADAPTER = 'CONTRACT_DAO_REGISTRY_ADAPTER';\nexport const CONTRACT_DISTRIBUTE = 'CONTRACT_DISTRIBUTE';\nexport const CONTRACT_ERC20_EXTENSION = 'CONTRACT_ERC20_EXTENSION';\nexport const CONTRACT_FINANCING = 'CONTRACT_FINANCING';\nexport const CONTRACT_GUILDKICK = 'CONTRACT_GUILDKICK';\nexport const CONTRACT_MANAGING = 'CONTRACT_MANAGING';\nexport const CONTRACT_NFT_ADAPTER = 'CONTRACT_NFT_ADAPTER';\nexport const CONTRACT_NFT_EXTENSION = 'CONTRACT_NFT_EXTENSION';\nexport const CONTRACT_ONBOARDING = 'CONTRACT_ONBOARDING';\nexport const CONTRACT_RAGEQUIT = 'CONTRACT_RAGEQUIT';\nexport const CONTRACT_TRIBUTE = 'CONTRACT_TRIBUTE';\nexport const CONTRACT_TRIBUTE_NFT = 'CONTRACT_TRIBUTE_NFT';\nexport const CONTRACT_VOTING = 'CONTRACT_VOTING';\nexport const CONTRACT_VOTING_OP_ROLLUP = 'CONTRACT_VOTING_OP_ROLLUP';\nexport const CONTRACT_WATER = 'CONTRACT_WATER';\n\nexport function clearContracts(): Record<'type', typeof CLEAR_CONTRACTS> {\n  return {\n    type: CLEAR_CONTRACTS,\n  };\n}\n\nexport function initContractBankFactory(web3Instance: Web3) {\n  return async function (dispatch: Dispatch<any>) {\n    try {\n      if (web3Instance) {\n        const {default: lazyBankFactoryABI} = await import(\n          '../../truffle-contracts/BankFactory.json'\n        );\n        const bankFactoryContract: AbiItem[] = lazyBankFactoryABI as any;\n        const contractAddress = BANK_FACTORY_CONTRACT_ADDRESS[DEFAULT_CHAIN];\n        const instance = new web3Instance.eth.Contract(\n          bankFactoryContract,\n          contractAddress\n        );\n\n        dispatch(\n          createContractAction({\n            type: CONTRACT_BANK_FACTORY,\n            abi: bankFactoryContract,\n            contractAddress,\n            instance,\n          })\n        );\n      }\n    } catch (error) {\n      throw error;\n    }\n  };\n}\n\nexport function initContractDaoFactory(web3Instance: Web3) {\n  return async function (dispatch: Dispatch<any>) {\n    try {\n      if (web3Instance) {\n        const {default: lazyDaoFactoryABI} = await import(\n          '../../truffle-contracts/DaoFactory.json'\n        );\n        const daoFactoryContract: AbiItem[] = lazyDaoFactoryABI as any;\n        const contractAddress = DAO_FACTORY_CONTRACT_ADDRESS[DEFAULT_CHAIN];\n        const instance = new web3Instance.eth.Contract(\n          daoFactoryContract,\n          contractAddress\n        );\n\n        dispatch(\n          createContractAction({\n            type: CONTRACT_DAO_FACTORY,\n            abi: daoFactoryContract,\n            contractAddress,\n            instance,\n          })\n        );\n      }\n    } catch (error) {\n      throw error;\n    }\n  };\n}\n\nexport function initContractDaoRegistry(web3Instance: Web3) {\n  return async function (dispatch: Dispatch<any>) {\n    try {\n      if (web3Instance) {\n        const {default: lazyDaoRegistryABI} = await import(\n          '../../truffle-contracts/DaoRegistry.json'\n        );\n\n        const daoRegistryContract: AbiItem[] = lazyDaoRegistryABI as any;\n        const contractAddress = DAO_REGISTRY_CONTRACT_ADDRESS;\n\n        if (!contractAddress) {\n          throw new Error('No DAO Registry contract address was found.');\n        }\n\n        const instance = new web3Instance.eth.Contract(\n          daoRegistryContract,\n          contractAddress\n        );\n\n        dispatch(\n          createContractAction({\n            type: CONTRACT_DAO_REGISTRY,\n            abi: daoRegistryContract,\n            contractAddress,\n            instance,\n          })\n        );\n      }\n    } catch (error) {\n      throw error;\n    }\n  };\n}\n\nexport function initContractVoting(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_VOTING,\n    adapterOrExtensionName: ContractAdapterNames.voting,\n    adapterNameForRedux: VotingAdapterName.VotingContract,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/VotingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractVotingOpRollup(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_VOTING_OP_ROLLUP,\n    adapterOrExtensionName: ContractAdapterNames.voting,\n    adapterNameForRedux: VotingAdapterName.OffchainVotingContract,\n    contractAddress,\n    lazyImport: () =>\n      import('../../truffle-contracts/OffchainVotingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractWater(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_WATER,\n    adapterNameForRedux: DaoAdapterConstants.WATER,\n    adapterOrExtensionName: ContractAdapterNames.water,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/WaterContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractOnboarding(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_ONBOARDING,\n    adapterNameForRedux: DaoAdapterConstants.ONBOARDING,\n    adapterOrExtensionName: ContractAdapterNames.onboarding,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/OnboardingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractBankExtension(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_BANK_EXTENSION,\n    adapterNameForRedux: DaoExtensionConstants.BANK,\n    adapterOrExtensionName: ContractExtensionNames.bank,\n    contractAddress,\n    isExtension: true,\n    lazyImport: () => import('../../truffle-contracts/BankExtension.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractTribute(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_TRIBUTE,\n    adapterNameForRedux: DaoAdapterConstants.TRIBUTE,\n    adapterOrExtensionName: ContractAdapterNames.tribute,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/TributeContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractDistribute(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_DISTRIBUTE,\n    adapterNameForRedux: DaoAdapterConstants.DISTRIBUTE,\n    adapterOrExtensionName: ContractAdapterNames.distribute,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/DistributeContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractManaging(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_MANAGING,\n    adapterNameForRedux: DaoAdapterConstants.MANAGING,\n    adapterOrExtensionName: ContractAdapterNames.managing,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/ManagingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractBankAdapter(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_BANK_ADAPTER,\n    adapterNameForRedux: DaoAdapterConstants.BANK,\n    adapterOrExtensionName: ContractAdapterNames.bank,\n    contractAddress,\n    lazyImport: () =>\n      import('../../truffle-contracts/BankAdapterContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractNFTAdapter(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_NFT_ADAPTER,\n    adapterNameForRedux: DaoAdapterConstants.NFT,\n    adapterOrExtensionName: ContractAdapterNames.nft,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/NFTAdapterContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractDaoRegistryAdapter(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_DAO_REGISTRY_ADAPTER,\n    adapterNameForRedux: DaoAdapterConstants.DAO_REGISTRY,\n    adapterOrExtensionName: ContractAdapterNames.dao_registry,\n    contractAddress,\n    lazyImport: () =>\n      import('../../truffle-contracts/DaoRegistryAdapterContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractRagequit(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_RAGEQUIT,\n    adapterNameForRedux: DaoAdapterConstants.RAGEQUIT,\n    adapterOrExtensionName: ContractAdapterNames.ragequit,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/RagequitContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractGuildKick(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_GUILDKICK,\n    adapterNameForRedux: DaoAdapterConstants.GUILDKICK,\n    adapterOrExtensionName: ContractAdapterNames.guildkick,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/GuildKickContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractFinancing(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_FINANCING,\n    adapterNameForRedux: DaoAdapterConstants.FINANCING,\n    adapterOrExtensionName: ContractAdapterNames.financing,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/FinancingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractConfiguration(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_CONFIGURATION,\n    adapterNameForRedux: DaoAdapterConstants.CONFIGURATION,\n    adapterOrExtensionName: ContractAdapterNames.configuration,\n    contractAddress,\n    lazyImport: () =>\n      import('../../truffle-contracts/ConfigurationContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractTributeNFT(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_TRIBUTE_NFT,\n    adapterNameForRedux: DaoAdapterConstants.TRIBUTE_NFT,\n    adapterOrExtensionName: ContractAdapterNames.tribute_nft,\n    contractAddress,\n    lazyImport: () => import('../../truffle-contracts/TributeNFTContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractCouponOnboarding(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_COUPON_ONBOARDING,\n    adapterNameForRedux: DaoAdapterConstants.COUPON_ONBOARDING,\n    adapterOrExtensionName: ContractAdapterNames.coupon_onboarding,\n    contractAddress,\n    lazyImport: () =>\n      import('../../truffle-contracts/CouponOnboardingContract.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractNFTExtension(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_NFT_EXTENSION,\n    adapterNameForRedux: DaoExtensionConstants.NFT,\n    adapterOrExtensionName: ContractExtensionNames.nft,\n    contractAddress,\n    isExtension: true,\n    lazyImport: () => import('../../truffle-contracts/NFTExtension.json'),\n    web3Instance,\n  });\n}\n\nexport function initContractERC20Extension(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return initContractThunkFactory({\n    actionType: CONTRACT_ERC20_EXTENSION,\n    adapterNameForRedux: DaoExtensionConstants.ERC20,\n    adapterOrExtensionName: ContractExtensionNames.erc20,\n    contractAddress,\n    isExtension: true,\n    lazyImport: () => import('../../truffle-contracts/ERC20Extension.json'),\n    web3Instance,\n  });\n}\n\n/**\n * Inits the currently registered `voting` contract.\n *\n * @note The DaoRegistry and Managing contracts must be initialised beforehand.\n */\nexport function initRegisteredVotingAdapter(\n  web3Instance: Web3,\n  contractAddress?: string\n) {\n  return async function (dispatch: Dispatch<any>, getState: () => StoreState) {\n    try {\n      if (web3Instance) {\n        const daoRegistryContract = getState().contracts.DaoRegistryContract;\n\n        if (!daoRegistryContract) {\n          console.warn(\n            'Please init the DaoRegistry contract before the voting contract.'\n          );\n          return;\n        }\n\n        let votingAdapterName: string = '';\n        let address: string = contractAddress || '';\n\n        if (address) {\n          votingAdapterName = await getVotingAdapterName(address, web3Instance);\n        }\n\n        if (!address && !votingAdapterName) {\n          address = await getAdapterAddress(\n            ContractAdapterNames.voting,\n            getState().contracts.DaoRegistryContract?.instance\n          );\n\n          votingAdapterName = await getVotingAdapterName(address, web3Instance);\n        }\n\n        /**\n         * @todo Move voting adapter enum names (see contracts: `ADAPTER_NAME`)\n         *   to an appropriate adapter config file.\n         */\n        switch (votingAdapterName) {\n          case 'VotingContract':\n            return await initContractVoting(web3Instance, address)(\n              dispatch,\n              getState\n            );\n          case 'OffchainVotingContract':\n            return await initContractVotingOpRollup(web3Instance, address)(\n              dispatch,\n              getState\n            );\n          default:\n            throw new Error('Voting contract name could not be found.');\n        }\n      }\n    } catch (error) {\n      console.warn(\n        `The voting contract could not be found in the DAO. Are you sure you meant to add this contract's ABI?`\n      );\n    }\n  };\n}\n\nexport function createContractAction({\n  type,\n  ...payload\n}: {\n  type: ContractAction;\n} & ContractsStateEntry) {\n  return {\n    type,\n    ...payload,\n  };\n}\n\nexport function initContractThunkFactory({\n  actionType,\n  adapterNameForRedux,\n  adapterOrExtensionName,\n  contractAddress,\n  isExtension = false,\n  lazyImport,\n  web3Instance,\n}: {\n  actionType: ContractAction;\n  adapterOrExtensionName: ContractAdapterNames | ContractExtensionNames;\n  /**\n   * The name to be shown in Redux state as `adapterOrExtensionName`.\n   */\n  adapterNameForRedux?: ContractsStateEntry['adapterOrExtensionName'];\n  contractAddress?: string;\n  /**\n   * If set to `true` an Extenion address will be searched for instead of an Adapter.\n   */\n  isExtension?: boolean;\n  /**\n   * Provide a Dynamic Import wrapped in a function.\n   *\n   * e.g. `() => import('./path/to/import')`\n   */\n  lazyImport: () => any;\n  web3Instance: Web3;\n}) {\n  // Return a Redux Thunk\n  return async function (dispatch: Dispatch<any>, getState: () => StoreState) {\n    try {\n      const {default: lazyABI} = await lazyImport();\n\n      const contractABI: AbiItem[] = lazyABI as any;\n\n      const address =\n        contractAddress ||\n        (isExtension\n          ? await getExtensionAddress(\n              adapterOrExtensionName as unknown as ContractExtensionNames,\n              getState().contracts.DaoRegistryContract?.instance\n            )\n          : await getAdapterAddress(\n              adapterOrExtensionName as unknown as ContractAdapterNames,\n              getState().contracts.DaoRegistryContract?.instance\n            ));\n\n      dispatch(\n        createContractAction({\n          type: actionType,\n          abi: contractABI,\n          contractAddress: address,\n          adapterOrExtensionName: adapterNameForRedux,\n          instance: new web3Instance.eth.Contract(contractABI, address),\n        })\n      );\n    } catch (error) {\n      // Warn instead of throwing as we want the Dapp to fail gracefully.\n      console.warn(\n        `The contract \"${adapterOrExtensionName}\" could not be found in the DAO. Are you sure you meant to add this contract's ABI?`\n      );\n    }\n  };\n}\n","import {isEthAddressValid} from '../validation';\n\n/**\n * truncateEthAddress\n *\n * Truncates Ethereum address.\n *\n * @param {string} addr\n * @param {number} [maxLength=5]\n * @returns {string}\n */\nexport function truncateEthAddress(\n  addr: string,\n  maxLength: number = 5\n): string {\n  if (addr === null || typeof addr === 'undefined') return '---';\n\n  if (isEthAddressValid(addr)) {\n    const firstSegment = addr.substring(0, maxLength);\n    const secondPart = addr.substring(addr.length - 3);\n    return firstSegment + '...' + secondPart;\n  } else {\n    // in case string argument is not actually an Ethereum address\n    return addr;\n  }\n}\n","import Web3 from 'web3';\n\nimport {ContractsStateEntry} from '../../../store/contracts/types';\nimport {ContractExtensionNames} from '../types';\n\nexport async function getExtensionAddress(\n  extensionName: ContractExtensionNames,\n  daoContractInstance: ContractsStateEntry['instance'] | undefined\n): Promise<string> {\n  try {\n    if (!daoContractInstance) {\n      throw new Error('No DaoRegistry contract instance provided.');\n    }\n\n    return await daoContractInstance.methods\n      .getExtensionAddress(Web3.utils.sha3(extensionName))\n      .call();\n  } catch (error) {\n    throw error;\n  }\n}\n","import {SubgraphNetworkStatusState} from './types';\n\nexport const SET_SUBGRAPH_NETWORK_STATUS = 'SET_SUBGRAPH_NETWORK_STATUS';\n\nexport function setSubgraphNetworkStatus(payload: SubgraphNetworkStatusState) {\n  return {type: SET_SUBGRAPH_NETWORK_STATUS, ...payload};\n}\n","import React, {useState, useEffect, CSSProperties} from 'react';\nimport FadeIn from '../common/FadeIn';\n\ntype CycleEllipsisProps = {\n  ariaLabel?: string;\n  /**\n   * What is the interval of cycling the message?\n   */\n  intervalMs?: number;\n  /**\n   * Optional settings for the inner `<FadeIn />` component.\n   */\n  fadeInProps?: Parameters<typeof FadeIn>[0];\n};\n\nconst MESSAGES = ['', '.', '.', '.'];\nconst rootStyles = {position: 'absolute'} as CSSProperties;\nconst nbspStyles = {\n  height: 1,\n  width: 1,\n} as CSSProperties;\n\nexport function CycleEllipsis(props: CycleEllipsisProps) {\n  const {ariaLabel, intervalMs = 1000, fadeInProps} = props;\n  const fadeInPropsMerged = {...fadeInProps, inline: true};\n\n  const [upToIndex, setUpToIndex] = useState<number>(1);\n\n  useEffect(() => {\n    const intervalId = setInterval(\n      () => setUpToIndex((prevIndex) => (prevIndex + 1) % MESSAGES.length),\n      intervalMs\n    );\n\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [intervalMs]);\n\n  return (\n    <>\n      <span aria-label={ariaLabel} style={rootStyles}>\n        <span>{upToIndex >= 0 && MESSAGES[0]}</span>\n        <span>\n          {upToIndex >= 1 && (\n            <FadeIn {...fadeInPropsMerged}>{MESSAGES[1]}</FadeIn>\n          )}\n        </span>\n        <span>\n          {upToIndex >= 2 && (\n            <FadeIn {...fadeInPropsMerged}>{MESSAGES[2]}</FadeIn>\n          )}\n        </span>\n        <span>\n          {upToIndex >= 3 && (\n            <FadeIn {...fadeInPropsMerged}>{MESSAGES[3]}</FadeIn>\n          )}\n        </span>\n      </span>\n      {/* @note Keep as it's an alignment fallback in certain CSS situations when no other text is a sibiling */}\n      <span style={nbspStyles}>&nbsp;</span>\n    </>\n  );\n}\n","import {useState, useRef, useEffect} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {\n  prepareVoteProposalData,\n  SnapshotType,\n} from '@openlaw/snapshot-js-erc712';\nimport {getContractByAddress} from '../web3/helpers';\nimport {ProposalData} from './types';\nimport {StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../web3/config';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {useCheckApplicant, useSignAndSubmitProposal} from './hooks';\nimport {Web3TxStatus} from '../web3/types';\nimport CycleMessage from '../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../web3/EtherscanURL';\nimport FadeIn from '../common/FadeIn';\nimport Loader from '../feedback/Loader';\nimport {AsyncStatus} from '../../util/types';\n\ntype SubmitArguments = [\n  string, // `dao`\n  string, // `proposalId`\n  ...any[],\n  string // `proposal data`\n];\n\ntype SubmitActionProps = {\n  checkApplicant?: string;\n  proposal: ProposalData;\n};\n\ntype ActionDisabledReasons = {\n  invalidApplicantMessage: string;\n};\n\nexport default function SubmitAction(props: SubmitActionProps) {\n  const {\n    checkApplicant,\n    proposal: {snapshotDraft, refetchProposalOrDraft},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    invalidApplicantMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const contracts = useSelector((s: StoreState) => s.contracts);\n  const daoRegistryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled();\n\n  const {proposalSignAndSendStatus, signAndSendProposal} =\n    useSignAndSubmitProposal<SnapshotType.proposal>();\n\n  const {fast: fastGasPrice} = useETHGasPrice();\n\n  const {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  } = useCheckApplicant(checkApplicant);\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING ||\n    proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === Web3TxStatus.PENDING;\n\n  const isDone =\n    txStatus === Web3TxStatus.FULFILLED &&\n    proposalSignAndSendStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (checkApplicant) {\n      // 1. Determine and set reasons why action would be disabled\n\n      // Reason: If the applicant address is invalid (see `useCheckApplicant`\n      // hook for reasons) the `submitProposal` smart contract transaction will\n      // fail.\n      if (checkApplicantError) {\n        console.warn(\n          `Error checking if the applicant address is valid: ${checkApplicantError.message}`\n        );\n      }\n\n      if (\n        checkApplicantStatus === AsyncStatus.FULFILLED &&\n        !isApplicantValid &&\n        checkApplicantInvalidMsg\n      ) {\n        actionDisabledReasonsRef.current = {\n          ...actionDisabledReasonsRef.current,\n          invalidApplicantMessage: checkApplicantInvalidMsg,\n        };\n      }\n\n      // 2. Set reasons\n      setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n    }\n  }, [\n    checkApplicant,\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n    setOtherDisabledReasons,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryAddress) {\n        throw new Error('No DAO Registry address was found.');\n      }\n\n      if (!snapshotDraft) {\n        throw new Error('No Snapshot draft was found.');\n      }\n\n      const contract = getContractByAddress(snapshotDraft.actionId, contracts);\n\n      const {\n        msg: {\n          payload: {name, body, metadata},\n          timestamp,\n        },\n      } = snapshotDraft;\n\n      // Sign and submit draft for snapshot-hub\n      const {data, signature} = await signAndSendProposal({\n        partialProposalData: {\n          name,\n          body,\n          metadata,\n          timestamp,\n        },\n        adapterAddress: contract.contractAddress,\n        type: SnapshotType.proposal,\n      });\n\n      /**\n       * Prepare `data` argument for submission to DAO\n       *\n       * For information about which data the smart contract needs for signature verification (e.g. `hashMessage`):\n       * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting/OffchainVoting.sol\n       */\n      const preparedVoteVerificationBytes = prepareVoteProposalData(\n        {\n          payload: {\n            name: data.payload.name,\n            body: data.payload.body,\n            choices: data.payload.choices,\n            snapshot: data.payload.snapshot.toString(),\n            start: data.payload.start,\n            end: data.payload.end,\n          },\n          sig: signature,\n          space: data.space,\n          timestamp: parseInt(data.timestamp),\n        },\n        web3Instance\n      );\n\n      const submitArguments: SubmitArguments = [\n        daoRegistryAddress,\n        snapshotDraft.idInDAO,\n        ...(metadata.submitActionArgs || []),\n        preparedVoteVerificationBytes,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      await txSend(\n        'submitProposal',\n        contract.instance.methods,\n        submitArguments,\n        txArguments\n      );\n\n      // Update the proposal\n      refetchProposalOrDraft();\n    } catch (error) {\n      setSubmitError(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  function renderSubmitStatus(): React.ReactNode {\n    // Either Snapshot or chain tx\n    if (\n      txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n      proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM\n    ) {\n      return 'Awaiting your confirmation\\u2026';\n    }\n\n    // Only for chain tx\n    switch (txStatus) {\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Proposal submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={isDisabled || isInProcessOrDone}\n          onClick={isDisabled || isInProcessOrDone ? () => {} : handleSubmit}>\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Sponsor'}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is sponsoring disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is sponsoring disabled?\" />\n    </>\n  );\n}\n","import {createContext, useEffect, useRef, useState} from 'react';\nimport Web3 from 'web3';\nimport Web3Modal from 'web3modal';\n\nimport useWeb3ModalManager, {\n  DefaultTheme,\n  Web3ModalError,\n} from './hooks/useWeb3ModalManager';\nimport {AsyncStatus} from '../../util/types';\nimport {ETHEREUM_PROVIDER_URL} from '../../config';\n\ntype Web3ModalProviderArguments = {\n  defaultChain?: number;\n  defaultTheme?: DefaultTheme;\n  /**\n   * Optional: Any action to take after disconnecting from an Ethereum provider.\n   */\n  onBeforeDisconnect?: Parameters<\n    typeof useWeb3ModalManager\n  >[0]['onBeforeDisconnect'];\n  /**\n   * Optional: Any action to take before connecting to an Ethereum provider.\n   */\n  onBeforeConnect?: Parameters<\n    typeof useWeb3ModalManager\n  >[0]['onBeforeConnect'];\n  providerOptions: Record<string, any>; // required\n};\n\ntype Web3ModalManagerProps = {\n  children: JSX.Element;\n} & Web3ModalProviderArguments;\n\nexport type Web3ModalContextValue = {\n  account: string | undefined;\n  connected: boolean | undefined;\n  connectWeb3Modal: (providerName: string) => void;\n  disconnectWeb3Modal: () => void;\n  error: Web3ModalError | undefined;\n  initialCachedConnectorCheckStatus: AsyncStatus | undefined;\n  networkId: number | undefined;\n  provider: any;\n  providerOptions: Record<string, any>;\n  web3Instance: Web3 | undefined;\n  web3Modal: Web3Modal | undefined;\n};\n\nexport const Web3ModalContext = createContext<Web3ModalContextValue>(\n  {} as Web3ModalContextValue\n);\n\n/**\n * Web3ModalManager\n *\n * A provider for the `web3modal` wallet connection, provides access to\n * the wallet states, enables connections and disconnections.\n *\n * @example\n * <Web3ModalManager defaultChain={1} defaultTheme={'dark'} providerOptions={...}>\n *   ...\n * </Web3ModalManager>\n *\n * @param children: React.JSX\n * @param defaultChain?: number\n * @param defaultTheme?: DefaultTheme; default is `dark`\n * @param providerOptions: Record<string, any>\n */\n\nexport default function Web3ModalManager({\n  children,\n  defaultChain,\n  defaultTheme = DefaultTheme.DARK,\n  onBeforeConnect,\n  onBeforeDisconnect,\n  providerOptions,\n}: Web3ModalManagerProps) {\n  /**\n   * Refs\n   */\n\n  const defaultWeb3InstanceRef = useRef<Web3 | undefined>(\n    new Web3(new Web3.providers.WebsocketProvider(ETHEREUM_PROVIDER_URL))\n  );\n\n  /**\n   * State\n   */\n\n  const [defaultWeb3NetID, setDefaultWeb3NetID] = useState<\n    number | undefined\n  >();\n\n  /**\n   * Variables\n   */\n\n  const web3ModalProviderArguments: Web3ModalProviderArguments = {\n    defaultChain,\n    defaultTheme,\n    onBeforeConnect,\n    onBeforeDisconnect,\n    providerOptions,\n  };\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    account,\n    connected,\n    connectWeb3Modal,\n    disconnectWeb3Modal,\n    error,\n    initialCachedConnectorCheckStatus,\n    networkId = defaultWeb3NetID,\n    provider = defaultWeb3InstanceRef.current?.currentProvider,\n    web3Instance = defaultWeb3InstanceRef.current,\n    web3Modal,\n  } = useWeb3ModalManager(web3ModalProviderArguments);\n\n  /**\n   * Effects\n   */\n\n  // Set network ID when using `defaultWeb3InstanceRef` (i.e. not connected to a wallet)\n  useEffect(() => {\n    if (\n      !connected &&\n      initialCachedConnectorCheckStatus === AsyncStatus.FULFILLED\n    ) {\n      defaultWeb3InstanceRef.current?.eth.net\n        .getId()\n        .then(setDefaultWeb3NetID)\n        .catch(() => setDefaultWeb3NetID(undefined));\n    }\n  }, [connected, initialCachedConnectorCheckStatus]);\n\n  /**\n   * Render\n   */\n\n  const web3ModalContext: Web3ModalContextValue = {\n    account,\n    connected,\n    connectWeb3Modal,\n    disconnectWeb3Modal,\n    error,\n    initialCachedConnectorCheckStatus,\n    networkId,\n    provider,\n    providerOptions,\n    web3Instance,\n    web3Modal,\n  };\n\n  return (\n    <Web3ModalContext.Provider value={web3ModalContext}>\n      {children}\n    </Web3ModalContext.Provider>\n  );\n}\n","// see: http://reactcommunity.org/react-transition-group/transition\nimport React from 'react';\nimport {Transition} from 'react-transition-group';\n\ntype FadeInProps = {\n  children?: React.ReactNode;\n  duration?: number;\n  /**\n   * Defaults to `true`\n   */\n  show?: boolean;\n  /**\n   * Renders a `<span>` wrapper where the animation CSS is applied.\n   */\n  inline?: boolean;\n};\n\nconst DEFAULT_DURATION = 300;\n\nconst defaultStyle = (props: FadeInProps) => ({\n  transition: `opacity ${\n    props.duration || 300\n  }ms cubic-bezier(0, 0.69, 0.32, 0.64)`,\n  opacity: 0,\n});\n\nconst transitionStyles: Record<string, any> = {\n  entering: {opacity: 0},\n  entered: {opacity: 1},\n  exiting: {opacity: 0},\n  exited: {opacity: 0},\n};\n\nexport default function FadeIn(props: FadeInProps) {\n  const {inline} = props;\n\n  return (\n    <Transition\n      appear\n      in={props.show !== undefined ? props.show : true}\n      timeout={props.duration || DEFAULT_DURATION}>\n      {(transition) =>\n        inline ? (\n          <span\n            style={{\n              ...defaultStyle(props),\n              ...transitionStyles[transition],\n            }}>\n            {props.children}\n          </span>\n        ) : (\n          <div\n            style={{\n              ...defaultStyle(props),\n              ...transitionStyles[transition],\n            }}>\n            {props.children}\n          </div>\n        )\n      }\n    </Transition>\n  );\n}\n","import {useState} from 'react';\n\nimport {MetaMaskRPCError} from '../../util/types';\nimport {normalizeString} from '../../util/helpers';\nimport FadeIn from './FadeIn';\n\ntype ErrorMessageWithDetailsProps = {\n  detailsProps?: React.DetailsHTMLAttributes<HTMLDetailsElement>;\n  error: Error | (() => React.ReactElement) | undefined;\n  renderText: (() => React.ReactElement) | string;\n};\n\nexport default function ErrorMessageWithDetails(\n  props: ErrorMessageWithDetailsProps\n) {\n  const {error, renderText} = props;\n\n  /**\n   * State\n   */\n\n  const [isExpanded, setIsExpanded] = useState<boolean>(false);\n\n  /**\n   * Variables\n   */\n\n  /**\n   * Some wallets will provide proper error codes. The `4001` is a \"user rejected transaction\".\n   *\n   * @link https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1193.md#provider-errors\n   */\n  const isWalletRejectedRequest =\n    typeof error !== 'function' &&\n    ((error as MetaMaskRPCError)?.code === 4001 ||\n      /^(the )?user rejected (the )?request$/g.test(\n        normalizeString(error?.message || '')\n      ));\n\n  const textToDisplay: React.ReactNode =\n    typeof renderText === 'string' ? renderText : renderText();\n\n  const areErrorMessageAndTextStringSame: boolean =\n    typeof renderText === 'string' &&\n    typeof error !== 'function' &&\n    normalizeString(renderText) === normalizeString(error?.message || '')\n      ? true\n      : false;\n\n  /**\n   * Render\n   */\n\n  if (!error || isWalletRejectedRequest) return null;\n\n  return (\n    <FadeIn>\n      <div className=\"text-center\">\n        <p className=\"error-message\">{textToDisplay}</p>\n\n        {error && !areErrorMessageAndTextStringSame && (\n          <details {...props.detailsProps}>\n            <summary\n              aria-expanded={isExpanded}\n              className=\"error-message\"\n              onClick={() => setIsExpanded(!isExpanded)}\n              style={{cursor: 'pointer', outline: 'none'}}>\n              <small>Details</small>\n            </summary>\n\n            <p className=\"error-message\">\n              <small>\n                {typeof error === 'function' ? error() : error.message}\n              </small>\n            </p>\n          </details>\n        )}\n      </div>\n    </FadeIn>\n  );\n}\n","import {Contract, SendOptions} from 'web3-eth-contract/types';\nimport {TransactionReceipt} from 'web3-core/types';\nimport BigNumber from 'bignumber.js';\n\n/**\n * contractSend\n *\n * Returns the resolved transaction receipt or error\n *\n * @param {string} methodName\n * @param {Record<string, any>} contractInstanceMethods An object of the methods for the Web3 contract instance.\n * @param {any[]} methodArguments An array of any arguments for the contract's method.\n * @param {Record<string, any>} txArguments\n * @param {(txHash: string) => void} onProcess Callback which runs after a txHash has been received,\n *   but before the transaction is complete.\n * @returns {Promise<TransactionReceipt>} Resolved or rejected transaction.\n */\nexport async function contractSend(\n  methodName: string,\n  contractInstanceMethods: typeof Contract.prototype.methods,\n  methodArguments: any[],\n  txArguments: SendOptions,\n  onProcess?: (txHash: string) => void\n): Promise<TransactionReceipt> {\n  // Promisify so we can both `reject()` inside .on('error') and from transactions.\n  return new Promise<TransactionReceipt>(async (resolve, reject) => {\n    try {\n      const BN = BigNumber;\n      const method = contractInstanceMethods[methodName];\n\n      // estimate gas limit for transaction\n      const gas = await method(...methodArguments).estimateGas({\n        from: txArguments.from,\n        value: txArguments.value,\n      });\n\n      const gastoBN = new BN(gas)\n        .decimalPlaces(0, BigNumber.ROUND_DOWN)\n        .toNumber();\n\n      await method(...methodArguments)\n        .send({\n          ...txArguments,\n          gas: gastoBN,\n        })\n        .on('transactionHash', function (txHash: string) {\n          // Call onProcess with transaction hash\n          onProcess && onProcess(txHash);\n        })\n        .on('receipt', function (receipt: TransactionReceipt) {\n          // resolve on transaction receipt; contains event returnValues\n          resolve(receipt);\n        })\n        .on('error', (error: Error) => {\n          // reject on transaction error\n          reject(error);\n        });\n    } catch (error) {\n      // reject on estimate gas or transaction error\n      reject(error);\n    }\n  });\n}\n","import Web3 from 'web3';\n\nimport {ContractsStateEntry} from '../../../store/contracts/types';\nimport {ContractAdapterNames} from '../types';\n\nexport async function getAdapterAddress(\n  adapterName: ContractAdapterNames,\n  daoContractInstance: ContractsStateEntry['instance'] | undefined\n): Promise<string> {\n  try {\n    if (!daoContractInstance) {\n      throw new Error('No DaoRegistry contract instance provided.');\n    }\n\n    return await daoContractInstance.methods\n      .getAdapterAddress(Web3.utils.sha3(adapterName))\n      .call();\n  } catch (error) {\n    throw error;\n  }\n}\n","import {ContractAdapterNames} from '../types';\nimport {ContractsStateEntry} from '../../../store/contracts/types';\nimport {StoreState} from '../../../store/types';\n\nfunction getContractAddressOrThrow(\n  contract: ContractsStateEntry | null\n): string {\n  try {\n    const address = contract?.contractAddress;\n\n    if (!address) {\n      throw new Error(`Contract address was not found in the store.`);\n    }\n\n    return address;\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * getAdapterAddressFromContracts\n *\n * Gets an adapter's address by its name (`type ContractAdapterNames`) from the Redux contracts state slice.\n *\n * @param {string} name\n * @param {StoreState['contracts']} contracts\n */\nexport function getAdapterAddressFromContracts(\n  name: ContractAdapterNames,\n  contracts: StoreState['contracts']\n): string {\n  try {\n    switch (name) {\n      case ContractAdapterNames.configuration:\n        return '';\n      case ContractAdapterNames.distribute:\n        return getContractAddressOrThrow(contracts.DistributeContract);\n      case ContractAdapterNames.financing:\n        return '';\n      case ContractAdapterNames.guildkick:\n        return '';\n      case ContractAdapterNames.managing:\n        return getContractAddressOrThrow(contracts.ManagingContract);\n      case ContractAdapterNames.onboarding:\n        return getContractAddressOrThrow(contracts.OnboardingContract);\n      case ContractAdapterNames.ragequit:\n        return '';\n      case ContractAdapterNames.tribute:\n        return getContractAddressOrThrow(contracts.TributeContract);\n      case ContractAdapterNames.tribute_nft:\n        return getContractAddressOrThrow(contracts.TributeNFTContract);\n      case ContractAdapterNames.voting:\n        return getContractAddressOrThrow(contracts.VotingContract);\n      default:\n        throw new Error(`Contract address was not found in the store.`);\n    }\n  } catch (error) {\n    throw error;\n  }\n}\n","import {ContractsStateEntry} from '../../../store/contracts/types';\n\nexport enum DaoState {\n  CREATION = 'CREATION',\n  READY = 'READY',\n}\n\nexport async function getDaoState(\n  daoContractInstance: ContractsStateEntry['instance'] | undefined\n): Promise<DaoState> {\n  try {\n    if (!daoContractInstance) {\n      throw new Error('No DaoRegistry contract instance provided.');\n    }\n\n    const daoRegistryMethods = daoContractInstance.methods;\n    const state = await daoRegistryMethods.state().call();\n\n    return Number(state) === 0 ? DaoState.CREATION : DaoState.READY;\n  } catch (error) {\n    throw error;\n  }\n}\n","import {ContractsStateEntry} from '../../../store/contracts/types';\nimport {normalizeString} from '../../../util/helpers';\nimport {StoreState} from '../../../store/types';\n\n/**\n * getContractByAddress\n *\n * Gets a Contract from the Redux contracts state slice by its `contractAddress`, or throws an Error.\n * A use case for this would be when using ERC712 signing data `actionId` to get\n * the appropriate Contract for submitting on-chain transactions.\n *\n * @param {string} address\n * @param {StoreState['contracts']} contracts\n */\nexport function getContractByAddress(\n  address: string,\n  contracts: StoreState['contracts']\n): ContractsStateEntry {\n  try {\n    const contract = Object.values(contracts).find(\n      (c) =>\n        c?.contractAddress &&\n        normalizeString(c.contractAddress) === normalizeString(address)\n    );\n\n    if (!contract) {\n      throw new Error(`Contract was not found in the store.`);\n    }\n\n    return contract;\n  } catch (error) {\n    throw error;\n  }\n}\n","import Web3 from 'web3';\n\nimport {ContractsStateEntry} from '../../../store/contracts/types';\nimport {ContractDAOConfigKeys} from '../types';\n\nexport async function getDAOConfigEntry(\n  configKey: ContractDAOConfigKeys,\n  daoContractInstance: ContractsStateEntry['instance'] | undefined\n): Promise<string> {\n  try {\n    if (!daoContractInstance) {\n      throw new Error('No DaoRegistry contract instance provided.');\n    }\n\n    return await daoContractInstance.methods\n      .getConfiguration(Web3.utils.sha3(configKey))\n      .call();\n  } catch (error) {\n    throw error;\n  }\n}\n","import {AbiItem} from 'web3-utils/types';\nimport {VotingAdapterName} from '../../adapters-extensions/enums';\nimport Web3 from 'web3';\n\nexport async function getVotingAdapterName(\n  address: string,\n  web3Instance: Web3\n): Promise<VotingAdapterName> {\n  try {\n    const {default: lazyIVotingABI} = await import(\n      '../../../truffle-contracts/IVoting.json'\n    );\n\n    return await new web3Instance.eth.Contract(\n      lazyIVotingABI as AbiItem[],\n      address\n    ).methods\n      .getAdapterName()\n      .call();\n  } catch (error) {\n    throw error;\n  }\n}\n","import {MemberFlag} from '../types';\nimport {ProposalFlag} from '../../proposals/types';\n\n/**\n * hasFlag\n *\n * A quicker alternative than calling `getProposalFlag` or `getMemberFlag` using `Multicall` for every possiblity.\n *\n * @todo Though this is faster, we may want to switch to using the contract and Multicall instead of re-creating the logic.\n *\n * @param flagToCheck\n * @param daoProposalFlag\n * @returns {boolean}\n *\n * @see `ProposalFlag` `DaoRegistry.sol`\n * @see `getFlag` `DaoConstants.sol`\n * @see `setFlag` `DaoConstants.sol`\n */\nexport function hasFlag(\n  flagToCheck: ProposalFlag | MemberFlag,\n  daoProposalFlag: number | string\n): boolean {\n  return flagToCheck === Math.log2(Number(daoProposalFlag) + 1) - 1;\n}\n","import Web3 from 'web3';\nimport {AbiItem} from 'web3-utils/types';\n\nimport {MULTICALL_CONTRACT_ADDRESS} from '../../../config';\n\nexport type MulticallTuple = [\n  contractAddress: string,\n  functionABI: AbiItem,\n  parameters: string[]\n];\n\nexport async function multicall({\n  blockNumber = 'latest',\n  calls,\n  web3Instance,\n}: {\n  /**\n   * Defaults to `latest`\n   */\n  blockNumber?: number | string | ReturnType<typeof Web3.utils.toBN>;\n  calls: MulticallTuple[];\n  web3Instance: Web3;\n}) {\n  const {default: lazyMulticallABI} = await import(\n    '../../../truffle-contracts/Multicall.json'\n  );\n\n  // Let's `console.error` and exit instead of throwing.\n  if (!MULTICALL_CONTRACT_ADDRESS) {\n    console.error('No Multicall address was found. Are you sure it is set?');\n    return;\n  }\n\n  try {\n    const {methods: multicallMethods} = new web3Instance.eth.Contract(\n      lazyMulticallABI as AbiItem[],\n      MULTICALL_CONTRACT_ADDRESS\n    );\n\n    const {returnData} = await multicallMethods\n      .aggregate(\n        calls.map(([address, abi, params]) => [\n          address.toLowerCase(),\n          web3Instance.eth.abi.encodeFunctionCall(abi, params),\n        ])\n      )\n      .call({}, blockNumber);\n\n    return returnData.map((hexString: string, i: number) => {\n      const outputsABIItem = calls[i][1].outputs || [];\n      const decodedOutputs = web3Instance.eth.abi.decodeParameters(\n        outputsABIItem,\n        hexString\n      );\n\n      // Output as single result\n      if (\n        decodedOutputs.__length__ === 1 &&\n        decodedOutputs['0'] !== undefined\n      ) {\n        return decodedOutputs['0'];\n      }\n\n      return web3Instance.eth.abi.decodeParameters(\n        outputsABIItem || [],\n        hexString\n      );\n    });\n  } catch (error) {\n    throw error;\n  }\n}\n","/**\n * FOR HIGH REUSE ENUMS\n *\n * For any other more specific enum types, co-locate them in either:\n *\n * 1) The actual code file.\n * 2) In a type file in the location of the code files which mainly use the types.\n *\n * @see https://kentcdodds.com/blog/colocation\n */\n\n/**\n * @see https://chainid.network/\n */\nexport enum NetworkIDs {\n  GOERLI = 5,\n  KOVAN = 42,\n  RINKEBY = 4,\n  ROPSTEN = 3,\n  MAINNET = 1,\n}\n\n/**\n * @see https://chainid.network/\n */\nexport enum NetworkNames {\n  GOERLI = 'goerli',\n  KOVAN = 'kovan',\n  RINKEBY = 'rinkeby',\n  ROPSTEN = 'ropsten',\n  MAINNET = 'mainnet',\n}\n\nexport enum FormFieldErrors {\n  REQUIRED = 'This field is required.',\n  INVALID_BYTES32 = 'The value is not a bytes32.',\n  INVALID_BYTES32_ARRAY = 'The value is not a comma-separated bytes32 format, ie. 0x...,0x...',\n  INVALID_EMAIL = 'The email address is invalid.',\n  INVALID_ETHEREUM_ADDRESS = 'The ethereum address is invalid.',\n  INVALID_NUMBER = 'The value is not a number.',\n  INVALID_NUMBER_ARRAY = 'The value is not a comma-separated number format, ie. 42,5,124',\n}\n\nexport enum ProposalHeaderNames {\n  FAILED = 'Failed',\n  PASSED = 'Passed',\n  REQUESTS = 'Proposals',\n  VOTING = 'Voting',\n}\n","import {\n  SnapshotDraftData,\n  SnapshotProposalData,\n  SnapshotDraftResponseData,\n  SnapshotProposalResponseData,\n  SnapshotType,\n  VoteChoices,\n} from '@openlaw/snapshot-js-erc712';\nimport {AbiItem} from 'web3-utils/types';\nimport {Contract} from 'web3-eth-contract/types';\n\nimport {VotingAdapterName} from '../adapters-extensions/enums';\nimport {VotingState} from './voting/types';\nimport {ContractAdapterNames} from '../web3/types';\n\n/**\n * ENUMS\n */\n\n/**\n * Mapping of DaoRegistry proposal flags.\n * This should match the enum (including order) in the `DaoRegistry`. If it does not match,\n * the results of checking the proposal's state via flag will be wrong.\n *\n * @see `ProposalFlag` `DaoRegistry.sol`\n * @see `getFlag` `DaoConstants.sol`\n * @see `setFlag` `DaoConstants.sol`\n */\nexport enum ProposalFlag {\n  EXISTS,\n  SPONSORED,\n  PROCESSED,\n}\n\n// @todo Need more information about the vote challenge flow.\nexport enum ProposalFlowStatus {\n  Submit = 'Submit',\n  Sponsor = 'Sponsor',\n  OffchainVoting = 'OffchainVoting',\n  OffchainVotingSubmitResult = 'OffchainVotingSubmitResult',\n  OffchainVotingGracePeriod = 'OffchainVotingGracePeriod',\n  OnchainVoting = 'OnchainVoting',\n  Process = 'Process',\n  Completed = 'Completed',\n}\n\n/**\n * @see `Distribute.sol` in tribute-contracts\n */\nexport enum DistributionStatus {\n  NOT_STARTED,\n  IN_PROGRESS,\n  DONE,\n  FAILED,\n}\n\n/**\n * This is an internal type we use for sending to Snapshot Hub via\n * `metadata: {}` to indicate the proposal is only meant for xyz.\n *\n * @note Only set the `metadata.type` in the case where the proposal's usage\n * cannot be determined by the `actionId` (adapter address) alone.\n */\nexport enum SnapshotMetadataType {\n  Governance = 'Governance',\n}\n\n/**\n * TYPES\n */\n\nexport type Proposal = {\n  adapterAddress: string;\n  flags: string; // unint256 of Proposal's current flag\n};\n\n// Arguments for an optional render prop for `<ProposalActions />` and its child action wrapping components.\nexport type RenderActionPropArguments = {\n  [VotingAdapterName.OffchainVotingContract]: {\n    adapterName: ContractAdapterNames;\n    // An enum name (`string`) of the DAO proposal's `VotingState` index\n    daoProposalVoteResult: typeof VotingState[any] | undefined;\n    daoProposalVotes: OffchainVotingAdapterVotes | undefined;\n    gracePeriodStartMs: number;\n    proposal: ProposalData;\n    status: ProposalFlowStatus | undefined;\n  };\n};\n\n// @todo Change the type to be precise\nexport type SubgraphProposal = Record<string, any>;\n\n/**\n * We augment the response data to add a few helpful data pieces.\n */\nexport type SnapshotDraft = {\n  /**\n   * The ID used to reference the DAO.\n   */\n  idInDAO: string;\n  /**\n   * An ID helper to reference the Draft hash\n   */\n  idInSnapshot: string;\n} & SnapshotDraftResponseData;\n\n/**\n * We augment the response data to add a few helpful data pieces.\n */\nexport type SnapshotProposal = {\n  /**\n   * The ID used to reference the DAO.\n   */\n  idInDAO: string;\n  /**\n   * An ID helper to reference the Proposal hash\n   */\n  idInSnapshot: string;\n} & SnapshotProposalResponseData;\n\n/**\n * Common data shared between a Snapshot Drafts and Proposals.\n * Helpful when we need to display information which is accessible on both.\n */\nexport type SnapshotProposalCommon = SnapshotDraft | SnapshotProposal;\n\nexport type ProposalData = {\n  // @todo Make non-nullable?\n  idInDAO?: string;\n  // @todo Make non-nullable?\n  daoProposalVotingAdapter?: ProposalVotingAdapterData;\n  // @todo Make non-nullable?\n  daoProposalVotes?: ProposalVotesData;\n  // @todo Make non-nullable?\n  daoProposalVotingState?: VotingState;\n  daoProposal: Proposal | undefined;\n  /**\n   * Data for either a Draft or Proposal which is shared between the two types.\n   */\n  getCommonSnapshotProposalData: () => SnapshotProposalCommon | undefined;\n  refetchProposalOrDraft: () => void;\n  snapshotDraft: SnapshotDraft | undefined;\n  snapshotProposal: SnapshotProposal | undefined;\n  snapshotType: ProposalOrDraftSnapshotType | undefined;\n};\n\n/**\n * A conditional helper type for determining which data shape to use.\n *\n * @link https://www.typescriptlang.org/docs/handbook/2/conditional-types.html\n */\nexport type ProposalOrDraftSnapshotData =\n  | SnapshotDraftResponseData\n  | SnapshotProposalResponseData;\n\nexport type ProposalOrDraftSnapshotType =\n  | SnapshotType.proposal\n  | SnapshotType.draft;\n\n/**\n * A conditional helper type for determining which data shape to use based on the `ProposalOrDraftSnapshotType`.\n *\n * @link https://www.typescriptlang.org/docs/handbook/2/conditional-types.html\n */\nexport type ProposalOrDraftSignDataFromType<\n  T extends ProposalOrDraftSnapshotType\n> = T extends SnapshotType.proposal ? SnapshotProposalData : SnapshotDraftData;\n\n/**\n * Voting.sol->Voting\n *\n * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting/Voting.sol\n */\nexport type VotingAdapterVotes = {\n  blockNumber: string;\n  nbNo: string;\n  nbYes: string;\n  startingTime: string;\n};\n\n/**\n * OffchainVoting.sol->Voting\n *\n * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting/OffchainVoting.sol\n */\nexport type OffchainVotingAdapterVotes = {\n  fallbackVotesCount: string;\n  forceFailed: boolean;\n  gracePeriodStartingTime: string;\n  index: string;\n  isChallenged: boolean;\n  nbNo: string;\n  nbYes: string;\n  reporter: string;\n  resultRoot: string;\n  snapshot: string;\n  startingTime: string;\n};\n\n/**\n * VotingResult\n *\n * A custom result we build to deliver to components.\n * It should accommodate all types of yes/no voting (i.e. on-chain, off-chain).\n */\n\nexport type VoteChoiceResult = {\n  percentage: number;\n  units: number;\n};\n\nexport type VotingResult = {\n  [VoteChoices.Yes]: VoteChoiceResult;\n  [VoteChoices.No]: VoteChoiceResult;\n  totalUnits: number;\n};\n\n/**\n * Proposal's voting adapter data\n */\nexport type ProposalVotingAdapterData = {\n  votingAdapterName: VotingAdapterName;\n  votingAdapterAddress: string;\n  /**\n   * Get the ABI for the proposal.\n   * The object is not included inline to\n   * save from repetitive data (some ABIs can be large).\n   */\n  getVotingAdapterABI: () => AbiItem[];\n  // Helper to use the Web3 Contract directly\n  getWeb3VotingAdapterContract: () => Contract;\n};\n\nexport type ProposalVotingAdapterTuple = [\n  proposalId: string,\n  votingAdapterData: ProposalVotingAdapterData\n];\n\n/**\n * Proposal on-chain votes data\n *\n * @see `useProposalsVotes`\n */\nexport type ProposalVotesData = {\n  [VotingAdapterName.OffchainVotingContract]?: OffchainVotingAdapterVotes;\n  [VotingAdapterName.VotingContract]?: VotingAdapterVotes;\n};\n","import {useState, useEffect, useRef} from 'react';\n\ntype UseAbortControllerReturn = {\n  abortController: AbortController | undefined;\n  isMountedRef: React.MutableRefObject<boolean>;\n};\n\n/**\n * useAbortController\n *\n * Provides an `AbortController` to cancel requests.\n * Also provides a helper `isMountedRef` to see if the React component has\n * been unmounted and therefore should not run any setting of state.\n */\nexport function useAbortController(): UseAbortControllerReturn {\n  /**\n   * State\n   */\n\n  const [abortController, setAbortController] = useState<AbortController>();\n\n  /**\n   * Refs\n   */\n\n  const isMountedRef = useRef<boolean>(false);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    isMountedRef.current = true;\n\n    !abortController && setAbortController(new AbortController());\n\n    return () => {\n      isMountedRef.current = false;\n\n      abortController && abortController.abort();\n    };\n  }, [abortController]);\n\n  return {\n    abortController,\n    isMountedRef,\n  };\n}\n","import {useReducer} from 'react';\n\ntype CounterState = {\n  count: number;\n};\n\ntype CounterAction = {\n  type: 'increment';\n};\n\ntype CounterReturn = [number, React.Dispatch<CounterAction>];\n\nconst initialState = {count: 0};\n\nfunction reducer(state: CounterState, action: CounterAction) {\n  switch (action.type) {\n    case 'increment':\n      return {count: state.count + 1};\n    default:\n      return state;\n  }\n}\n\n/**\n * useCounter\n *\n * A counter which is kept track of via a reducer.\n *\n * @note This is mainly to use inside a custom hook's callback resulting in a\n *  changed dependency for consumer's useEffect when a consumer higher up wants to trigger a \"re-run\"\n *  (i.e. re-fetch, refresh some data), similarly to dispatching a Redux action again to update the state.\n */\nexport function useCounter(): CounterReturn {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  return [state.count, dispatch];\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useLazyQuery} from '@apollo/react-hooks';\n\nimport {StoreState} from '../store/types';\nimport {useSelector} from 'react-redux';\n\nimport {GET_DAO} from '../gql';\n\ntype UseDaoReturn = {\n  dao: Record<string, any> | undefined;\n  gqlError: Error | undefined;\n};\n\n/**\n * useDao\n *\n * This component queries The Graph API to get data on the dao\n *\n * @returns {UseDaoReturn}\n */\nexport function useDao(): UseDaoReturn {\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  const [getDao, {called, loading, data, error}] = useLazyQuery(GET_DAO, {\n    variables: {id: daoRegistryContract?.contractAddress.toLowerCase()},\n  });\n\n  const [dao, setDao] = useState<Record<string, any> | undefined>();\n  const [gqlError, setGqlError] = useState<Error>();\n\n  const getDaoRegistryCallback = useCallback(getDaoRegistry, [\n    daoRegistryContract?.contractAddress,\n    data,\n    error,\n    loading,\n  ]);\n\n  useEffect(() => {\n    if (!called) {\n      getDao();\n    }\n  }, [called, getDao]);\n\n  useEffect(() => {\n    if (!loading && daoRegistryContract?.contractAddress) {\n      getDaoRegistryCallback();\n    }\n  }, [daoRegistryContract?.contractAddress, getDaoRegistryCallback, loading]);\n\n  function getDaoRegistry() {\n    try {\n      if (!loading && data) {\n        setDao(data.tributeDaos[0]);\n\n        if (data.tributeDaos.length === 0) {\n          const error = new Error(\n            `\"${daoRegistryContract?.contractAddress}\" dao address not found.`\n          );\n\n          throw error;\n        }\n      } else {\n        if (error) {\n          const error = new Error(\n            `\"${daoRegistryContract?.contractAddress}\" is not a valid dao address.`\n          );\n\n          throw error;\n        }\n      }\n    } catch (error) {\n      setGqlError(error);\n    }\n  }\n\n  return {dao, gqlError};\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useLazyQuery} from '@apollo/react-hooks';\nimport {useSelector} from 'react-redux';\n\nimport {AsyncStatus} from '../util/types';\nimport {StoreState} from '../store/types';\nimport {SubgraphNetworkStatus} from '../store/subgraphNetworkStatus/types';\nimport {GET_DAO} from '../gql';\nimport {TOTAL_ADDRESS, UNITS_ADDRESS} from '../config';\n\ntype UseDaoTotalUnitsReturn = {\n  totalUnits: number | undefined;\n  totalUnitsError: Error | undefined;\n  totalUnitsStatus: AsyncStatus;\n};\n\n/**\n * useDaoTotalUnits\n *\n * Gets DAO total units from subgraph with direct onchain fallback.\n *\n * @returns {UseDaoTotalUnitsReturn}\n */\nexport function useDaoTotalUnits(): UseDaoTotalUnitsReturn {\n  /**\n   * Selectors\n   */\n\n  const DaoRegistryContract = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract\n  );\n  const BankExtensionContract = useSelector(\n    (state: StoreState) => state.contracts.BankExtensionContract\n  );\n  const subgraphNetworkStatus = useSelector(\n    (state: StoreState) => state.subgraphNetworkStatus.status\n  );\n\n  /**\n   * GQL Query\n   */\n\n  const [getDaoFromSubgraphResult, {called, loading, data, error}] =\n    useLazyQuery(GET_DAO, {\n      variables: {\n        id: DaoRegistryContract?.contractAddress.toLowerCase(),\n      },\n    });\n\n  /**\n   * State\n   */\n\n  const [totalUnits, setTotalUnits] = useState<number>();\n  const [totalUnitsStatus, setTotalUnitsStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n  const [totalUnitsError, setTotalUnitsError] = useState<Error>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const getTotalUnitsFromExtensionCached = useCallback(\n    getTotalUnitsFromExtension,\n    [BankExtensionContract]\n  );\n\n  const getTotalUnitsFromSubgraphCached = useCallback(\n    getTotalUnitsFromSubgraph,\n    [data, error, getTotalUnitsFromExtensionCached, loading]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!called) {\n      getDaoFromSubgraphResult();\n    }\n  }, [called, getDaoFromSubgraphResult]);\n\n  useEffect(() => {\n    if (subgraphNetworkStatus === SubgraphNetworkStatus.OK) {\n      if (!loading && DaoRegistryContract?.contractAddress) {\n        getTotalUnitsFromSubgraphCached();\n      }\n    } else {\n      // If there is a subgraph network error fallback to fetching totalUnits\n      // directly from smart contract\n      getTotalUnitsFromExtensionCached();\n    }\n  }, [\n    DaoRegistryContract?.contractAddress,\n    getTotalUnitsFromExtensionCached,\n    getTotalUnitsFromSubgraphCached,\n    loading,\n    subgraphNetworkStatus,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function getTotalUnitsFromSubgraph() {\n    try {\n      setTotalUnitsStatus(AsyncStatus.PENDING);\n\n      if (!loading && data) {\n        // extract totalUnits from gql data\n        const {totalUnits} = data.tributeDaos[0] as Record<string, any>;\n        setTotalUnits(Number(totalUnits));\n        setTotalUnitsStatus(AsyncStatus.FULFILLED);\n      } else {\n        if (error) {\n          throw new Error(error.message);\n        }\n      }\n    } catch (error) {\n      // If there is a subgraph query error fallback to fetching totalUnits\n      // directly from smart contract\n      console.log(`subgraph query error: ${error.message}`);\n      getTotalUnitsFromExtensionCached();\n    }\n  }\n\n  async function getTotalUnitsFromExtension() {\n    if (!BankExtensionContract) {\n      return;\n    }\n\n    try {\n      setTotalUnitsStatus(AsyncStatus.PENDING);\n\n      const totalUnits = await BankExtensionContract.instance.methods\n        .balanceOf(TOTAL_ADDRESS, UNITS_ADDRESS)\n        .call();\n\n      setTotalUnits(Number(totalUnits));\n      setTotalUnitsStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      console.log(error);\n      setTotalUnits(undefined);\n      setTotalUnitsError(error);\n      setTotalUnitsStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  return {totalUnits, totalUnitsError, totalUnitsStatus};\n}\n","import {useEffect, useRef} from 'react';\n\ntype UseIsMountedReturn = {\n  isMountedRef: React.MutableRefObject<boolean>;\n};\n\n/**\n * useIsMounted\n *\n * A hook that returns a React Ref which tells if the component is mounted, or not.\n * This is helpful when needing to stop state updates in hooks with effects.\n */\nexport function useIsMounted(): UseIsMountedReturn {\n  /**\n   * Refs\n   */\n\n  const isMountedRef = useRef<boolean>(false);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    isMountedRef.current = true;\n\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  return {\n    isMountedRef,\n  };\n}\n","import React, {useCallback, useState} from 'react';\nimport ReactModal from 'react-modal';\n\nimport {StoreState} from '../store/types';\nimport {useSelector} from 'react-redux';\nimport {useWeb3Modal} from '../components/web3/hooks';\nimport FadeIn from '../components/common/FadeIn';\nimport TimesSVG from '../assets/svg/TimesSVG';\n\n/**\n * Props should be cached somehow to prevent a new object\n * making the hook re-render each time the parent re-renders,\n * causing a continuous loop.\n */\ntype UseMemberActionDisabledProps = {\n  /**\n   * Allows the active member check to be skipped.\n   * e.g. A tx does not require the account to be a member.\n   */\n  skipIsActiveMemberCheck?: boolean;\n};\n\ntype UseMemberActionDisabledReturn = {\n  disabledReason: string;\n  isDisabled: boolean;\n  openWhyDisabledModal: () => void;\n  setOtherDisabledReasons: (r: string[]) => void;\n  WhyDisabledModal: (p: WhyDisabledModalProps) => JSX.Element | null;\n};\n\ntype WhyDisabledModalProps = {\n  title?: string;\n};\n\n/**\n * useMemberActionDisabled\n *\n * This component covers the most common cases for why a member action button should be disabled.\n * More reasons for disabling the button can be added via props using `setOtherDisabledReasons`.\n *\n * @param {ProposalActionWhyDisabledProps} props\n * @returns {UseMemberActionDisabledReturn}\n */\nexport function useMemberActionDisabled(\n  props?: UseMemberActionDisabledProps\n): UseMemberActionDisabledReturn {\n  const {skipIsActiveMemberCheck = false} = props || {};\n\n  /**\n   * State\n   */\n\n  const [otherDisabledReasons, setOtherDisabledReasons] = useState<string[]>(\n    []\n  );\n  const [shouldShowWhyModal, setShouldShowWhyModal] = useState<boolean>(false);\n\n  /**\n   * Selectors\n   */\n\n  const isActiveMember = useSelector(\n    (s: StoreState) => s.connectedMember?.isActiveMember\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {connected} = useWeb3Modal();\n\n  /**\n   * Variables\n   */\n\n  // Get the first index of other reasons.\n  const otherReasonNext =\n    otherDisabledReasons && otherDisabledReasons.find((r) => r);\n  const disabledReason = getDisabledReason();\n  const isDisabled =\n    (disabledReason ? true : false) || (otherReasonNext ? true : false);\n  const canShowDisabledReason = isDisabled && disabledReason ? true : false;\n\n  /**\n   * Cached callbacks\n   */\n\n  const WhyDisabledModalCached = useCallback(WhyDisabledModal, [\n    canShowDisabledReason,\n    disabledReason,\n    shouldShowWhyModal,\n  ]);\n\n  const handleSetOtherDisabledReasonsCached = useCallback(\n    handleSetOtherDisabledReasons,\n    []\n  );\n\n  /**\n   * Functions\n   */\n\n  function handleSetOtherDisabledReasons(otherReasons: string[]) {\n    setOtherDisabledReasons(otherReasons.filter(Boolean));\n  }\n\n  function getDisabledReason() {\n    if (!connected) {\n      return 'Your wallet is not connected.';\n    }\n\n    if (!isActiveMember && !skipIsActiveMemberCheck) {\n      return 'Either you are not a member, or your membership is not active.';\n    }\n\n    return otherReasonNext || '';\n  }\n\n  function handleOpenWhyDisabledModal() {\n    setShouldShowWhyModal(true);\n  }\n\n  function WhyDisabledModal(props: WhyDisabledModalProps): JSX.Element | null {\n    if (!canShowDisabledReason) return null;\n\n    const {title} = props;\n\n    return (\n      <ReactModal\n        ariaHideApp={false}\n        className=\"modal-container\"\n        isOpen={shouldShowWhyModal}\n        onRequestClose={() => {\n          setShouldShowWhyModal(false);\n        }}\n        overlayClassName=\"modal-overlay\"\n        role=\"dialog\"\n        style={{overlay: {zIndex: 1000}}}>\n        <FadeIn>\n          <div className=\"modal\">\n            <button\n              className=\"modal__close-button modal__close-button--icon\"\n              onClick={() => {\n                setShouldShowWhyModal(false);\n              }}>\n              <TimesSVG />\n            </button>\n            <div className=\"card\">\n              <h2 className=\"modal__title\">{title || 'Why disabled?'}</h2>\n              <p>{disabledReason}</p>\n            </div>\n          </div>\n        </FadeIn>\n      </ReactModal>\n    );\n  }\n\n  return {\n    disabledReason,\n    isDisabled,\n    openWhyDisabledModal: handleOpenWhyDisabledModal,\n    setOtherDisabledReasons: handleSetOtherDisabledReasonsCached,\n    WhyDisabledModal: WhyDisabledModalCached,\n  };\n}\n","import {useState, useEffect, useCallback} from 'react';\nimport {useSelector} from 'react-redux';\nimport usePreviousDistinct from 'react-use/lib/usePreviousDistinct';\nimport {AbiItem} from 'web3-utils';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {StoreState} from '../../../store/types';\nimport {multicall, MulticallTuple} from '../../../components/web3/helpers';\nimport {useWeb3Modal} from '../../../components/web3/hooks';\nimport {truncateEthAddress} from '../../../util/helpers';\n\ntype UseCheckApplicantReturn = {\n  checkApplicantError: Error | undefined;\n  checkApplicantInvalidMsg: string | undefined;\n  checkApplicantStatus: AsyncStatus;\n  isApplicantValid: boolean | undefined;\n};\n\n/**\n * useCheckApplicant\n *\n * Checks if the provided applicant address is valid to become a potential new member.\n *\n * @export\n * @param {string} [address]\n * @returns {UseCheckApplicantReturn}\n */\nexport function useCheckApplicant(address?: string): UseCheckApplicantReturn {\n  /**\n   * Selectors\n   */\n\n  const DaoRegistryContract = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract\n  );\n\n  /**\n   * State\n   */\n\n  const [checkApplicantError, setCheckApplicantError] = useState<Error>();\n  const [checkApplicantInvalidMsg, setCheckApplicantInvalidMsg] =\n    useState<string>();\n  const [checkApplicantStatus, setCheckApplicantStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n  const [isApplicantValid, setIsApplicantValid] = useState<boolean>();\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * Their hooks\n   */\n\n  const prevAddress = usePreviousDistinct(address);\n\n  /**\n   * Cached callbacks\n   */\n\n  const checkApplicantValidityCached = useCallback(checkApplicantValidity, [\n    DaoRegistryContract,\n    address,\n    web3Instance,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    // Reset state if no address is detected\n    if (prevAddress && !address) {\n      setCheckApplicantError(undefined);\n      setCheckApplicantInvalidMsg(undefined);\n      setIsApplicantValid(undefined);\n      setCheckApplicantStatus(AsyncStatus.STANDBY);\n    }\n\n    if (address) {\n      checkApplicantValidityCached();\n    }\n  }, [address, checkApplicantValidityCached, prevAddress]);\n\n  /**\n   * Functions\n   */\n\n  async function checkApplicantValidity() {\n    if (!address || !DaoRegistryContract || !web3Instance) return;\n\n    try {\n      setCheckApplicantStatus(AsyncStatus.PENDING);\n\n      const truncatedAddress = truncateEthAddress(address, 7);\n\n      const {abi: daoRegistryABI, contractAddress: daoRegistryAddress} =\n        DaoRegistryContract;\n\n      // Build calls to DaoRegistry contract (which includes relevant DaoConstants functions)\n      const getIsNotReservedAddressABI = daoRegistryABI.find(\n        (item) => item.name === 'isNotReservedAddress'\n      );\n      const isNotReservedAddressCall: MulticallTuple = [\n        daoRegistryAddress,\n        getIsNotReservedAddressABI as AbiItem,\n        [address],\n      ];\n\n      const getIsNotZeroAddressABI = daoRegistryABI.find(\n        (item) => item.name === 'isNotZeroAddress'\n      );\n      const isNotZeroAddressCall: MulticallTuple = [\n        daoRegistryAddress,\n        getIsNotZeroAddressABI as AbiItem,\n        [address],\n      ];\n\n      const getGetAddressIfDelegatedABI = daoRegistryABI.find(\n        (item) => item.name === 'getAddressIfDelegated'\n      );\n      const getAddressIfDelegatedCall: MulticallTuple = [\n        daoRegistryAddress,\n        getGetAddressIfDelegatedABI as AbiItem,\n        [address],\n      ];\n\n      const calls = [\n        isNotReservedAddressCall,\n        isNotZeroAddressCall,\n        getAddressIfDelegatedCall,\n      ];\n\n      const [\n        isNotReservedAddressResult,\n        isNotZeroAddressResult,\n        getAddressIfDelegatedResult,\n      ]: [boolean, boolean, string] = await multicall({calls, web3Instance});\n\n      if (!isNotReservedAddressResult) {\n        // Applicant address cannot be a reserved address.\n        setIsApplicantValid(false);\n        setCheckApplicantInvalidMsg(\n          `The applicant address ${truncatedAddress} is invalid because it is a DAO reserved address.`\n        );\n      } else if (!isNotZeroAddressResult) {\n        // Applicant address cannot be 0x0 address.\n        setIsApplicantValid(false);\n        setCheckApplicantInvalidMsg(\n          `The applicant address ${truncatedAddress} is invalid.`\n        );\n      } else if (\n        address.toLowerCase() !== getAddressIfDelegatedResult.toLowerCase()\n      ) {\n        // Applicant address cannot already be in use as a delegate key.\n        setIsApplicantValid(false);\n        setCheckApplicantInvalidMsg(\n          `The applicant address ${truncatedAddress} is already in use as a delegate key. The address must be removed as a delegate before it can become a member.`\n        );\n      } else {\n        setIsApplicantValid(true);\n        setCheckApplicantInvalidMsg(undefined);\n      }\n\n      setCheckApplicantStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      setIsApplicantValid(undefined);\n      setCheckApplicantInvalidMsg(undefined);\n      setCheckApplicantError(error);\n      setCheckApplicantStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  return {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  };\n}\n","import {AbiItem} from 'web3-utils/types';\nimport {useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport Web3 from 'web3';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {Proposal} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks';\n\ntype DaoProposalEntries = [proposalId: string, proposal: Proposal][];\n\ntype UseDaoProposalsReturn = {\n  daoProposals: DaoProposalEntries;\n  daoProposalsStatus: AsyncStatus;\n  daoProposalsError: Error | undefined;\n};\n\nconst INITIAL_DAO_PROPOSAL_ENTRIES: DaoProposalEntries = [];\n\n/**\n * useDaoProposals\n *\n * Gets `proposals` by their id from the DAO via `multicall`.\n *\n * @param proposalIds\n * @returns `UseDaoProposalsReturn`\n */\nexport function useDaoProposals(proposalIds: string[]): UseDaoProposalsReturn {\n  /**\n   * Selectors\n   */\n\n  const proposalsAbi = useSelector((s: StoreState) =>\n    s.contracts.DaoRegistryContract?.abi.find((a) => a.name === 'proposals')\n  );\n\n  const registryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  /**\n   * State\n   */\n\n  const [daoProposals, setDaoProposals] = useState<DaoProposalEntries>(\n    INITIAL_DAO_PROPOSAL_ENTRIES\n  );\n\n  const [daoProposalsStatus, setDaoProposalsStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  const [daoProposalsError, setDaoProposalsError] = useState<Error>();\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (\n      !proposalIds.length ||\n      !proposalsAbi ||\n      !registryAddress ||\n      !web3Instance\n    ) {\n      return;\n    }\n\n    handleGetDaoProposals({\n      proposalIds,\n      proposalsAbi,\n      registryAddress,\n      web3Instance,\n    });\n  }, [proposalIds, proposalsAbi, registryAddress, web3Instance]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetDaoProposals({\n    proposalIds,\n    proposalsAbi,\n    registryAddress,\n    web3Instance,\n  }: {\n    proposalIds: string[];\n    proposalsAbi: AbiItem;\n    registryAddress: string;\n    web3Instance: Web3;\n  }) {\n    try {\n      if (!proposalIds.length) return;\n\n      // Only use hex (more specifically `bytes32`) id's\n      const safeProposalIds = proposalIds.filter(\n        web3Instance.utils.isHexStrict\n      );\n\n      if (!safeProposalIds.length) {\n        setDaoProposalsStatus(AsyncStatus.FULFILLED);\n        setDaoProposals([]);\n\n        return;\n      }\n\n      setDaoProposalsStatus(AsyncStatus.PENDING);\n      // Reset error\n      setDaoProposalsError(undefined);\n\n      const calls: MulticallTuple[] = safeProposalIds.map((id) => [\n        registryAddress,\n        proposalsAbi,\n        [id],\n      ]);\n\n      const proposals = await multicall({\n        calls,\n        web3Instance,\n      });\n\n      setDaoProposals(safeProposalIds.map((id, i) => [id, proposals[i]]));\n      setDaoProposalsStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      setDaoProposals(INITIAL_DAO_PROPOSAL_ENTRIES);\n      setDaoProposalsError(error);\n      setDaoProposalsStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  return {\n    daoProposals,\n    daoProposalsStatus,\n    daoProposalsError,\n  };\n}\n","import {AbiItem} from 'web3-utils/types';\nimport {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {VoteChoicesIndex} from '@openlaw/snapshot-js-erc712';\nimport Web3 from 'web3';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {UNITS_ADDRESS, TOTAL_ADDRESS} from '../../../config';\nimport {SnapshotProposal, VotingResult} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useIsMounted} from '../../../hooks';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VoteChoices} from '../../web3/types';\n\ntype OffchainVotingResultEntries = [\n  proposalHash: string,\n  votingResult: VotingResult\n][];\n\ntype UseOffchainVotingResultsReturn = {\n  offchainVotingResults: OffchainVotingResultEntries;\n  offchainVotingResultsError: Error | undefined;\n  offchainVotingResultsStatus: AsyncStatus;\n};\n\n/**\n * @todo Polling\n * @todo Attempt to use subgraph data first.\n */\nexport function useOffchainVotingResults(\n  /**\n   * Accepts a single `SnapshotProposal` or `SnapshotProposal[]`\n   */\n  proposals: (SnapshotProposal | undefined) | (SnapshotProposal | undefined)[]\n): UseOffchainVotingResultsReturn {\n  /**\n   * Selectors\n   */\n\n  const bankABI = useSelector(\n    (s: StoreState) => s.contracts.BankExtensionContract?.abi\n  );\n  const bankAddress = useSelector(\n    (s: StoreState) => s.contracts.BankExtensionContract?.contractAddress\n  );\n\n  /**\n   * State\n   */\n\n  const [votingResults, setVotingResults] =\n    useState<OffchainVotingResultEntries>([]);\n\n  const [offchainVotingResultsStatus, setOffchainVotingResultsStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  const [offchainVotingResultsError, setOffchainVotingResultsError] = useState<\n    Error | undefined\n  >();\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n  const {isMountedRef} = useIsMounted();\n\n  /**\n   * Variables\n   */\n\n  const getPriorAmountABI = bankABI?.find(\n    (item) => item.name === 'getPriorAmount'\n  );\n\n  /**\n   * Cached callbacks\n   */\n\n  const getUnitsPerChoiceCached = useCallback(\n    getUnitsPerChoiceFromContract,\n    []\n  );\n\n  /**\n   * Effects\n   */\n\n  // Build result entries of `OffchainVotingResultEntries`\n  useEffect(() => {\n    const proposalsToMap = Array.isArray(proposals) ? proposals : [proposals];\n\n    if (\n      !bankAddress ||\n      !getPriorAmountABI ||\n      !proposalsToMap.length ||\n      !web3Instance\n    ) {\n      return;\n    }\n\n    setOffchainVotingResultsStatus(AsyncStatus.PENDING);\n\n    const votingResultPromises = proposalsToMap.map(async (p) => {\n      const snapshot = p?.msg.payload.snapshot;\n      const idInSnapshot = p?.idInSnapshot;\n\n      if (!idInSnapshot || !snapshot) return;\n\n      const voterEntries = p?.votes?.map((v): [string, number] => {\n        const vote = v[Object.keys(v)[0]];\n\n        return [\n          /**\n           * Must be the true member's address for calculating voting power.\n           * This value is (or at least should be) derived from `OffchainVoting.memberAddressesByDelegatedKey`.\n           */\n          vote.msg.payload.metadata.memberAddress,\n          vote.msg.payload.choice,\n        ];\n      });\n\n      if (!voterEntries) return;\n\n      // Dedupe any duplicate addresses to be safe.\n      const voterAddressesAndChoices = Object.entries(\n        Object.fromEntries(voterEntries)\n      );\n\n      try {\n        const result = await getUnitsPerChoiceCached({\n          bankAddress,\n          getPriorAmountABI,\n          snapshot,\n          voterAddressesAndChoices,\n          web3Instance,\n        });\n\n        return [idInSnapshot, result];\n      } catch (error) {\n        return;\n      }\n    });\n\n    Promise.all(votingResultPromises)\n      .then((p) => p.filter((p) => p) as OffchainVotingResultEntries)\n      .then((r) => {\n        if (!isMountedRef.current) return;\n\n        setOffchainVotingResultsStatus(AsyncStatus.FULFILLED);\n        setVotingResults(r);\n        setOffchainVotingResultsError(undefined);\n      })\n      .catch((error) => {\n        if (!isMountedRef.current) return;\n\n        setOffchainVotingResultsStatus(AsyncStatus.REJECTED);\n        setVotingResults([]);\n        setOffchainVotingResultsError(error);\n      });\n  }, [\n    bankAddress,\n    getPriorAmountABI,\n    getUnitsPerChoiceCached,\n    isMountedRef,\n    proposals,\n    web3Instance,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function getUnitsPerChoiceFromContract({\n    bankAddress,\n    getPriorAmountABI,\n    snapshot,\n    voterAddressesAndChoices,\n    web3Instance,\n  }: {\n    bankAddress: string;\n    getPriorAmountABI: AbiItem;\n    snapshot: number;\n    voterAddressesAndChoices: [string, number][];\n    web3Instance: Web3;\n  }): Promise<VotingResult> {\n    try {\n      // Create results object to set later\n      const results = {\n        [VoteChoices.Yes]: {\n          percentage: 0,\n          units: 0,\n        },\n        [VoteChoices.No]: {\n          percentage: 0,\n          units: 0,\n        },\n        totalUnits: 0,\n      };\n\n      // Build a call for total units\n      const totalUnitsCall: MulticallTuple = [\n        bankAddress,\n        getPriorAmountABI,\n        [\n          TOTAL_ADDRESS, // account\n          UNITS_ADDRESS, // tokenAddr\n          snapshot.toString(), // blockNumber\n        ],\n      ];\n\n      // Build calls to Bank contract\n      const unitsCalls = voterAddressesAndChoices.map(\n        ([address]): MulticallTuple => [\n          bankAddress,\n          getPriorAmountABI,\n          [\n            address, // account\n            UNITS_ADDRESS, // tokenAddr\n            snapshot.toString(), // blockNumber\n          ],\n        ]\n      );\n\n      const calls = [totalUnitsCall, ...unitsCalls];\n\n      const [totalUnitsResult, ...votingResults]: string[] = await multicall({\n        calls,\n        web3Instance,\n      });\n\n      // Set Units values for choices\n      votingResults.forEach((units, i) => {\n        const isYes =\n          VoteChoicesIndex[voterAddressesAndChoices[i][1]] ===\n          VoteChoicesIndex[VoteChoicesIndex.Yes];\n        const choice = isYes ? VoteChoices.Yes : VoteChoices.No;\n\n        results[choice].units += Number(units);\n      });\n\n      // Set percentages\n      results[VoteChoices.Yes].percentage =\n        (results[VoteChoices.Yes].units / Number(totalUnitsResult)) * 100;\n\n      results[VoteChoices.No].percentage =\n        (results[VoteChoices.No].units / Number(totalUnitsResult)) * 100;\n\n      // Set total units\n      results.totalUnits = Number(totalUnitsResult);\n\n      return results;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  return {\n    offchainVotingResults: votingResults,\n    offchainVotingResultsError,\n    offchainVotingResultsStatus,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {BURN_ADDRESS} from '../../../util/constants';\nimport {getVotingAdapterABI} from '../helpers';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {ProposalVotingAdapterData} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VotingAdapterName} from '../../adapters-extensions/enums';\n\ntype ProposalVotingAdapterTuple = [\n  proposalId: string,\n  votingAdapterData: ProposalVotingAdapterData\n];\n\ntype UseProposalsVotingAdapterReturn = {\n  proposalsVotingAdapters: ProposalVotingAdapterTuple[];\n  proposalsVotingAdaptersError: Error | undefined;\n  proposalsVotingAdaptersStatus: AsyncStatus;\n};\n\nconst INITIAL_VOTING_ADAPTERS: ProposalVotingAdapterTuple[] = [];\n\n/**\n * Fetch voting adapter data for proposals by DAO proposal id.\n * Only returns data for proposals of which voting adapters have been assigned (i.e. sponsored).\n *\n * @param {string[]}\n * @returns {UseProposalsVotingAdapterReturn}\n */\nexport function useProposalsVotingAdapter(\n  proposalIds: string[]\n): UseProposalsVotingAdapterReturn {\n  /**\n   * Selectors\n   */\n\n  const registryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n  const registryABI = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.abi\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [proposalsVotingAdapters, setProposalsVotingAdapters] = useState<\n    ProposalVotingAdapterTuple[]\n  >(INITIAL_VOTING_ADAPTERS);\n\n  const [proposalsVotingAdaptersError, setProposalsVotingAdaptersError] =\n    useState<Error | undefined>();\n\n  const [proposalsVotingAdaptersStatus, setProposalsVotingAdaptersStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  /**\n   * Cached callbacks\n   */\n\n  const getProposalsVotingAdaptersOnchainCached = useCallback(\n    getProposalsVotingAdaptersOnchain,\n    [proposalIds, registryABI, registryAddress, web3Instance]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getProposalsVotingAdaptersOnchainCached();\n  }, [getProposalsVotingAdaptersOnchainCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getProposalsVotingAdaptersOnchain(): Promise<void> {\n    if (\n      !proposalIds.length ||\n      !registryABI ||\n      !registryAddress ||\n      !web3Instance\n    ) {\n      return;\n    }\n\n    // Only use hex (more specifically `bytes32`) id's\n    const safeProposalIds = proposalIds.filter(web3Instance.utils.isHexStrict);\n\n    if (!safeProposalIds.length) {\n      setProposalsVotingAdapters(INITIAL_VOTING_ADAPTERS);\n      setProposalsVotingAdaptersStatus(AsyncStatus.FULFILLED);\n\n      return;\n    }\n\n    try {\n      const votingAdapterABI = registryABI.find(\n        (ai) => ai.name === 'votingAdapter'\n      );\n\n      if (!votingAdapterABI) {\n        throw new Error(\n          'No \"votingAdapter\" ABI function was found in the DAO registry ABI.'\n        );\n      }\n\n      // `DaoRegistry.votingAdapter` calls\n      const votingAdapterCalls: MulticallTuple[] = safeProposalIds.map((id) => [\n        registryAddress,\n        votingAdapterABI,\n        [id],\n      ]);\n\n      setProposalsVotingAdaptersStatus(AsyncStatus.PENDING);\n\n      const votingAdapterAddressResults: string[] = await multicall({\n        calls: votingAdapterCalls,\n        web3Instance,\n      });\n\n      const {default: lazyIVotingABI} = await import(\n        '../../../truffle-contracts/IVoting.json'\n      );\n\n      const getAdapterNameABI = (lazyIVotingABI as typeof registryABI).find(\n        (ai) => ai.name === 'getAdapterName'\n      );\n\n      if (!getAdapterNameABI) {\n        throw new Error(\n          'No \"getAdapterName\" ABI function was found in the IVoting ABI.'\n        );\n      }\n\n      /**\n       * Filter out `safeProposalIds` which are not sponsored (i.e. voting adapter address === `BURN_ADDRESS`).\n       * Filter out `votingAdapterAddressResults` which equal the `BURN_ADDRESS`.\n       *\n       * This ensures these two arrays maintain the same length as they rely on indexes for the\n       * proposals to match up to the array of `multicall` results.\n       */\n\n      const filteredProposalIds = safeProposalIds.filter(\n        (_id, i) => votingAdapterAddressResults[i] !== BURN_ADDRESS\n      );\n\n      const filteredVotingAdapterAddressResults =\n        votingAdapterAddressResults.filter((a) => a !== BURN_ADDRESS);\n\n      /**\n       * Exit early if there's no voting adapter addresses.\n       * It means no proposals were found to be sponsored\n       */\n      if (!filteredVotingAdapterAddressResults.length) {\n        setProposalsVotingAdapters(INITIAL_VOTING_ADAPTERS);\n        setProposalsVotingAdaptersStatus(AsyncStatus.FULFILLED);\n\n        return;\n      }\n\n      const votingAdapterNameCalls: MulticallTuple[] =\n        filteredVotingAdapterAddressResults.map((votingAdapterAddress) => [\n          votingAdapterAddress,\n          getAdapterNameABI,\n          [],\n        ]);\n\n      const adapterNameResults: VotingAdapterName[] = await multicall({\n        calls: votingAdapterNameCalls,\n        web3Instance,\n      });\n\n      const votingAdaptersToSet = await Promise.all(\n        filteredProposalIds.map(\n          async (id, i): Promise<ProposalVotingAdapterTuple> => {\n            const votingAdapterABI = await getVotingAdapterABI(\n              adapterNameResults[i]\n            );\n            const votingAdapterAddress = filteredVotingAdapterAddressResults[i];\n\n            return [\n              id,\n              {\n                votingAdapterName: adapterNameResults[i],\n                votingAdapterAddress,\n                getVotingAdapterABI: () => votingAdapterABI,\n                getWeb3VotingAdapterContract: () =>\n                  new web3Instance.eth.Contract(\n                    votingAdapterABI,\n                    votingAdapterAddress\n                  ),\n              },\n            ];\n          }\n        )\n      );\n\n      setProposalsVotingAdapters(votingAdaptersToSet);\n      setProposalsVotingAdaptersStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      setProposalsVotingAdaptersStatus(AsyncStatus.REJECTED);\n      setProposalsVotingAdapters([]);\n      setProposalsVotingAdaptersError(error);\n    }\n  }\n\n  return {\n    proposalsVotingAdapters,\n    proposalsVotingAdaptersError,\n    proposalsVotingAdaptersStatus,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {\n  SnapshotDraftResponse,\n  SnapshotProposalResponse,\n  SnapshotType,\n} from '@openlaw/snapshot-js-erc712';\n\nimport {\n  Proposal,\n  ProposalData,\n  ProposalOrDraftSnapshotType,\n  SnapshotDraft,\n  SnapshotProposal,\n  SnapshotProposalCommon,\n} from '../types';\nimport {AsyncStatus} from '../../../util/types';\nimport {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {useAbortController, useCounter} from '../../../hooks';\nimport {useProposalsVotingAdapter} from './useProposalsVotingAdapter';\n\ntype UseProposalReturn = {\n  proposalData: ProposalData | undefined;\n  proposalError: Error | undefined;\n  proposalNotFound: boolean;\n  proposalStatus: AsyncStatus;\n};\n\nconst ERROR_PROPOSAL: string =\n  'Something went wrong while getting the proposal.';\nconst ERROR_PROPOSAL_NOT_FOUND: string = 'Proposal was not found.';\n\n/**\n * useProposalOrDraft\n *\n * Fetches a snapshot-hub `proposal` or `draft` type by an ID string.\n *\n * If no `type` argument is provided it will search first for a\n * `proposal`, then if not found, search for a `draft`.\n *\n * @todo Fetch subgraph proposal on mount before a draft or proposal has been fetched.\n *\n * @param {string} id A draft's or a proposal's ID to search for.\n * @param {SnapshotType?} type An optional snapshot-hub `type` to search by.\n * @returns {UseProposalReturn}\n */\nexport function useProposalOrDraft(\n  id: string,\n  type?: ProposalOrDraftSnapshotType\n): UseProposalReturn {\n  /**\n   * State\n   */\n\n  /**\n   * @todo Get subgraph data using useLazyQuery\n   * @link https://www.apollographql.com/docs/react/data/queries/#executing-queries-manually\n   */\n\n  const [daoProposal /* setDAOProposal */] = useState<Proposal>();\n  const [snapshotDraft, setSnapshotDraft] = useState<SnapshotDraft>();\n  const [snapshotProposal, setSnapshotProposal] = useState<SnapshotProposal>();\n  const [proposalNotFound, setProposalNotFound] = useState<boolean>(false);\n  const [proposalError, setProposalError] = useState<Error>();\n  const [proposalStatus, setProposalStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n  const [proposalVotingAdapterId, setProposalVotingAdapterId] = useState<\n    string[]\n  >([id]);\n\n  // The overall status of the async data being fetched\n  const [proposalInclusiveStatus, setProposalInclusiveStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  // Any error of the async data being fetched\n  const [proposalInclusiveError, setProposalInclusiveError] = useState<Error>();\n\n  /**\n   * Our hooks\n   */\n\n  const {abortController, isMountedRef} = useAbortController();\n\n  const [refetchCount, updateRefetchCount] = useCounter();\n\n  /**\n   * Fetch on-chain voting adapter data for proposals.\n   * Only returns data for proposals of which voting adapters have been assigned (i.e. sponsored).\n   */\n  const {\n    proposalsVotingAdapters,\n    proposalsVotingAdaptersError,\n    proposalsVotingAdaptersStatus,\n  } = useProposalsVotingAdapter(proposalVotingAdapterId);\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleGetDraftCached = useCallback(handleGetDraft, [\n    abortController?.signal,\n    id,\n    isMountedRef,\n  ]);\n\n  const handleGetProposalCached = useCallback(handleGetProposal, [\n    abortController?.signal,\n    id,\n    isMountedRef,\n    type,\n  ]);\n\n  const handleGetProposalOrDraftCached = useCallback(handleGetProposalOrDraft, [\n    handleGetDraftCached,\n    handleGetProposalCached,\n  ]);\n\n  /**\n   * Variables\n   */\n\n  const snapshotType: ProposalOrDraftSnapshotType | undefined = snapshotProposal\n    ? SnapshotType.proposal\n    : snapshotDraft\n    ? SnapshotType.draft\n    : undefined;\n\n  /**\n   * We need to at least have Snapshot data to provide the proposal,\n   * otherwise we will have nothing to show the user.\n   */\n  const proposalData: UseProposalReturn['proposalData'] =\n    snapshotDraft || snapshotProposal\n      ? {\n          // idInDAO: '',\n          daoProposal,\n          daoProposalVotingAdapter: proposalsVotingAdapters[0]?.[1],\n          getCommonSnapshotProposalData,\n          refetchProposalOrDraft,\n          snapshotDraft,\n          snapshotProposal,\n          snapshotType,\n        }\n      : undefined;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!abortController?.signal) return;\n\n    switch (type) {\n      case SnapshotType.draft:\n        handleGetDraftCached();\n        break;\n      case SnapshotType.proposal:\n        handleGetProposalCached();\n        break;\n      default:\n        handleGetProposalOrDraftCached();\n        break;\n    }\n  }, [\n    abortController?.signal,\n    handleGetDraftCached,\n    handleGetProposalCached,\n    handleGetProposalOrDraftCached,\n    // Required in order to refetch\n    refetchCount,\n    type,\n  ]);\n\n  useEffect(() => {\n    if (refetchCount === 0) return;\n\n    /**\n     * Provide a different Array reference to force a re-render\n     * of the `useProposalsVotingAdapter` hook. If the `id` argument changes,\n     * that's fine as well, but it's unlikely.\n     */\n    setProposalVotingAdapterId([id]);\n  }, [id, refetchCount]);\n\n  // Set overall async status\n  useEffect(() => {\n    const {STANDBY, PENDING, FULFILLED, REJECTED} = AsyncStatus;\n    const statuses = [proposalStatus, proposalsVotingAdaptersStatus];\n\n    /**\n     * Standby\n     *\n     * The other statuses rely on a Snapshot Hub proposal or draft being fetched,\n     * so it's only in `STANDBY` at the point the proposals have\n     * not yet been fetched.\n     */\n    if (proposalStatus === STANDBY) {\n      setProposalInclusiveStatus(STANDBY);\n\n      return;\n    }\n\n    /**\n     * Pending\n     *\n     * Do not trigger pending requests (UI may show loader) for refetches (meant to be silent).\n     */\n    if (statuses.some((s) => s === PENDING) && refetchCount === 0) {\n      setProposalInclusiveStatus(PENDING);\n\n      return;\n    }\n\n    // Fulfilled\n    if (statuses.every((s) => s === FULFILLED)) {\n      setProposalInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    // Fulfilled: checked for DAO proposals' voting adapters and none were returned - not sponsored\n    if (\n      proposalStatus === FULFILLED &&\n      proposalsVotingAdaptersStatus === FULFILLED &&\n      !proposalsVotingAdapters.length\n    ) {\n      setProposalInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    // Rejected\n    if (statuses.some((s) => s === REJECTED)) {\n      setProposalInclusiveStatus(REJECTED);\n\n      return;\n    }\n  }, [\n    proposalStatus,\n    proposalsVotingAdapters.length,\n    proposalsVotingAdaptersStatus,\n    refetchCount,\n  ]);\n\n  // Set any error from async calls\n  useEffect(() => {\n    const errors = [proposalError, proposalsVotingAdaptersError];\n\n    setProposalInclusiveError(errors.find((e) => e));\n  }, [proposalError, proposalsVotingAdaptersError]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetDraft(): Promise<SnapshotDraft | undefined> {\n    try {\n      setProposalStatus(AsyncStatus.PENDING);\n\n      const response = await fetch(\n        `${SNAPSHOT_HUB_API_URL}/api/${SPACE}/draft/${id}`,\n        {signal: abortController?.signal}\n      );\n\n      if (!response.ok) {\n        throw new Error(ERROR_PROPOSAL);\n      }\n\n      const responseJSON: SnapshotDraftResponse = await response.json();\n\n      if (!isMountedRef.current) return;\n\n      // @note API does not provide a 404\n      if (!responseJSON || !Object.keys(responseJSON).length) {\n        setProposalNotFound(true);\n\n        throw new Error(ERROR_PROPOSAL_NOT_FOUND);\n      }\n\n      const idKey = Object.keys(responseJSON)[0];\n      // Get the `SnapshotDraftResponseData` by the address key of the single result.\n      const draft: SnapshotDraft = {\n        idInDAO: idKey,\n        idInSnapshot: idKey,\n        ...responseJSON[idKey],\n      };\n\n      setProposalStatus(AsyncStatus.FULFILLED);\n      setSnapshotDraft(draft);\n\n      return draft;\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setProposalStatus(AsyncStatus.REJECTED);\n      setProposalError(error);\n    }\n  }\n\n  async function handleGetProposal(): Promise<SnapshotProposal | undefined> {\n    try {\n      setProposalStatus(AsyncStatus.PENDING);\n\n      /**\n       * @note `searchUniqueDraftId` includes the draft id in the search for the proposal\n       *   as a Tribute proposal's ID hash could be the Snapshot Draft's ID.\n       */\n      const response = await fetch(\n        `${SNAPSHOT_HUB_API_URL}/api/${SPACE}/proposal/${id}?searchUniqueDraftId=true&includeVotes=true`,\n        {signal: abortController?.signal}\n      );\n\n      if (!response.ok) {\n        /**\n         * If `type` is set then we know we can determine `handleGetDraft`\n         * will not be called after in `handleGetProposalOrDraft`.\n         */\n        if (type === SnapshotType.proposal) {\n          throw new Error(ERROR_PROPOSAL);\n        }\n\n        return;\n      }\n\n      const responseJSON: SnapshotProposalResponse = await response.json();\n\n      if (!isMountedRef.current) return;\n\n      // @note API does not provide a 404\n      if (!responseJSON || !Object.keys(responseJSON).length) {\n        /**\n         * If `type` is set then we know we can determine `handleGetDraft`\n         * will not be called after in `handleGetProposalOrDraft`.\n         */\n        if (type === SnapshotType.proposal) {\n          setProposalNotFound(true);\n          throw new Error(ERROR_PROPOSAL_NOT_FOUND);\n        }\n\n        return;\n      }\n\n      const idKey = Object.keys(responseJSON)[0];\n      // Determine ID submitted to DAO, i.e. if there's a Draft ID hash, we should use that.\n      const proposalId: string =\n        responseJSON[idKey]?.data.erc712DraftHash || idKey;\n      // Get the `SnapshotProposalResponseData` by the address key of the single result.\n      const proposal: SnapshotProposal = {\n        idInDAO: proposalId,\n        idInSnapshot: idKey,\n        ...responseJSON[idKey],\n      };\n\n      setProposalStatus(AsyncStatus.FULFILLED);\n      setSnapshotProposal(proposal);\n\n      return proposal;\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setProposalStatus(AsyncStatus.REJECTED);\n      setProposalError(error);\n    }\n  }\n\n  /**\n   * Searches all possible combinations to return a proposal or a draft:\n   *\n   * 1. Search for a proposal (including by using the `id` as the Draft's ID hash via `searchUniqueDraftId`)\n   * 2. Search for a draft, if nothing is returned for a proposal.\n   */\n  async function handleGetProposalOrDraft() {\n    // 1. Attempt to search for a proposal.\n    const proposal = await handleGetProposalCached();\n\n    if (!proposal) {\n      // 2. If not found, attempt a search for a draft.\n      const draft = await handleGetDraftCached();\n\n      setSnapshotDraft(draft);\n\n      return;\n    }\n\n    setSnapshotProposal(proposal);\n  }\n\n  /**\n   * getCommonSnapshotProposalData\n   *\n   * @returns `SnapshotProposalCommon | undefined` Data for either a Draft or Proposal which is shared between the two types.\n   */\n  function getCommonSnapshotProposalData(): SnapshotProposalCommon | undefined {\n    switch (snapshotType) {\n      case SnapshotType.draft:\n        return snapshotDraft;\n      case SnapshotType.proposal:\n        return snapshotProposal;\n      default:\n        return undefined;\n    }\n  }\n\n  function refetchProposalOrDraft(): void {\n    updateRefetchCount({type: 'increment'});\n  }\n\n  return {\n    proposalData,\n    proposalError: proposalInclusiveError,\n    proposalNotFound,\n    proposalStatus: proposalInclusiveStatus,\n  };\n}\n","import {useEffect, useMemo, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {\n  SnapshotDraftResponse,\n  SnapshotDraftResponseData,\n  SnapshotProposalResponse,\n  SnapshotProposalResponseData,\n  SnapshotType,\n} from '@openlaw/snapshot-js-erc712';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {DaoAdapterConstants} from '../../adapters-extensions/enums';\nimport {normalizeString} from '../../../util/helpers';\nimport {ProposalData, SnapshotDraft, SnapshotProposal} from '../types';\nimport {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {StoreState} from '../../../store/types';\nimport {useDaoProposals, useProposalsVotingState} from '.';\nimport {useProposalsVotes} from './useProposalsVotes';\nimport {useProposalsVotingAdapter} from './useProposalsVotingAdapter';\n\ntype UseProposalsReturn = {\n  proposals: ProposalData[];\n  proposalsStatus: AsyncStatus;\n  proposalsError: Error | undefined;\n};\n\ntype SnapshotDraftAndProposalEntries = [\n  string,\n  SnapshotDraftResponseData | SnapshotProposalResponseData\n][];\n\nconst INITIAL_ARRAY: any[] = [];\n\n// Gets Drafts (unsponsored Proposals) from Snapshot Hub\nasync function getSnapshotDraftsByAdapterAddress(\n  adapterAddress: string\n): Promise<[string, SnapshotDraftResponseData][]> {\n  try {\n    const baseURL = `${SNAPSHOT_HUB_API_URL}/api/${SPACE}`;\n\n    const drafts = await fetch(`${baseURL}/drafts/${adapterAddress}`);\n\n    if (!drafts.ok) {\n      throw new Error(\n        'Something went wrong while fetching the Snapshot drafts.'\n      );\n    }\n\n    const draftsJSON: SnapshotDraftResponse = await drafts.json();\n\n    // Get Drafts which have not yet been sponsored (Proposal created)\n    const draftEntries = Object.entries(draftsJSON).filter(\n      ([_, d]) => d.data.sponsored === false\n    );\n\n    return draftEntries;\n  } catch (error) {\n    throw error;\n  }\n}\n\n// Gets Proposals from Snapshot Hub\nasync function getSnapshotProposalsByAdapterAddress(\n  adapterAddress: string\n): Promise<[string, SnapshotProposalResponseData][]> {\n  try {\n    const baseURL = `${SNAPSHOT_HUB_API_URL}/api/${SPACE}`;\n\n    const proposals = await fetch(\n      `${baseURL}/proposals/${adapterAddress}?includeVotes=true`\n    );\n\n    if (!proposals.ok) {\n      throw new Error(\n        'Something went wrong while fetching the Snapshot proposals.'\n      );\n    }\n\n    const proposalsJSON: SnapshotProposalResponse = await proposals.json();\n\n    /**\n     * Re-map entries setting the correct id used for the `proposalId` in the DAO.\n     * If it has a draft hash, then this is what was submitted to the DAO, most likely (e.g. submit proposal)\n     */\n    const proposalEntries = Object.entries(proposalsJSON).map(\n      ([id, p]): [string, SnapshotProposalResponseData] => [\n        p.data.erc712DraftHash || id,\n        p,\n      ]\n    );\n\n    return proposalEntries;\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * useProposals\n *\n * @param {string} adapterName Name of the adapter contract to get proposals for.\n * @param {string} includeProposalsExistingOnlyOffchain To handle proposal types where the first step is creating a snapshot draft/offchain proposal only (no onchain proposal exists).\n * @returns `UseProposalsReturn` An object with the proposals, and the current async status.\n */\nexport function useProposals({\n  adapterName,\n  includeProposalsExistingOnlyOffchain = false,\n}: {\n  adapterName: DaoAdapterConstants;\n  includeProposalsExistingOnlyOffchain?: boolean;\n}): UseProposalsReturn {\n  /**\n   * State\n   */\n\n  const [adapterAddress, setAdapterAddress] = useState<string>();\n\n  const [snapshotDraftAndProposals, setSnapshotDraftAndProposals] =\n    useState<SnapshotDraftAndProposalEntries>(INITIAL_ARRAY);\n\n  const [snapshotDraftAndProposalsStatus, setSnapshotDraftAndProposalsStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  const [snapshotDraftAndProposalsError, setSnapshotDraftAndProposalsError] =\n    useState<Error | undefined>();\n\n  const [daoProposalIdsToUse, setDaoProposalIdsToUse] =\n    useState<string[]>(INITIAL_ARRAY);\n\n  const [proposals, setProposals] = useState<ProposalData[]>(INITIAL_ARRAY);\n\n  // The overall status of the async data being fetched\n  const [proposalsInclusiveStatus, setProposalsInclusiveStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  // Any error of the async data being fetched\n  const [proposalsInclusiveError, setProposalsInclusiveError] =\n    useState<Error>();\n\n  /**\n   * Selectors\n   */\n\n  const contracts = useSelector((s: StoreState) => s.contracts);\n\n  /**\n   * Memo\n   */\n\n  const snapshotDraftAndProposalsIds: string[] = useMemo(\n    () => snapshotDraftAndProposals.map((e) => e[0]),\n    [snapshotDraftAndProposals]\n  );\n\n  /**\n   * Our hooks\n   */\n\n  /**\n   * Fetch DAO proposals, if there are `snapshotDraftAndProposals`.\n   *\n   * Dependent upon `snapshotDraftAndProposals`.\n   */\n  const {daoProposals, daoProposalsError, daoProposalsStatus} = useDaoProposals(\n    snapshotDraftAndProposalsIds\n  );\n\n  /**\n   * Fetch on-chain voting adapter data for proposals of which voting adapters have been assigned (i.e. sponsored).\n   *\n   * Dependent upon `daoProposals`.\n   */\n  const {\n    proposalsVotingAdapters,\n    proposalsVotingAdaptersError,\n    proposalsVotingAdaptersStatus,\n  } = useProposalsVotingAdapter(daoProposalIdsToUse);\n\n  /**\n   * Fetch on-chain voting state for proposals of which voting adapters have been assigned (i.e. sponsored).\n   *\n   * Dependent upon `useProposalsVotingAdapter`.\n   */\n  const {\n    proposalsVotingState,\n    proposalsVotingStateError,\n    proposalsVotingStateStatus,\n  } = useProposalsVotingState(proposalsVotingAdapters);\n\n  /**\n   * Fetch on-chain votes data for proposals of which voting adapters have been assigned (i.e. sponsored)\n   *\n   * Dependent upon `useProposalsVotingAdapter`.\n   */\n  const {proposalsVotes, proposalsVotesError, proposalsVotesStatus} =\n    useProposalsVotes(proposalsVotingAdapters);\n\n  /**\n   * Effects\n   */\n\n  // Get and set the adapter address\n  useEffect(() => {\n    // @note We don't use the helper function as we don't want it to throw here.\n    const address = Object.entries(contracts).find(\n      ([_, c]) => c?.adapterOrExtensionName === adapterName\n    )?.[1]?.contractAddress;\n\n    setAdapterAddress(address);\n  }, [adapterAddress, adapterName, contracts]);\n\n  // Get and set all Snapshot drafts and proposal entries\n  useEffect(() => {\n    if (!adapterAddress) return;\n\n    handleGetAllSnapshotDraftsAndProposals(adapterAddress);\n  }, [adapterAddress]);\n\n  // Set the DAO proposal IDs we want to work with\n  useEffect(() => {\n    if (!daoProposals.length) return;\n\n    if (includeProposalsExistingOnlyOffchain) {\n      // Do not filter-out proposals which exist only off-chain\n      return setDaoProposalIdsToUse(daoProposals.map(([id]) => id));\n    }\n\n    // Filter-out proposals which do not exist onchain\n    return setDaoProposalIdsToUse(\n      daoProposals.filter(([_, p]) => p.flags !== '0').map(([id]) => id)\n    );\n  }, [daoProposals, includeProposalsExistingOnlyOffchain]);\n\n  // Set `proposals` with any returned data, once overall `AsyncStatus` equals `FULFILLED`\n  useEffect(() => {\n    if (proposalsInclusiveStatus !== AsyncStatus.FULFILLED) {\n      return;\n    }\n\n    const proposalsToSet = daoProposalIdsToUse\n      .map((id): ProposalData => {\n        const [, daoProposal] =\n          daoProposals.find(\n            ([daoProposalId]) =>\n              normalizeString(daoProposalId) === normalizeString(id)\n          ) || [];\n\n        const [snapshotDataId, snapshotData] =\n          snapshotDraftAndProposals.find(\n            ([snapshotId]) =>\n              normalizeString(snapshotId) === normalizeString(id)\n          ) || [];\n\n        const isSnapshotDraft: boolean =\n          snapshotData?.msg.type === SnapshotType.draft;\n\n        const snapshotDraft: SnapshotDraft | undefined =\n          snapshotDataId && isSnapshotDraft\n            ? {\n                ...(snapshotData as SnapshotDraft),\n                // @todo Rename to `idForDAO` as it is more accurate, as the ID may not yet exist in the DAO.\n                idInDAO: id,\n                idInSnapshot: snapshotDataId,\n              }\n            : undefined;\n\n        const snapshotProposal: SnapshotProposal | undefined =\n          snapshotDataId && !isSnapshotDraft\n            ? {\n                ...(snapshotData as SnapshotProposal),\n                // @todo Rename to `idForDAO` as it is more accurate, as the ID may not yet exist in the DAO.\n                idInDAO: id,\n                idInSnapshot: snapshotDataId,\n              }\n            : undefined;\n\n        const daoProposalVotingAdapter = proposalsVotingAdapters.find(\n          ([proposalIdVotingAdapter]) =>\n            normalizeString(proposalIdVotingAdapter) === normalizeString(id)\n        )?.[1];\n\n        const daoProposalVotingState = proposalsVotingState.find(\n          ([proposalIdVotingState]) =>\n            normalizeString(proposalIdVotingState) === normalizeString(id)\n        )?.[1];\n\n        const daoProposalVotes = proposalsVotes.find(\n          ([proposalIdVotes]) =>\n            normalizeString(id) === normalizeString(proposalIdVotes)\n        )?.[1];\n\n        return {\n          daoProposal,\n          daoProposalVotes,\n          daoProposalVotingAdapter,\n          daoProposalVotingState,\n          /**\n           * @todo Work to remove `idInDAO` on the root. Don't think we use this?\n           */\n          idInDAO: id,\n          snapshotDraft,\n          snapshotProposal,\n          snapshotType: isSnapshotDraft\n            ? SnapshotType.draft\n            : SnapshotType.proposal,\n\n          // @todo Make type optional\n          getCommonSnapshotProposalData: () => undefined,\n          // @todo Make type optional\n          refetchProposalOrDraft: () => {},\n        };\n      })\n      .filter((p) => p.snapshotDraft || p.snapshotProposal);\n\n    // Set proposals\n    setProposals(proposalsToSet);\n  }, [\n    daoProposalIdsToUse,\n    daoProposals,\n    proposalsInclusiveStatus,\n    proposalsVotes,\n    proposalsVotingAdapters,\n    proposalsVotingState,\n    snapshotDraftAndProposals,\n  ]);\n\n  // Set overall async status\n  useEffect(() => {\n    const {STANDBY, PENDING, FULFILLED, REJECTED} = AsyncStatus;\n\n    const statuses = [\n      daoProposalsStatus,\n      proposalsVotingAdaptersStatus,\n      proposalsVotingStateStatus,\n      proposalsVotesStatus,\n      snapshotDraftAndProposalsStatus,\n    ];\n\n    /**\n     * Standby\n     *\n     * The other statuses rely on Snapshot drafts and proposals being fetched,\n     * so it's only in `STANDBY` at the point the Snapshot data has\n     * not yet been fetched.\n     */\n    if (snapshotDraftAndProposalsStatus === STANDBY) {\n      setProposalsInclusiveStatus(STANDBY);\n\n      return;\n    }\n\n    // Pending\n    if (statuses.some((s) => s === PENDING)) {\n      setProposalsInclusiveStatus(PENDING);\n\n      return;\n    }\n\n    // Fulfilled\n    if (statuses.every((s) => s === FULFILLED)) {\n      setProposalsInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    /**\n     * Fulfilled: no `snapshotDraftAndProposals` were found.\n     *\n     * Since the other data-fetching hooks rely on `snapshotDraftAndProposals`\n     * their statuses will be in `STANDBY` if `snapshotDraftAndProposals` is empty.\n     */\n    if (\n      snapshotDraftAndProposalsStatus === FULFILLED &&\n      !snapshotDraftAndProposals.length\n    ) {\n      setProposalsInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    /**\n     * Fulfilled: No data was returned after running `useProposalsVotingAdapter`.\n     *\n     * The hooks `useProposalsVotingState`, `useProposalsVotes` are dependent upon `proposalsVotingAdapters`,\n     * so if there is no data, at this point, it's safe to return `FULFILLED`.\n     */\n    if (\n      proposalsVotingAdaptersStatus === FULFILLED &&\n      !proposalsVotingAdapters.length\n    ) {\n      setProposalsInclusiveStatus(FULFILLED);\n\n      return;\n    }\n\n    // Rejected\n    if (statuses.some((s) => s === REJECTED)) {\n      setProposalsInclusiveStatus(REJECTED);\n\n      return;\n    }\n  }, [\n    daoProposalIdsToUse.length,\n    daoProposalsStatus,\n    proposalsVotesStatus,\n    proposalsVotingAdapters,\n    proposalsVotingAdaptersStatus,\n    proposalsVotingStateStatus,\n    snapshotDraftAndProposals.length,\n    snapshotDraftAndProposalsStatus,\n  ]);\n\n  // Set any error from async calls\n  useEffect(() => {\n    setProposalsInclusiveError(\n      [\n        daoProposalsError,\n        proposalsVotesError,\n        proposalsVotingAdaptersError,\n        proposalsVotingStateError,\n        snapshotDraftAndProposalsError,\n      ].find((e) => e)\n    );\n  }, [\n    daoProposalsError,\n    proposalsVotesError,\n    proposalsVotingAdaptersError,\n    proposalsVotingStateError,\n    snapshotDraftAndProposalsError,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetAllSnapshotDraftsAndProposals(\n    adapterAddress: string\n  ) {\n    try {\n      setSnapshotDraftAndProposalsStatus(AsyncStatus.PENDING);\n      // Reset error\n      setSnapshotDraftAndProposalsError(undefined);\n\n      const snapshotDraftEntries = await getSnapshotDraftsByAdapterAddress(\n        adapterAddress\n      );\n\n      const snapshotProposalEntries =\n        await getSnapshotProposalsByAdapterAddress(adapterAddress);\n\n      const mergedEntries = [\n        ...snapshotDraftEntries,\n        ...snapshotProposalEntries,\n      ];\n\n      if (!mergedEntries.length) {\n        setSnapshotDraftAndProposalsStatus(AsyncStatus.FULFILLED);\n\n        return;\n      }\n\n      setSnapshotDraftAndProposals(mergedEntries);\n      setSnapshotDraftAndProposalsStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      setSnapshotDraftAndProposalsStatus(AsyncStatus.REJECTED);\n      setSnapshotDraftAndProposals(INITIAL_ARRAY);\n      setSnapshotDraftAndProposalsError(error);\n    }\n  }\n\n  return {\n    proposals,\n    proposalsError: proposalsInclusiveError,\n    proposalsStatus: proposalsInclusiveStatus,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {AbiItem} from 'web3-utils/types';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {ProposalVotesData, ProposalVotingAdapterTuple} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VotingAdapterName} from '../../adapters-extensions/enums';\n\ntype ProposalsVotesTuple = [\n  proposalId: string,\n  /**\n   * For each proposal, each result is stored under its adapter name.\n   */\n  adapterData: ProposalVotesData\n];\n\ntype UseProposalsVotesReturn = {\n  proposalsVotes: ProposalsVotesTuple[];\n  proposalsVotesError: Error | undefined;\n  proposalsVotesStatus: AsyncStatus;\n};\n\nexport function useProposalsVotes(\n  /**\n   * A tuple of proposal id's and voting adapter data.\n   * This data is returned by `useProposalsVotingAdapter`.\n   */\n  proposalVotingAdapters: ProposalVotingAdapterTuple[]\n): UseProposalsVotesReturn {\n  /**\n   * Selectors\n   */\n\n  const registryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n  const registryABI = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.abi\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [proposalsVotes, setProposalsVotes] = useState<ProposalsVotesTuple[]>(\n    []\n  );\n  const [proposalsVotesError, setProposalsVotesError] = useState<Error>();\n  const [proposalsVotesStatus, setProposalsVotesStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  /**\n   * Cached callbacks\n   */\n\n  const getProposalsVotesOnchainCached = useCallback(getProposalsVotesOnchain, [\n    proposalVotingAdapters,\n    registryABI,\n    registryAddress,\n    web3Instance,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getProposalsVotesOnchainCached();\n  }, [getProposalsVotesOnchainCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getProposalsVotesOnchain() {\n    if (\n      !proposalVotingAdapters.length ||\n      !registryABI ||\n      !registryAddress ||\n      !web3Instance\n    ) {\n      return;\n    }\n\n    // Only use hex (more specifically `bytes32`) id's\n    const safeProposalVotingAdapters = proposalVotingAdapters.filter(([id]) =>\n      web3Instance.utils.isHexStrict(id)\n    );\n\n    if (!safeProposalVotingAdapters.length) {\n      setProposalsVotesStatus(AsyncStatus.FULFILLED);\n      setProposalsVotes([]);\n\n      return;\n    }\n\n    try {\n      setProposalsVotesStatus(AsyncStatus.PENDING);\n\n      // Build votes results\n      const votesDataCalls: MulticallTuple[] = await Promise.all(\n        safeProposalVotingAdapters.map(\n          async ([\n            proposalId,\n            {votingAdapterAddress, getVotingAdapterABI, votingAdapterName},\n          ]): Promise<MulticallTuple> => [\n            votingAdapterAddress,\n            await getVotesDataABI(votingAdapterName, getVotingAdapterABI()),\n            /**\n             * We build the call arguments the same way for the different voting adapters\n             * (i.e. [dao, proposalId]). If we need to change this we can move it to another function.\n             */\n            [registryAddress, proposalId],\n          ]\n        )\n      );\n\n      const votesDataResults = await multicall({\n        calls: votesDataCalls,\n        web3Instance,\n      });\n\n      setProposalsVotesStatus(AsyncStatus.FULFILLED);\n      setProposalsVotes(\n        safeProposalVotingAdapters.map(\n          ([proposalId, {votingAdapterName}], i) => [\n            proposalId,\n            {\n              [votingAdapterName]: votesDataResults[i],\n            },\n          ]\n        )\n      );\n    } catch (error) {\n      setProposalsVotesStatus(AsyncStatus.REJECTED);\n      setProposalsVotes([]);\n      setProposalsVotesError(error);\n    }\n  }\n\n  /**\n   * getVotesDataABI\n   *\n   * Gets the ABI for the public mapping getter of voting data.\n   *\n   * @param {VotingAdapterName} votingAdapterName\n   * @returns {Promise<AbiItem>}\n   */\n  async function getVotesDataABI(\n    votingAdapterName: VotingAdapterName,\n    votingAdapterABI: AbiItem[]\n  ): Promise<AbiItem> {\n    try {\n      switch (votingAdapterName) {\n        case VotingAdapterName.OffchainVotingContract:\n          const offchainVotesDataABI = votingAdapterABI.find(\n            (ai) => ai.name === 'votes'\n          );\n\n          if (!offchainVotesDataABI) {\n            throw new Error(\n              `No \"votes\" function ABI was found for \"${votingAdapterName}\".`\n            );\n          }\n\n          return offchainVotesDataABI;\n\n        case VotingAdapterName.VotingContract:\n          const votingVotesDataABI = votingAdapterABI.find(\n            (ai) => ai.name === 'votes'\n          );\n\n          if (!votingVotesDataABI) {\n            throw new Error(\n              `No \"votes\" function ABI was found for \"${votingAdapterName}\".`\n            );\n          }\n\n          return votingVotesDataABI;\n\n        default:\n          throw new Error(\n            `No voting adapter name was found for \"${votingAdapterName}\".`\n          );\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  return {\n    proposalsVotes,\n    proposalsVotesError,\n    proposalsVotesStatus,\n  };\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {AbiItem} from 'web3-utils/types';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {ProposalVotingAdapterTuple} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VotingState} from '../voting/types';\n\ntype ProposalsVotingStateTuples = [\n  proposalId: string,\n  votingState: VotingState\n][];\n\ntype UseProposalsVotingStateReturn = {\n  proposalsVotingState: ProposalsVotingStateTuples;\n  proposalsVotingStateError: Error | undefined;\n  proposalsVotingStateStatus: AsyncStatus;\n};\n\nexport function useProposalsVotingState(\n  /**\n   * A tuple of proposal id's and voting adapter data.\n   * This data is returned by `useProposalsVotingAdapter`.\n   */\n  proposalVotingAdapters: ProposalVotingAdapterTuple[]\n): UseProposalsVotingStateReturn {\n  /**\n   * Selectors\n   */\n\n  const registryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [proposalsVotingState, setProposaslsVotingState] =\n    useState<ProposalsVotingStateTuples>([]);\n\n  const [proposalsVotingStateError, setProposalsVotingStateError] =\n    useState<Error>();\n\n  const [proposalsVotingStateStatus, setProposalsVotingStateStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  /**\n   * Cached callbacks\n   */\n\n  const getProposalsVotingStateOnchainCached = useCallback(\n    getProposalsVotingStateOnchain,\n    [proposalVotingAdapters, registryAddress, web3Instance]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getProposalsVotingStateOnchainCached();\n  }, [getProposalsVotingStateOnchainCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getProposalsVotingStateOnchain() {\n    if (!registryAddress || !proposalVotingAdapters.length || !web3Instance) {\n      return;\n    }\n\n    // Only use hex (more specifically `bytes32`) id's\n    const safeProposalVotingAdapters = proposalVotingAdapters.filter(([id]) =>\n      web3Instance.utils.isHexStrict(id)\n    );\n\n    if (!safeProposalVotingAdapters.length) {\n      setProposalsVotingStateStatus(AsyncStatus.FULFILLED);\n\n      return;\n    }\n\n    try {\n      const lazyIVotingABI = (\n        await import('../../../truffle-contracts/IVoting.json')\n      ).default as AbiItem[];\n\n      const votingResultAbi = lazyIVotingABI.find(\n        (ai) => ai.name === 'voteResult'\n      );\n\n      if (!votingResultAbi) {\n        throw new Error(\n          'No \"voteResult\" ABI function was found on the \"IVoting\" contract.'\n        );\n      }\n\n      const calls: MulticallTuple[] = safeProposalVotingAdapters.map(\n        ([proposalId, {votingAdapterAddress}]) => [\n          votingAdapterAddress,\n          votingResultAbi,\n          [registryAddress, proposalId],\n        ]\n      );\n\n      setProposalsVotingStateStatus(AsyncStatus.PENDING);\n\n      const proposalsVotingStateResult = await multicall({\n        calls,\n        web3Instance,\n      });\n\n      setProposalsVotingStateStatus(AsyncStatus.FULFILLED);\n      setProposaslsVotingState(\n        safeProposalVotingAdapters.map(([proposalId], i) => [\n          proposalId,\n          proposalsVotingStateResult[i],\n        ])\n      );\n    } catch (error) {\n      setProposalsVotingStateStatus(AsyncStatus.REJECTED);\n      setProposaslsVotingState([]);\n      setProposalsVotingStateError(error);\n    }\n  }\n\n  return {\n    proposalsVotingState,\n    proposalsVotingStateError,\n    proposalsVotingStateStatus,\n  };\n}\n","import {useSelector} from 'react-redux';\nimport {useCallback, useEffect, useRef, useState} from 'react';\nimport {isAddress} from 'web3-utils';\n\nimport {\n  ProposalFlowStatus,\n  ProposalData,\n  ProposalFlag,\n  OffchainVotingAdapterVotes,\n} from '../types';\nimport {BURN_ADDRESS} from '../../../util/constants';\nimport {ENVIRONMENT} from '../../../config';\nimport {multicall, MulticallTuple} from '../../web3/helpers';\nimport {normalizeString} from '../../../util/helpers';\nimport {proposalHasFlag} from '../helpers';\nimport {StoreState} from '../../../store/types';\nimport {useVotingTimeStartEnd} from '.';\nimport {useWeb3Modal} from '../../web3/hooks';\nimport {VotingState} from '../voting/types';\n\n// @todo Logic to fall back to on-chain polling this if subgraph is not available\n\ntype UseProposalWithOffchainVoteStatusReturn = {\n  daoProposal: {adapterAddress: string; flags: number} | undefined;\n  daoProposalVotes: OffchainVotingAdapterVotes | undefined;\n  /**\n   * An enum name (`string`) of the DAO proposal's `VotingState` index\n   */\n  daoProposalVoteResult: typeof VotingState[any] | undefined;\n  proposalFlowStatusError: Error | undefined;\n  status: ProposalFlowStatus | undefined;\n};\n\nconst DEFAULT_POLL_INTERVAL_MS: number =\n  ENVIRONMENT === 'production' ? 15000 : 5000;\n\nexport function useProposalWithOffchainVoteStatus(\n  proposal: ProposalData,\n  options?: {pollInterval?: number}\n): UseProposalWithOffchainVoteStatusReturn {\n  const {daoProposalVotingAdapter, snapshotDraft, snapshotProposal} = proposal;\n  const {votes: snapshotVotes} = snapshotProposal || {};\n  const proposalId = snapshotDraft?.idInDAO || snapshotProposal?.idInDAO;\n  const {pollInterval = DEFAULT_POLL_INTERVAL_MS} = options || {};\n\n  /**\n   * Selectors\n   */\n\n  const {web3Instance} = useWeb3Modal();\n  const daoRegistryAddress = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.contractAddress\n  );\n  const daoRegistryABI = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract?.abi\n  );\n\n  /**\n   * State\n   */\n\n  const [daoProposal, setDAOProposal] =\n    useState<UseProposalWithOffchainVoteStatusReturn['daoProposal']>();\n  const [daoProposalVotes, setDAOProposalVotes] =\n    useState<UseProposalWithOffchainVoteStatusReturn['daoProposalVotes']>();\n  const [daoProposalVoteResult, setDAOProposalVoteResult] =\n    useState<\n      UseProposalWithOffchainVoteStatusReturn['daoProposalVoteResult']\n    >();\n\n  const [proposalFlowStatusError, setProposalFlowStatusError] =\n    useState<Error>();\n\n  /**\n   * Refs\n   */\n\n  const pollingIntervalIdRef = useRef<NodeJS.Timeout>();\n  const stopPollingRef = useRef<boolean>(false);\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    hasVotingTimeStarted,\n    hasVotingTimeEnded,\n    votingTimeStartEndInitReady,\n  } = useVotingTimeStartEnd(\n    proposal.snapshotProposal?.msg.payload.start,\n    proposal.snapshotProposal?.msg.payload.end\n  );\n\n  /**\n   * Variables\n   */\n\n  const atExistsInDAO = daoProposal\n    ? proposalHasFlag(ProposalFlag.EXISTS, daoProposal.flags)\n    : false;\n  const atSponsoredInDAO = daoProposal\n    ? proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags)\n    : false;\n  const atProcessedInDAO = daoProposal\n    ? proposalHasFlag(ProposalFlag.PROCESSED, daoProposal.flags)\n    : false;\n\n  const offchainVotingAddress = daoProposalVotingAdapter?.votingAdapterAddress;\n  const offchainVotingABI = daoProposalVotingAdapter?.getVotingAdapterABI();\n\n  /**\n   * Check if vote result was submitted.\n   * We can do this by checking if `reporter` and `resultRoot` has been set.\n   *\n   * @see `submitVoteResult` in tribute-contracts off-chain voting adapters\n   */\n  const offchainResultSubmitted: boolean =\n    daoProposalVotes !== undefined &&\n    isAddress(daoProposalVotes.reporter) &&\n    normalizeString(daoProposalVotes.reporter) !== BURN_ADDRESS;\n\n  const isInVotingGracePeriod: boolean =\n    daoProposalVoteResult !== undefined &&\n    VotingState[daoProposalVoteResult] ===\n      VotingState[VotingState.GRACE_PERIOD];\n\n  /**\n   * Cached callbacks\n   */\n\n  const getStatusFromContractCached = useCallback(getStatusFromContract, [\n    daoProposalVotingAdapter,\n    daoRegistryABI,\n    daoRegistryAddress,\n    offchainVotingABI,\n    offchainVotingAddress,\n    proposalId,\n    web3Instance,\n  ]);\n\n  useEffect(() => {\n    // Call as soon as possible.\n    getStatusFromContractCached().catch((error) => {\n      setProposalFlowStatusError(error);\n    });\n  }, [getStatusFromContractCached]);\n\n  useEffect(() => {\n    /**\n     * Stop polling if processed:\n     * Set our ref to be accessed inside of the polling interval callback\n     */\n    if (atProcessedInDAO) {\n      stopPollingRef.current = true;\n    }\n\n    // Clear any previous intervals\n    if (pollingIntervalIdRef.current) {\n      clearInterval(pollingIntervalIdRef.current);\n    }\n\n    // Then, poll every `x` Ms\n    const intervalId = setInterval(async () => {\n      try {\n        if (stopPollingRef.current && pollingIntervalIdRef.current) {\n          clearInterval(pollingIntervalIdRef.current);\n        }\n\n        await getStatusFromContractCached();\n      } catch (error) {\n        pollingIntervalIdRef.current &&\n          clearInterval(pollingIntervalIdRef.current);\n\n        setProposalFlowStatusError(error);\n      }\n    }, pollInterval);\n\n    pollingIntervalIdRef.current = intervalId;\n  }, [atProcessedInDAO, pollInterval, getStatusFromContractCached]);\n\n  // Stop polling if propsal is processed\n  useEffect(() => {\n    if (atProcessedInDAO && pollingIntervalIdRef.current) {\n      clearInterval(pollingIntervalIdRef.current);\n    }\n\n    // Cleanup polling on unmount\n    return () => {\n      pollingIntervalIdRef.current &&\n        clearInterval(pollingIntervalIdRef.current);\n    };\n  }, [atProcessedInDAO]);\n\n  /**\n   * Functions\n   */\n\n  function getReturnData(\n    status: ProposalFlowStatus | undefined\n  ): UseProposalWithOffchainVoteStatusReturn {\n    return {\n      daoProposal,\n      daoProposalVoteResult,\n      daoProposalVotes,\n      proposalFlowStatusError,\n      status,\n    };\n  }\n\n  async function getStatusFromContract() {\n    try {\n      if (\n        !daoRegistryABI ||\n        !daoRegistryAddress ||\n        !proposalId ||\n        !web3Instance\n      ) {\n        return;\n      }\n\n      const proposalsABI = daoRegistryABI.filter(\n        (item) => item.name === 'proposals'\n      )[0];\n\n      /**\n       * If there is no voting adapter (i.e. the proposal is not yet sponsored)\n       * then only call the DAO for the proposal data and exit early.\n       */\n      if (!daoProposalVotingAdapter) {\n        const [proposal] = await multicall({\n          calls: [\n            // DAO proposals call\n            [daoRegistryAddress, proposalsABI, [proposalId]],\n          ],\n          web3Instance,\n        });\n\n        setDAOProposal(proposal);\n\n        return;\n      }\n\n      if (!offchainVotingABI || !offchainVotingAddress) return;\n\n      const voteResultABI = offchainVotingABI.filter(\n        (item) => item.name === 'voteResult'\n      )[0];\n      const votesABI = offchainVotingABI.filter(\n        (item) => item.name === 'votes'\n      )[0];\n\n      const calls: MulticallTuple[] = [\n        // DAO proposals call\n        [daoRegistryAddress, proposalsABI, [proposalId]],\n        // Votes call\n        [offchainVotingAddress, votesABI, [daoRegistryAddress, proposalId]],\n        // Vote result call\n        [\n          offchainVotingAddress,\n          voteResultABI,\n          [daoRegistryAddress, proposalId],\n        ],\n      ];\n\n      const [proposal, votes, voteResult] = await multicall({\n        calls,\n        web3Instance,\n      });\n\n      setDAOProposal(proposal);\n      setDAOProposalVotes(votes);\n      setDAOProposalVoteResult(voteResult);\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  // Status: Submit\n  if (votingTimeStartEndInitReady && !hasVotingTimeStarted && !atExistsInDAO) {\n    return getReturnData(ProposalFlowStatus.Submit);\n  }\n\n  // Status: Sponsor\n  if (votingTimeStartEndInitReady && !hasVotingTimeStarted && atExistsInDAO) {\n    return getReturnData(ProposalFlowStatus.Sponsor);\n  }\n\n  // Status: Off-chain Voting\n  if (\n    votingTimeStartEndInitReady &&\n    hasVotingTimeStarted &&\n    !hasVotingTimeEnded &&\n    atSponsoredInDAO\n  ) {\n    return getReturnData(ProposalFlowStatus.OffchainVoting);\n  }\n\n  // Status: If no votes, skip `OffchainVotingSubmitResult` and set to `OffchainVotingGracePeriod` or `Process`\n  if (\n    votingTimeStartEndInitReady &&\n    hasVotingTimeEnded &&\n    atSponsoredInDAO &&\n    !snapshotVotes?.length &&\n    !offchainResultSubmitted\n  ) {\n    return getReturnData(\n      isInVotingGracePeriod\n        ? ProposalFlowStatus.OffchainVotingGracePeriod\n        : ProposalFlowStatus.Process\n    );\n  }\n\n  // Status: Ready to Submit Vote Result\n  if (\n    votingTimeStartEndInitReady &&\n    hasVotingTimeEnded &&\n    atSponsoredInDAO &&\n    !offchainResultSubmitted\n  ) {\n    return getReturnData(ProposalFlowStatus.OffchainVotingSubmitResult);\n  }\n\n  // Status: Grace period\n  if (\n    votingTimeStartEndInitReady &&\n    hasVotingTimeEnded &&\n    atSponsoredInDAO &&\n    offchainResultSubmitted &&\n    isInVotingGracePeriod\n  ) {\n    return getReturnData(ProposalFlowStatus.OffchainVotingGracePeriod);\n  }\n\n  // Status: Process\n  if (\n    atSponsoredInDAO &&\n    votingTimeStartEndInitReady &&\n    hasVotingTimeEnded &&\n    offchainResultSubmitted &&\n    !isInVotingGracePeriod\n  ) {\n    return getReturnData(ProposalFlowStatus.Process);\n  }\n\n  // Status: Processed (completed)\n  if (atProcessedInDAO) {\n    return getReturnData(ProposalFlowStatus.Completed);\n  }\n\n  // Fallthrough\n  return {\n    daoProposal,\n    daoProposalVoteResult,\n    daoProposalVotes,\n    proposalFlowStatusError,\n    status: undefined,\n  };\n}\n","import {useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {\n  buildVoteMessage,\n  getDomainDefinition,\n  getSpace,\n  prepareVoteMessage,\n  signMessage,\n  SnapshotMessageVote,\n  SnapshotSubmitBaseReturn,\n  SnapshotType,\n  SnapshotVoteData,\n  SnapshotVoteProposal,\n  submitMessage,\n  VoteChoicesIndex,\n} from '@openlaw/snapshot-js-erc712';\n\nimport {BURN_ADDRESS} from '../../../util/constants';\nimport {ContractAdapterNames, Web3TxStatus} from '../../web3/types';\nimport {DEFAULT_CHAIN, SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {getAdapterAddressFromContracts} from '../../web3/helpers';\nimport {PRIMARY_TYPE_ERC712} from '../../web3/config';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks/useWeb3Modal';\n\ntype SignAndSendVoteDataParam = {\n  choice: SnapshotMessageVote['choice'];\n  metadata?: Record<string, any>;\n};\n\ntype UseSignAndSendVoteReturn = {\n  signAndSendVote: (data: {\n    partialVoteData: SignAndSendVoteDataParam;\n    // e.g. Governance does not have an adpater name\n    adapterName?: ContractAdapterNames;\n    proposalIdInDAO: SnapshotVoteData['payload']['proposalId'];\n    proposalIdInSnapshot: string;\n  }) => Promise<SignAndSendVoteReturn>;\n  voteData: SignAndSendVoteReturn | undefined;\n  voteDataError: Error | undefined;\n  voteDataStatus: Web3TxStatus;\n};\n\ntype SignAndSendVoteReturn = {\n  data: SnapshotVoteData;\n  signature: string;\n  uniqueId: SnapshotSubmitBaseReturn['uniqueId'];\n};\n\n/**\n * useSignAndSendVote\n *\n * React hook which prepares proposal data for submission\n * to Snapshot and Tribute and signs it (ERC712)\n *\n * @returns {Promise<BuildAndSignProposalDataReturn>} An object with the proposal data and the ERC712 signature string.\n */\nexport function useSignAndSendVote(): UseSignAndSendVoteReturn {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryAddress = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract?.contractAddress\n  );\n\n  const contracts = useSelector((s: StoreState) => s.contracts);\n\n  const memberAddress = useSelector(\n    (s: StoreState) => s.connectedMember?.memberAddress\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, provider, web3Instance} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [voteData, setVoteData] = useState<SignAndSendVoteReturn>();\n  const [voteDataError, setVoteDataError] = useState<Error>();\n  const [voteDataStatus, setVoteDataStatus] = useState<Web3TxStatus>(\n    Web3TxStatus.STANDBY\n  );\n\n  /**\n   * Functions\n   */\n\n  /**\n   * signAndSendVote\n   *\n   * Builds the vote data for submission to Snapshot and signs it (ERC712).\n   *\n   * @param {SignAndSendVoteDataParam}\n   * @param {adapterName} ContractAdapterNames - An adapter's contract address this data is related to.\n   *   @note Does not accept voting adapter names.\n   * @param {SnapshotVoteData['payload']['proposalHash']} proposalHash - The unique hash of the proposal from snapshot-hub.\n   * @returns {Promise<BuildAndSignProposalDataReturn>} An object with the vote data and the ERC712 signature string.\n   */\n  async function signAndSendVote({\n    partialVoteData,\n    adapterName,\n    proposalIdInDAO,\n    proposalIdInSnapshot,\n  }: {\n    partialVoteData: SignAndSendVoteDataParam;\n    // e.g. Governance does not have an adpater name\n    adapterName?: ContractAdapterNames;\n    /**\n     * This is the hash of the content as submitted to the DAO.\n     * The hash should be the same as the Snapshot draft's, or\n     * proposal's (if not submitted as a draft), ID.\n     *\n     * We need to make sure this matches what has been submitted to\n     * the DAO for later signature verifications.\n     */\n    proposalIdInDAO: SnapshotVoteData['payload']['proposalId'];\n    /**\n     * Must match a `proposal` type's ID in Snapshot so a `vote` may be attached.\n     */\n    proposalIdInSnapshot: string;\n  }): Promise<SignAndSendVoteReturn> {\n    try {\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      if (!account) {\n        throw new Error('No account was found.');\n      }\n\n      if (!memberAddress) {\n        throw new Error('No member address was found.');\n      }\n\n      if (!daoRegistryAddress) {\n        throw new Error('No \"DaoRegistry\" address was found.');\n      }\n\n      if (!SNAPSHOT_HUB_API_URL) {\n        throw new Error('No \"SNAPSHOT_HUB_API_URL\" was found.');\n      }\n\n      if (!SPACE) {\n        throw new Error('No Snapshot \"SPACE\" was found.');\n      }\n\n      setVoteDataStatus(Web3TxStatus.AWAITING_CONFIRM);\n\n      const adapterAddress = adapterName\n        ? getAdapterAddressFromContracts(adapterName, contracts)\n        : BURN_ADDRESS;\n\n      const {choice, metadata = {}} = partialVoteData;\n\n      const {data: snapshotSpace} = await getSpace(SNAPSHOT_HUB_API_URL, SPACE);\n\n      const voteData: SnapshotMessageVote = {\n        chainId: DEFAULT_CHAIN,\n        choice,\n        metadata: {\n          ...metadata,\n          /**\n           * Must be the true member's address for calculating voting power.\n           * It's safest to use our helper Redux value `memberAddress: string`,\n           * as it uses `OffchainVoting.memberAddressesByDelegatedKey`.\n           */\n          memberAddress,\n        },\n      };\n\n      const voteProposalData: SnapshotVoteProposal = {\n        proposalId: proposalIdInDAO,\n        space: SPACE,\n        token: snapshotSpace.token,\n      };\n\n      // 1. Check proposal type and get appropriate message\n      const message = await buildVoteMessage(\n        voteData,\n        voteProposalData,\n        SNAPSHOT_HUB_API_URL\n      );\n\n      const erc712Message = prepareVoteMessage({\n        timestamp: message.timestamp,\n        payload: {\n          proposalId: message.payload.proposalId,\n          choice: VoteChoicesIndex[choice],\n        },\n      });\n\n      const {domain, types} = getDomainDefinition(\n        {...erc712Message, type: SnapshotType.vote},\n        daoRegistryAddress,\n        adapterAddress,\n        DEFAULT_CHAIN\n      );\n\n      const dataToSign = JSON.stringify({\n        types: types,\n        domain: domain,\n        primaryType: PRIMARY_TYPE_ERC712,\n        message: erc712Message,\n      });\n\n      const signature: string = await signMessage(\n        provider,\n        account,\n        dataToSign\n      );\n\n      setVoteDataStatus(Web3TxStatus.PENDING);\n\n      // 3. Send data to snapshot-hub\n      const {data} = await submitMessage<SnapshotSubmitBaseReturn>(\n        SNAPSHOT_HUB_API_URL,\n        account,\n        {\n          ...message,\n          payload: {...message.payload, proposalId: proposalIdInSnapshot},\n        },\n        signature,\n        {\n          actionId: domain.actionId,\n          chainId: domain.chainId,\n          verifyingContract: domain.verifyingContract,\n          message: erc712Message,\n        }\n      );\n\n      const dataToReturn = {\n        data: message,\n        signature,\n        uniqueId: data.uniqueId,\n      };\n\n      setVoteDataStatus(Web3TxStatus.FULFILLED);\n      setVoteData(dataToReturn);\n\n      return dataToReturn;\n    } catch (error) {\n      setVoteDataStatus(Web3TxStatus.REJECTED);\n      setVoteDataError(error);\n\n      throw error;\n    }\n  }\n\n  return {\n    signAndSendVote,\n    voteData,\n    voteDataError,\n    voteDataStatus,\n  };\n}\n","import {useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {\n  buildDraftMessage,\n  buildProposalMessage,\n  getDomainDefinition,\n  getSpace,\n  prepareDraftMessage,\n  prepareProposalMessage,\n  signMessage,\n  SnapshotMessageBase,\n  SnapshotMessageProposal,\n  SnapshotProposalData,\n  SnapshotSubmitBaseReturn,\n  SnapshotSubmitProposalReturn,\n  SnapshotType,\n  submitMessage,\n} from '@openlaw/snapshot-js-erc712';\n\nimport {\n  ContractAdapterNames,\n  ContractDAOConfigKeys,\n  Web3TxStatus,\n} from '../../web3/types';\nimport {DEFAULT_CHAIN, SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {\n  getAdapterAddressFromContracts,\n  getDAOConfigEntry,\n} from '../../web3/helpers';\nimport {PRIMARY_TYPE_ERC712} from '../../web3/config';\nimport {\n  ProposalOrDraftSignDataFromType,\n  ProposalOrDraftSnapshotType,\n} from '../types';\nimport {StoreState} from '../../../store/types';\nimport {useWeb3Modal} from '../../web3/hooks/useWeb3Modal';\nimport {BURN_ADDRESS} from '../../../util/constants';\n\ntype SignAndSendData<T extends ProposalOrDraftSnapshotType> = {\n  partialProposalData: PrepareAndSignProposalDataParam;\n  adapterAddress?: string;\n  adapterName?: ContractAdapterNames;\n  type: T;\n};\n\ntype PrepareAndSignProposalDataParam = {\n  body: SnapshotProposalData['payload']['body'];\n  name: SnapshotProposalData['payload']['name'];\n  metadata: SnapshotProposalData['payload']['metadata'];\n  /**\n   * Helpful for Proposal types when hashes between created Drafts\n   * and yet to be created Proposals need to match.\n   */\n  timestamp?: SnapshotProposalData['timestamp'];\n};\n\ntype UseSignAndSubmitProposalReturn<T extends ProposalOrDraftSnapshotType> = {\n  signAndSendProposal: (\n    d: SignAndSendData<T>\n  ) => Promise<SignAndSendProposalReturn<T>>;\n  proposalData: SignAndSendProposalReturn<T> | undefined;\n  proposalSignAndSendError: Error | undefined;\n  proposalSignAndSendStatus: Web3TxStatus;\n};\n\ntype SignAndSendProposalReturn<T extends ProposalOrDraftSnapshotType> = {\n  data: ProposalOrDraftSignDataFromType<T>;\n  signature: string;\n  uniqueId: SnapshotSubmitBaseReturn['uniqueId'];\n  uniqueIdDraft: SnapshotSubmitProposalReturn['uniqueIdDraft'];\n};\n\n/**\n * useSignAndSubmitProposal\n *\n * React hook which prepares proposal data for submission\n * to Snapshot and Tribute and signs it (ERC712)\n *\n * @returns {Promise<UseSignAndSubmitProposalReturn>} An object with the proposal data and the ERC712 signature string.\n */\nexport function useSignAndSubmitProposal<\n  T extends ProposalOrDraftSnapshotType\n>(): UseSignAndSubmitProposalReturn<T> {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryAddress = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract?.contractAddress\n  );\n  const daoRegistryInstance = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract?.instance\n  );\n  const contracts = useSelector((state: StoreState) => state.contracts);\n\n  /**\n   * Our hooks\n   */\n\n  const {account, provider, web3Instance} = useWeb3Modal();\n\n  /**\n   * State\n   */\n\n  const [proposalData, setProposalData] =\n    useState<SignAndSendProposalReturn<T>>();\n  const [proposalSignAndSendError, setProposalSignAndSendError] =\n    useState<Error>();\n  const [proposalSignAndSendStatus, setProposalSignAndSendStatus] =\n    useState<Web3TxStatus>(Web3TxStatus.STANDBY);\n\n  /**\n   * Functions\n   */\n\n  /**\n   * A wrapper to clearly separate the running of functions\n   * specific to Proposals.\n   *\n   * @param {SnapshotMessageBase & Partial<SnapshotMessageProposal>} commonData\n   * @returns {Promise<SnapshotProposalData>}\n   */\n  async function buildProposalMessageHelper(\n    commonData: SnapshotMessageBase & Partial<SnapshotMessageProposal>\n  ): Promise<SnapshotProposalData> {\n    if (!SNAPSHOT_HUB_API_URL) {\n      throw new Error('No \"SNAPSHOT_HUB_API_URL\" was found.');\n    }\n\n    if (!web3Instance) {\n      throw new Error('No Web3 instance was found.');\n    }\n\n    const snapshot: number = await web3Instance.eth.getBlockNumber();\n\n    const votingTimeSeconds: number = parseInt(\n      await getDAOConfigEntry(\n        ContractDAOConfigKeys.offchainVotingVotingPeriod,\n        daoRegistryInstance\n      )\n    );\n\n    return await buildProposalMessage(\n      {\n        ...commonData,\n        votingTimeSeconds,\n        snapshot,\n      },\n      SNAPSHOT_HUB_API_URL\n    );\n  }\n\n  /**\n   * signAndSendProposal\n   *\n   * Builds the proposal data for submission to Tribute and Snapshot and signs it (ERC712).\n   *\n   * @returns {Promise<SignAndSendProposalReturn>} An object with the proposal data, signature string, and propsal hash(es) from snapshot-hub.\n   */\n  async function signAndSendProposal({\n    partialProposalData,\n    adapterAddress,\n    adapterName,\n    type,\n  }: SignAndSendData<T>): Promise<SignAndSendProposalReturn<T>> {\n    try {\n      if (!account) {\n        throw new Error('No account was found to send.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      if (!daoRegistryAddress) {\n        throw new Error('No \"DaoRegistry\" address was found.');\n      }\n\n      if (!SNAPSHOT_HUB_API_URL) {\n        throw new Error('No \"SNAPSHOT_HUB_API_URL\" was found.');\n      }\n\n      if (!SPACE) {\n        throw new Error('No Snapshot \"SPACE\" was found.');\n      }\n\n      if (type !== SnapshotType.draft && type !== SnapshotType.proposal) {\n        throw new Error('Handling for type \"vote\" is not implemented.');\n      }\n\n      setProposalSignAndSendStatus(Web3TxStatus.AWAITING_CONFIRM);\n\n      const actionId = adapterAddress\n        ? adapterAddress\n        : adapterName\n        ? getAdapterAddressFromContracts(adapterName, contracts)\n        : BURN_ADDRESS;\n\n      const {body, name, metadata, timestamp} = partialProposalData;\n\n      const {data: snapshotSpace} = await getSpace(SNAPSHOT_HUB_API_URL, SPACE);\n\n      const commonData: SnapshotMessageBase = {\n        name,\n        body,\n        metadata,\n        token: snapshotSpace.token,\n        space: SPACE,\n      };\n\n      // 1. Check proposal type and prepare appropriate message\n      const message = (\n        type === SnapshotType.draft\n          ? await buildDraftMessage(commonData, SNAPSHOT_HUB_API_URL)\n          : await buildProposalMessageHelper({\n              ...commonData,\n              timestamp,\n            })\n      ) as ProposalOrDraftSignDataFromType<T>;\n\n      // 2. Prepare signing data. Snapshot and the contracts will verify this same data against the signature.\n      const erc712Message =\n        type === SnapshotType.draft\n          ? prepareDraftMessage(message)\n          : prepareProposalMessage(message as SnapshotProposalData);\n\n      const {domain, types} = getDomainDefinition(\n        {...erc712Message, type},\n        daoRegistryAddress,\n        actionId,\n        DEFAULT_CHAIN\n      );\n\n      const dataToSign = JSON.stringify({\n        types,\n        domain,\n        primaryType: PRIMARY_TYPE_ERC712,\n        message: erc712Message,\n      });\n\n      // 3. Sign data\n      const signature = await signMessage(provider, account, dataToSign);\n\n      setProposalSignAndSendStatus(Web3TxStatus.PENDING);\n\n      // 3. Send data to snapshot-hub\n      const {data} = await submitMessage<SnapshotSubmitProposalReturn>(\n        SNAPSHOT_HUB_API_URL,\n        account,\n        message,\n        signature,\n        {\n          actionId: domain.actionId,\n          chainId: domain.chainId,\n          verifyingContract: domain.verifyingContract,\n          message: erc712Message,\n        }\n      );\n\n      const dataToReturn = {\n        data: message,\n        signature,\n        uniqueId: data.uniqueId,\n        uniqueIdDraft: data.uniqueIdDraft || '',\n      };\n\n      setProposalSignAndSendStatus(Web3TxStatus.FULFILLED);\n      setProposalData(dataToReturn);\n\n      return dataToReturn;\n    } catch (error) {\n      setProposalSignAndSendStatus(Web3TxStatus.REJECTED);\n      setProposalSignAndSendError(error);\n\n      throw error;\n    }\n  }\n\n  return {\n    proposalData,\n    proposalSignAndSendError,\n    proposalSignAndSendStatus,\n    signAndSendProposal,\n  };\n}\n","import {useEffect, useRef, useState} from 'react';\n\nimport {AsyncStatus} from '../../../util/types';\n\ntype UseVotingTimeStartEndReturn = {\n  hasVotingTimeEnded: boolean;\n  hasVotingTimeStarted: boolean;\n  /**\n   * Informs if the initial async checks have run.\n   * This helps to tame UI false-positives that can arise when\n   * using only booleans to check status.\n   */\n  votingTimeStartEndInitReady: boolean;\n};\n\ntype StartEndStatus = {start: AsyncStatus; end: AsyncStatus};\n\nexport function useVotingTimeStartEnd(\n  startSeconds: number | undefined,\n  endSeconds: number | undefined\n): UseVotingTimeStartEndReturn {\n  /**\n   * Refs\n   */\n\n  const votingStartEndStatusRef = useRef<StartEndStatus>({\n    start: AsyncStatus.STANDBY,\n    end: AsyncStatus.STANDBY,\n  });\n\n  /**\n   * State\n   */\n\n  const [hasVotingTimeStarted, setHasVotingTimeStarted] =\n    useState<boolean>(false);\n\n  const [hasVotingTimeEnded, setHasVotingTimeEnded] = useState<boolean>(false);\n\n  const [votingTimeStartEndInitReady, setVotingTimeStartEndInitReady] =\n    useState<boolean>(isInitReady(votingStartEndStatusRef.current));\n\n  /**\n   * Effects\n   */\n\n  // Actively check if voting has started\n  useEffect(() => {\n    if (\n      hasVotingTimeStarted ||\n      startSeconds === undefined ||\n      endSeconds === undefined\n    ) {\n      setVotingTimeStartEndInitReady(() => {\n        votingStartEndStatusRef.current.start = AsyncStatus.FULFILLED;\n        return isInitReady(votingStartEndStatusRef.current);\n      });\n\n      return;\n    }\n\n    setVotingTimeStartEndInitReady(() => {\n      votingStartEndStatusRef.current.start = AsyncStatus.PENDING;\n      return isInitReady(votingStartEndStatusRef.current);\n    });\n\n    // Check if voting has started every 1 second\n    const intervalID = setInterval(() => {\n      // Async process ran\n      setVotingTimeStartEndInitReady(() => {\n        votingStartEndStatusRef.current.start = AsyncStatus.FULFILLED;\n        return isInitReady(votingStartEndStatusRef.current);\n      });\n\n      const hasStartedCheck = Math.floor(Date.now() / 1000) > startSeconds;\n\n      if (!hasStartedCheck) return;\n\n      setHasVotingTimeStarted(hasStartedCheck);\n    }, 1000);\n\n    return () => {\n      clearInterval(intervalID);\n    };\n  }, [endSeconds, hasVotingTimeStarted, startSeconds]);\n\n  // Actively check if voting has ended\n  useEffect(() => {\n    if (\n      hasVotingTimeEnded ||\n      startSeconds === undefined ||\n      endSeconds === undefined\n    ) {\n      setVotingTimeStartEndInitReady(() => {\n        votingStartEndStatusRef.current.end = AsyncStatus.FULFILLED;\n        return isInitReady(votingStartEndStatusRef.current);\n      });\n\n      return;\n    }\n\n    setVotingTimeStartEndInitReady(() => {\n      votingStartEndStatusRef.current.end = AsyncStatus.PENDING;\n      return isInitReady(votingStartEndStatusRef.current);\n    });\n\n    // Check if voting has ended every 1 second\n    const intervalID = setInterval(() => {\n      // Async process ran\n      setVotingTimeStartEndInitReady(() => {\n        votingStartEndStatusRef.current.end = AsyncStatus.FULFILLED;\n        return isInitReady(votingStartEndStatusRef.current);\n      });\n\n      const hasEndedCheck = Math.ceil(Date.now() / 1000) > endSeconds;\n\n      if (!hasEndedCheck) return;\n\n      setHasVotingTimeEnded(hasEndedCheck);\n    }, 1000);\n\n    return () => {\n      clearInterval(intervalID);\n    };\n  }, [endSeconds, hasVotingTimeEnded, startSeconds]);\n\n  /**\n   * Functions\n   */\n\n  function isInitReady(votingTimeStartEndInitReady: StartEndStatus) {\n    return Object.values(votingTimeStartEndInitReady).every(\n      (s) => s === AsyncStatus.FULFILLED\n    );\n  }\n\n  return {\n    hasVotingTimeStarted,\n    hasVotingTimeEnded,\n    votingTimeStartEndInitReady,\n  };\n}\n","import React, {useEffect, useState} from 'react';\n\ninterface IProps {\n  // Show spinner after some time has elapsed.\n  // Prevents the \"sudden spinner\" UI/UX no-no.\n  // Esp. if we could have cached data.\n  showAfterMs?: number;\n  text?: string;\n  textProps?: {[key: string]: any};\n}\n\nfunction Spinner(props: Partial<IProps>) {\n  return <div className=\"loader\" {...props} />;\n}\n\nconst Loader = (\n  props: IProps & React.PropsWithoutRef<JSX.IntrinsicElements['div']>\n) => {\n  const {showAfterMs, text, textProps, ...loaderProps} = props;\n  const [showLoaderAfterMs, setShowLoaderAfterMs] = useState<boolean>(false);\n\n  useEffect(() => {\n    /* 200ms is approx. the time a user will notice a stalled, blank screen */\n    const timeoutId =\n      showAfterMs && setTimeout(() => setShowLoaderAfterMs(true), showAfterMs);\n\n    return function cleanup() {\n      timeoutId && clearTimeout(timeoutId);\n    };\n  }, [showAfterMs]);\n\n  return (!showAfterMs || (showAfterMs && showLoaderAfterMs)) && props.text ? (\n    <div className=\"loader-container\">\n      <Spinner {...loaderProps} />\n      <span className=\"loader__text\" {...textProps}>\n        {text}\n      </span>\n    </div>\n  ) : (!showAfterMs || (showAfterMs && showLoaderAfterMs)) && !props.text ? (\n    <Spinner {...loaderProps} />\n  ) : null;\n};\n\nexport default Loader;\n","import {lazy, Suspense} from 'react';\n\ntype WalletIconProps = {\n  providerName: string | undefined;\n};\n\n/**\n * Lazy load SVG's\n */\n\nconst MetaMaskSVG = lazy(() => import('../../assets/svg/MetaMaskSVG'));\n\nconst WalletConnectSVG = lazy(\n  () => import('../../assets/svg/WalletConnectSVG')\n);\n\n// Mapping of provider name to lazy component\nconst walletIconMap: Record<string, JSX.Element> = {\n  injected: <MetaMaskSVG />,\n  walletconnect: <WalletConnectSVG />,\n};\n\nexport function WalletIcon({\n  providerName,\n}: WalletIconProps): JSX.Element | null {\n  if (!providerName || !walletIconMap[providerName]) return null;\n\n  return (\n    <Suspense fallback={null}>\n      <span className=\"walletconnect__wallet-icon\">\n        {walletIconMap[providerName]}\n      </span>\n    </Suspense>\n  );\n}\n","type EtherscanURLProps = {\n  url: string;\n  isPending?: boolean;\n};\n\nexport default function EtherscanURL(props: EtherscanURLProps) {\n  const {url, isPending = false} = props;\n\n  return (\n    <small>\n      <a href={url} rel=\"noopener noreferrer\" target=\"_blank\">\n        {isPending ? 'view progress' : 'view transaction'}\n      </a>\n    </small>\n  );\n}\n","/**\n * WEB3 TYPES\n */\n\n// ...\n\n/**\n * WEB3 ENUMS\n */\n\n/**\n * Mapping of DaoRegistry member flags.\n * This should match the enum (including order) in the `DaoRegistry`. If it does not match,\n * the results of checking the proposal's state via flag will be wrong.\n *\n * @see `MemberFlag` `DaoRegistry.sol`\n * @see `getFlag` `DaoConstants.sol`\n * @see `setFlag` `DaoConstants.sol`\n */\nexport enum MemberFlag {\n  EXISTS,\n}\n\n/**\n * Should match tribute-contracts constants\n *\n * @todo Add other extensions as needs arise\n */\nexport enum ContractAdapterNames {\n  bank = 'bank',\n  configuration = 'configuration',\n  coupon_onboarding = 'coupon-onboarding',\n  dao_registry = 'daoRegistry',\n  distribute = 'distribute',\n  financing = 'financing',\n  guildkick = 'guildkick',\n  managing = 'managing',\n  nft = 'nft',\n  onboarding = 'onboarding',\n  ragequit = 'ragequit',\n  tribute = 'tribute',\n  tribute_nft = 'tribute-nft',\n  voting = 'voting',\n  water = 'water',\n}\n\n/**\n * Should match tribute-contracts constants\n *\n * @todo Add other extensions as needs arise\n */\nexport enum ContractExtensionNames {\n  bank = 'bank',\n  erc20 = 'erc20-ext',\n  nft = 'nft',\n}\n\n/**\n * Should match tribute-contracts constants\n *\n * @todo Add other extensions as needs arise\n */\nexport enum ContractDAOConfigKeys {\n  offchainVotingGracePeriod = 'offchainvoting.gracePeriod',\n  offchainVotingStakingAmount = 'offchainvoting.stakingAmount',\n  offchainVotingVotingPeriod = 'offchainvoting.votingPeriod',\n  onboardingChunkSize = 'onboarding.chunkSize',\n  onboardingMaximumChunks = 'onboarding.maximumChunks',\n  onboardingUnitsPerChunk = 'onboarding.unitsPerChunk',\n  onboardingTokenAddr = 'onboarding.tokenAddr',\n  votingGracePeriod = 'voting.gracePeriod',\n  votingStakingAmount = 'voting.stakingAmount',\n  votingVotingPeriod = 'voting.votingPeriod',\n}\n\nexport enum VoteChoices {\n  Yes = 'Yes',\n  No = 'No',\n}\n\nexport enum Web3TxStatus {\n  STANDBY = 'STANDBY',\n  AWAITING_CONFIRM = 'AWAITING_CONFIRM',\n  PENDING = 'PENDING',\n  FULFILLED = 'FULFILLED',\n  REJECTED = 'REJECTED',\n}\n","import {ToStepNodeResult} from '@openlaw/snapshot-js-erc712/dist/types';\n\n/**\n * @see `IVoting.sol` in tribute-contracts\n */\nexport enum VotingState {\n  NOT_STARTED,\n  TIE,\n  PASS,\n  NOT_PASS,\n  IN_PROGRESS,\n  GRACE_PERIOD,\n}\n\n/**\n * Response when calling `GET snapshot-hub/api/:space/offchain_proof/:merkle_root`\n */\nexport type SnapshotOffchainProofResponse = {\n  merkle_root: string;\n  space: string;\n  steps: ToStepNodeResult[];\n};\n","/**\n * BURN_ADDRESS\n *\n * - e.g. Helpful when detecting no address.\n * - e.g. Helpful for ERC-712 signatures which have no action id (like Governance).\n */\nexport const BURN_ADDRESS: '0x0000000000000000000000000000000000000000' =\n  '0x0000000000000000000000000000000000000000';\n","import {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {SnapshotOffchainProofResponse} from '../voting/types';\n\n/**\n * getOffchainVotingProof\n *\n * Gets a Merkle hex root's steps from Snapshot Hub\n * for verification.\n *\n * @link https://github.com/openlawteam/snapshot-hub\n */\nexport async function getOffchainVotingProof(\n  merkleRootHex: string\n): Promise<SnapshotOffchainProofResponse | undefined> {\n  try {\n    const response = await fetch(\n      `${SNAPSHOT_HUB_API_URL}/api/${SPACE}/offchain_proof/${merkleRootHex}`\n    );\n\n    // Return empty if not found\n    if (response.status === 404) {\n      return undefined;\n    }\n\n    // Some other error occured\n    if (!response.ok) {\n      throw new Error(\n        'Something went wrong while getting the off-chain vote proof.'\n      );\n    }\n\n    return await response.json();\n  } catch (error) {\n    throw error;\n  }\n}\n","import {VoteChoicesIndex} from '@openlaw/snapshot-js-erc712';\n\nimport {normalizeString} from '../../../util/helpers';\nimport {SnapshotProposal} from '../types';\nimport {VoteChoices} from '../../web3/types';\n\nexport function getVoteChosen(\n  votes: SnapshotProposal['votes'],\n  account: string\n): VoteChoices | undefined {\n  const voteEntry = (votes || []).find((ve) =>\n    Object.entries(ve).find(\n      ([address, _voteData]) =>\n        normalizeString(address) === normalizeString(account || '')\n    )\n  );\n\n  if (voteEntry) {\n    const voteData = Object.entries(voteEntry)[0][1];\n    const choice = voteData.msg.payload.choice;\n\n    return choice === VoteChoicesIndex.Yes ? VoteChoices.Yes : VoteChoices.No;\n  }\n\n  return undefined;\n}\n","import {AbiItem} from 'web3-utils/types';\n\nimport {VotingAdapterName} from '../../adapters-extensions/enums';\n\n/**\n * getVotingAdapterABI\n *\n * Gets the ABI for a voting adapter by the adapter's adapter name.\n *\n * @param {VotingAdapterName} votingAdapterName\n * @returns {Promise<AbiItem[]>}\n */\nexport async function getVotingAdapterABI(\n  votingAdapterName: VotingAdapterName\n): Promise<AbiItem[]> {\n  try {\n    switch (votingAdapterName) {\n      // Off-chain optimistic rollup\n      case VotingAdapterName.OffchainVotingContract:\n        const {default: lazyOffchainVotingABI} = await import(\n          '../../../truffle-contracts/OffchainVotingContract.json'\n        );\n\n        return lazyOffchainVotingABI as AbiItem[];\n\n      // On-chain voting\n      case VotingAdapterName.VotingContract:\n        const {default: lazyVotingABI} = await import(\n          '../../../truffle-contracts/VotingContract.json'\n        );\n\n        return lazyVotingABI as AbiItem[];\n\n      default:\n        throw new Error(\n          `No voting adapter name was found for \"${votingAdapterName}\".`\n        );\n    }\n  } catch (error) {\n    throw error;\n  }\n}\n","import {ProposalFlag} from '../types';\n\n/**\n * proposalHasFlag\n *\n * @param flagToCheck\n * @param daoProposalFlag\n * @returns {boolean}\n *\n * @see `ProposalFlag` `DaoRegistry.sol`\n * @see `getFlag` `DaoConstants.sol`\n * @see `setFlag` `DaoConstants.sol`\n */\nexport function proposalHasFlag(\n  flagToCheck: ProposalFlag,\n  daoProposalFlag: number | string\n): boolean {\n  return flagToCheck === Math.log2(Number(daoProposalFlag) + 1) - 1;\n}\n","import {VotingState} from '../voting/types';\n\nexport function proposalHasVotingState(\n  votingStateToCheck: VotingState,\n  votingState: number | string\n): boolean {\n  return VotingState[votingState] === VotingState[votingStateToCheck];\n}\n","import {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {ToStepNodeResult} from '@openlaw/snapshot-js-erc712/dist/types';\n\ntype SubmitOffchainVotingProofArguments = {\n  /**\n   * DAO Adapter address\n   */\n  actionId: string;\n  /**\n   * Blockchain network ID\n   */\n  chainId: number;\n  /**\n   * Hex string of the Merkle root\n   */\n  merkleRoot: string;\n  /**\n   * An array of Merkle tree steps\n   */\n  steps: ToStepNodeResult[];\n  /**\n   * DAO Registry address\n   */\n  verifyingContract: string;\n};\n\n/**\n * submitOffchainVotingProof\n *\n * Submits a Merkle hex root and its steps to Snapshot Hub\n * for verification and storage (if successful).\n *\n * The API endpoint does not have any return data, only a `201` response.\n *\n * @link https://github.com/openlawteam/snapshot-hub\n */\nexport async function submitOffchainVotingProof(\n  data: SubmitOffchainVotingProofArguments\n): Promise<void> {\n  try {\n    const response = await fetch(\n      `${SNAPSHOT_HUB_API_URL}/api/${SPACE}/offchain_proofs`,\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      }\n    );\n\n    if (!response.ok) {\n      throw new Error(\n        'Something went wrong while submitting the off-chain vote proof.'\n      );\n    }\n  } catch (error) {\n    throw error;\n  }\n}\n","import {CoreProposalVoteChoices} from '@openlaw/snapshot-js-erc712';\nimport {VoteChoices} from './types';\n\n/**\n * WEB3 CONFIG for TRIBUTE\n */\n\n// Vote choices should be \"yes\", \"no\" unless Tribute contracts change.\nexport const VOTE_CHOICES: CoreProposalVoteChoices = [\n  VoteChoices.Yes,\n  VoteChoices.No,\n];\n\n// When signing data this is the `primaryType` key's value which is part of the data to sign.\nexport const PRIMARY_TYPE_ERC712 = 'Message';\n\nexport const TX_CYCLE_MESSAGES: string[] = [\n  'Submitting\\u2026',\n  'Working\\u2026',\n  'DAOing\\u2026',\n  'Getting closer\\u2026',\n  'Dreaming of ETH\\u2026',\n];\n","export * from './CycleEllipsis';\n","import React, {useState, useEffect} from 'react';\n\nimport {chooseRandom} from '../../util/helpers';\n\ntype CycleMessageProps = {\n  /**\n   * Use the first item as the default.\n   */\n  useFirstItemStart?: boolean;\n  /**\n   * What is the interval of cycling the message?\n   */\n  intervalMs: number;\n  /**\n   * Provide multiple strings to cycle through.\n   */\n  messages: string[];\n  /**\n   * Render a React Element.\n   * activeMessage is passed in.\n   */\n  render: (m: string) => React.ReactElement;\n};\n\nexport default function CycleMessage(props: CycleMessageProps) {\n  const {intervalMs, messages, useFirstItemStart} = props;\n\n  // Default item at start.\n  const INITIAL_ITEM = useFirstItemStart\n    ? messages[0]\n    : chooseRandom<string>(messages);\n\n  const [activeMessage, setActiveMessage] = useState<string>(INITIAL_ITEM);\n\n  useEffect(() => {\n    const intervalId = setInterval(\n      () =>\n        setActiveMessage((prevMessage) =>\n          chooseRandom<string>(messages, prevMessage)\n        ),\n      intervalMs\n    );\n\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [intervalMs, messages]);\n\n  return props.render(activeMessage);\n}\n","import {useState, useEffect} from 'react';\n\ntype LoaderLargeProps = {\n  // Show waiting effect after some time has elapsed. Prevents the \"sudden\n  // spinner\" UI/UX no-no. Esp. if we could have cached data.\n  showAfterMs?: number;\n};\n\nexport default function LoaderLarge(props: LoaderLargeProps) {\n  const {showAfterMs} = props;\n  const [showLoaderAfterMs, setShowLoaderAfterMs] = useState<boolean>(false);\n\n  useEffect(() => {\n    /* 200ms is approx. the time a user will notice a stalled, blank screen */\n    const timeoutId =\n      showAfterMs && setTimeout(() => setShowLoaderAfterMs(true), showAfterMs);\n\n    return function cleanup() {\n      timeoutId && clearTimeout(timeoutId);\n    };\n  }, [showAfterMs]);\n\n  return !showAfterMs || (showAfterMs && showLoaderAfterMs) ? (\n    <div className=\"loader--large\" aria-label=\"Loading content...\" />\n  ) : null;\n}\n","import Web3 from 'web3';\n\nexport const hasValue = (value: string) => (value !== '' ? true : false);\n\nexport const isEmailValid = (email: string) =>\n  /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i.test(email);\n\nexport const isEthAddressValid = (ethAddress: string) =>\n  Web3.utils.isAddress(ethAddress);\n","import {gql} from '@apollo/client';\n\nexport const GET_DAO = gql`\n  query GetDao($id: ID) {\n    tributeDaos(where: {id: $id}) {\n      id # dao address\n      daoAddress\n      name\n      totalUnits\n    }\n  }\n`;\n","import {gql} from '@apollo/client';\n\nexport const GET_ADAPTERS_AND_EXTENSIONS = gql`\n  query GetAdaptersAndExtensions($daoAddress: String) {\n    tributeDaos(where: {daoAddress: $daoAddress}) {\n      daoAddress\n      adapters {\n        id\n        acl\n        adapterId\n        adapterAddress\n      }\n      extensions {\n        id\n        extensionId\n        extensionAddress\n      }\n    }\n  }\n`;\n","import {gql} from '@apollo/client';\n\nexport const GET_MEMBERS = gql`\n  query GetMembers($daoAddress: String) {\n    tributeDaos(where: {daoAddress: $daoAddress}) {\n      members(orderBy: createdAt, orderDirection: desc) {\n        createdAt\n        address: memberAddress\n        delegateKey\n        isDelegated\n        units\n        didFullyRagequit\n      }\n    }\n  }\n`;\n","import {gql} from '@apollo/client';\n\nexport const GET_TOKEN_HOLDER_BALANCES = gql`\n  query GetTokenHolderBalances($tokenAddress: String) {\n    tokens(where: {tokenAddress: $tokenAddress}) {\n      symbol\n      tokenAddress\n      holders {\n        balance\n        member {\n          id\n          delegateKey\n        }\n      }\n    }\n  }\n`;\n","import {ApolloLink} from '@apollo/client';\nimport {onError} from '@apollo/client/link/error';\nimport {Store} from 'redux';\n\nimport {setSubgraphNetworkStatus} from '../store/actions';\nimport {SubgraphNetworkStatus} from '../store/subgraphNetworkStatus/types';\nimport {StoreState} from '../store/types';\n\n/**\n * handleSubgraphError\n *\n * Handles an error from The Graph's GQL server at the Apollo\n * Link level.\n *\n * Handles network errors from The Graph's GQL server.\n *\n * About network errors from the Apollo Docs:\n *\n *   \"Network errors occur \"These are errors encountered while attempting\n *    to communicate with your GraphQL server, usually resulting in a\n *    4xx or 5xx response status code (and no data).\"\n *\n * We do not handle GQL errors that arise from individual queries.\n * Perhaps it best to handle those inside of the concerned components\n * (i.e. IF query error || subgraph is down THEN fallback)\n *\n * About GQL errors from the Apollo Docs:\n *\n *  - Syntax errors (e.g., a query was malformed)\n *  - Validation errors (e.g., a query included a schema field that doesn't exist)\n *  - Resolver errors (e.g., an error occurred while attempting to populate a query field)\n *\n * @param {Store} store\n * @returns {ApolloLink}\n * @link https://www.apollographql.com/docs/react/data/error-handling\n */\nexport function handleSubgraphError(store: Store): ApolloLink {\n  return onError(({/* graphQLErrors */ networkError}) => {\n    if (networkError) {\n      const reduxStateNotYetSet =\n        (store.getState() as StoreState).subgraphNetworkStatus.status !==\n        SubgraphNetworkStatus.ERR;\n\n      if (reduxStateNotYetSet) {\n        store.dispatch(\n          setSubgraphNetworkStatus({status: SubgraphNetworkStatus.ERR})\n        );\n\n        // Show error once\n        console.error(`[Subgraph network error]: ${networkError}`);\n      }\n    }\n\n    // Reset when there's no more network error\n    if (!networkError) {\n      const reduxStateNotYetSet =\n        (store.getState() as StoreState).subgraphNetworkStatus.status !==\n        SubgraphNetworkStatus.OK;\n\n      if (reduxStateNotYetSet) {\n        store.dispatch(\n          setSubgraphNetworkStatus({status: SubgraphNetworkStatus.OK})\n        );\n      }\n    }\n  });\n}\n","/**\n * FOR HIGH REUSE TYPES\n *\n * For any other more specific types, co-locate them in either:\n *\n * 1) The actual code file.\n * 2) In a type file in the location of the code files which mainly use the types.\n *\n * @see https://kentcdodds.com/blog/colocation\n */\n\nexport type EnvironmentName = 'localhost' | 'development' | 'production';\n\nexport enum AsyncStatus {\n  STANDBY = 'STANDBY',\n  PENDING = 'PENDING',\n  FULFILLED = 'FULFILLED',\n  REJECTED = 'REJECTED',\n}\n\nexport interface MetaMaskRPCError extends Error {\n  code: number;\n}\n","export enum SubgraphNetworkStatus {\n  OK = 'OK',\n  ERR = 'ERR',\n}\n\nexport type SubgraphNetworkStatusState = {\n  status: SubgraphNetworkStatus;\n};\n","import {CLEAR_CONNECTED_MEMBER, SET_CONNECTED_MEMBER} from './actions';\nimport {ConnectedMemberState} from './types';\n\nconst INITIAL_STATE = null;\n\nexport default function reducer(\n  state: ConnectedMemberState = INITIAL_STATE,\n  action: any\n) {\n  const {type, ...payload} = action;\n\n  switch (type) {\n    case SET_CONNECTED_MEMBER:\n      return setConnectedMemberReducer(state, payload);\n    case CLEAR_CONNECTED_MEMBER:\n      return clearConnectedMemberReducer();\n    default:\n      return state;\n  }\n}\n\nfunction setConnectedMemberReducer(\n  state: Partial<ConnectedMemberState>,\n  payload: Record<string, any>\n) {\n  return {...state, ...payload};\n}\n\nfunction clearConnectedMemberReducer() {\n  return INITIAL_STATE;\n}\n","import {CONNECT_MODAL_CLOSE, CONNECT_MODAL_OPEN} from './actions';\nimport {ConnectModalState} from './types';\n\nconst INITIAL_STATE = {\n  isOpen: false,\n};\n\nexport default function reducer(\n  state: ConnectModalState = INITIAL_STATE,\n  action: any\n) {\n  const {type} = action;\n\n  switch (type) {\n    case CONNECT_MODAL_CLOSE:\n      return connectModalClose(state);\n    case CONNECT_MODAL_OPEN:\n      return connectModalOpen(state);\n    default:\n      return state;\n  }\n}\n\nfunction connectModalClose(\n  state: Partial<ConnectModalState>\n): ConnectModalState {\n  return {...state, isOpen: false};\n}\n\nfunction connectModalOpen(\n  state: Partial<ConnectModalState>\n): ConnectModalState {\n  return {...state, isOpen: true};\n}\n","import {\n  CLEAR_CONTRACTS,\n  CONTRACT_BANK_ADAPTER,\n  CONTRACT_BANK_EXTENSION,\n  CONTRACT_BANK_FACTORY,\n  CONTRACT_CONFIGURATION,\n  CONTRACT_COUPON_ONBOARDING,\n  CONTRACT_DAO_FACTORY,\n  CONTRACT_DAO_REGISTRY_ADAPTER,\n  CONTRACT_DAO_REGISTRY,\n  CONTRACT_DISTRIBUTE,\n  CONTRACT_ERC20_EXTENSION,\n  CONTRACT_FINANCING,\n  CONTRACT_GUILDKICK,\n  CONTRACT_MANAGING,\n  CONTRACT_NFT_ADAPTER,\n  CONTRACT_NFT_EXTENSION,\n  CONTRACT_ONBOARDING,\n  CONTRACT_RAGEQUIT,\n  CONTRACT_TRIBUTE_NFT,\n  CONTRACT_TRIBUTE,\n  CONTRACT_VOTING_OP_ROLLUP,\n  CONTRACT_VOTING,\n  CONTRACT_WATER,\n} from '../actions';\nimport {ContractsState} from './types';\n\nconst initialState = {\n  BankAdapterContract: null,\n  BankExtensionContract: null,\n  BankFactoryContract: null,\n  ConfigurationContract: null,\n  CouponOnboardingContract: null,\n  DaoFactoryContract: null,\n  DaoRegistryAdapterContract: null,\n  DaoRegistryContract: null,\n  DistributeContract: null,\n  ERC20ExtensionContract: null,\n  FinancingContract: null,\n  GuildBankContract: null,\n  ManagingContract: null,\n  NFTAdapterContract: null,\n  NFTExtensionContract: null,\n  OnboardingContract: null,\n  RagequitContract: null,\n  TributeContract: null,\n  TributeNFTContract: null,\n  VotingContract: null,\n  WaterContract: null,\n};\n\nexport default function reducer(\n  state: ContractsState = initialState,\n  action: any\n) {\n  const {type, ...payload} = action;\n\n  switch (type) {\n    case CLEAR_CONTRACTS:\n      return clearContracts(state);\n    case CONTRACT_BANK_ADAPTER:\n      return contractBankAdapter(state, payload);\n    case CONTRACT_BANK_EXTENSION:\n      return contractBankExtension(state, payload);\n    case CONTRACT_BANK_FACTORY:\n      return contractBankFactory(state, payload);\n    case CONTRACT_CONFIGURATION:\n      return contractConfiguration(state, payload);\n    case CONTRACT_COUPON_ONBOARDING:\n      return contractCouponOnboarding(state, payload);\n    case CONTRACT_DAO_FACTORY:\n      return contractDAOFactory(state, payload);\n    case CONTRACT_DAO_REGISTRY:\n      return contractDAORegistry(state, payload);\n    case CONTRACT_DAO_REGISTRY_ADAPTER:\n      return contractDaoRegistryAdapter(state, payload);\n    case CONTRACT_DISTRIBUTE:\n      return contractDistribute(state, payload);\n    case CONTRACT_ERC20_EXTENSION:\n      return contractERC20Extension(state, payload);\n    case CONTRACT_FINANCING:\n      return contractFinancing(state, payload);\n    case CONTRACT_GUILDKICK:\n      return contractGuildBank(state, payload);\n    case CONTRACT_MANAGING:\n      return contractManaging(state, payload);\n    case CONTRACT_NFT_ADAPTER:\n      return contractNFTAdapter(state, payload);\n    case CONTRACT_NFT_EXTENSION:\n      return contractNFTExtension(state, payload);\n    case CONTRACT_ONBOARDING:\n      return contractOnboarding(state, payload);\n    case CONTRACT_RAGEQUIT:\n      return contractRagequit(state, payload);\n    case CONTRACT_TRIBUTE:\n      return contractTribute(state, payload);\n    case CONTRACT_TRIBUTE_NFT:\n      return contractTributeNFT(state, payload);\n    case CONTRACT_VOTING:\n      return contractVoting(state, payload);\n    case CONTRACT_VOTING_OP_ROLLUP:\n      return contractVoting(state, payload);\n    case CONTRACT_WATER:\n      return contractWater(state, payload);\n\n    default:\n      return state;\n  }\n}\n\nfunction clearContracts(state: ContractsState) {\n  return {...state, ...initialState};\n}\n\nfunction contractBankFactory(state: ContractsState, payload: any) {\n  return {...state, BankFactoryContract: {...payload}};\n}\n\nfunction contractDAOFactory(state: ContractsState, payload: any) {\n  return {...state, DaoFactoryContract: {...payload}};\n}\n\nfunction contractDAORegistry(state: ContractsState, payload: any) {\n  return {...state, DaoRegistryContract: {...payload}};\n}\n\nfunction contractDaoRegistryAdapter(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, DaoRegistryAdapterContract: {...payload}};\n}\n\nfunction contractBankExtension(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, BankExtensionContract: {...payload}};\n}\n\nfunction contractConfiguration(state: ContractsState, payload: any) {\n  return {...state, ConfigurationContract: {...payload}};\n}\n\nfunction contractDistribute(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, DistributeContract: {...payload}};\n}\n\nfunction contractFinancing(state: ContractsState, payload: any) {\n  return {...state, FinancingContract: {...payload}};\n}\n\nfunction contractGuildBank(state: ContractsState, payload: any) {\n  return {...state, GuildBankContract: {...payload}};\n}\n\nfunction contractOnboarding(state: ContractsState, payload: any) {\n  return {...state, OnboardingContract: {...payload}};\n}\n\nfunction contractRagequit(state: ContractsState, payload: any) {\n  return {...state, RagequitContract: {...payload}};\n}\n\nfunction contractTribute(state: ContractsState, payload: any): ContractsState {\n  return {...state, TributeContract: {...payload}};\n}\n\nfunction contractVoting(state: ContractsState, payload: any): ContractsState {\n  return {...state, VotingContract: {...payload}};\n}\n\nfunction contractWater(state: ContractsState, payload: any): ContractsState {\n  return {...state, WaterContract: {...payload}};\n}\n\nfunction contractManaging(state: ContractsState, payload: any): ContractsState {\n  return {...state, ManagingContract: {...payload}};\n}\n\nfunction contractBankAdapter(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, BankAdapterContract: {...payload}};\n}\n\nfunction contractNFTAdapter(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, NFTAdapterContract: {...payload}};\n}\n\nfunction contractTributeNFT(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, TributeNFTContract: {...payload}};\n}\n\nfunction contractCouponOnboarding(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, CouponOnboardingContract: {...payload}};\n}\n\nfunction contractNFTExtension(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, NFTExtensionContract: {...payload}};\n}\n\nfunction contractERC20Extension(\n  state: ContractsState,\n  payload: any\n): ContractsState {\n  return {...state, ERC20ExtensionContract: {...payload}};\n}\n","import {SET_SUBGRAPH_NETWORK_STATUS} from './actions';\nimport {SubgraphNetworkStatus, SubgraphNetworkStatusState} from './types';\n\nconst INITIAL_STATE = {\n  status: SubgraphNetworkStatus.OK,\n};\n\nexport default function reducer(\n  state: SubgraphNetworkStatusState = INITIAL_STATE,\n  action: any\n) {\n  const {type, ...payload} = action;\n\n  switch (type) {\n    case SET_SUBGRAPH_NETWORK_STATUS:\n      return setSubgraphNetworkStatus(state, payload);\n    default:\n      return state;\n  }\n}\n\nfunction setSubgraphNetworkStatus(\n  state: Partial<SubgraphNetworkStatusState>,\n  payload: Record<string, any>\n) {\n  return {...state, ...payload};\n}\n","import {combineReducers} from 'redux';\n\nimport connectedMember from './connectedMember/reducers';\nimport connectModal from './connectModal/reducers';\nimport contracts from './contracts/reducers';\nimport subgraphNetworkStatus from './subgraphNetworkStatus/reducers';\n\nexport default combineReducers({\n  connectModal,\n  connectedMember,\n  contracts,\n  subgraphNetworkStatus,\n});\n","import {applyMiddleware, createStore} from 'redux';\nimport {composeWithDevTools} from 'redux-devtools-extension/logOnlyInProduction';\nimport thunk from 'redux-thunk';\n\nimport rootReducer from './reducers';\n\nexport const store = createStore(\n  rootReducer,\n  composeWithDevTools(applyMiddleware(thunk))\n);\n","import {useLocation} from 'react-router-dom';\n\nexport default function Footer() {\n  /**\n   * Their hooks\n   */\n\n  const location = useLocation();\n\n  /**\n   * Variables\n   */\n\n  const isIndexPath = location.pathname === '/';\n\n  /**\n   * Render\n   */\n\n  // Don't display footer if we're on the index page\n  if (isIndexPath) return null;\n\n  return <div className=\"footer\"></div>;\n}\n","import {lazy, Suspense, useState} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {useEffect} from 'react';\n\nimport {\n  useIsDefaultChain,\n  useMaybeContractWallet,\n  useWeb3Modal,\n} from './components/web3/hooks';\nimport {AsyncStatus} from './util/types';\nimport {connectModalClose, connectModalOpen} from './store/actions';\nimport {StoreState} from './store/types';\nimport {useLocation} from 'react-router-dom';\n\n/**\n * Lazy load ConnectWalletModal only when open\n */\nconst ConnectWalletModal = lazy(\n  () => import('./components/web3/ConnectWalletModal')\n);\n\nexport default function GlobalConnectWalletModal() {\n  /**\n   * Selectors\n   */\n\n  const isConnectModalOpen: boolean = useSelector(\n    ({connectModal}: StoreState) => connectModal.isOpen\n  );\n\n  /**\n   * State\n   */\n\n  const [modalProps, setModalProps] = useState<\n    Parameters<typeof ConnectWalletModal>[0]['modalProps']\n  >({\n    isOpen: isConnectModalOpen,\n    onRequestClose: () => {\n      dispatch(connectModalClose());\n    },\n  });\n\n  /**\n   * Our hooks\n   */\n\n  const {account, connected, initialCachedConnectorCheckStatus, web3Instance} =\n    useWeb3Modal();\n\n  const {isDefaultChain} = useIsDefaultChain();\n\n  const maybeContractWallet = useMaybeContractWallet(\n    account,\n    web3Instance?.currentProvider\n  );\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch();\n  const {pathname} = useLocation();\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    setModalProps((prevState) => ({...prevState, isOpen: isConnectModalOpen}));\n  }, [isConnectModalOpen]);\n\n  /**\n   * Effects\n   */\n\n  /**\n   * Will automatically re-show the modal (on app `pathname` change) only when:\n   *  - If wrong chain\n   *  - If smart contract wallet\n   */\n  useEffect(() => {\n    if (initialCachedConnectorCheckStatus === AsyncStatus.FULFILLED) {\n      const shouldAutomaticallyOpenModal: boolean =\n        connected && (!isDefaultChain || maybeContractWallet) ? true : false;\n\n      shouldAutomaticallyOpenModal\n        ? dispatch(connectModalOpen())\n        : dispatch(connectModalClose());\n    }\n  }, [\n    connected,\n    dispatch,\n    initialCachedConnectorCheckStatus,\n    isDefaultChain,\n    maybeContractWallet,\n    pathname,\n  ]);\n\n  /**\n   * Render\n   */\n\n  if (!isConnectModalOpen) return null;\n\n  return (\n    <Suspense fallback={null}>\n      <ConnectWalletModal\n        // @todo Look into more generic way to render errors in the modal\n        maybeContractWallet={maybeContractWallet}\n        modalProps={modalProps}\n      />\n    </Suspense>\n  );\n}\n","import {Helmet} from 'react-helmet';\n\nexport default function Head() {\n  return (\n    <Helmet>\n      <title>compost.energy</title>\n      <meta name=\"description\" content=\"Managing our gardening community\" />\n    </Helmet>\n  );\n}\n","interface LogoProps {\n  size?: 'small' | 'medium' | 'large' | '';\n}\n\nexport default function Logo(props: LogoProps) {\n  return (\n    <div className={`logo ${props.size ? `logo--${props.size}` : ''}`}>\n      compost.energy\n    </div>\n  );\n}\n","import React from 'react';\n\nimport Logo from './Logo';\n\n/**\n * ModalLogo\n * This component is used for modal menu\n */\nexport function ModalLogo() {\n  return (\n    <div className=\"logo-container logo-container--center\">\n      <Logo size=\"small\" />\n    </div>\n  );\n}\n\n/**\n * LeftLogo\n * This component is used for main pages\n */\nexport function LeftLogo() {\n  return (\n    <div className=\"logo-container logo-container--header\">\n      <Logo size=\"medium\" />\n    </div>\n  );\n}\n\n/**\n * CenterLogo\n * This component is used for splash page\n */\nexport function CenterLogo() {\n  return (\n    <div className=\"logo-container logo-container--center\">\n      <Logo size=\"large\" />\n    </div>\n  );\n}\n","import {isMobile} from 'react-device-detect';\nimport {useDispatch} from 'react-redux';\n\nimport {connectModalOpen} from '../../store/actions';\nimport {truncateEthAddress} from '../../util/helpers';\nimport {useIsDefaultChain} from './hooks';\nimport {useWeb3Modal} from './hooks';\nimport {WalletIcon} from './';\n\ntype CustomWalletTextProps = {\n  account: ReturnType<typeof useWeb3Modal>['account'];\n  connected: ReturnType<typeof useWeb3Modal>['connected'];\n  isMobile: typeof isMobile;\n};\n\ntype ConnectWalletButtonProps = {\n  customWalletText?: ((o: CustomWalletTextProps) => string) | string;\n  showWalletETHBadge?: boolean;\n};\n\nexport default function ConnectWalletButton({\n  customWalletText,\n  // Defaults to `true`\n  showWalletETHBadge = true,\n}: ConnectWalletButtonProps): JSX.Element {\n  /**\n   * Our hooks\n   */\n\n  const {account, connected, web3Modal} = useWeb3Modal();\n\n  const {isDefaultChain} = useIsDefaultChain();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch();\n\n  /**\n   * Variables\n   */\n\n  const isWrongNetwork: boolean = isDefaultChain === false;\n\n  /**\n   * Functions\n   */\n\n  function getWalletText(): string {\n    if (customWalletText) {\n      return typeof customWalletText === 'function'\n        ? customWalletText({account, connected, isMobile})\n        : customWalletText;\n    }\n\n    if (account) {\n      return truncateEthAddress(account);\n    }\n\n    return 'Connect';\n  }\n\n  /**\n   * Return\n   */\n\n  return (\n    <button\n      className={`walletconnect__connect-button \n        ${\n          isWrongNetwork && connected\n            ? 'walletconnect__connect-button--error'\n            : ''\n        }`}\n      onClick={() => {\n        dispatch(connectModalOpen());\n      }}>\n      <span\n        className={`connect-button-text ${\n          connected ? 'connect-button-text--ethAddress' : ''\n        }`}>\n        {getWalletText()}\n      </span>\n\n      {isWrongNetwork && connected && <span>Wrong Network</span>}\n\n      {showWalletETHBadge && (\n        <WalletIcon providerName={web3Modal?.cachedProvider} />\n      )}\n    </button>\n  );\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {StoreState} from '../../../store/types';\nimport {ERC20RegisterDetails} from '../DaoToken';\nimport {AsyncStatus} from '../../../util/types';\n\ntype UseDaoTokenDetailsReturn = {\n  daoTokenDetails: ERC20RegisterDetails | undefined;\n  daoTokenDetailsError: Error | undefined;\n  daoTokenDetailsStatus: AsyncStatus;\n};\n\n/**\n * useDaoTokenDetails\n *\n * Gets DAO token details from ERC20Extension contract.\n *\n * @returns {UseDaoTokenDetailsReturn}\n */\nexport function useDaoTokenDetails(): UseDaoTokenDetailsReturn {\n  /**\n   * Selectors\n   */\n\n  const ERC20ExtensionContract = useSelector(\n    (state: StoreState) => state.contracts?.ERC20ExtensionContract\n  );\n\n  /**\n   * State\n   */\n\n  const [daoTokenDetails, setDaoTokenDetails] =\n    useState<ERC20RegisterDetails>();\n  const [daoTokenDetailsStatus, setDaoTokenDetailsStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n  const [daoTokenDetailsError, setDaoTokenDetailsError] = useState<Error>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const getDaoTokenDetailsCached = useCallback(getDaoTokenDetails, [\n    ERC20ExtensionContract,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getDaoTokenDetailsCached();\n  }, [getDaoTokenDetailsCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getDaoTokenDetails() {\n    if (!ERC20ExtensionContract) return;\n\n    try {\n      setDaoTokenDetailsStatus(AsyncStatus.PENDING);\n\n      const symbol = await ERC20ExtensionContract.instance.methods\n        .symbol()\n        .call();\n      const decimals = await ERC20ExtensionContract.instance.methods\n        .decimals()\n        .call();\n\n      setDaoTokenDetails({\n        address: ERC20ExtensionContract.contractAddress,\n        symbol,\n        decimals: Number(decimals),\n        image: `${window.location.origin}/favicon.ico`,\n      });\n\n      setDaoTokenDetailsStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      console.log(error);\n      setDaoTokenDetails(undefined);\n      setDaoTokenDetailsError(error);\n      setDaoTokenDetailsStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  return {daoTokenDetails, daoTokenDetailsError, daoTokenDetailsStatus};\n}\n","import {useCallback, useEffect, useState} from 'react';\n\nimport FadeIn from '../../components/common/FadeIn';\nimport {useWeb3Modal} from '../../components/web3/hooks';\nimport {useTokenHolderBalances} from './hooks';\nimport {formatNumber} from '../../util/helpers';\nimport {ETHERSCAN_URLS} from '../../config';\n\nexport type ERC20HolderDetails = {\n  symbol: string;\n  balance: number;\n  tokenAddress: string;\n};\n\ntype DaoTokenHolderProps = {\n  backgroundColor?: string;\n  border?: string;\n  color?: string;\n  customStyles?: Record<string, string>;\n};\n\nconst image = `${window.location.origin}/favicon.ico`;\n\nconst toDataURL = (url: string) =>\n  fetch(url)\n    .then((response) => response.blob())\n    .then(\n      (blob) =>\n        new Promise((resolve, reject) => {\n          const reader = new FileReader();\n          reader.onloadend = () => resolve(reader.result);\n          reader.onerror = reject;\n          reader.readAsDataURL(blob);\n        })\n    );\n\nexport default function DaoTokenHolder({\n  customStyles,\n  ...badgeStyles\n}: DaoTokenHolderProps): JSX.Element {\n  /**\n   * State\n   */\n\n  const [tokenHolder, setTokenHolder] = useState<ERC20HolderDetails>();\n  const [tokenImageUrl, setTokenImageURL] = useState<string | undefined>();\n  const [tokenEtherscanURL, setTokenEtherscanURL] = useState<string>('');\n\n  /**\n   * Our hooks\n   */\n\n  const {tokenHolderBalances} = useTokenHolderBalances();\n  const {account, networkId} = useWeb3Modal();\n\n  /**\n   * Cached callbacks\n   */\n\n  const getTokenImageCallback = useCallback(getTokenImage, []);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    setTokenHolder(undefined);\n\n    if (account && tokenHolderBalances) {\n      const {holders, symbol, tokenAddress} = tokenHolderBalances;\n\n      const holderData = holders?.find(\n        (holder: any) =>\n          holder.member?.id.toLowerCase() === account.toLowerCase()\n      );\n\n      holderData &&\n        setTokenHolder({\n          balance: holderData.balance,\n          tokenAddress,\n          symbol,\n        });\n\n      account &&\n        networkId &&\n        setTokenEtherscanURL(\n          `${ETHERSCAN_URLS[networkId]}/token/${tokenAddress}?a=${account}`\n        );\n\n      getTokenImageCallback();\n    }\n  }, [account, networkId, tokenHolderBalances, getTokenImageCallback]);\n\n  /**\n   * Functions\n   */\n\n  function getTokenImage() {\n    try {\n      toDataURL(image).then((dataUrl: any) => {\n        dataUrl && setTokenImageURL(dataUrl);\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  if (tokenHolder) {\n    return (\n      <FadeIn>\n        <a\n          className=\"daotokenholder__button\"\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n          href={tokenEtherscanURL}\n          style={{...badgeStyles, ...customStyles}}>\n          <span className=\"daotokenholder__balance\">\n            {formatNumber(tokenHolder.balance)}\n          </span>\n          <span className=\"daotokenholder__symbol\">{tokenHolder.symbol}</span>\n\n          {tokenImageUrl && <img src={tokenImageUrl} alt=\"Token Icon\" />}\n        </a>\n      </FadeIn>\n    );\n  }\n\n  return <></>;\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\nimport {useLazyQuery} from '@apollo/react-hooks';\n\nimport {StoreState} from '../../../store/types';\nimport {GET_TOKEN_HOLDER_BALANCES} from '../../../gql';\n\ntype UseTokenHolderBalancesReturn = {\n  tokenHolderBalances: Record<string, any> | undefined;\n  gqlError: Error | undefined;\n};\n\n/**\n * useTokenHolderBalances\n *\n * This component queries The Graph API to get data on the token holders\n *\n * @returns {UseTokenHolderBalancesReturn}\n */\nexport function useTokenHolderBalances(): UseTokenHolderBalancesReturn {\n  /**\n   * Selectors\n   */\n\n  const erc20ExtensionContract = useSelector(\n    (s: StoreState) => s.contracts?.ERC20ExtensionContract\n  );\n\n  const connectedMember = useSelector((s: StoreState) => s.connectedMember);\n\n  /**\n   * GQL Query\n   */\n\n  const [\n    getTokenHolderBalances,\n    {called, loading, data, error, startPolling, stopPolling},\n  ] = useLazyQuery(GET_TOKEN_HOLDER_BALANCES, {\n    variables: {\n      tokenAddress: erc20ExtensionContract?.contractAddress.toLowerCase(),\n    },\n  });\n\n  /**\n   * State\n   */\n\n  const [tokenHolderBalances, setTokenHolderBalances] = useState<\n    Record<string, any> | undefined\n  >();\n  const [gqlError, setGqlError] = useState<Error>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const getTokenBalanceCallback = useCallback(getTokenBalance, [\n    erc20ExtensionContract?.contractAddress,\n    data,\n    error,\n    loading,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!called) {\n      getTokenHolderBalances();\n    }\n  }, [called, getTokenHolderBalances]);\n\n  useEffect(() => {\n    if (!loading && erc20ExtensionContract?.contractAddress) {\n      getTokenBalanceCallback();\n    }\n  }, [\n    erc20ExtensionContract?.contractAddress,\n    getTokenBalanceCallback,\n    loading,\n  ]);\n\n  // When the `SET_CONNECTED_MEMBER` redux action is dispatched in other\n  // components (to refetch the connected user's member status info) the\n  // `useSelector` hook above will return a new `connectedMember` object. By\n  // default, the `useEffect` hook uses a strict equality comparison which will\n  // consider the new object a changed value (even if the individual fields are\n  // the same from the previous `connectedMember` store state). This change is\n  // used to trigger a refresh of the `GET_TOKEN_HOLDER_BALANCES` query result\n  // so any change to the connected token holder's balance can be shown in the\n  // nav badge without having to do a page reload.\n  useEffect(() => {\n    // a single refetch may not be enough to catch any token balance change so\n    // we poll but only for a short time period\n    connectedMember && startPolling && startPolling(2000);\n\n    const pollingTimeoutId = stopPolling && setTimeout(stopPolling, 10000);\n\n    return function cleanup() {\n      pollingTimeoutId && clearTimeout(pollingTimeoutId);\n    };\n  }, [connectedMember, startPolling, stopPolling]);\n\n  /**\n   * Functions\n   */\n\n  function getTokenBalance() {\n    try {\n      if (!loading && data) {\n        setTokenHolderBalances(data.tokens[0]);\n        if (data.tokens.length === 0) {\n          const error = new Error(\n            `\"${erc20ExtensionContract?.contractAddress}\" erc20 address not found.`\n          );\n          throw error;\n        }\n      } else {\n        if (error) {\n          const error = new Error(\n            `\"${erc20ExtensionContract?.contractAddress}\" is not a valid erc20 address.`\n          );\n\n          throw error;\n        }\n      }\n    } catch (error) {\n      setGqlError(error);\n    }\n  }\n\n  return {tokenHolderBalances, gqlError};\n}\n","import Media from 'react-media';\nimport {NavLink} from 'react-router-dom';\n\nimport Web3ModalButton from './web3/Web3ModalButton';\nimport DaoTokenHolder from './dao-token/DaoTokenHolder';\n\nexport function NavLinks() {\n  return (\n    <nav role=\"navigation\" id=\"navigation\">\n      <ul className=\"nav__list\" data-testid=\"nav__list\">\n        <li tabIndex={0}>\n          <NavLink to=\"/membership\">\n            <span>Membership</span>\n          </NavLink>\n        </li>\n        <li tabIndex={0}>\n          <NavLink to=\"/governance\">\n            <span>Governance</span>\n          </NavLink>\n        </li>\n        <li tabIndex={0}>\n          <NavLink to=\"/transfers\">\n            <span>Transfer</span>\n          </NavLink>\n        </li>\n        <li tabIndex={0}>\n          <NavLink to=\"/tributes\">\n            <span>Tribute</span>\n          </NavLink>\n        </li>\n        <li tabIndex={0}>\n          <NavLink to=\"/water\">\n            <span>Water</span>\n          </NavLink>\n        </li>\n      </ul>\n    </nav>\n  );\n}\n\nexport default function Nav() {\n  /**\n   * Render\n   */\n\n  return (\n    <Media query=\"(max-width: 62em)\">\n      {(_matches: boolean) => (\n        <div className=\"nav-header\">\n          <div className=\"nav-header__menu-container\">\n            {/* NAV */}\n            <NavLinks />\n            <DaoTokenHolder border={'2px solid #000'} />\n            <div className=\"nav-header__walletconnect-button-container\">\n              <Web3ModalButton />\n            </div>\n          </div>\n        </div>\n      )}\n    </Media>\n  );\n}\n","import {Link} from 'react-router-dom';\n\nimport {LeftLogo} from './logo';\nimport Nav from './Nav';\n\nexport default function Header() {\n  /**\n   * Functions\n   */\n\n  // Render the location with a link\n  function RenderLogo(props: React.PropsWithChildren<any>) {\n    return <Link to=\"/\">{props.children}</Link>;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <header className=\"header\">\n      <RenderLogo>\n        <LeftLogo />\n      </RenderLogo>\n\n      <div className=\"header__nav-container\">\n        <Nav />\n      </div>\n    </header>\n  );\n}\n","import Web3 from 'web3';\n\nimport {DaoAdapterConstants, DaoExtensionConstants} from './enums';\nimport {AclFlag} from './types';\n\nexport function getAdapterOrExtensionId(\n  adapterName: DaoAdapterConstants | DaoExtensionConstants\n): string {\n  return sha3(adapterName) as string;\n}\n\n/**\n * getAccessControlLayer\n *\n * @param adapterName\n */\nexport function getAccessControlLayer(\n  adapterOrExtensionName: string\n): Record<string, any> {\n  const adapterAndExtensionFlags: Record<\n    | DaoAdapterConstants\n    | DaoExtensionConstants.BANK\n    | DaoExtensionConstants.NFT,\n    any\n  > = {\n    [DaoExtensionConstants.BANK]: {},\n    [DaoAdapterConstants.CONFIGURATION]: {\n      SUBMIT_PROPOSAL: true,\n      PROCESS_PROPOSAL: true,\n      SPONSOR_PROPOSAL: true,\n      SET_CONFIGURATION: true,\n    },\n    [DaoAdapterConstants.DISTRIBUTE]: {\n      SUBMIT_PROPOSAL: true,\n      SPONSOR_PROPOSAL: true,\n      PROCESS_PROPOSAL: true,\n      INTERNAL_TRANSFER: true,\n    },\n    [DaoAdapterConstants.EXECUTION]: {},\n    [DaoAdapterConstants.TRIBUTE]: {\n      SUBMIT_PROPOSAL: true,\n      SPONSOR_PROPOSAL: true,\n      PROCESS_PROPOSAL: true,\n      NEW_MEMBER: true,\n      ADD_TO_BALANCE: true,\n      REGISTER_NEW_TOKEN: true,\n    },\n    [DaoAdapterConstants.FINANCING]: {\n      SUBMIT_PROPOSAL: true,\n      SPONSOR_PROPOSAL: true,\n      PROCESS_PROPOSAL: true,\n      ADD_TO_BALANCE: true,\n      SUB_FROM_BALANCE: true,\n    },\n    [DaoAdapterConstants.GUILDKICK]: {\n      SUBMIT_PROPOSAL: true,\n      SPONSOR_PROPOSAL: true,\n      PROCESS_PROPOSAL: true,\n      SUB_FROM_BALANCE: true,\n      ADD_TO_BALANCE: true,\n      JAIL_MEMBER: true,\n      UNJAIL_MEMBER: true,\n      INTERNAL_TRANSFER: true,\n    },\n    [DaoAdapterConstants.MANAGING]: {\n      SUBMIT_PROPOSAL: true,\n      PROCESS_PROPOSAL: true,\n      SPONSOR_PROPOSAL: true,\n      REMOVE_ADAPTER: true,\n      ADD_ADAPTER: true,\n    },\n    [DaoAdapterConstants.OFFCHAINVOTING]: {},\n    [DaoAdapterConstants.ONBOARDING]: {\n      SUBMIT_PROPOSAL: true,\n      SPONSOR_PROPOSAL: true,\n      PROCESS_PROPOSAL: true,\n      ADD_TO_BALANCE: true,\n      UPDATE_DELEGATE_KEY: true,\n      NEW_MEMBER: true,\n    },\n    [DaoAdapterConstants.NONVOTING_ONBOARDING]: {},\n    [DaoAdapterConstants.RAGEQUIT]: {\n      SUB_FROM_BALANCE: true,\n      JAIL_MEMBER: true,\n      UNJAIL_MEMBER: true,\n      INTERNAL_TRANSFER: true,\n    },\n    [DaoAdapterConstants.VOTING]: {},\n    [DaoAdapterConstants.WATER]: {},\n    [DaoAdapterConstants.BANK]: {\n      WITHDRAW: true,\n      SUB_FROM_BALANCE: true,\n      UPDATE_TOKEN: true,\n    },\n    [DaoAdapterConstants.NFT]: {\n      COLLECT_NFT: true,\n    },\n    [DaoAdapterConstants.COUPON_ONBOARDING]: {\n      SUBMIT_PROPOSAL: false,\n      ADD_TO_BALANCE: true,\n      UPDATE_DELEGATE_KEY: false,\n      NEW_MEMBER: true,\n    },\n    [DaoAdapterConstants.TRIBUTE_NFT]: {\n      SUBMIT_PROPOSAL: true,\n      NEW_MEMBER: true,\n      ADD_TO_BALANCE: true,\n      COLLECT_NFT: true,\n    },\n    [DaoExtensionConstants.NFT]: {\n      WITHDRAW_NFT: true,\n      COLLECT_NFT: true,\n      INTERNAL_TRANSFER: true,\n    },\n    [DaoAdapterConstants.DAO_REGISTRY]: {\n      UPDATE_DELEGATE_KEY: true,\n    },\n  };\n\n  const flags = adapterAndExtensionFlags[adapterOrExtensionName];\n\n  return {acl: accessFlags(flags)};\n}\n\n/**\n *   === INTERNAL HELPER FUNCTIONS ===\n */\n\n/**\n * accessFlags()\n *\n * @param flags\n */\nfunction accessFlags(flags: Record<AclFlag, boolean>): number {\n  const ADAPTER_ACCESS_FLAGS = [\n    flags.ADD_ADAPTER,\n    flags.REMOVE_ADAPTER,\n    flags.JAIL_MEMBER,\n    flags.UNJAIL_MEMBER,\n    flags.SUBMIT_PROPOSAL,\n    flags.SPONSOR_PROPOSAL,\n    flags.PROCESS_PROPOSAL,\n    flags.UPDATE_DELEGATE_KEY,\n    flags.SET_CONFIGURATION,\n    flags.ADD_EXTENSION,\n    flags.REMOVE_EXTENSION,\n    flags.NEW_MEMBER,\n  ];\n  const EXTENSION_ACCESS_FLAGS = [flags.TRANSFER_NFT];\n\n  const values: boolean[] = [\n    ...ADAPTER_ACCESS_FLAGS,\n    ...EXTENSION_ACCESS_FLAGS,\n  ];\n\n  return entry(values) as number;\n}\n\n/**\n * sha3()\n *\n * @returns string | null\n * @param value\n */\nfunction sha3(value: string): string | null {\n  return Web3.utils.sha3(value);\n}\n\n/**\n * entry()\n *\n * @param values\n */\nfunction entry(values: Boolean[]): number {\n  return values\n    .map((v: any, idx: number) => (v !== undefined ? 2 ** idx : 0))\n    .reduce((a: any, b: any) => a + b);\n}\n","import {DaoAdapterConstants /*DaoExtensionConstants*/} from './enums';\nimport {getAdapterOrExtensionId} from './helpers';\n\nimport {\n  BANK_ADAPTER_CONTRACT_ADDRESS,\n  CONFIGURATION_CONTRACT_ADDRESS,\n  COUPONONBOARDING_CONTRACT_ADDRESS,\n  DAO_REGISTRY_ADAPTER_CONTRACT_ADDRESS,\n  DEFAULT_CHAIN,\n  DISTRIBUTE_CONTRACT_ADDRESS,\n  FINANCING_CONTRACT_ADDRESS,\n  GUILDKICK_CONTRACT_ADDRESS,\n  MANAGING_CONTRACT_ADDRESS,\n  NFT_ADAPTER_CONTRACT_ADDRESS,\n  // NFT_EXTENSION_CONTRACT_ADDRESS,\n  OFFCHAINVOTING_CONTRACT_ADDRESS,\n  ONBOARDING_CONTRACT_ADDRESS,\n  RAGEQUIT_CONTRACT_ADDRESS,\n  TRIBUTE_CONTRACT_ADDRESS,\n  TRIBUTE_NFT_CONTRACT_ADDRESS,\n  VOTING_CONTRACT_ADDRESS,\n  WATER_CONTRACT_ADDRESS,\n} from '../../config';\n\ntype AdapterProps = {\n  abiFunctionName: string;\n  adapterId?: string;\n  contractAddress: string;\n  description: string;\n  extensionId?: string;\n  name: string;\n  /**\n   * Sets the access control for a particular adapter (by address)\n   * to a specific extension. Both adapter and extension need to be\n   * already registered to the DAO.\n   *\n   * We call the `setAclToExtensionForAdapter` function from the\n   * DaoRegistry, and set the access for each adapter based on this flag\n   */\n  setAclToExtensionForAdapter?: boolean;\n};\n\nexport type AdaptersAndExtensionsType = {\n  isExtension?: boolean;\n  options?: Omit<\n    AdapterProps,\n    | 'abiFunctionName'\n    | 'adapterId'\n    | 'contractAddress'\n    | 'description'\n    | 'extensionId'\n    | 'name'\n    | 'setAclToExtensionForAdapter'\n  >;\n  optionDefaultTarget?: DaoAdapterConstants;\n} & Partial<AdapterProps>;\n\n/**\n * @note README [IMPORTANT]\n *\n *    HOW TO ADD A NEW DEFAULT ADAPTER OR EXTENSION\n *\n * 1. Add the new contract address to the `./src/config.ts`\n *    list ie: <NAME-OF-NEW-CONTRACT>_CONTRACT_ADDRESS\n *\n * 2. Create a new object in the following variable `defaultAdaptersAndExtensions`\n *    - Extensions: must have the key/value pair set `isExtension: true`\n *    - Choosing an adapter/extension from a group: must be defined within a nested `options` key\n */\nexport const defaultAdaptersAndExtensions: AdaptersAndExtensionsType[] = [\n  {\n    name: DaoAdapterConstants.CONFIGURATION,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.CONFIGURATION),\n    contractAddress: CONFIGURATION_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'submitConfigurationProposal',\n    description:\n      'Manages storing and retrieving per-DAO settings required by shared adapters.',\n  },\n  {\n    name: DaoAdapterConstants.DISTRIBUTE,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.DISTRIBUTE),\n    contractAddress: DISTRIBUTE_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'submitProposal',\n    description:\n      'Allows the members to distribute funds to one or all members of the DAO.',\n  },\n  {\n    name: DaoAdapterConstants.FINANCING,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.FINANCING),\n    contractAddress: FINANCING_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'createFinancingRequest',\n    description:\n      'Allows individuals and/or organizations to request funds to finance their projects, and the members of the DAO have the power to vote and decide which projects should be funded.',\n  },\n  {\n    name: DaoAdapterConstants.GUILDKICK,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.GUILDKICK),\n    contractAddress: GUILDKICK_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'submitKickProposal',\n    description:\n      'Gives the members the freedom to choose which individuals or organizations should really be part of the DAO.',\n  },\n  {\n    name: DaoAdapterConstants.MANAGING,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.MANAGING),\n    contractAddress: MANAGING_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'submitProposal',\n    description:\n      'Enhances the DAO capabilities by adding/updating the DAO Adapters through a voting process.',\n  },\n  {\n    name: DaoAdapterConstants.ONBOARDING,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.ONBOARDING),\n    contractAddress: ONBOARDING_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'configureDao',\n    description:\n      'Triggers the process of minting internal tokens in exchange of a specific token at a fixed price.',\n  },\n  {\n    name: DaoAdapterConstants.RAGEQUIT,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.RAGEQUIT),\n    contractAddress: RAGEQUIT_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'ragequit',\n    description:\n      'Gives the members the freedom to choose when it is the best time to exit the DAO for any given reason.',\n  },\n  {\n    name: DaoAdapterConstants.TRIBUTE,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.TRIBUTE),\n    contractAddress: TRIBUTE_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'configureDao',\n    description:\n      'Allows potential and existing DAO members to contribute any amount of ERC-20 tokens to the DAO in exchange for any amount of DAO internal tokens.',\n  },\n  {\n    name: DaoAdapterConstants.TRIBUTE_NFT,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.TRIBUTE_NFT),\n    contractAddress: TRIBUTE_NFT_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'provideTributeNFT',\n    description:\n      'Allows potential DAO members to contribute a registered ERC-721 asset to the DAO in exchange for any amount of DAO units.',\n  },\n  {\n    options: [\n      {\n        name: DaoAdapterConstants.VOTING,\n        displayName: DaoAdapterConstants.OFFCHAINVOTING,\n        adapterId: getAdapterOrExtensionId(DaoAdapterConstants.VOTING),\n        contractAddress: OFFCHAINVOTING_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n        abiFunctionName: 'configureDao',\n        description:\n          'Adds the offchain voting governance process to the DAO to support gasless voting.',\n        setAclToExtensionForAdapter: true,\n      },\n      {\n        name: DaoAdapterConstants.VOTING,\n        displayName: DaoAdapterConstants.VOTING,\n        adapterId: getAdapterOrExtensionId(DaoAdapterConstants.VOTING),\n        contractAddress: VOTING_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n        abiFunctionName: 'configureDao',\n        description:\n          'Adds the simple on chain voting governance process to the DAO.',\n        setAclToExtensionForAdapter: true,\n      },\n    ],\n    optionDefaultTarget: DaoAdapterConstants.VOTING,\n  },\n  {\n    name: DaoAdapterConstants.WATER,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.WATER),\n    contractAddress: WATER_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    description: 'Allows the members to trigger irrigation.',\n  },\n  {\n    name: DaoAdapterConstants.BANK,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.BANK),\n    contractAddress: BANK_ADAPTER_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'withdraw',\n    description:\n      'Allows the members to withdraw their funds from the DAO bank.',\n  },\n  {\n    name: DaoAdapterConstants.NFT,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.NFT),\n    contractAddress: NFT_ADAPTER_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'collect',\n    description: 'Transfers ownership of an NFT to the DAO collection.',\n  },\n  {\n    name: DaoAdapterConstants.COUPON_ONBOARDING,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.COUPON_ONBOARDING),\n    contractAddress: COUPONONBOARDING_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'configureDao',\n    description:\n      'Provides a way to onboard an initial group of members quickly without requiring multiple proposals.',\n  },\n  {\n    name: DaoAdapterConstants.DAO_REGISTRY,\n    adapterId: getAdapterOrExtensionId(DaoAdapterConstants.DAO_REGISTRY),\n    contractAddress: DAO_REGISTRY_ADAPTER_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n    abiFunctionName: 'updateDelegateKey',\n    description: 'Allows the member to update delegate key.',\n  },\n  // {\n  //   isExtension: true,\n  //   name: DaoExtensionConstants.NFT,\n  //   extensionId: getAdapterOrExtensionId(DaoExtensionConstants.NFT),\n  //   contractAddress: NFT_EXTENSION_CONTRACT_ADDRESS[DEFAULT_CHAIN],\n  //   abiFunctionName: 'registerPotentialNewNFT',\n  //   description:\n  //     'Adds to the DAO the capability of managing and curate a collection of standard NFTs.',\n  // },\n];\n","import {useCallback, useEffect, useState} from 'react';\nimport {useLazyQuery} from '@apollo/react-hooks';\nimport {useSelector} from 'react-redux';\n\nimport {StoreState} from '../../../store/types';\nimport {AsyncStatus} from '../../../util/types';\nimport {Adapters, Extensions} from '../types';\n\nimport {GET_ADAPTERS_AND_EXTENSIONS} from '../../../gql';\n\nimport {\n  defaultAdaptersAndExtensions,\n  AdaptersAndExtensionsType,\n} from '../config';\nimport {GQL_QUERY_POLLING_INTERVAL} from '../../../config';\n\nimport {DaoAdapterConstants, DaoExtensionConstants} from '../enums';\n\nexport type AdapterType = {\n  __typename: string;\n  id: string;\n  acl: string;\n  adapterId: string;\n  adapterAddress: string;\n};\n\nexport type ExtensionType = {\n  __typename: string;\n  id: string;\n  extensionId: string;\n  extensionAddress: string;\n};\n\ntype UseAdaptersOrExtensionsReturn = {\n  adapterExtensionStatus: AsyncStatus;\n  getAdapterOrExtensionFromRedux: (\n    adapterName: DaoAdapterConstants | DaoExtensionConstants\n  ) => Record<string, any>;\n  registeredAdaptersOrExtensions: AdapterType[] | undefined;\n  unRegisteredAdaptersOrExtensions: Adapters[] | undefined;\n};\n\nexport type AdaptersType = AdapterType & Adapters;\nexport type ExtensionsType = ExtensionType & Extensions;\n\n/**\n * useAdaptersOrExtensions\n *\n * This component queries The Graph API to get the daos adapters.\n * It returns the available adapters filtered by a search on the current dao.\n *\n * @returns {UseAdaptersOrExtensionsReturn}\n */\nexport function useAdaptersOrExtensions(): UseAdaptersOrExtensionsReturn {\n  /**\n   * Selectors\n   */\n  const {DaoRegistryContract, ...adapterExtensionContracts} = useSelector(\n    (s: StoreState) => s.contracts\n  );\n\n  /**\n   * Their hooks\n   */\n  const [getRegisteredAdaptersAndExtensions, {called, data, error}] =\n    useLazyQuery(GET_ADAPTERS_AND_EXTENSIONS, {\n      pollInterval: GQL_QUERY_POLLING_INTERVAL,\n      variables: {\n        daoAddress: DaoRegistryContract?.contractAddress.toLowerCase(),\n      },\n    });\n\n  /**\n   * State\n   */\n  const [registeredAdaptersOrExtensions, setRegisteredAdaptersOrExtensions] =\n    useState<AdapterType[] | undefined>();\n  const [\n    unRegisteredAdaptersOrExtensions,\n    setUnRegisteredAdaptersOrExtensions,\n  ] = useState<Adapters[] | undefined>();\n  const [adapterExtensionStatus, setAdapterExtensionStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  const getAdaptersAndExtensionsCached = useCallback(\n    getAdaptersAndExtensions,\n    []\n  );\n\n  useEffect(() => {\n    if (!called) {\n      getRegisteredAdaptersAndExtensions();\n    }\n  }, [called, getRegisteredAdaptersAndExtensions]);\n\n  // Get adapters and extensions from GQL\n  useEffect(() => {\n    if (!DaoRegistryContract?.contractAddress) return;\n\n    try {\n      setAdapterExtensionStatus(AsyncStatus.PENDING);\n\n      if (data) {\n        // extract adapters and extensions from gql data\n        const {adapters, extensions} = data.tributeDaos[0] as Record<\n          string,\n          any\n        >;\n\n        // create a list of registered and un-registered adapters and extensions\n        const {registeredList, unRegisteredList} =\n          getAdaptersAndExtensionsCached(adapters, extensions);\n\n        setRegisteredAdaptersOrExtensions(registeredList);\n        setUnRegisteredAdaptersOrExtensions(unRegisteredList);\n\n        // done; lets set status to fulfilled\n        setAdapterExtensionStatus(AsyncStatus.FULFILLED);\n      } else {\n        if (error) {\n          throw new Error(error.message);\n        }\n      }\n    } catch (error) {\n      setRegisteredAdaptersOrExtensions(undefined);\n      setUnRegisteredAdaptersOrExtensions(undefined);\n\n      setAdapterExtensionStatus(AsyncStatus.REJECTED);\n    }\n  }, [DaoRegistryContract, data, error, getAdaptersAndExtensionsCached]);\n\n  /**\n   * getAdaptersAndExtensions\n   *\n   * Find all registered and un-registered adapters and extensions\n   *\n   * @param registeredDaoAdapters\n   * @param registeredDaoExtensions\n   */\n  function getAdaptersAndExtensions(\n    registeredDaoAdapters: any,\n    registeredDaoExtensions: any\n  ): Record<string, any> {\n    //@todo types\n\n    let registeredList: AdaptersAndExtensionsType[] = [];\n    let unRegisteredList: AdaptersAndExtensionsType[] = [];\n\n    const getAdapterFromGql = (adapterId: string) => {\n      return registeredDaoAdapters.find(\n        (adapter: AdaptersAndExtensionsType) => {\n          return adapter.adapterId?.toLowerCase() === adapterId?.toLowerCase();\n        }\n      );\n    };\n\n    const getExtensionFromGql = (extensionId: string) => {\n      return registeredDaoExtensions.find(\n        (extension: AdaptersAndExtensionsType) => {\n          return (\n            extension.extensionId?.toLowerCase() === extensionId?.toLowerCase()\n          );\n        }\n      );\n    };\n\n    defaultAdaptersAndExtensions.forEach(\n      (adapterOrExtension: AdaptersAndExtensionsType | any) => {\n        if (adapterOrExtension?.isExtension) {\n          // Add an extenaion\n\n          const gqlExtension = getExtensionFromGql(\n            adapterOrExtension.extensionId\n          );\n\n          if (gqlExtension) {\n            registeredList.push({\n              ...gqlExtension,\n              ...adapterOrExtension,\n              name: adapterOrExtension.name as DaoAdapterConstants,\n              description: adapterOrExtension.description,\n            } as AdaptersAndExtensionsType);\n          } else {\n            unRegisteredList.push({\n              ...adapterOrExtension,\n              name: adapterOrExtension.name as DaoAdapterConstants,\n              description: adapterOrExtension.description,\n            } as AdaptersAndExtensionsType);\n          }\n        } else if (adapterOrExtension?.options) {\n          // Check options for adapters and extensions\n\n          // dry-run check to see if any of the options have already been registered\n          const maybeSomeAdapters = adapterOrExtension?.options.some(\n            (s: any) => {\n              return !s.isExtension && getAdapterFromGql(s.adapterId);\n            }\n          );\n\n          // dry-run check to see if any of the options have already been registered\n          const maybeSomeExtensions = adapterOrExtension?.options.some(\n            (s: any) => {\n              return s.isExtension && getExtensionFromGql(s.extensionId);\n            }\n          );\n\n          // this means an adapter or extension has already been\n          // added from the options\n          if (maybeSomeAdapters || maybeSomeExtensions) {\n            let shouldSkip = false;\n\n            adapterOrExtension?.options?.forEach((option: any) => {\n              if (shouldSkip) {\n                return;\n              }\n\n              if (option?.isExtension) {\n                const gqlExtension = getExtensionFromGql(option.extensionId);\n\n                if (gqlExtension) {\n                  registeredList.push({\n                    ...gqlExtension,\n                    ...option,\n                    name: option.name as DaoAdapterConstants,\n                    description: option.description,\n                  } as AdaptersAndExtensionsType);\n\n                  shouldSkip = true;\n                  return;\n                } else {\n                  unRegisteredList.push({\n                    ...option,\n                    name: option.name as DaoAdapterConstants,\n                    description: option.description,\n                  } as AdaptersAndExtensionsType);\n                }\n              } else {\n                const gqlAdapter = getAdapterFromGql(option.adapterId);\n                if (gqlAdapter) {\n                  registeredList.push({\n                    ...gqlAdapter,\n                    ...option,\n                    name: option.name as DaoAdapterConstants,\n                    description: option.description,\n                  } as AdaptersAndExtensionsType);\n\n                  shouldSkip = true;\n                  return;\n                } else {\n                  unRegisteredList.push({\n                    ...option,\n                    name: option.name as DaoAdapterConstants,\n                    description: option.description,\n                  } as AdaptersAndExtensionsType);\n                }\n              }\n            });\n          } else {\n            // just add the options as a nested object;\n            // this will trigger the dropdown to display the options\n            unRegisteredList.push(adapterOrExtension);\n          }\n        } else {\n          // Add an adapter\n          const gqlAdapter = getAdapterFromGql(adapterOrExtension.adapterId);\n\n          if (gqlAdapter) {\n            registeredList.push({\n              ...gqlAdapter,\n              ...adapterOrExtension,\n              name: adapterOrExtension.name as DaoAdapterConstants,\n              description: adapterOrExtension.description,\n            } as AdaptersAndExtensionsType);\n          } else {\n            unRegisteredList.push({\n              ...adapterOrExtension,\n              name: adapterOrExtension.name as DaoAdapterConstants,\n              description: adapterOrExtension.description,\n            } as AdaptersAndExtensionsType);\n          }\n        }\n      }\n    );\n\n    return {\n      registeredList,\n      unRegisteredList,\n    };\n  }\n\n  /**\n   * getAdapterOrExtensionFromRedux\n   *\n   * @param adapterOrExtensionName DaoAdapterConstants\n   */\n  function getAdapterOrExtensionFromRedux(\n    adapterOrExtensionName: DaoAdapterConstants | DaoExtensionConstants\n  ): Record<string, any> {\n    return Object.keys(adapterExtensionContracts)\n      .map((ae) => adapterExtensionContracts[ae])\n      .filter((ae) => ae) // filter out any `null` objects\n      .filter((ae) => ae.adapterOrExtensionName === adapterOrExtensionName)[0];\n  }\n\n  return {\n    adapterExtensionStatus,\n    getAdapterOrExtensionFromRedux,\n    registeredAdaptersOrExtensions,\n    unRegisteredAdaptersOrExtensions,\n  };\n}\n","import Web3 from 'web3';\n\nimport {FormFieldErrors} from '../../../util/enums';\nimport {useIsDefaultChain} from '../../web3/hooks';\n\ntype ValidationType =\n  | 'address'\n  | 'bytes32'\n  | 'bytes32[]'\n  | 'uint256'\n  | 'uint256[]';\n\nexport type ParamInputType = string | string[] | number | number[];\n\nexport enum ParamType {\n  ADDRESS = 'address',\n  BYTES32 = 'bytes32',\n  BYTES32_ARRAY = 'bytes32[]',\n  UINT256 = 'uint256',\n  UINT256_ARRAY = 'uint256[]',\n}\n\ntype UseValidationReturn = {\n  isParamInputValid: (\n    paramInput: ParamInputType,\n    paramType: ValidationType\n  ) => boolean;\n  getFormFieldError: (paramType: ValidationType) => string | FormFieldErrors;\n  formatInputByType: (inputValue: any, inputType: ParamType) => string;\n};\n\n/**\n * useValidation\n *\n * This hook validates the input values for the ABI parameters.\n *\n * @returns {UseValidationReturn}\n */\nexport function useValidation(): UseValidationReturn {\n  /**\n   * Hooks\n   */\n  const {defaultChain} = useIsDefaultChain();\n\n  function isParamInputValid(\n    paramInput: ParamInputType,\n    paramType: ValidationType\n  ): boolean {\n    const parameter: string = paramInput.toString();\n\n    const isValid: boolean =\n      paramType === ParamType.ADDRESS\n        ? isAddressValid(parameter)\n        : paramType === ParamType.BYTES32\n        ? isBytes32Valid(parameter)\n        : paramType === ParamType.BYTES32_ARRAY\n        ? isBytes32ArrayValid(parameter)\n        : paramType === ParamType.UINT256\n        ? isUint256Valid(parameter)\n        : paramType === ParamType.UINT256_ARRAY\n        ? isUint256ArrayValid(parameter)\n        : true;\n\n    return isValid;\n  }\n\n  function getFormFieldError(\n    paramType: ValidationType\n  ): string | FormFieldErrors {\n    return paramType === ParamType.ADDRESS\n      ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n      : paramType === ParamType.BYTES32\n      ? FormFieldErrors.INVALID_BYTES32\n      : paramType === ParamType.BYTES32_ARRAY\n      ? FormFieldErrors.INVALID_BYTES32_ARRAY\n      : paramType === ParamType.UINT256\n      ? FormFieldErrors.INVALID_NUMBER\n      : paramType === ParamType.UINT256_ARRAY\n      ? FormFieldErrors.INVALID_NUMBER_ARRAY\n      : FormFieldErrors.REQUIRED;\n  }\n\n  /**\n   * isAddressValid()\n   *\n   * @returns boolean\n   * @param parameter string\n   */\n  function isAddressValid(parameter: string): boolean {\n    try {\n      if (!parameter) return false;\n\n      return (\n        Web3.utils.checkAddressChecksum(parameter, defaultChain) ||\n        Web3.utils.isAddress(parameter, defaultChain)\n      );\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * isBytes32Valid()\n   *\n   * @returns boolean\n   * @param parameter string\n   */\n  function isBytes32Valid(parameter: string): boolean {\n    try {\n      if (!parameter) return false;\n\n      return parameter.length === 66 && Web3.utils.isHex(parameter);\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * isBytes32ArrayValid()\n   *\n   * @returns boolean\n   * @param parameter string\n   */\n  function isBytes32ArrayValid(parameter: string): boolean {\n    try {\n      return Array.from(parameter.split(',')).every(\n        (p) => p.length === 66 && Web3.utils.isHex(p)\n      );\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * isUint256Valid\n   *\n   * @returns boolean\n   * @param parameter string\n   */\n  function isUint256Valid(parameter: string): boolean {\n    return !isNaN(Number(parameter));\n  }\n\n  /**\n   * isUint256ArrayValid()\n   *\n   * @returns boolean\n   * @param parameter string\n   */\n  function isUint256ArrayValid(parameter: string): boolean {\n    return Array.from(parameter.split(',')).every((p) => Number(p));\n  }\n\n  function formatInputByType(inputValue: any, inputType: any) {\n    const formatBytes32Array = (): string[] =>\n      Array.from(inputValue.split(','));\n    const formatUint256Array = (): number[] => {\n      return Array.from(inputValue.split(',').map((i: string) => Number(i)));\n    };\n\n    return inputType === ParamType.BYTES32_ARRAY\n      ? formatBytes32Array()\n      : inputType === ParamType.UINT256_ARRAY\n      ? formatUint256Array()\n      : inputType === ParamType.UINT256\n      ? Number(inputValue)\n      : inputValue;\n  }\n\n  return {\n    isParamInputValid,\n    getFormFieldError,\n    formatInputByType,\n  };\n}\n","import React, {useState} from 'react';\n\nimport {DaoAdapterConstants, DaoExtensionConstants} from './enums';\n\ntype AdapterExtensionTarget =\n  | DaoAdapterConstants\n  | DaoExtensionConstants\n  | null;\n\ntype AdapterExtensionSelectTargetRenderActionsArgs = {\n  selectedTargetOption: AdapterExtensionTarget;\n  selectedTargetOptionProps: any;\n};\n\ntype AdapterExtensionSelectTargetProps = {\n  defaultTarget?: AdapterExtensionTarget;\n  adapterOrExtension: Record<string, any>;\n  renderActions: (\n    a: AdapterExtensionSelectTargetRenderActionsArgs\n  ) => JSX.Element | null;\n  renderCheckboxAction: (a: {\n    selectedTargetOption: AdapterExtensionTarget;\n  }) => JSX.Element | null;\n};\n\n/**\n * AdapterExtensionSelectTarget\n *\n * Displays a drop-down confirm list with options to\n * choose to from the defined list of options in `./config.ts`\n\n *\n * @param {AdapterExtensionSelectTargetProps} props\n * @returns {JSX.Element}\n */\nexport default function AdapterExtensionSelectTarget(\n  props: AdapterExtensionSelectTargetProps\n) {\n  const {\n    adapterOrExtension,\n    defaultTarget,\n    renderActions,\n    renderCheckboxAction,\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [selectedTargetOption, setSelectedTargetOption] =\n    useState<AdapterExtensionTarget>(defaultTarget || null);\n\n  const [selectedTargetOptionProps, setSelectedTargetOptionProps] =\n    useState<any>({});\n\n  /**\n   * Functions\n   */\n\n  function handleSelectTargetChange(\n    event: React.ChangeEvent<HTMLSelectElement>\n  ) {\n    const {value} = event.target;\n\n    setSelectedTargetOption(value as AdapterExtensionTarget);\n\n    const selectedTargetProps: string = adapterOrExtension?.options.find(\n      (selectedOption: any) => selectedOption.displayName === value\n    );\n\n    setSelectedTargetOptionProps(selectedTargetProps);\n  }\n\n  function renderDescription(\n    selectedTargetOption: DaoAdapterConstants | DaoExtensionConstants | null\n  ) {\n    if (!selectedTargetOption) return null;\n\n    try {\n      const description: string =\n        adapterOrExtension?.options.find(\n          (selectedOption: any) =>\n            selectedOption.displayName === selectedTargetOption\n        ).description || '';\n\n      return <span className=\"adapter-extension__desc\">{description}</span>;\n    } catch (error) {\n      console.warn(error);\n    }\n  }\n\n  return (\n    <>\n      <div className=\"adapter-extension__inner-wrapper \">\n        {/* CHECKBOX ACTIONS */}\n        {renderCheckboxAction({selectedTargetOption})}\n\n        <div className=\"adapter-extension__info\">\n          {/* ADAPTER/EXTENSION TARGET DEFAULT NAME */}\n          <span className=\"adapter-extension__name\">\n            {adapterOrExtension?.optionDefaultTarget}\n            {adapterOrExtension?.isExtension && '(EXTENSION)'}\n          </span>\n\n          {/* CHOOSE ADAPTER/EXTENSION TARGET */}\n          <select className=\"select\" onChange={handleSelectTargetChange}>\n            <option\n              key={'adapterOrExtensionSelect'}\n              value=\"\"\n              disabled={selectedTargetOption !== null}>\n              Select a {adapterOrExtension?.optionDefaultTarget} type&hellip;\n            </option>\n\n            {adapterOrExtension?.options.map((option: any) => (\n              <option key={option.displayName} value={option.displayName}>\n                {option.displayName.toUpperCase()}\n              </option>\n            ))}\n          </select>\n\n          {renderDescription(selectedTargetOption)}\n        </div>\n      </div>\n\n      {/* BUTTON ACTIONS */}\n      {renderActions({selectedTargetOption, selectedTargetOptionProps})}\n    </>\n  );\n}\n","import React from 'react';\n\nimport FadeIn from './FadeIn';\n\ntype InputErrorProps = {\n  error: string;\n};\n\nexport default function InputError(\n  props: InputErrorProps & React.HtmlHTMLAttributes<HTMLParagraphElement>\n) {\n  const {error, ...restProps} = props;\n\n  return (\n    <>\n      {error && (\n        <FadeIn>\n          <p\n            {...restProps}\n            className={`error-message ${restProps.className || ''}`}>\n            {error}\n          </p>\n        </FadeIn>\n      )}\n    </>\n  );\n}\n","import {useState} from 'react';\nimport {useForm} from 'react-hook-form';\nimport {useSelector} from 'react-redux';\nimport {AbiItem} from 'web3-utils/types';\n\nimport {DaoAdapterConstants} from './enums';\nimport {AdaptersOrExtensions} from './types';\nimport {StoreState} from '../../store/types';\nimport {Web3TxStatus} from '../web3/types';\nimport {FormFieldErrors} from '../../util/enums';\nimport {getValidationError} from '../../util/helpers';\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useAdaptersOrExtensions, useValidation} from './hooks';\nimport {ParamInputType, ParamType} from './hooks/useValidation';\n\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport InputError from '../common/InputError';\nimport Loader from '../feedback/Loader';\n\ntype ConfigurationFormProps = {\n  abiConfigurationInputs: Record<string, any> | undefined;\n  abiMethodName: string;\n  adapterOrExtension: Pick<AdaptersOrExtensions, any> | undefined;\n  closeHandler?: () => void;\n};\n\ntype RemoveExtensionArgument = [\n  //`extensionId`\n  string\n];\n\ntype RemoveAdapterArguments = [\n  // `adapterId`\n  string,\n  // set to `BURN_ADDRESS` zero address\n  string,\n  // acl set to `0` - no access/permissions\n  number,\n  // keys\n  [],\n  // values\n  []\n];\n\nexport default function ConfigurationForm({\n  abiConfigurationInputs,\n  abiMethodName,\n  adapterOrExtension,\n  closeHandler,\n}: ConfigurationFormProps) {\n  /**\n   * Selectors\n   */\n  const {DaoRegistryContract} = useSelector(\n    (state: StoreState) => state.contracts\n  );\n\n  /**\n   * State\n   */\n  const [submitError, setSubmitError] = useState<Error>();\n  const [configureAdapterStatus, setConfigureAdapterStatus] =\n    useState<Web3TxStatus>(Web3TxStatus.STANDBY);\n  const [removeStatus, setRemoveStatus] = useState<Web3TxStatus>(\n    Web3TxStatus.STANDBY\n  );\n\n  /**\n   * Hooks\n   */\n  const {\n    txError,\n    // txEtherscanURL,\n    txIsPromptOpen,\n    txSend,\n    txStatus,\n  } = useContractSend();\n  const {fast: fastGasPrice} = useETHGasPrice();\n  const {connected, account} = useWeb3Modal();\n  const {isParamInputValid, getFormFieldError, formatInputByType} =\n    useValidation();\n  const {getAdapterOrExtensionFromRedux} = useAdaptersOrExtensions();\n\n  /**\n   * Their hooks\n   */\n  const form = useForm<Record<string, any>>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n\n  /**\n   * Variables\n   */\n  const {errors, formState, getValues, setValue, register, trigger} = form;\n  const configureAdapterError = submitError || txError;\n  const isConnected = connected && account;\n  const adapterOrExtensionText = adapterOrExtension?.isExtension\n    ? 'extension'\n    : 'adapter';\n\n  /**\n   * @note From the docs: \"Read the formState before render to subscribe the form state through Proxy\"\n   * @see https://react-hook-form.com/api#formState\n   */\n  const {isValid} = formState;\n\n  const isConfigureInProcess =\n    (txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n      txStatus === Web3TxStatus.PENDING) &&\n    (configureAdapterStatus === Web3TxStatus.AWAITING_CONFIRM ||\n      configureAdapterStatus === Web3TxStatus.PENDING);\n  const isRemoveInProcess =\n    (txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n      txStatus === Web3TxStatus.PENDING) &&\n    (removeStatus === Web3TxStatus.AWAITING_CONFIRM ||\n      removeStatus === Web3TxStatus.PENDING);\n\n  const isConfigureDone =\n    txStatus === Web3TxStatus.FULFILLED &&\n    configureAdapterStatus === Web3TxStatus.FULFILLED;\n  const isRemoveDone =\n    txStatus === Web3TxStatus.FULFILLED &&\n    removeStatus === Web3TxStatus.FULFILLED;\n\n  const isConfigureInProcessOrDone =\n    (isConfigureInProcess || isConfigureDone) && txIsPromptOpen;\n  const isRemoveInProcessOrDone =\n    (isRemoveInProcess || isRemoveDone) && txIsPromptOpen;\n\n  /**\n   * handleRemove()\n   */\n  async function handleRemove(): Promise<void> {\n    if (!DaoRegistryContract) return;\n\n    try {\n      setRemoveStatus(Web3TxStatus.AWAITING_CONFIRM);\n\n      const removeExtensionArgument: RemoveExtensionArgument = [\n        adapterOrExtension?.extensionId,\n      ];\n\n      const removeAdapterArguments: RemoveAdapterArguments = [\n        adapterOrExtension?.adapterId,\n        BURN_ADDRESS,\n        0,\n        [],\n        [],\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      // Execute contract call to `removeExtension` or `replaceAdapter`\n      await txSend(\n        adapterOrExtension?.isExtension ? 'removeExtension' : 'replaceAdapter',\n        DaoRegistryContract.instance.methods,\n        adapterOrExtension?.isExtension\n          ? removeExtensionArgument\n          : removeAdapterArguments,\n        txArguments\n      );\n\n      setRemoveStatus(Web3TxStatus.FULFILLED);\n\n      // Close modal\n      closeHandler &&\n        setTimeout(() => {\n          closeHandler();\n          // @todo Display closing modal message\n        }, 3000);\n    } catch (error) {\n      setSubmitError(error);\n      setRemoveStatus(Web3TxStatus.REJECTED);\n    }\n  }\n\n  /**\n   * handleSubmit()\n   * @param values\n   */\n  async function handleSubmit(values: Record<string, any>) {\n    try {\n      setConfigureAdapterStatus(Web3TxStatus.PENDING);\n\n      const {\n        contractAddress,\n        instance: {methods},\n      } = getAdapterOrExtensionFromRedux(\n        adapterOrExtension?.name as DaoAdapterConstants\n      );\n\n      if (!isConnected) {\n        throw new Error(\n          'No user account was found. Please make sure your wallet is connected.'\n        );\n      }\n\n      if (!contractAddress) {\n        throw new Error(`No ${adapterOrExtension?.name} contract found.`);\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      let adapterConfigArguments: Array<ParamInputType> = [];\n      // construct method arguments\n      abiConfigurationInputs?.forEach((abiInput: AbiItem) => {\n        const inputValue = Object.entries(values).find(\n          (v: any) => v[0] === abiInput.name\n        );\n\n        if (inputValue) {\n          const formattedValue: ParamInputType = formatInputByType(\n            inputValue[1] as ParamInputType,\n            abiInput.type as ParamType\n          );\n\n          adapterConfigArguments.push(formattedValue);\n        }\n      });\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      setConfigureAdapterStatus(Web3TxStatus.AWAITING_CONFIRM);\n\n      // Execute contract call\n      await txSend(abiMethodName, methods, adapterConfigArguments, txArguments);\n\n      setConfigureAdapterStatus(Web3TxStatus.FULFILLED);\n    } catch (error) {\n      // Set any errors from Web3 utils or explicitly set above.\n      setSubmitError(error);\n      setConfigureAdapterStatus(Web3TxStatus.REJECTED);\n    }\n  }\n\n  return (\n    <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n      {/* INPUT PARAMETERS */}\n      {abiConfigurationInputs &&\n        abiConfigurationInputs.map((input: Record<string, any>) => (\n          <div className=\"form__input-row\" key={input.name}>\n            <label className=\"form__input-row-label\">{input.name}</label>\n            <div className=\"form__input-row-fieldwrap\">\n              <input\n                aria-describedby={`error-${input.name}`}\n                aria-invalid={errors[input.name] ? 'true' : 'false'}\n                name={input.name}\n                placeholder={input.type}\n                type=\"text\"\n                onChange={() =>\n                  setValue(input.name[0], getValues()[input.name])\n                }\n                ref={register({\n                  validate: (value: string): string | boolean => {\n                    return value === ''\n                      ? FormFieldErrors.REQUIRED\n                      : isParamInputValid(value, input.type)\n                      ? true\n                      : getFormFieldError(input.type);\n                  },\n                })}\n                disabled={isConfigureInProcessOrDone}\n              />\n\n              <InputError\n                error={getValidationError(input.name, errors)}\n                id={`error-${input.name}`}\n              />\n            </div>\n          </div>\n        ))}\n\n      {/* SUBMIT */}\n      <button\n        className=\"button\"\n        disabled={isConfigureInProcessOrDone || isRemoveInProcessOrDone}\n        onClick={() => {\n          if (isConfigureInProcessOrDone) return;\n\n          if (!isValid) {\n            trigger();\n            return;\n          }\n\n          handleSubmit(getValues());\n        }}\n        type=\"submit\">\n        {isConfigureInProcess ? (\n          <Loader />\n        ) : isConfigureDone ? (\n          'Done'\n        ) : (\n          'Submit'\n        )}\n      </button>\n\n      {/* SUBMIT ERROR */}\n      {configureAdapterError && (\n        <div className=\"form__submit-error-container\">\n          <ErrorMessageWithDetails\n            renderText=\"Something went wrong while submitting the adapter configuration.\"\n            error={configureAdapterError}\n          />\n        </div>\n      )}\n\n      {/** REMOVE EXTENSION BUTTON - @todo only show if DAO isn't finalized */}\n      <div className=\"adapter-extension__remove\">\n        <p>\n          Delete this {adapterOrExtensionText}. Once you delete this{' '}\n          {adapterOrExtensionText}, it can be re-added if the DAO isn't\n          finalized.\n        </p>\n        <button\n          className=\"button--secondary\"\n          disabled={isRemoveInProcessOrDone || isConfigureInProcessOrDone}\n          onClick={() => (isRemoveDone ? {} : handleRemove())}>\n          {isRemoveInProcess ? <Loader /> : isRemoveDone ? 'Done' : 'Remove'}\n        </button>\n      </div>\n    </form>\n  );\n}\n","import {AdaptersOrExtensions} from './types';\nimport ConfigurationForm from './ConfigurationForm';\nimport Modal from '../common/Modal';\n\nimport TimesSVG from '../../assets/svg/TimesSVG';\n\ntype ConfigurationModalProps = {\n  abiMethodName: string;\n  adapterOrExtension: AdaptersOrExtensions | undefined;\n  configurationInputs: Record<string, any> | undefined;\n  isOpen: boolean;\n  closeHandler: () => void;\n};\n\nexport default function ConfigurationModal({\n  abiMethodName,\n  adapterOrExtension,\n  configurationInputs,\n  isOpen,\n  closeHandler,\n}: ConfigurationModalProps) {\n  return (\n    <Modal\n      keyProp=\"adapter-extension-configuration\"\n      modalClassNames=\"adapter-extension-configure-modal\"\n      isOpen={isOpen}\n      isOpenHandler={() => {\n        closeHandler();\n      }}>\n      {/* MODEL CLOSE BUTTON */}\n      <>\n        <span\n          className=\"modal__close-button\"\n          onClick={() => {\n            closeHandler();\n          }}>\n          <TimesSVG />\n        </span>\n\n        <h1>{adapterOrExtension?.name.toUpperCase()}</h1>\n        <p>{adapterOrExtension?.description}</p>\n\n        <ConfigurationForm\n          abiConfigurationInputs={configurationInputs}\n          abiMethodName={abiMethodName}\n          adapterOrExtension={adapterOrExtension as AdaptersOrExtensions}\n          closeHandler={closeHandler}\n        />\n      </>\n    </Modal>\n  );\n}\n","import React, {Fragment} from 'react';\n\ninterface IProps {\n  checked: boolean;\n  id: string;\n  label: string;\n  name: string;\n  onChange: (event: React.ChangeEvent<HTMLInputElement>) => void;\n}\n\ntype OtherProps = {[key: string]: any; size?: CheckboxSize};\n\nexport enum CheckboxSize {\n  LARGE = 'large',\n  SMALL = 'small',\n}\n\nexport default function Checkbox({size, ...props}: IProps & OtherProps) {\n  return (\n    <Fragment>\n      <input\n        {...props}\n        aria-checked={props.checked}\n        checked={props.checked}\n        className={`checkbox-input ${props.className || ''} `}\n        id={props.id}\n        name={props.name}\n        onChange={props.onChange}\n        type=\"checkbox\"\n      />\n\n      <label className={`checkbox-label`} htmlFor={props.id}>\n        <span className={`checkbox-box ${size || CheckboxSize.SMALL}`}></span>\n        <span className={`checkbox-text`}>{props.label}</span>\n      </label>\n    </Fragment>\n  );\n}\n","import {useState} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {StoreState} from '../../store/types';\nimport {Web3TxStatus} from '../web3/types';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useDao} from '../../hooks';\nimport {truncateEthAddress} from '../../util/helpers';\nimport {TX_CYCLE_MESSAGES} from '../web3/config';\n\nimport {CycleEllipsis} from '../feedback';\nimport Modal from '../common/Modal';\nimport Loader from '../feedback/Loader';\nimport TimesSVG from '../../assets/svg/TimesSVG';\nimport CycleMessage from '../feedback/CycleMessage';\nimport EtherscanURL from '../web3/EtherscanURL';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport FadeIn from '../common/FadeIn';\n\ntype FinalizeModalProps = {\n  isOpen: boolean;\n  closeHandler: () => void;\n};\n\nexport default function FinalizeModal({\n  isOpen,\n  closeHandler,\n}: FinalizeModalProps) {\n  /**\n   * State\n   */\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Selectors\n   */\n  const {DaoRegistryContract} = useSelector(\n    (state: StoreState) => state.contracts\n  );\n\n  /**\n   * Hooks\n   */\n  const {txError, txEtherscanURL, txIsPromptOpen, txSend, txStatus} =\n    useContractSend();\n  const {fast: fastGasPrice} = useETHGasPrice();\n  const {dao} = useDao();\n  const {connected, account} = useWeb3Modal();\n\n  /**\n   * Variables\n   */\n  const TIMEOUT_INTERVAL = 3000;\n  const isConnected = connected && account;\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n  const finalizeError = submitError || txError;\n\n  function renderSubmitStatus(): React.ReactNode {\n    // Only for chain tx\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Awaiting your confirmation\n            <CycleEllipsis />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>{'Finalized!'}</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  function configureExtensions() {\n    // @todo if any adapters have the `setAclToExtensionForAdapter` flag set we need to call\n    //  `configureExtension(\n    //     DaoRegistry dao,\n    //     address extension,\n    //     Adapter[] calldata adapters\n    // )` to set the permission for those adapters for the bank before finalizing the DAO\n    /**\n     * STEPS\n     * - get all added adapters from the subgraph\n     * - check the `setAclToExtensionForAdapter` flag against the added adpaters\n     * - set the permission for any adapters that are required\n     */\n  }\n\n  async function finalizeDao(): Promise<void> {\n    try {\n      if (!isConnected) {\n        throw new Error(\n          'No user account was found. Please make sure your wallet is connected.'\n        );\n      }\n\n      if (!DaoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      // @todo set permissions for adapters\n      configureExtensions();\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      // Execute contract call for `finalizeDao`\n      await txSend(\n        'finalizeDao',\n        DaoRegistryContract.instance.methods,\n        [],\n        txArguments\n      );\n\n      // Close modal\n      closeHandler &&\n        setTimeout(() => {\n          closeHandler();\n        }, TIMEOUT_INTERVAL);\n    } catch (error) {\n      setSubmitError(error);\n    }\n  }\n\n  return (\n    <Modal\n      keyProp=\"adapter-extension-finalize\"\n      isOpen={isOpen}\n      isOpenHandler={() => {\n        closeHandler();\n      }}>\n      {/* MODEL CLOSE BUTTON */}\n      <>\n        <span\n          className=\"modal__close-button\"\n          onClick={() => {\n            closeHandler();\n          }}>\n          <TimesSVG />\n        </span>\n\n        <h1>Finalize</h1>\n        <h2>\n          {dao && dao.name}{' '}\n          <small>{dao && truncateEthAddress(dao.daoAddress, 7)}</small>\n        </h2>\n        <p>\n          After your DAO is finalized you will need to submit a proposal to make\n          changes.\n        </p>\n\n        {/* SUBMIT */}\n        <button\n          className=\"button\"\n          disabled={isInProcessOrDone}\n          onClick={() => {\n            if (isInProcessOrDone) return;\n\n            finalizeDao();\n          }}\n          type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {finalizeError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while trying to finalize the DAO.\"\n              error={finalizeError}\n            />\n          </div>\n        )}\n      </>\n    </Modal>\n  );\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {StoreState} from '../../store/types';\nimport {AsyncStatus} from '../../util/types';\nimport {\n  AddAdapterArguments,\n  AddAdaptersArguments,\n  AddExtensionArguments,\n  AdaptersOrExtensions,\n} from './types';\n\nimport {DaoAdapterConstants, DaoExtensionConstants} from './enums';\n\nimport {\n  defaultAdaptersAndExtensions,\n  AdaptersAndExtensionsType,\n} from './config';\n\nimport {getAdapterOrExtensionId, getAccessControlLayer} from './helpers';\nimport {getDaoState, DaoState} from '../web3/helpers';\nimport {truncateEthAddress} from '../../util/helpers';\n\nimport {\n  useAdaptersOrExtensions,\n  useInitAdapterExtensionContracts,\n} from './hooks';\nimport {useDao, useMemberActionDisabled} from '../../hooks';\nimport {\n  useContractSend,\n  useETHGasPrice,\n  useWeb3Modal,\n  useIsDefaultChain,\n} from '../web3/hooks';\n\nimport AdapterExtensionSelectTarget from './AdapterOrExtensionSelectTarget';\nimport ConfigurationModal from './ConfigurationModal';\nimport Checkbox, {CheckboxSize} from '../common/Checkbox';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport FadeIn from '../common/FadeIn';\nimport FinalizeModal from './FinalizeModal';\nimport Loader from '../feedback/Loader';\nimport Wrap from '../common/Wrap';\n\nenum WhyDisableModalTitles {\n  FINALIZED_REASON = 'Why is finalizing disabled?',\n  CONFIGURATION_REASON = 'Why are configurations disabled?',\n}\n/**\n * AdapterOrExtensionManager()\n *\n * This components lists all the registered and unregistered adapters/extensions\n * from the list of available adapters in the `defaultAdaptersAndExtensions` in `./config.ts`\n *\n * It allows for adding unreigsterd adapters and extensions, configurating\n * registered adapters and extensions, and finalizing the DAO.\n *\n * @note it is not possible to manage the adapters/extensions if the DAO is finalized.\n */\nexport default function AdapterOrExtensionManager() {\n  /**\n   * Selectors\n   */\n  const {DaoRegistryContract, DaoFactoryContract} = useSelector(\n    (s: StoreState) => s.contracts\n  );\n  const isActiveMember = useSelector(\n    (s: StoreState) => s.connectedMember?.isActiveMember\n  );\n\n  /**\n   * States\n   */\n  const [abiMethodName, setABIMethodName] = useState<string>('');\n  const [daoState, setDaoState] = useState<DaoState>();\n  const [isDone, setIsDone] = useState<Record<string, boolean> | undefined>();\n  const [inputParameters, setInputParameters] = useState<Record<string, any>>();\n  const [submitError, setSubmitError] = useState<Error>();\n  const [openConfigureModal, setOpenConfigureModal] = useState<boolean>(false);\n  const [openFinalizeModal, setOpenFinalizeModal] = useState<boolean>(false);\n  const [selectAll, setSelectAll] = useState<boolean>(false);\n  const [selectionCount, setSelectionCount] = useState<number>(0);\n  const [selections, setSelections] = useState<\n    Record<string, boolean> | undefined\n  >();\n  const [configureAdapterOrExtension, setConfigureAdapterOrExtension] =\n    useState<AdaptersOrExtensions | undefined>();\n  const [isInProcess, setIsInProcess] = useState<\n    Record<string, boolean> | undefined\n  >();\n  const [whyDisabledReason, setWhyDisabledReason] = useState<\n    WhyDisableModalTitles | undefined\n  >();\n\n  /**\n   * Hooks\n   */\n  const {defaultChainError} = useIsDefaultChain();\n  const {connected, account, web3Instance} = useWeb3Modal();\n  const {dao, gqlError} = useDao();\n  const {\n    adapterExtensionStatus,\n    getAdapterOrExtensionFromRedux,\n    registeredAdaptersOrExtensions,\n    unRegisteredAdaptersOrExtensions,\n  } = useAdaptersOrExtensions();\n  const {initAdapterExtensionContract} = useInitAdapterExtensionContracts();\n\n  const {txSend} = useContractSend();\n  const {fast: fastGasPrice} = useETHGasPrice();\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    setOtherDisabledReasons,\n    WhyDisabledModal,\n  } = useMemberActionDisabled();\n\n  /**\n   * Variables\n   */\n  const isConnected = connected && account;\n  const isDAOExisting: Record<string, any> | undefined = dao;\n  const isDAOReady: boolean = daoState === DaoState.READY;\n  const isUnavailable: boolean =\n    adapterExtensionStatus === AsyncStatus.REJECTED &&\n    registeredAdaptersOrExtensions === undefined &&\n    unRegisteredAdaptersOrExtensions === undefined;\n  const isLoading: boolean = adapterExtensionStatus === AsyncStatus.PENDING;\n  const nothingToAdd = unRegisteredAdaptersOrExtensions?.length === 0;\n  // @todo track the prior selection of a dropdown target\n  // let priorSelectedTargetOption: DaoAdapterConstants | null = null;\n\n  /**\n   * Cached callbacks\n   */\n  const checkDaoStateCached = useCallback(checkDaoState, [\n    DaoRegistryContract,\n    dao?.name,\n    setOtherDisabledReasons,\n  ]);\n\n  /**\n   * Effects\n   */\n  // Check the Dao state\n  useEffect(() => {\n    checkDaoStateCached();\n  }, [checkDaoStateCached, DaoRegistryContract]);\n\n  useEffect(() => {\n    // Set the select all check to false by default\n    setSelectAll(false);\n\n    if (!unRegisteredAdaptersOrExtensions) return;\n\n    /**\n     * @note Select all functionality is for adding adapters only.\n     * Extensions must be added separately.\n     *\n     * Sets the initial checkbox selections for non-registered adapters to `false`\n     * and sets the `Select All` checkbox to disabled if no adapters are available\n     */\n    unRegisteredAdaptersOrExtensions &&\n      unRegisteredAdaptersOrExtensions?.forEach(\n        (adapterOrExtension: Record<string, any>) => {\n          // only add a selection if it doesn't have nested `options`\n          // and if it's not an extension\n          !adapterOrExtension?.options &&\n            !adapterOrExtension.isExtension &&\n            setSelections((prevState: Record<string, boolean> | undefined) => ({\n              ...prevState,\n              [adapterOrExtension.name]: false,\n            }));\n        }\n      );\n  }, [isDisabled, unRegisteredAdaptersOrExtensions]);\n\n  // Updates checkbox selection counter when user selects a checkbox\n  useEffect(() => {\n    selections &&\n      setSelectionCount(\n        Object.values(selections).filter((adapter: boolean) => adapter === true)\n          .length\n      );\n  }, [selections]);\n\n  /**\n   * Functions\n   */\n  async function checkDaoState() {\n    if (!DaoRegistryContract) {\n      return;\n    }\n\n    try {\n      const finalizedMessage = `${dao?.name} is already finalized`;\n\n      const daoRegistryState = await getDaoState(DaoRegistryContract.instance);\n      setDaoState(daoRegistryState);\n\n      daoRegistryState === DaoState.READY &&\n        setOtherDisabledReasons([finalizedMessage]);\n    } catch (error) {\n      setDaoState(undefined);\n    }\n  }\n\n  /**\n   * handleAddAdapter\n   *\n   * Handles adding an `adapter`\n   *\n   * @param adapter\n   */\n  function handleAddAdapter(adapter: Record<string, any>): void {\n    const adapterOrExtensionAddress = new Promise<any>((resolve, reject) => {\n      try {\n        // Get contract address\n        const {contractAddress} = getAdapterOrExtensionFromRedux(\n          adapter.name as DaoAdapterConstants\n        );\n\n        resolve(contractAddress);\n      } catch (error) {\n        // try and get the default contract address from the arg `adapter`\n        const contractAddress = adapter.contractAddress;\n\n        if (contractAddress) {\n          resolve(contractAddress);\n        } else {\n          reject(error);\n        }\n      }\n    });\n\n    adapterOrExtensionAddress\n      .then((contractAddress: string) => {\n        addAdapterOrExtension(contractAddress, adapter.name, 'ADAPTER');\n      })\n      .catch((error) => {\n        console.warn(\n          `Dao adapter contract not found, try adding the default \"${adapter.name}\" contract`\n        );\n      });\n  }\n\n  /**\n   * handleAddExtension\n   *\n   * Handle adding an `extension`\n   * @param extension\n   */\n  function handleAddExtension(extension: any): void {\n    const adapterOrExtensionAddress = new Promise<any>((resolve, reject) => {\n      try {\n        // Get contract address\n        const {contractAddress} = getAdapterOrExtensionFromRedux(\n          extension.name as DaoExtensionConstants\n        );\n\n        resolve(contractAddress);\n      } catch (error) {\n        // try and get the default contract address\n        // from the arg `adapter` or  `extension`\n        const contractAddress = extension.contractAddress;\n\n        if (contractAddress) {\n          resolve(contractAddress);\n        } else {\n          reject(error);\n        }\n      }\n    });\n\n    adapterOrExtensionAddress\n      .then((contractAddress: string) => {\n        addAdapterOrExtension(contractAddress, extension.name, 'EXTENSION');\n      })\n      .catch((error) => {\n        console.warn(\n          `Dao extension contract not found, try adding the default \"${extension.name}\" contract`,\n          error\n        );\n      });\n  }\n\n  async function addAdapterOrExtension(\n    adapterOrExtensionAddress: string,\n    adapterOrExtensionName: DaoAdapterConstants | DaoExtensionConstants,\n    adapterOrExtensionType: 'ADAPTER' | 'EXTENSION'\n  ): Promise<void> {\n    setSubmitError(undefined);\n\n    if (!DaoRegistryContract) {\n      throw new Error('No DAO Registry contract was found.');\n    }\n\n    if (!web3Instance) {\n      throw new Error('No Web3 instance was found.');\n    }\n\n    try {\n      setIsInProcess((prevState) => ({\n        ...prevState,\n        [adapterOrExtensionName]: true,\n      }));\n\n      if (!adapterOrExtensionAddress) {\n        throw new Error(`${adapterOrExtensionType} address must not be empty`);\n      }\n\n      // 1. Get the bytes32 hash of the adapter name\n      const adapterOrExtensionId = getAdapterOrExtensionId(\n        adapterOrExtensionName\n      );\n\n      // 2. Get adapters access control layer (acl)\n      // these are the functions the adapter will have access to\n      const {acl} = getAccessControlLayer(adapterOrExtensionName);\n\n      // 3. Contract the function arguments base of its type\n      const addAdapterOrExtensionArguments:\n        | AddAdapterArguments\n        | AddExtensionArguments =\n        adapterOrExtensionType === 'ADAPTER'\n          ? ([\n              adapterOrExtensionId,\n              adapterOrExtensionAddress,\n              acl,\n              [],\n              [],\n            ] as AddAdapterArguments)\n          : ([\n              adapterOrExtensionId,\n              adapterOrExtensionAddress,\n              account,\n            ] as AddExtensionArguments);\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      const txSendMethod =\n        adapterOrExtensionType === 'ADAPTER'\n          ? 'replaceAdapter'\n          : 'addExtension';\n\n      // Execute contract call for `addAdapter` or `addExtension`\n      await txSend(\n        txSendMethod,\n        DaoRegistryContract.instance.methods,\n        addAdapterOrExtensionArguments,\n        txArguments\n      );\n\n      setIsInProcess((prevState) => ({\n        ...prevState,\n        [adapterOrExtensionName]: false,\n      }));\n      setIsDone((prevState) => ({\n        ...prevState,\n        [adapterOrExtensionName]: true,\n      }));\n\n      // init adapter/extension contracts\n      initAdapterExtensionContract(adapterOrExtensionName, web3Instance);\n    } catch (error) {\n      setIsInProcess((prevState) => ({\n        ...prevState,\n        [adapterOrExtensionName]: false,\n      }));\n\n      const errorMessage = new Error(\n        error && error?.code === 4001\n          ? error.message\n          : `Unable to add ${adapterOrExtensionName} ${adapterOrExtensionType}; ${error}`\n      );\n      setSubmitError(errorMessage);\n    }\n  }\n\n  /**\n   * handleAddSelectedAdapters()\n   *\n   * This function only adds adapters, not extensions\n   */\n  async function handleAddSelectedAdapters(): Promise<void> {\n    setSubmitError(undefined);\n\n    if (!DaoFactoryContract) {\n      throw new Error('DaoFactoryContract not found');\n    }\n\n    if (!web3Instance) {\n      throw new Error('No Web3 instance was found.');\n    }\n\n    try {\n      let adaptersArguments: AddAdaptersArguments[] = [];\n\n      // Set the `Add` button states to true for all selected adapters\n      for (const adapterName in selections) {\n        if (selections[adapterName]) {\n          // Get adapterOrExtensionId from `defaultAdaptersAndExtensions`\n          const {adapterId, contractAddress}: AdaptersAndExtensionsType =\n            defaultAdaptersAndExtensions.filter(\n              (a: AdaptersAndExtensionsType) => a.name === adapterName\n            )[0];\n\n          let adapterContractAddress = contractAddress;\n\n          if (!adapterContractAddress) {\n            // Get adapter contract address from redux\n            let contractAddressFromRedux = getAdapterOrExtensionFromRedux(\n              adapterName as DaoAdapterConstants\n            );\n\n            adapterContractAddress = contractAddressFromRedux?.contractAddress;\n          }\n\n          // Get adapters access control layer (acl)\n          // these are the functions the adapter will have access to\n          const {acl} = getAccessControlLayer(adapterName);\n\n          // skip if `adapterId` or `adapterContractAddress` are undefined\n          if (adapterId && adapterContractAddress) {\n            adaptersArguments.push([\n              adapterId,\n              adapterContractAddress,\n              acl,\n            ] as AddAdaptersArguments);\n\n            setIsInProcess((prevState) => ({\n              ...prevState,\n              [adapterName]: true,\n            }));\n          }\n        }\n      }\n\n      const addAdaptersArguments: [string, AddAdaptersArguments[]] = [\n        dao?.daoAddress,\n        adaptersArguments,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      // Execute contract call for `addAdapters`\n      await txSend(\n        'addAdapters',\n        DaoFactoryContract.instance.methods,\n        addAdaptersArguments,\n        txArguments\n      );\n\n      // init adapter contracts to the store for all added adapters\n      for (const adapterName in selections) {\n        if (selections[adapterName]) {\n          adapterName &&\n            initAdapterExtensionContract(\n              adapterName as DaoAdapterConstants,\n              web3Instance\n            );\n        }\n      }\n    } catch (error) {\n      const errorMessage = new Error(\n        error && error?.code === 4001\n          ? error.message\n          : `Unable to add adapters; ${error}`\n      );\n      setSubmitError(errorMessage);\n\n      // reset all the checkboxes for the selected adapters\n      checkboxesSelection(false);\n      // reset all the buttons for the selected adapters\n      for (const adapterName in selections) {\n        setIsInProcess((prevState) => ({\n          ...prevState,\n          [adapterName]: false,\n        }));\n      }\n    }\n  }\n\n  /**\n   * configureAdapter\n   *\n   * @param adapter\n   */\n  async function handleConfigure(\n    adapterOrExtension: AdaptersOrExtensions\n  ): Promise<void> {\n    setSubmitError(undefined);\n\n    try {\n      const {abiFunctionName, name} = adapterOrExtension;\n\n      if (!abiFunctionName) {\n        throw new Error(`ABI function not found for ${name}`);\n      }\n\n      // Get adapters/extension ABI\n      const {abi} = getAdapterOrExtensionFromRedux(name);\n      // Get adapters/extension configure function input parameters\n      const {inputs} = abi.filter(\n        (p: Record<string, any>) => p.name === abiFunctionName\n      )[0];\n\n      setABIMethodName(abiFunctionName);\n      setConfigureAdapterOrExtension(adapterOrExtension);\n      setInputParameters(inputs);\n      setOpenConfigureModal(true);\n    } catch (error) {\n      const errorMessage = new Error(\n        error && error?.code === 4001\n          ? error.message\n          : `${adapterOrExtension.name} contract not found`\n      );\n      setSubmitError(errorMessage);\n    }\n  }\n\n  // Handles the select all checkbox event\n  function handleOnChange(event: React.ChangeEvent<HTMLInputElement>): void {\n    checkboxesSelection(event.target.checked);\n  }\n\n  function checkboxesSelection(checked: boolean): void {\n    // Update the select all checkbox\n    setSelectAll(checked);\n\n    // Update all un-registered adapters only\n    for (const key in selections) {\n      setSelections((s) => ({\n        ...s,\n        [key]: checked,\n      }));\n    }\n  }\n\n  function handleSelectTargetChange({event, selectedTargetOption}: any): void {\n    // @todo Remove previously selected target if its from an `options` list\n    // update the prior selected target to track the change\n    // so we can remove the old target from checkbox `selections`\n\n    setSelections((s) => ({\n      ...s,\n      [selectedTargetOption]: event.target.checked,\n    }));\n  }\n\n  function renderDaoName() {\n    if (!dao && gqlError) {\n      window.scrollTo({\n        top: 0,\n        left: 200,\n        behavior: 'smooth',\n      });\n\n      return (\n        <ErrorMessageWithDetails\n          error={gqlError}\n          renderText=\"Something went wrong\"\n        />\n      );\n    }\n\n    if (dao) {\n      return (\n        <h3>\n          {dao.name} <small>{truncateEthAddress(dao.daoAddress, 7)}</small>\n        </h3>\n      );\n    }\n  }\n\n  function renderErrorMessage() {\n    if (submitError) {\n      window.scrollTo({\n        top: 0,\n        left: 200,\n        behavior: 'smooth',\n      });\n\n      return (\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n      );\n    } else {\n      return <></>;\n    }\n  }\n\n  function getUnauthorizedMessage() {\n    // user is not connected\n    if (!isConnected) {\n      return 'Connect your wallet to manage the DAO adapters and extensions.';\n    }\n\n    // user is on wrong network\n    if (defaultChainError) {\n      return defaultChainError.message;\n    }\n\n    // user is not an active member\n    if (!isActiveMember) {\n      return 'Either you are not a member, or your membership is not active.';\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || !isActiveMember || defaultChainError) {\n    return (\n      <RenderWrapper>\n        <div className=\"adapter-extension__unauthorized-message\">\n          <p>{getUnauthorizedMessage()}</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  /* @todo\n   * disable when selection is processing\n   * disable when there are no more unused adapters to select\n   */\n  return (\n    <RenderWrapper>\n      <div className=\"adaptermanager\">\n        {renderDaoName()}\n        {renderErrorMessage()}\n        <div className=\"adapter-extension__selection\">\n          <div>\n            <Checkbox\n              data-testid=\"selectall\"\n              role=\"checkbox\"\n              id=\"selectall\"\n              label={`${selectionCount} selected`}\n              checked={selectAll === true}\n              disabled={\n                isDisabled || // connected user is not an active member\n                isUnavailable ||\n                nothingToAdd || // nothing left to register\n                !isDAOExisting\n              }\n              name=\"selectall\"\n              size={CheckboxSize.LARGE}\n              onChange={handleOnChange}\n            />\n          </div>\n          <div>\n            <button\n              className=\"button--secondary\"\n              disabled={selectionCount === 0 || isDisabled}\n              onClick={handleAddSelectedAdapters}>\n              Add selected\n            </button>\n          </div>\n        </div>\n\n        {isLoading && (\n          <div className=\"adapter-extension__loader\">\n            <Loader text=\"Loading data from subgraph...\" />\n          </div>\n        )}\n        {isUnavailable && <p>No adapters/extensions available</p>}\n\n        {/** UNUSED ADAPTERS AND EXTENSIONS TO ADD */}\n        {isDAOExisting &&\n          unRegisteredAdaptersOrExtensions &&\n          unRegisteredAdaptersOrExtensions?.length > 0 &&\n          unRegisteredAdaptersOrExtensions.map(\n            (adapterOrExtension: Record<string, any>, idx: number) => (\n              <div className=\"adapter-extension__grid unregistered\" key={idx}>\n                {/** RENDER ADAPTER/EXTENSION DROPDOWN */}\n                {adapterOrExtension?.options ? (\n                  <AdapterExtensionSelectTarget\n                    adapterOrExtension={adapterOrExtension}\n                    renderCheckboxAction={({selectedTargetOption}) => {\n                      return (\n                        <>\n                          <div className=\"adapter-extension__checkbox\">\n                            <Checkbox\n                              id={selectedTargetOption || 'empty'}\n                              label={''}\n                              checked={\n                                (selectedTargetOption &&\n                                  selections &&\n                                  selections[selectedTargetOption] === true) ||\n                                false\n                              }\n                              disabled={\n                                isDisabled ||\n                                selectedTargetOption === null ||\n                                adapterOrExtension?.isExtension\n                              }\n                              name={selectedTargetOption || ''}\n                              size={CheckboxSize.LARGE}\n                              onChange={(event) => {\n                                selectedTargetOption &&\n                                  handleSelectTargetChange({\n                                    event,\n                                    selectedTargetOption,\n                                  });\n                              }}\n                            />\n                          </div>\n                        </>\n                      );\n                    }}\n                    renderActions={({\n                      selectedTargetOption,\n                      selectedTargetOptionProps,\n                    }) => {\n                      return (\n                        <>\n                          <div className=\"adapter-extension__add\">\n                            <button\n                              className=\"button--secondary\"\n                              disabled={\n                                selectedTargetOption === null ||\n                                (isInProcess &&\n                                  isInProcess[\n                                    selectedTargetOptionProps.name\n                                  ]) ||\n                                isDisabled\n                              }\n                              onClick={() =>\n                                selectedTargetOptionProps?.isExtension\n                                  ? handleAddExtension(\n                                      selectedTargetOptionProps\n                                    )\n                                  : handleAddAdapter(selectedTargetOptionProps)\n                              }>\n                              {isInProcess &&\n                              isInProcess[selectedTargetOptionProps.name] ? (\n                                <Loader />\n                              ) : isDone &&\n                                isDone[selectedTargetOptionProps.name] ? (\n                                'Done'\n                              ) : (\n                                'Add'\n                              )}\n                            </button>\n                          </div>\n                        </>\n                      );\n                    }}\n                  />\n                ) : (\n                  <>\n                    {/** RENDER ADAPTER/EXTENSION */}\n                    <div className=\"adapter-extension__inner-wrapper \">\n                      <div className=\"adapter-extension__checkbox\">\n                        {!adapterOrExtension?.isExtension && (\n                          <Checkbox\n                            id={adapterOrExtension.name}\n                            label={''}\n                            checked={\n                              (selections &&\n                                selections[adapterOrExtension.name] === true) ||\n                              false\n                            }\n                            disabled={isDisabled}\n                            name={adapterOrExtension.name}\n                            size={CheckboxSize.LARGE}\n                            onChange={(event) => {\n                              setSelections((s) => ({\n                                ...s,\n                                [adapterOrExtension.name]: event.target.checked,\n                              }));\n                            }}\n                          />\n                        )}\n                      </div>\n\n                      <div className=\"adapter-extension__info\">\n                        <span className=\"adapter-extension__name\">\n                          {adapterOrExtension.name}{' '}\n                          {adapterOrExtension?.isExtension && '(EXTENSION)'}\n                        </span>\n                        <span className=\"adapter-extension__desc\">\n                          {adapterOrExtension.description}\n                        </span>\n                      </div>\n                    </div>\n\n                    <div className=\"adapter-extension__add\">\n                      <button\n                        className=\"button--secondary\"\n                        disabled={\n                          (isInProcess &&\n                            isInProcess[adapterOrExtension.name]) ||\n                          (isDone && isDone[adapterOrExtension.name]) ||\n                          isDisabled\n                        }\n                        onClick={() =>\n                          adapterOrExtension?.isExtension\n                            ? handleAddExtension(adapterOrExtension)\n                            : handleAddAdapter(adapterOrExtension)\n                        }>\n                        {isInProcess && isInProcess[adapterOrExtension.name] ? (\n                          <Loader />\n                        ) : isDone && isDone[adapterOrExtension.name] ? (\n                          'Done'\n                        ) : (\n                          'Add'\n                        )}\n                      </button>\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          )}\n\n        {/** USED ADAPTERS/EXTENSIONS TO CONFIGURE OR REMOVE */}\n        {isDAOExisting &&\n          registeredAdaptersOrExtensions &&\n          registeredAdaptersOrExtensions?.length > 0 &&\n          registeredAdaptersOrExtensions.map(\n            (adapterOrExtension: Record<string, any>, idx: number) => (\n              <div\n                className=\"adapter-extension__grid registered\"\n                key={`${adapterOrExtension.id}-${idx}`}>\n                <div className=\"adapter-extension__info\">\n                  <span className=\"adapter-extension__name\">\n                    {adapterOrExtension.name}{' '}\n                    {adapterOrExtension?.isExtension && '(EXTENSION)'}\n                  </span>\n                  <span className=\"adapter-extension__desc\">\n                    {adapterOrExtension.description}\n                  </span>\n                </div>\n\n                <div className=\"adapter-extension__configure\">\n                  <button\n                    className=\"button--secondary\"\n                    disabled={isDisabled || adapterOrExtension?.isExtension}\n                    onClick={() =>\n                      handleConfigure(\n                        adapterOrExtension as AdaptersOrExtensions\n                      )\n                    }>\n                    Configure\n                  </button>\n                </div>\n              </div>\n            )\n          )}\n\n        {isDisabled && (\n          <div>\n            <button\n              className=\"button--help\"\n              onClick={() => {\n                openWhyDisabledModal();\n                setWhyDisabledReason(\n                  WhyDisableModalTitles.CONFIGURATION_REASON\n                );\n              }}>\n              {WhyDisableModalTitles.CONFIGURATION_REASON}\n            </button>\n          </div>\n        )}\n\n        <div className=\"adapter-adapter-extension__finalize\">\n          <p>\n            If you're happy with your setup, you can finalize your DAO. After\n            your DAO is finalized you will need to submit a proposal to make\n            changes.\n          </p>\n          <div>\n            <button\n              data-testid=\"finalizedao\"\n              className=\"button--secondary finalize\"\n              disabled={\n                isUnavailable || !isDAOExisting || isDAOReady\n                /* @todo \n              - also disable when selection is processing \n              - when there are no more unused adapters to select\n              */\n              }\n              onClick={() => setOpenFinalizeModal(true)}>\n              Finalize Dao\n            </button>\n          </div>\n\n          {isDisabled && (\n            <div>\n              <button\n                className=\"button--help\"\n                onClick={() => {\n                  openWhyDisabledModal();\n\n                  setWhyDisabledReason(WhyDisableModalTitles.FINALIZED_REASON);\n                }}>\n                {WhyDisableModalTitles.FINALIZED_REASON}\n              </button>\n            </div>\n          )}\n\n          <WhyDisabledModal title={whyDisabledReason} />\n        </div>\n\n        {openConfigureModal && (\n          <ConfigurationModal\n            abiMethodName={abiMethodName}\n            adapterOrExtension={configureAdapterOrExtension}\n            configurationInputs={inputParameters}\n            isOpen={openConfigureModal}\n            closeHandler={() => {\n              setOpenConfigureModal(false);\n            }}\n          />\n        )}\n\n        {openFinalizeModal && (\n          <FinalizeModal\n            isOpen={openFinalizeModal}\n            closeHandler={() => {\n              setOpenFinalizeModal(false);\n\n              // check the state of the dao\n              checkDaoStateCached();\n            }}\n          />\n        )}\n      </div>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Adapter/Extension Manager</h2>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React, {ReactNode} from 'react';\n\ninterface WrapProps {\n  children: ReactNode;\n  className?: string;\n}\n\nconst Wrap = ({\n  children,\n  ...rest\n}: WrapProps & React.HTMLAttributes<HTMLDivElement>) => (\n  <div style={{position: 'relative'}} {...rest}>\n    {children}\n  </div>\n);\n\nexport default Wrap;\n","import {useDispatch} from 'react-redux';\nimport Web3 from 'web3';\n\nimport {\n  initContractBankAdapter,\n  initContractConfiguration,\n  initContractCouponOnboarding,\n  initContractDaoRegistryAdapter,\n  initContractDistribute,\n  initContractERC20Extension,\n  initContractFinancing,\n  initContractGuildKick,\n  initContractManaging,\n  initContractNFTAdapter,\n  initContractNFTExtension,\n  initContractOnboarding,\n  initContractRagequit,\n  initContractTribute,\n  initContractTributeNFT,\n  initRegisteredVotingAdapter,\n} from '../../../store/actions';\n\nimport {DaoAdapterConstants, DaoExtensionConstants} from '../enums';\nimport {ReduxDispatch} from '../../../store/types';\n\ntype UseInitAdapterExtensionContractsReturn = {\n  initAdapterExtensionContract: (\n    adapterExtensionName: DaoAdapterConstants | DaoExtensionConstants,\n    web3Instance: Web3\n  ) => void;\n};\n\nexport function useInitAdapterExtensionContracts(): UseInitAdapterExtensionContractsReturn {\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Functions\n   */\n\n  async function initAdapterExtensionContract(\n    adapterExtensionName: DaoAdapterConstants | DaoExtensionConstants,\n    web3Instance: Web3\n  ) {\n    switch (adapterExtensionName) {\n      case DaoAdapterConstants.CONFIGURATION:\n        await dispatch(initContractConfiguration(web3Instance));\n        break;\n      case DaoAdapterConstants.FINANCING:\n        await dispatch(initContractFinancing(web3Instance));\n        break;\n      case DaoAdapterConstants.GUILDKICK:\n        await dispatch(initContractGuildKick(web3Instance));\n        break;\n      case DaoAdapterConstants.MANAGING:\n        await dispatch(initContractManaging(web3Instance));\n        break;\n      case DaoAdapterConstants.RAGEQUIT:\n        await dispatch(initContractRagequit(web3Instance));\n        break;\n      case DaoAdapterConstants.BANK:\n        await dispatch(initContractBankAdapter(web3Instance));\n        break;\n      case DaoExtensionConstants.NFT:\n        await dispatch(initContractNFTExtension(web3Instance));\n        break;\n      case DaoAdapterConstants.ONBOARDING:\n        await dispatch(initContractOnboarding(web3Instance));\n        break;\n      case DaoAdapterConstants.TRIBUTE:\n        await dispatch(initContractTribute(web3Instance));\n        break;\n      case DaoAdapterConstants.DISTRIBUTE:\n        await dispatch(initContractDistribute(web3Instance));\n        break;\n      case DaoAdapterConstants.VOTING:\n        await dispatch(initRegisteredVotingAdapter(web3Instance));\n        break;\n      case DaoAdapterConstants.COUPON_ONBOARDING:\n        await dispatch(initContractCouponOnboarding(web3Instance));\n        break;\n      case DaoAdapterConstants.TRIBUTE_NFT:\n        await dispatch(initContractTributeNFT(web3Instance));\n        break;\n      case DaoAdapterConstants.NFT:\n        await dispatch(initContractNFTAdapter(web3Instance));\n        break;\n      case DaoAdapterConstants.DAO_REGISTRY:\n        await dispatch(initContractDaoRegistryAdapter(web3Instance));\n        break;\n      case DaoExtensionConstants.ERC20:\n        await dispatch(initContractERC20Extension(web3Instance));\n        break;\n    }\n  }\n\n  return {\n    initAdapterExtensionContract,\n  };\n}\n","import React, {useState} from 'react';\nimport {useForm} from 'react-hook-form';\nimport {useHistory} from 'react-router';\nimport {useSelector} from 'react-redux';\nimport {SnapshotType} from '@openlaw/snapshot-js-erc712';\n\nimport {CycleEllipsis} from '../../components/feedback';\nimport {FormFieldErrors} from '../../util/enums';\nimport {getValidationError} from '../../util/helpers';\nimport {SnapshotMetadataType} from '../../components/proposals/types';\nimport {StoreState} from '../../store/types';\nimport {useSignAndSubmitProposal} from '../../components/proposals/hooks';\nimport {useWeb3Modal, useIsDefaultChain} from '../../components/web3/hooks';\nimport {Web3TxStatus} from '../../components/web3/types';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport Loader from '../../components/feedback/Loader';\nimport PreviewInputMarkdown from '../../components/common/PreviewInputMarkdown';\nimport Wrap from '../../components/common/Wrap';\n\nenum Fields {\n  title = 'title',\n  description = 'description',\n}\n\ntype FormInputs = {\n  title: string;\n  description: string;\n};\n\nexport default function CreateGovernanceProposal() {\n  /**\n   * Selectors\n   */\n\n  const isActiveMember = useSelector(\n    (s: StoreState) => s.connectedMember?.isActiveMember\n  );\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Our hooks\n   */\n\n  const {connected, account} = useWeb3Modal();\n  const {proposalSignAndSendStatus, signAndSendProposal} =\n    useSignAndSubmitProposal<SnapshotType.proposal>();\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n  const history = useHistory();\n\n  /**\n   * Variables\n   */\n\n  const {errors, getValues, register, trigger, watch} = form;\n  const isConnected = connected && account;\n  const isInProcess =\n    proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === Web3TxStatus.PENDING;\n\n  const isDone = proposalSignAndSendStatus === Web3TxStatus.FULFILLED;\n  const isInProcessOrDone = isInProcess || isDone;\n\n  /**\n   * Functions\n   */\n\n  function getUnauthorizedMessage() {\n    // user is not connected\n    if (!isConnected) {\n      return 'Connect your wallet to submit a governance proposal.';\n    }\n\n    // user is on wrong network\n    if (defaultChainError) {\n      return defaultChainError.message;\n    }\n\n    // user is not an active member\n    if (!isActiveMember) {\n      return 'Either you are not a member, or your membership is not active.';\n    }\n  }\n\n  async function handleSubmit(values: FormInputs) {\n    try {\n      // Sign and submit proposal for Snapshot Hub\n      const {uniqueId} = await signAndSendProposal({\n        partialProposalData: {\n          name: values.title,\n          body: values.description,\n          metadata: {\n            type: SnapshotMetadataType.Governance,\n          },\n        },\n        type: SnapshotType.proposal,\n      });\n\n      // Go to newly creatd governance proposal's page\n      history.push(`/governance/${uniqueId}`);\n    } catch (error) {\n      setSubmitError(error);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    switch (proposalSignAndSendStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Awaiting your confirmation\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            Submitting\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return 'Done!';\n      default:\n        return '';\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || !isActiveMember || defaultChainError) {\n    return (\n      <RenderWrapper>\n        <div className=\"form__description--unauthorized\">\n          <p>{getUnauthorizedMessage()}</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n        {/* PROPOSAL TITLE */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\" htmlFor={Fields.title}>\n            Title\n          </label>\n          <div className=\"form__input-row-fieldwrap\">\n            <input\n              aria-describedby={`error-${Fields.title}`}\n              aria-invalid={errors.title ? 'true' : 'false'}\n              id={Fields.title}\n              name={Fields.title}\n              ref={register({\n                required: FormFieldErrors.REQUIRED,\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.title, errors)}\n              id={`error-${Fields.title}`}\n            />\n          </div>\n        </div>\n\n        {/* PROPOSAL DESCRIPTION */}\n        <div className=\"form__textarea-row\">\n          <label className=\"form__input-row-label\" htmlFor={Fields.description}>\n            Description\n          </label>\n          <div className=\"form__input-row-fieldwrap\">\n            <textarea\n              aria-describedby={`error-${Fields.description}`}\n              aria-invalid={errors.description ? 'true' : 'false'}\n              id={Fields.description}\n              name={Fields.description}\n              placeholder=\"Say something about your governance proposal...\"\n              ref={register({\n                required: FormFieldErrors.REQUIRED,\n              })}\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.description, errors)}\n              id={`error-${Fields.description}`}\n            />\n\n            <PreviewInputMarkdown value={watch(Fields.description)} />\n          </div>\n        </div>\n\n        {/* SUBMIT */}\n        <button\n          aria-label={isInProcess ? 'Submitting your proposal...' : ''}\n          className=\"button\"\n          disabled={isInProcessOrDone}\n          onClick={async () => {\n            if (isInProcessOrDone) return;\n\n            if (!(await trigger())) {\n              return;\n            }\n\n            handleSubmit(getValues());\n          }}\n          type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {submitError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while submitting the proposal.\"\n              error={submitError}\n            />\n          </div>\n        )}\n      </form>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Governance Proposal</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          <div className=\"form__description\"></div>\n\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import Markdown from 'markdown-to-jsx';\n\ntype PreviewInputMarkdownProps = {\n  value: string;\n};\n\nexport default function PreviewInputMarkdown(props: PreviewInputMarkdownProps) {\n  const {value} = props;\n\n  if (!value) return null;\n\n  return (\n    <details>\n      <summary style={{cursor: 'pointer', outline: 'none'}}>\n        <small>Preview Markdown</small>\n      </summary>\n\n      <div style={{marginTop: '1em'}}>\n        <Markdown>{value}</Markdown>\n      </div>\n    </details>\n  );\n}\n","import React, {useState, useCallback, useEffect} from 'react';\nimport {SnapshotType} from '@openlaw/snapshot-js-erc712';\nimport {useForm} from 'react-hook-form';\nimport {toWei, toChecksumAddress} from 'web3-utils';\nimport {useHistory} from 'react-router-dom';\n\nimport {\n  getValidationError,\n  stripFormatNumber,\n  formatNumber,\n  formatDecimal,\n  truncateEthAddress,\n  normalizeString,\n} from '../../util/helpers';\nimport {useIsDefaultChain, useWeb3Modal} from '../../components/web3/hooks';\nimport {ContractAdapterNames, Web3TxStatus} from '../../components/web3/types';\nimport {FormFieldErrors} from '../../util/enums';\nimport {isEthAddressValid} from '../../util/validation';\nimport {AsyncStatus} from '../../util/types';\nimport {UNITS_ADDRESS} from '../../config';\nimport {CycleEllipsis} from '../../components/feedback';\nimport {\n  useCheckApplicant,\n  useSignAndSubmitProposal,\n} from '../../components/proposals/hooks';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport Loader from '../../components/feedback/Loader';\nimport Wrap from '../../components/common/Wrap';\n\nenum Fields {\n  ethAddress = 'ethAddress',\n  ethAmount = 'ethAmount',\n}\n\ntype FormInputs = {\n  ethAddress: string;\n  ethAmount: string;\n};\n\ntype SubmitActionArguments = [\n  string, // `applicant`\n  string, // `tokenToMint`\n  string // `tokenAmount`\n];\n\nexport default function CreateMembershipProposal() {\n  /**\n   * Our hooks\n   */\n\n  const {defaultChainError} = useIsDefaultChain();\n  const {connected, account, web3Instance} = useWeb3Modal();\n  const {\n    proposalData,\n    proposalSignAndSendError,\n    proposalSignAndSendStatus,\n    signAndSendProposal,\n  } = useSignAndSubmitProposal<SnapshotType.draft>();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n  const history = useHistory();\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n  const [userAccountBalance, setUserAccountBalance] = useState<string>();\n\n  /**\n   * Variables\n   */\n\n  const {errors, getValues, setValue, register, trigger, watch} = form;\n\n  const ethAddressValue = watch(Fields.ethAddress);\n\n  const createMemberError = submitError || proposalSignAndSendError;\n  const isConnected = connected && account;\n\n  const isInProcess =\n    proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === Web3TxStatus.PENDING;\n\n  const isDone = proposalSignAndSendStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone;\n\n  const {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  } = useCheckApplicant(ethAddressValue);\n\n  /**\n   * Cached callbacks\n   */\n\n  const getUserAccountBalanceCached = useCallback(getUserAccountBalance, [\n    account,\n    web3Instance,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getUserAccountBalanceCached();\n  }, [getUserAccountBalanceCached]);\n\n  // Set the value of `ethAddress` if the `account` changes\n  useEffect(() => {\n    setValue(Fields.ethAddress, account);\n  }, [account, setValue]);\n\n  /**\n   * Functions\n   */\n\n  async function getUserAccountBalance() {\n    if (!web3Instance || !account) {\n      setUserAccountBalance(undefined);\n      return;\n    }\n\n    try {\n      // Ether wallet balance\n      const accountBalanceInWei = await web3Instance.eth.getBalance(account);\n      setUserAccountBalance(\n        web3Instance.utils.fromWei(accountBalanceInWei, 'ether')\n      );\n    } catch (error) {\n      setUserAccountBalance(undefined);\n    }\n  }\n\n  async function handleSubmit(values: FormInputs) {\n    try {\n      if (!isConnected) {\n        throw new Error(\n          'No user account was found. Please make sure your wallet is connected.'\n        );\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (checkApplicantError) {\n        // Just log the error (don't throw) because it is not a blocker for the\n        // snapshot draft to be submitted. The applicant address validity will\n        // be checked again when the proposal is submitted onchain.\n        console.warn(\n          `Error checking if the applicant address is valid: ${checkApplicantError.message}`\n        );\n      }\n\n      if (\n        checkApplicantStatus === AsyncStatus.FULFILLED &&\n        !isApplicantValid &&\n        checkApplicantInvalidMsg\n      ) {\n        throw new Error(checkApplicantInvalidMsg);\n      }\n\n      // Maybe set proposal ID from previous attempt\n      let proposalId: string = proposalData?.uniqueId || '';\n\n      const {ethAddress, ethAmount} = values;\n      const ethAddressToChecksum = toChecksumAddress(ethAddress);\n      const ethAmountInWei = toWei(stripFormatNumber(ethAmount), 'ether');\n      const proposerAddressToChecksum = toChecksumAddress(account);\n\n      // Values needed to display relevant proposal amounts in the proposal\n      // details page are set in the snapshot draft metadata. (We can no longer\n      // rely on getting this data from onchain because the proposal may not\n      // exist there yet.)\n      const proposalAmountValues = {\n        tributeAmount: ethAmount,\n        tributeAmountUnit: 'ETH',\n      };\n\n      // Arguments needed to submit the proposal onchain are set in the snapshot\n      // draft metadata.\n      const submitActionArgs: SubmitActionArguments = [\n        ethAddressToChecksum,\n        UNITS_ADDRESS,\n        ethAmountInWei,\n      ];\n\n      // Only submit to snapshot if there is not already a proposal ID returned from a previous attempt.\n      if (!proposalId) {\n        const body =\n          normalizeString(ethAddress) === normalizeString(account)\n            ? `Membership for ${truncateEthAddress(ethAddressToChecksum, 7)}.`\n            : `Membership proposal from ${truncateEthAddress(\n                proposerAddressToChecksum,\n                7\n              )} for applicant ${truncateEthAddress(ethAddressToChecksum, 7)}.`;\n\n        // Sign and submit draft for snapshot-hub\n        const {uniqueId} = await signAndSendProposal({\n          partialProposalData: {\n            name: ethAddressToChecksum,\n            body,\n            metadata: {\n              proposalAmountValues,\n              submitActionArgs,\n              accountAuthorizedToProcessPassedProposal:\n                proposerAddressToChecksum,\n            },\n          },\n          adapterName: ContractAdapterNames.onboarding,\n          type: SnapshotType.draft,\n        });\n\n        proposalId = uniqueId;\n      }\n\n      // go to MembershipDetails page for newly created member proposal\n      history.push(`/membership/${proposalId}`);\n    } catch (error) {\n      // Set any errors from Web3 utils or explicitly set above.\n      setSubmitError(error);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    switch (proposalSignAndSendStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Awaiting your confirmation\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            Submitting\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return 'Done!';\n      default:\n        return '';\n    }\n  }\n\n  function renderUserAccountBalance() {\n    if (!userAccountBalance) {\n      return '---';\n    }\n\n    const isBalanceInt = Number.isInteger(Number(userAccountBalance));\n    return isBalanceInt\n      ? userAccountBalance\n      : formatDecimal(Number(userAccountBalance));\n  }\n\n  function getUnauthorizedMessage() {\n    // user is not connected\n    if (!isConnected) {\n      return 'Connect your wallet to submit a membership proposal.';\n    }\n\n    // user is on wrong network\n    if (defaultChainError) {\n      return defaultChainError.message;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || defaultChainError) {\n    return (\n      <RenderWrapper>\n        <div className=\"form__description--unauthorized\">\n          <p>{getUnauthorizedMessage()}</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n        {/* ETH ADDRESS */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\" htmlFor={Fields.ethAddress}>\n            Applicant Address\n          </label>\n          <div className=\"form__input-row-fieldwrap\">\n            {/* @note We don't need the default value as it's handled in the useEffect above. */}\n            <input\n              aria-describedby={`error-${Fields.ethAddress}`}\n              aria-invalid={errors.ethAddress ? 'true' : 'false'}\n              id={Fields.ethAddress}\n              name={Fields.ethAddress}\n              ref={register({\n                validate: (ethAddress: string): string | boolean => {\n                  return !ethAddress\n                    ? FormFieldErrors.REQUIRED\n                    : !isEthAddressValid(ethAddress)\n                    ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                    : true;\n                },\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.ethAddress, errors)}\n              id={`error-${Fields.ethAddress}`}\n            />\n          </div>\n        </div>\n\n        {/* ETH AMOUNT */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\" htmlFor={Fields.ethAmount}>\n            Amount\n          </label>\n          <div className=\"form__input-row-fieldwrap--narrow\">\n            <div className=\"input__suffix-wrap\">\n              <input\n                className=\"input__suffix\"\n                aria-describedby={`error-${Fields.ethAmount}`}\n                aria-invalid={errors.ethAmount ? 'true' : 'false'}\n                id={Fields.ethAmount}\n                name={Fields.ethAmount}\n                onChange={() =>\n                  setValue(\n                    Fields.ethAmount,\n                    formatNumber(getValues().ethAmount)\n                  )\n                }\n                ref={register({\n                  validate: (value: string): string | boolean => {\n                    const amount = Number(stripFormatNumber(value));\n\n                    return value === ''\n                      ? FormFieldErrors.REQUIRED\n                      : isNaN(amount)\n                      ? FormFieldErrors.INVALID_NUMBER\n                      : amount <= 0\n                      ? 'The value must be greater than 0 ETH.'\n                      : amount >= Number(userAccountBalance)\n                      ? 'Insufficient funds.'\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={isInProcessOrDone}\n              />\n              <div className=\"input__suffix-item\">ETH</div>\n            </div>\n\n            <InputError\n              error={getValidationError(Fields.ethAmount, errors)}\n              id={`error-${Fields.ethAmount}`}\n            />\n          </div>\n          <div className=\"form__input-addon\">\n            available: <span>{renderUserAccountBalance()}</span>\n          </div>\n        </div>\n\n        {/* SUBMIT */}\n        <button\n          aria-label={isInProcess ? 'Submitting your proposal.' : ''}\n          className=\"button\"\n          disabled={isInProcessOrDone}\n          onClick={async () => {\n            if (isInProcessOrDone) return;\n\n            if (!(await trigger())) {\n              return;\n            }\n\n            handleSubmit(getValues());\n          }}\n          type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {createMemberError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while submitting the proposal.\"\n              error={createMemberError}\n            />\n          </div>\n        )}\n      </form>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Join</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          <div className=\"form__description\"></div>\n\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React, {useState, useCallback, useEffect} from 'react';\nimport {\n  SnapshotType,\n  SnapshotProposalData,\n  prepareVoteProposalData,\n} from '@openlaw/snapshot-js-erc712';\nimport {useForm} from 'react-hook-form';\nimport {useSelector} from 'react-redux';\nimport {useHistory} from 'react-router-dom';\nimport {toBN, AbiItem, toWei, toChecksumAddress} from 'web3-utils';\n\nimport {ETH_TOKEN_ADDRESS, GUILD_ADDRESS, UNITS_ADDRESS} from '../../config';\nimport {\n  getValidationError,\n  stripFormatNumber,\n  formatNumber,\n  formatDecimal,\n  truncateEthAddress,\n} from '../../util/helpers';\nimport {\n  useContractSend,\n  useETHGasPrice,\n  useIsDefaultChain,\n  useWeb3Modal,\n} from '../../components/web3/hooks';\nimport {ContractAdapterNames, Web3TxStatus} from '../../components/web3/types';\nimport {FormFieldErrors} from '../../util/enums';\nimport {isEthAddressValid} from '../../util/validation';\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../../components/web3/config';\nimport {multicall, MulticallTuple} from '../../components/web3/helpers';\nimport {useSignAndSubmitProposal} from '../../components/proposals/hooks';\nimport CycleMessage from '../../components/feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport Loader from '../../components/feedback/Loader';\nimport Wrap from '../../components/common/Wrap';\nimport EtherscanURL from '../../components/web3/EtherscanURL';\nimport {default as ERC20ABI} from '../../truffle-contracts/ERC20.json';\n\nenum Fields {\n  type = 'type',\n  selectedToken = 'selectedToken',\n  memberAddress = 'memberAddress',\n  amount = 'amount',\n  notes = 'notes',\n}\n\ntype FormInputs = {\n  type: string;\n  selectedToken: string;\n  memberAddress: string;\n  amount: string;\n  notes: string;\n};\n\ntype TransferArguments = [\n  string, // `dao`\n  string, // `proposalId`\n  string, // `unitHolderAddr`\n  string, // `token`\n  string, // `amount`\n  string // `data`\n];\n\ntype InitialTokenDetails = {\n  address: string;\n  daoBalance: string;\n};\n\ntype TokenDetails = InitialTokenDetails & {\n  name: string;\n  symbol: string;\n  decimals: number;\n};\n\nexport default function CreateTransferProposal() {\n  /**\n   * Selectors\n   */\n\n  const DistributeContract = useSelector(\n    (state: StoreState) => state.contracts?.DistributeContract\n  );\n  const DaoRegistryContract = useSelector(\n    (state: StoreState) => state.contracts?.DaoRegistryContract\n  );\n  const BankExtensionContract = useSelector(\n    (state: StoreState) => state.contracts?.BankExtensionContract\n  );\n  const isActiveMember = useSelector(\n    (s: StoreState) => s.connectedMember?.isActiveMember\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {defaultChainError} = useIsDefaultChain();\n  const {connected, account, web3Instance} = useWeb3Modal();\n  const {fast: fastGasPrice} = useETHGasPrice();\n  const {txError, txEtherscanURL, txIsPromptOpen, txSend, txStatus} =\n    useContractSend();\n  const {proposalData, proposalSignAndSendStatus, signAndSendProposal} =\n    useSignAndSubmitProposal<SnapshotType.proposal>();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n  const history = useHistory();\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n  const [daoTokens, setDaoTokens] = useState<TokenDetails[]>();\n  const [selectedTokenBalance, setSelectedTokenBalance] = useState<string>();\n\n  /**\n   * Variables\n   */\n\n  const {errors, getValues, setValue, register, trigger, watch} = form;\n  const typeValue = watch('type');\n  const isTypeAllMembers = typeValue === 'all members';\n  const selectedTokenValue = watch('selectedToken');\n\n  const createTransferError = submitError || txError;\n  const isConnected = connected && account;\n  const erc20ABI: AbiItem[] = ERC20ABI as any;\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING ||\n    proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === Web3TxStatus.PENDING;\n\n  const isDone =\n    txStatus === Web3TxStatus.FULFILLED &&\n    proposalSignAndSendStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n\n  /**\n   * Cached callbacks\n   */\n\n  const getDaoTokensCached = useCallback(getDaoTokens, [\n    BankExtensionContract,\n    account,\n    erc20ABI,\n    web3Instance,\n  ]);\n\n  const getSelectedTokenBalanceCached = useCallback(getSelectedTokenBalance, [\n    account,\n    selectedTokenValue,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getDaoTokensCached();\n  }, [getDaoTokensCached]);\n\n  useEffect(() => {\n    getSelectedTokenBalanceCached();\n  }, [getSelectedTokenBalanceCached]);\n\n  /**\n   * Functions\n   */\n\n  async function getDaoTokens() {\n    if (!account || !BankExtensionContract || !web3Instance) {\n      setDaoTokens(undefined);\n      return;\n    }\n\n    try {\n      const {\n        abi: bankABI,\n        contractAddress: bankAddress,\n        instance: {methods: bankMethods},\n      } = BankExtensionContract;\n\n      const nbTokens = await bankMethods.nbTokens().call();\n\n      if (Number(nbTokens) < 1) {\n        setDaoTokens([]);\n      } else {\n        let parsedAndSortedTokens: TokenDetails[] = [];\n\n        // Build calls to get DAO token list with details\n        const getTokenABI = bankABI.find((item) => item.name === 'getToken');\n        const getTokenCalls = [...Array(Number(nbTokens)).keys()].map(\n          (index): MulticallTuple => [\n            bankAddress,\n            getTokenABI as AbiItem,\n            [index.toString()],\n          ]\n        );\n        const fetchedTokens: string[] = await multicall({\n          calls: getTokenCalls,\n          web3Instance,\n        });\n\n        const balanceOfABI = bankABI.find((item) => item.name === 'balanceOf');\n        const getDaoTokenBalanceCalls = fetchedTokens.map(\n          (token): MulticallTuple => [\n            bankAddress,\n            balanceOfABI as AbiItem,\n            [GUILD_ADDRESS, token],\n          ]\n        );\n        const daoTokenBalances: string[] = await multicall({\n          calls: getDaoTokenBalanceCalls,\n          web3Instance,\n        });\n\n        const tokensArray: InitialTokenDetails[] = fetchedTokens\n          .map((token, index) => ({\n            address: token,\n            daoBalance: daoTokenBalances[index],\n          }))\n          // Don't need to include tokens that have 0 balance\n          .filter((tokenObj) => toBN(tokenObj.daoBalance).gt(toBN(0)));\n\n        const ethToken = tokensArray.find(\n          (token) => token.address === ETH_TOKEN_ADDRESS\n        );\n        if (ethToken) {\n          parsedAndSortedTokens.push({\n            ...ethToken,\n            name: 'Ether',\n            symbol: 'ETH',\n            decimals: 18,\n          });\n        }\n\n        // Filter out Ether to handle ERC20 tokens\n        const erc20Tokens = tokensArray.filter(\n          (token) => token.address !== ETH_TOKEN_ADDRESS\n        );\n\n        if (erc20Tokens.length > 0) {\n          const nameABI = erc20ABI.find((item) => item.name === 'name');\n          const nameCalls = erc20Tokens.map(\n            (token): MulticallTuple => [\n              token.address as string,\n              nameABI as AbiItem,\n              [],\n            ]\n          );\n          const symbolABI = erc20ABI.find((item) => item.name === 'symbol');\n          const symbolCalls = erc20Tokens.map(\n            (token): MulticallTuple => [\n              token.address as string,\n              symbolABI as AbiItem,\n              [],\n            ]\n          );\n          const decimalsABI = erc20ABI.find((item) => item.name === 'decimals');\n          const decimalsCalls = erc20Tokens.map(\n            (token): MulticallTuple => [\n              token.address as string,\n              decimalsABI as AbiItem,\n              [],\n            ]\n          );\n          const erc20DetailsCalls = [\n            ...nameCalls,\n            ...symbolCalls,\n            ...decimalsCalls,\n          ];\n          let results = await multicall({\n            calls: erc20DetailsCalls,\n            web3Instance,\n          });\n          let chunkedResults = [];\n          while (results.length) {\n            chunkedResults.push(results.splice(0, erc20Tokens.length));\n          }\n          const [names, symbols, decimals] = chunkedResults;\n\n          const parsedAndSortedERC20Tokens = erc20Tokens\n            .map((token, index) => ({\n              ...token,\n              name: names[index],\n              symbol: symbols[index],\n              decimals: decimals[index],\n            }))\n            .sort((a, b) => a.name.localeCompare(b.name));\n\n          parsedAndSortedTokens = [\n            ...parsedAndSortedTokens,\n            ...parsedAndSortedERC20Tokens,\n          ];\n        }\n\n        setDaoTokens(parsedAndSortedTokens);\n      }\n    } catch (error) {\n      console.error(error);\n      setDaoTokens(undefined);\n    }\n  }\n\n  async function getSelectedTokenBalance() {\n    if (!account || !selectedTokenValue) {\n      setSelectedTokenBalance(undefined);\n      return;\n    }\n\n    try {\n      const selectedTokenObj = JSON.parse(selectedTokenValue);\n      const balance = selectedTokenObj.daoBalance;\n      const balanceBN = toBN(balance);\n      const decimals = selectedTokenObj.decimals;\n      const divisor = toBN(10).pow(toBN(decimals));\n      const beforeDecimal = balanceBN.div(divisor);\n      const afterDecimal = balanceBN.mod(divisor);\n      const balanceReadable = afterDecimal.eq(toBN(0))\n        ? beforeDecimal.toString()\n        : `${beforeDecimal.toString()}.${afterDecimal.toString()}`;\n\n      setSelectedTokenBalance(balanceReadable);\n    } catch (error) {\n      console.error(error);\n      setSelectedTokenBalance(undefined);\n    }\n  }\n\n  async function handleSubmit(values: FormInputs) {\n    try {\n      if (!isConnected) {\n        throw new Error(\n          'No user account was found. Please make sure your wallet is connected.'\n        );\n      }\n\n      if (!DistributeContract) {\n        throw new Error('No DistributeContract found.');\n      }\n\n      if (!DaoRegistryContract) {\n        throw new Error('No DaoRegistryContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const {selectedToken, memberAddress, amount, notes} = values;\n      const memberAddressToChecksum = toChecksumAddress(memberAddress);\n      const selectedTokenObj = JSON.parse(selectedToken);\n      const {symbol, decimals, address: tokenAddress} = selectedTokenObj;\n      let amountArg;\n      if (tokenAddress === ETH_TOKEN_ADDRESS) {\n        amountArg = toWei(stripFormatNumber(amount), 'ether');\n      } else {\n        const multiplier = toBN(10).pow(toBN(decimals));\n        const amountWithDecimals = toBN(stripFormatNumber(amount)).mul(\n          multiplier\n        );\n        amountArg = amountWithDecimals.toString();\n      }\n\n      // Maybe set proposal info from previous attempt\n      let proposalId: string = proposalData?.uniqueId || '';\n      let data: SnapshotProposalData | undefined = proposalData?.data;\n      let signature: string = proposalData?.signature || '';\n\n      const bodyIntro = isTypeAllMembers\n        ? 'Transfer to all members pro rata.'\n        : `Transfer to ${truncateEthAddress(memberAddressToChecksum, 7)}.`;\n\n      // Values needed to display relevant proposal amounts in the proposal\n      // details page are set in the snapshot draft metadata. (We can no longer\n      // rely on getting this data from onchain because the proposal may not\n      // exist there yet.)\n      const proposalAmountValues = {\n        transferAmount: amount,\n        transferAmountUnit: symbol,\n      };\n\n      // Only submit to snapshot if there is not already a proposal ID returned from a previous attempt.\n      if (!proposalId) {\n        const body = notes ? `${bodyIntro}\\n${notes}` : bodyIntro;\n        const name = isTypeAllMembers ? 'All members' : memberAddressToChecksum;\n        const now = Math.floor(Date.now() / 1000);\n\n        // Sign and submit proposal for snapshot-hub\n        const {\n          uniqueId,\n          data: returnData,\n          signature: returnSignature,\n        } = await signAndSendProposal({\n          partialProposalData: {\n            name,\n            body,\n            metadata: {\n              proposalAmountValues,\n              isTypeAllMembers,\n            },\n            timestamp: now.toString(),\n          },\n          adapterName: ContractAdapterNames.distribute,\n          type: SnapshotType.proposal,\n        });\n\n        proposalId = uniqueId;\n        data = returnData;\n        signature = returnSignature;\n      }\n\n      const memberAddressArg = isTypeAllMembers\n        ? BURN_ADDRESS // 0x0 address indicates distribution to all active members\n        : memberAddressToChecksum;\n      /**\n       * Prepare `data` argument for submission to DAO\n       *\n       * For information about which data the smart contract needs for signature verification (e.g. `hashMessage`):\n       * @link https://github.com/openlawteam/tribute-contracts/blob/master/contracts/adapters/voting/OffchainVoting.sol\n       */\n      const preparedVoteVerificationBytes = data\n        ? prepareVoteProposalData(\n            {\n              payload: {\n                name: data.payload.name,\n                body: data.payload.body,\n                choices: data.payload.choices,\n                snapshot: data.payload.snapshot.toString(),\n                start: data.payload.start,\n                end: data.payload.end,\n              },\n              sig: signature,\n              space: data.space,\n              timestamp: parseInt(data.timestamp),\n            },\n            web3Instance\n          )\n        : '';\n\n      const transferArguments: TransferArguments = [\n        DaoRegistryContract.contractAddress,\n        proposalId,\n        memberAddressArg,\n        tokenAddress,\n        amountArg,\n        preparedVoteVerificationBytes,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      // Execute contract call for `submitProposal`\n      await txSend(\n        'submitProposal',\n        DistributeContract.instance.methods,\n        transferArguments,\n        txArguments\n      );\n\n      // go to TransferDetails page for newly created transfer proposal\n      history.push(`/transfers/${proposalId}`);\n    } catch (error) {\n      // Set any errors from Web3 utils or explicitly set above.\n      setSubmitError(error);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    // Either Snapshot or chain tx\n    if (\n      txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n      proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM\n    ) {\n      return 'Awaiting your confirmation\\u2026';\n    }\n\n    // Only for chain tx\n    switch (txStatus) {\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Proposal submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  function renderSelectedTokenBalance() {\n    if (!selectedTokenBalance) {\n      return '---';\n    }\n\n    const isBalanceInt = Number.isInteger(Number(selectedTokenBalance));\n    return isBalanceInt\n      ? selectedTokenBalance\n      : formatDecimal(Number(selectedTokenBalance));\n  }\n\n  function getUnauthorizedMessage() {\n    // user is not connected\n    if (!isConnected) {\n      return 'Connect your wallet to submit a transfer proposal.';\n    }\n\n    // user is on wrong network\n    if (defaultChainError) {\n      return defaultChainError.message;\n    }\n\n    // user is not an active member\n    if (!isActiveMember) {\n      return 'Either you are not a member, or your membership is not active.';\n    }\n  }\n\n  async function isActiveMemberWithUnits(address: string) {\n    if (!BankExtensionContract) {\n      console.error('No BankExtensionContract found.');\n      return false;\n    }\n\n    const unitsBalance = await BankExtensionContract.instance.methods\n      .balanceOf(address, UNITS_ADDRESS)\n      .call();\n\n    return toBN(unitsBalance).gt(toBN(0));\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || defaultChainError || !isActiveMember) {\n    return (\n      <RenderWrapper>\n        <div className=\"form__description--unauthorized\">\n          <p>{getUnauthorizedMessage()}</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n        {/* TYPE */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Type</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <select\n              name={Fields.type}\n              ref={register}\n              disabled={isInProcessOrDone}>\n              <option value=\"single member\">Single member</option>\n              <option value=\"all members\">All members</option>\n            </select>\n          </div>\n        </div>\n\n        {/* MEMBER ADDRESS */}\n        {!isTypeAllMembers && (\n          <div className=\"form__input-row\">\n            <label className=\"form__input-row-label\">Member Address</label>\n            <div className=\"form__input-row-fieldwrap\">\n              <input\n                aria-describedby={`error-${Fields.memberAddress}`}\n                aria-invalid={errors.memberAddress ? 'true' : 'false'}\n                name={Fields.memberAddress}\n                ref={register({\n                  validate: async (\n                    memberAddress: string\n                  ): Promise<string | boolean> => {\n                    return !memberAddress\n                      ? FormFieldErrors.REQUIRED\n                      : !isEthAddressValid(memberAddress)\n                      ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                      : !(await isActiveMemberWithUnits(memberAddress))\n                      ? 'The address is not an active member with membership tokens.'\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={isInProcessOrDone}\n              />\n\n              <InputError\n                error={getValidationError(Fields.memberAddress, errors)}\n                id={`error-${Fields.memberAddress}`}\n              />\n            </div>\n          </div>\n        )}\n\n        {/* SELECTED TOKEN */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Asset</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <select\n              aria-describedby={`error-${Fields.selectedToken}`}\n              aria-invalid={errors.selectedToken ? 'true' : 'false'}\n              name={Fields.selectedToken}\n              ref={register({\n                validate: (token: string): string | boolean => {\n                  return !daoTokens || daoTokens.length < 1\n                    ? 'No tokens available for distribution.'\n                    : !token\n                    ? FormFieldErrors.REQUIRED\n                    : true;\n                },\n              })}\n              disabled={isInProcessOrDone}>\n              <option value=\"\">Select from DAO assets</option>\n              {daoTokens?.map((token) => (\n                <option\n                  key={token.address}\n                  value={JSON.stringify(\n                    token\n                  )}>{`${token.name} (${token.symbol})`}</option>\n              ))}\n            </select>\n\n            <InputError\n              error={getValidationError(Fields.selectedToken, errors)}\n              id={`error-${Fields.selectedToken}`}\n            />\n          </div>\n        </div>\n\n        {/* AMOUNT */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Amount</label>\n          <div className=\"form__input-row-fieldwrap--narrow\">\n            <div className=\"input__suffix-wrap\">\n              <input\n                className=\"input__suffix\"\n                aria-describedby={`error-${Fields.amount}`}\n                aria-invalid={errors.amount ? 'true' : 'false'}\n                name={Fields.amount}\n                onChange={() =>\n                  setValue(Fields.amount, formatNumber(getValues().amount))\n                }\n                ref={register({\n                  validate: (amount: string): string | boolean => {\n                    const amountToNumber = Number(stripFormatNumber(amount));\n                    const selectedTokenObj =\n                      selectedTokenValue && JSON.parse(selectedTokenValue);\n                    const isSelectedTokenEth =\n                      selectedTokenObj?.address === ETH_TOKEN_ADDRESS;\n\n                    return amount === ''\n                      ? FormFieldErrors.REQUIRED\n                      : isNaN(amountToNumber)\n                      ? FormFieldErrors.INVALID_NUMBER\n                      : amountToNumber <= 0\n                      ? 'The value must be greater than 0.'\n                      : amountToNumber > Number(selectedTokenBalance)\n                      ? 'Insufficient funds.'\n                      : isSelectedTokenEth\n                      ? true\n                      : !Number.isInteger(amountToNumber)\n                      ? 'The value must be an integer for an ERC20 token.'\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={isInProcessOrDone}\n              />\n\n              <div className=\"input__suffix-item\">\n                {(selectedTokenValue &&\n                  JSON.parse(selectedTokenValue).symbol) ||\n                  '___'}\n              </div>\n            </div>\n\n            <InputError\n              error={getValidationError(Fields.amount, errors)}\n              id={`error-${Fields.amount}`}\n            />\n\n            <div className=\"form__input-description\">\n              {isTypeAllMembers\n                ? \"If the proposal passes, this total amount will be distributed pro rata to all members' internal accounts, based on the current number of membership tokens held by each member.\"\n                : \"If the proposal passes, this amount will be distributed to the member's internal account.\"}\n            </div>\n          </div>\n\n          <div className=\"form__input-addon\">\n            available: <span>{renderSelectedTokenBalance()}</span>\n          </div>\n        </div>\n\n        {/* NOTES */}\n        <div className=\"form__textarea-row\">\n          <label className=\"form__input-row-label\">Notes</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <textarea\n              name={Fields.notes}\n              placeholder=\"Transactions purpose...\"\n              ref={register}\n              disabled={isInProcessOrDone}\n            />\n          </div>\n        </div>\n\n        {/* SUBMIT */}\n        <button\n          className=\"button\"\n          disabled={isInProcessOrDone}\n          onClick={async () => {\n            if (isInProcessOrDone) return;\n\n            if (!(await trigger())) {\n              return;\n            }\n\n            handleSubmit(getValues());\n          }}\n          type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {createTransferError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while submitting the proposal.\"\n              error={createTransferError}\n            />\n          </div>\n        )}\n      </form>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Transfer Proposal</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          <div className=\"form__description\"></div>\n\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {useState, useCallback, useEffect} from 'react';\nimport {useSelector} from 'react-redux';\nimport {SnapshotType} from '@openlaw/snapshot-js-erc712';\nimport {useForm} from 'react-hook-form';\nimport {useHistory} from 'react-router-dom';\nimport {Contract as Web3Contract} from 'web3-eth-contract/types';\nimport {toBN, AbiItem, toChecksumAddress} from 'web3-utils';\n\nimport {\n  getValidationError,\n  stripFormatNumber,\n  formatNumber,\n  formatDecimal,\n  normalizeString,\n  truncateEthAddress,\n} from '../../util/helpers';\nimport {useIsDefaultChain, useWeb3Modal} from '../../components/web3/hooks';\nimport {ContractAdapterNames, Web3TxStatus} from '../../components/web3/types';\nimport {FormFieldErrors} from '../../util/enums';\nimport {isEthAddressValid} from '../../util/validation';\nimport {AsyncStatus} from '../../util/types';\nimport {UNITS_ADDRESS} from '../../config';\nimport {StoreState} from '../../store/types';\nimport {\n  useCheckApplicant,\n  useSignAndSubmitProposal,\n} from '../../components/proposals/hooks';\nimport {CycleEllipsis} from '../../components/feedback';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport Loader from '../../components/feedback/Loader';\nimport Wrap from '../../components/common/Wrap';\n\nenum Fields {\n  applicantAddress = 'applicantAddress',\n  erc20Address = 'erc20Address',\n  tributeAmount = 'tributeAmount',\n  requestAmount = 'requestAmount',\n  description = 'description',\n}\n\ntype FormInputs = {\n  applicantAddress: string;\n  erc20Address: string;\n  tributeAmount: string;\n  requestAmount: string;\n  description: string;\n};\n\ntype SubmitActionArguments = [\n  string, // `applicant`\n  string, // `tokenToMint`\n  string, // `requestAmount`\n  string, // `tokenAddr`\n  string, // `tributeAmount`\n  string // `tributeTokenOwner`\n];\n\ntype ERC20Details = {\n  symbol: string;\n  decimals: number;\n};\n\nexport default function CreateTributeProposal() {\n  /**\n   * Selectors\n   */\n\n  const ERC20ExtensionContract = useSelector(\n    (state: StoreState) => state.contracts?.ERC20ExtensionContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {defaultChainError} = useIsDefaultChain();\n  const {connected, account, web3Instance} = useWeb3Modal();\n  const {\n    proposalData,\n    proposalSignAndSendError,\n    proposalSignAndSendStatus,\n    signAndSendProposal,\n  } = useSignAndSubmitProposal<SnapshotType.draft>();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n  const history = useHistory();\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n  const [userERC20Balance, setUserERC20Balance] = useState<string>();\n  const [erc20Details, setERC20Details] = useState<ERC20Details>();\n  const [erc20Contract, setERC20Contract] = useState<Web3Contract>();\n\n  /**\n   * Variables\n   */\n\n  const {errors, getValues, setValue, register, trigger, watch} = form;\n\n  const erc20AddressValue = watch(Fields.erc20Address);\n\n  const applicantAddressValue = watch(Fields.applicantAddress);\n\n  const createTributeError = submitError || proposalSignAndSendError;\n\n  const isConnected = connected && account;\n\n  const isInProcess =\n    proposalSignAndSendStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    proposalSignAndSendStatus === Web3TxStatus.PENDING;\n\n  const isDone = proposalSignAndSendStatus === Web3TxStatus.FULFILLED;\n\n  const isInProcessOrDone = isInProcess || isDone;\n\n  const {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  } = useCheckApplicant(applicantAddressValue);\n\n  /**\n   * Cached callbacks\n   */\n\n  const getERC20ContractCached = useCallback(getERC20Contract, [\n    erc20AddressValue,\n    web3Instance,\n  ]);\n\n  const getERC20DetailsCached = useCallback(getERC20Details, [\n    account,\n    erc20Contract,\n  ]);\n\n  const getUserERC20BalanceCached = useCallback(getUserERC20Balance, [\n    account,\n    erc20Contract,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getERC20ContractCached();\n  }, [getERC20ContractCached]);\n\n  useEffect(() => {\n    getERC20DetailsCached();\n  }, [getERC20DetailsCached]);\n\n  useEffect(() => {\n    getUserERC20BalanceCached();\n  }, [getUserERC20BalanceCached]);\n\n  // Set the value of `applicantAddress` if the `account` changes\n  useEffect(() => {\n    setValue(Fields.applicantAddress, account);\n  }, [account, setValue]);\n\n  /**\n   * Functions\n   */\n\n  async function getERC20Contract() {\n    if (!web3Instance || !erc20AddressValue) {\n      setERC20Contract(undefined);\n      return;\n    }\n\n    try {\n      const {default: lazyERC20ABI} = await import(\n        '../../truffle-contracts/ERC20.json'\n      );\n      const erc20Contract: AbiItem[] = lazyERC20ABI as any;\n      const instance = new web3Instance.eth.Contract(\n        erc20Contract,\n        erc20AddressValue\n      );\n      setERC20Contract(instance);\n    } catch (error) {\n      console.error(error);\n      setERC20Contract(undefined);\n    }\n  }\n\n  async function getERC20Details() {\n    if (!account || !erc20Contract) {\n      setERC20Details(undefined);\n      return;\n    }\n\n    try {\n      const symbol = await erc20Contract.methods.symbol().call();\n      const decimals = await erc20Contract.methods.decimals().call();\n      setERC20Details({symbol, decimals: Number(decimals)});\n    } catch (error) {\n      console.error(error);\n      setERC20Details(undefined);\n    }\n  }\n\n  async function getUserERC20Balance() {\n    if (!account || !erc20Contract) {\n      setUserERC20Balance(undefined);\n      return;\n    }\n\n    try {\n      const balance = await erc20Contract.methods.balanceOf(account).call();\n      const balanceBN = toBN(balance);\n      const decimals = await erc20Contract.methods.decimals().call();\n      const divisor = toBN(10).pow(toBN(decimals));\n      const beforeDecimal = balanceBN.div(divisor);\n      const afterDecimal = balanceBN.mod(divisor);\n      const balanceReadable = afterDecimal.eq(toBN(0))\n        ? beforeDecimal.toString()\n        : `${beforeDecimal.toString()}.${afterDecimal.toString()}`;\n\n      setUserERC20Balance(balanceReadable);\n    } catch (error) {\n      console.error(error);\n      setUserERC20Balance(undefined);\n    }\n  }\n\n  async function getRequestAmountUnit() {\n    if (!ERC20ExtensionContract) {\n      return 'UNITS';\n    } else {\n      try {\n        return await ERC20ExtensionContract.instance.methods.symbol().call();\n      } catch (error) {\n        console.log(error);\n        return 'UNITS';\n      }\n    }\n  }\n\n  async function handleSubmit(values: FormInputs) {\n    try {\n      if (!isConnected) {\n        throw new Error(\n          'No user account was found. Please make sure your wallet is connected.'\n        );\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!erc20Contract) {\n        throw new Error('No ERC20Contract found.');\n      }\n\n      if (!erc20Details) {\n        throw new Error('No ERC20 details found.');\n      }\n\n      if (checkApplicantError) {\n        // Just log the error (don't throw) because it is not a blocker for the\n        // snapshot draft to be submitted. The applicant address validity will\n        // be checked again when the proposal is submitted onchain.\n        console.warn(\n          `Error checking if the applicant address is valid: ${checkApplicantError.message}`\n        );\n      }\n\n      if (\n        checkApplicantStatus === AsyncStatus.FULFILLED &&\n        !isApplicantValid &&\n        checkApplicantInvalidMsg\n      ) {\n        throw new Error(checkApplicantInvalidMsg);\n      }\n\n      const {\n        applicantAddress,\n        erc20Address,\n        tributeAmount,\n        requestAmount,\n        description,\n      } = values;\n      const multiplier = toBN(10).pow(toBN(erc20Details.decimals));\n      const tributeAmountWithDecimals = toBN(\n        stripFormatNumber(tributeAmount)\n      ).mul(multiplier);\n      const requestAmountArg = stripFormatNumber(requestAmount);\n      const applicantAddressToChecksum = toChecksumAddress(applicantAddress);\n      const proposerAddressToChecksum = toChecksumAddress(account);\n\n      // Maybe set proposal ID from previous attempt\n      let proposalId: string = proposalData?.uniqueId || '';\n\n      // Only submit to snapshot if there is not already a proposal ID returned from a previous attempt.\n      if (!proposalId) {\n        const bodyIntro =\n          normalizeString(applicantAddress) === normalizeString(account)\n            ? `Tribute from ${truncateEthAddress(\n                applicantAddressToChecksum,\n                7\n              )}.`\n            : `Tribute from ${truncateEthAddress(\n                proposerAddressToChecksum,\n                7\n              )} for applicant ${truncateEthAddress(\n                applicantAddressToChecksum,\n                7\n              )}.`;\n        const body = description ? `${bodyIntro}\\n${description}` : bodyIntro;\n\n        // Values needed to display relevant proposal amounts in the proposal\n        // details page are set in the snapshot draft metadata. (We can no\n        // longer rely on getting this data from onchain because the proposal\n        // may not exist there yet.)\n        const proposalAmountValues = {\n          requestAmount,\n          requestAmountUnit: await getRequestAmountUnit(),\n          tributeAmount,\n          tributeAmountUnit: erc20Details.symbol,\n        };\n\n        // Arguments needed to submit the proposal onchain are set in the\n        // snapshot draft metadata.\n        const submitActionArgs: SubmitActionArguments = [\n          applicantAddressToChecksum,\n          UNITS_ADDRESS,\n          requestAmountArg,\n          toChecksumAddress(erc20Address),\n          tributeAmountWithDecimals.toString(),\n          proposerAddressToChecksum,\n        ];\n\n        // Sign and submit draft for snapshot-hub\n        const {uniqueId} = await signAndSendProposal({\n          partialProposalData: {\n            name: applicantAddressToChecksum,\n            body,\n            metadata: {\n              proposalAmountValues,\n              submitActionArgs,\n              accountAuthorizedToProcessPassedProposal:\n                proposerAddressToChecksum,\n            },\n          },\n          adapterName: ContractAdapterNames.tribute,\n          type: SnapshotType.draft,\n        });\n\n        proposalId = uniqueId;\n      }\n\n      // go to TributeDetails page for newly created tribute proposal\n      history.push(`/tributes/${proposalId}`);\n    } catch (error) {\n      // Set any errors from Web3 utils or explicitly set above.\n      setSubmitError(error);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    switch (proposalSignAndSendStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Awaiting your confirmation\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            Submitting\n            <CycleEllipsis intervalMs={500} />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return 'Done!';\n      default:\n        return '';\n    }\n  }\n\n  function renderUserERC20Balance() {\n    if (!userERC20Balance) {\n      return '---';\n    }\n\n    const isBalanceInt = Number.isInteger(Number(userERC20Balance));\n    return isBalanceInt\n      ? userERC20Balance\n      : formatDecimal(Number(userERC20Balance));\n  }\n\n  function getUnauthorizedMessage() {\n    // user is not connected\n    if (!isConnected) {\n      return 'Connect your wallet to submit a tribute proposal.';\n    }\n\n    // user is on wrong network\n    if (defaultChainError) {\n      return defaultChainError.message;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render unauthorized message\n  if (!isConnected || defaultChainError) {\n    return (\n      <RenderWrapper>\n        <div className=\"form__description--unauthorized\">\n          <p>{getUnauthorizedMessage()}</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n        {/* APPLICANT ADDRESS */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Applicant Address</label>\n          <div className=\"form__input-row-fieldwrap\">\n            {/* @note We don't need the default value as it's handled in the useEffect above. */}\n            <input\n              aria-describedby={`error-${Fields.applicantAddress}`}\n              aria-invalid={errors.applicantAddress ? 'true' : 'false'}\n              name={Fields.applicantAddress}\n              ref={register({\n                validate: (applicantAddress: string): string | boolean => {\n                  return !applicantAddress\n                    ? FormFieldErrors.REQUIRED\n                    : !isEthAddressValid(applicantAddress)\n                    ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                    : true;\n                },\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.applicantAddress, errors)}\n              id={`error-${Fields.applicantAddress}`}\n            />\n          </div>\n        </div>\n\n        {/* ERC20 ADDRESS */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">ERC20 Address</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <input\n              aria-describedby={`error-${Fields.erc20Address}`}\n              aria-invalid={errors.erc20Address ? 'true' : 'false'}\n              name={Fields.erc20Address}\n              ref={register({\n                validate: (erc20Address: string): string | boolean => {\n                  return !erc20Address\n                    ? FormFieldErrors.REQUIRED\n                    : !isEthAddressValid(erc20Address)\n                    ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                    : true;\n                },\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.erc20Address, errors)}\n              id={`error-${Fields.erc20Address}`}\n            />\n          </div>\n        </div>\n\n        {/* TRIBUTE AMOUNT */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Amount</label>\n          <div className=\"form__input-row-fieldwrap--narrow\">\n            <div className=\"input__suffix-wrap\">\n              <input\n                className=\"input__suffix\"\n                aria-describedby={`error-${Fields.tributeAmount}`}\n                aria-invalid={errors.tributeAmount ? 'true' : 'false'}\n                name={Fields.tributeAmount}\n                onChange={() =>\n                  setValue(\n                    Fields.tributeAmount,\n                    formatNumber(getValues().tributeAmount)\n                  )\n                }\n                ref={register({\n                  validate: (tributeAmount: string): string | boolean => {\n                    const amount = Number(stripFormatNumber(tributeAmount));\n\n                    return tributeAmount === ''\n                      ? FormFieldErrors.REQUIRED\n                      : isNaN(amount)\n                      ? FormFieldErrors.INVALID_NUMBER\n                      : amount <= 0\n                      ? 'The value must be greater than 0.'\n                      : amount > Number(userERC20Balance)\n                      ? 'Insufficient funds.'\n                      : !Number.isInteger(amount)\n                      ? 'The value must be an integer for an ERC20 token.'\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={isInProcessOrDone}\n              />\n\n              <div className=\"input__suffix-item\">\n                {erc20Details?.symbol || '___'}\n              </div>\n            </div>\n\n            <InputError\n              error={getValidationError(Fields.tributeAmount, errors)}\n              id={`error-${Fields.tributeAmount}`}\n            />\n\n            <div className=\"form__input-description\">\n              This amount will be held in escrow pending a member vote. If the\n              proposal passes, the funds will automatically be sent to the DAO.\n              If the proposal fails, the funds will be refunded to you.\n            </div>\n          </div>\n\n          <div className=\"form__input-addon\">\n            available: <span>{renderUserERC20Balance()}</span>\n          </div>\n        </div>\n\n        {/* REQUEST AMOUNT */}\n        <div className=\"form__input-row\">\n          <label className=\"form__input-row-label\">Request Amount</label>\n          <div className=\"form__input-row-fieldwrap--narrow\">\n            <input\n              aria-describedby={`error-${Fields.requestAmount}`}\n              aria-invalid={errors.requestAmount ? 'true' : 'false'}\n              name={Fields.requestAmount}\n              onChange={() =>\n                setValue(\n                  Fields.requestAmount,\n                  formatNumber(getValues().requestAmount)\n                )\n              }\n              ref={register({\n                validate: (requestAmount: string): string | boolean => {\n                  const amount = Number(stripFormatNumber(requestAmount));\n\n                  return requestAmount === ''\n                    ? FormFieldErrors.REQUIRED\n                    : isNaN(amount)\n                    ? FormFieldErrors.INVALID_NUMBER\n                    : amount < 0\n                    ? 'The value must be at least 0.'\n                    : true;\n                },\n              })}\n              type=\"text\"\n              disabled={isInProcessOrDone}\n            />\n\n            <InputError\n              error={getValidationError(Fields.requestAmount, errors)}\n              id={`error-${Fields.requestAmount}`}\n            />\n\n            <div className=\"form__input-description\">\n              This is the amount of DAO membership tokens you are requesting be\n              sent to the Applicant Address in exchange for your tribute.\n            </div>\n          </div>\n        </div>\n\n        {/* DESCRIPTION */}\n        <div className=\"form__textarea-row\">\n          <label className=\"form__input-row-label\">Description</label>\n          <div className=\"form__input-row-fieldwrap\">\n            <textarea\n              name={Fields.description}\n              placeholder=\"Say something about your tribute...\"\n              ref={register}\n              disabled={isInProcessOrDone}\n            />\n          </div>\n        </div>\n\n        {/* SUBMIT */}\n        <button\n          className=\"button\"\n          disabled={isInProcessOrDone}\n          onClick={async () => {\n            if (isInProcessOrDone) return;\n\n            if (!(await trigger())) {\n              return;\n            }\n\n            handleSubmit(getValues());\n          }}\n          type=\"submit\">\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Submit'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {createTributeError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while submitting the proposal.\"\n              error={createTributeError}\n            />\n          </div>\n        )}\n      </form>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Tribute Proposal</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          <div className=\"form__description\"></div>\n\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","export default __webpack_public_path__ + \"static/media/compost.662c0eab.jpg\";","import React, {useEffect} from 'react';\nimport {useHistory} from 'react-router-dom';\nimport AOS from 'aos';\nimport '../../../node_modules/aos/dist/aos.css';\n\nimport {CenterLogo} from '../../components/logo';\nimport FadeIn from '../../components/common/FadeIn';\nimport Wrap from '../../components/common/Wrap';\n\nimport compost from '../../assets/images/compost.jpg';\n\nconst CompostImg = React.memo(() => {\n  return <img alt=\"Compost heap.\" src={compost}></img>;\n});\n\nfunction GetStartedHeader() {\n  return <div data-testid=\"header\" className=\"landing__header\"></div>;\n}\n\nexport default function GetStarted() {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    AOS.init({\n      duration: 800,\n      offset: 40,\n      delay: 120,\n      mirror: false,\n      once: true,\n    });\n  }, []);\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <GetStartedHeader />\n      <Wrap className=\"section-wrapper\">\n        <FadeIn>\n          <CenterLogo />\n\n          <div className=\"landing\">\n            <div className=\"landing__subtitle\">\n              Managing our gardening community\n            </div>\n\n            <div className=\"landing__img\">\n              <CompostImg></CompostImg>\n            </div>\n\n            <div className=\"landing__button\">\n              <button\n                className=\"button\"\n                onClick={() => {\n                  history.push('/join');\n                }}>\n                Join\n              </button>\n            </div>\n          </div>\n        </FadeIn>\n      </Wrap>\n    </>\n  );\n}\n","import {OffchainVotingAction, OffchainVotingStatus} from '../proposals/voting';\nimport {ProposalData} from '../proposals/types';\nimport {useVotingTimeStartEnd} from '../proposals/hooks';\n\ntype GovernanceActionsProps = {\n  proposal: ProposalData;\n};\n\nexport function GovernanceActions(props: GovernanceActionsProps) {\n  const {proposal} = props;\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    hasVotingTimeEnded,\n    hasVotingTimeStarted,\n    votingTimeStartEndInitReady,\n  } = useVotingTimeStartEnd(\n    proposal.snapshotProposal?.msg.payload.start,\n    proposal.snapshotProposal?.msg.payload.end\n  );\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      {votingTimeStartEndInitReady && hasVotingTimeStarted && (\n        <OffchainVotingStatus proposal={proposal} />\n      )}\n\n      {votingTimeStartEndInitReady &&\n        hasVotingTimeStarted &&\n        !hasVotingTimeEnded && <OffchainVotingAction proposal={proposal} />}\n    </>\n  );\n}\n","import React from 'react';\n\nimport Wrap from '../../components/common/Wrap';\nimport FadeIn from '../../components/common/FadeIn';\n\nexport default function NotFound() {\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div style={{textAlign: 'center', fontSize: '5rem'}}>\n          <h3>\n            4\n            <span\n              className=\"pulse\"\n              role=\"img\"\n              aria-label=\"404, not found\"\n              style={{display: 'inline-block'}}>\n              \n            </span>\n            4\n          </h3>\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {ProposalData} from './types';\n\nimport {truncateEthAddress} from '../../util/helpers';\nimport Markdown from 'markdown-to-jsx';\n\ntype ProposalDetailsProps = {\n  proposal: ProposalData;\n  /**\n   * A render prop to render amount(s) badge.\n   */\n  renderAmountBadge?: () => React.ReactNode;\n  /**\n   * A render prop to render any action button flows for a proposal.\n   */\n  renderActions: () => React.ReactNode;\n};\n\nexport default function ProposalDetails(props: ProposalDetailsProps) {\n  const {proposal, renderAmountBadge, renderActions} = props;\n\n  const commonData = proposal.getCommonSnapshotProposalData();\n\n  /**\n   * Render\n   */\n\n  if (!commonData) {\n    return null;\n  }\n\n  return (\n    <>\n      <div className=\"proposaldetails__header\">Proposal Details</div>\n      <div className=\"proposaldetails\">\n        {/* PROPOSAL NAME (an address in most cases) AND BODY */}\n        <div className=\"proposaldetails__content\">\n          <h3>\n            {/* @note If the proposal title is not an address it will fall back to a normal, non-truncated string. */}\n            {truncateEthAddress(commonData.msg.payload.name || '', 7)}\n          </h3>\n\n          <Markdown>{commonData.msg.payload.body}</Markdown>\n        </div>\n\n        {/* SIDEBAR */}\n        <div className=\"proposaldetails__status\">\n          {/* AMOUNT(S) IF RELEVANT FOR PROPOSAL */}\n          {renderAmountBadge && renderAmountBadge()}\n\n          {/* SPONSOR & VOTING ACTIONS */}\n          {renderActions()}\n        </div>\n      </div>\n    </>\n  );\n}\n","import {SnapshotType} from '@openlaw/snapshot-js-erc712';\nimport React from 'react';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {AsyncStatus} from '../../util/types';\nimport {GovernanceActions} from '../../components/governance';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport {useProposalOrDraft} from '../../components/proposals/hooks';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport NotFound from '../subpages/NotFound';\nimport ProposalDetails from '../../components/proposals/ProposalDetails';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function GovernanceProposalDetails() {\n  /**\n   * Their hooks\n   */\n\n  // Get hash for fetching the proposal.\n  const {proposalId} = useParams<{proposalId: string}>();\n\n  /**\n   * Our hooks\n   */\n\n  const {proposalData, proposalError, proposalNotFound, proposalStatus} =\n    useProposalOrDraft(proposalId, SnapshotType.proposal);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean = proposalStatus === AsyncStatus.PENDING;\n  const error: Error | undefined = proposalError || defaultChainError;\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render 404 no proposal found\n  if (proposalNotFound) {\n    return (\n      <RenderWrapper>\n        <NotFound />\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong while getting the proposal.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render proposal\n  if (proposalData) {\n    return (\n      <RenderWrapper>\n        <ProposalDetails\n          proposal={proposalData}\n          renderActions={() => <GovernanceActions proposal={proposalData} />}\n        />\n      </RenderWrapper>\n    );\n  }\n\n  // Render nothing. Should never reach this case.\n  return <></>;\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function viewAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n\n    history.push('/governance');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Governance</h2>\n\n          <button className=\"titlebar__action\" onClick={viewAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {Link, useHistory} from 'react-router-dom';\nimport LinesEllipsis from 'react-lines-ellipsis';\nimport responsiveHOC from 'react-lines-ellipsis/lib/responsiveHOC';\n\nimport {isEthAddressValid} from '../../util/validation';\nimport {truncateEthAddress} from '../../util/helpers';\n\ntype ProposalCardProps = {\n  buttonText?: string;\n  /**\n   * The path to link to. Defaults to `${location.pathname}/${proposalOnClickId}`.\n   */\n  linkPath?: string | ((id: string) => string);\n  /**\n   * Take arbitrary actions on click\n   */\n  onClick?: (proposalOnClickId: string) => void;\n  /**\n   * The ID for the proposal to be used for navigation.\n   * As there can be a few different options, it's best to provide it\n   * explicitly.\n   */\n  proposalOnClickId: string;\n  name: string;\n  /**\n   * Render a custom status via render prop\n   */\n  renderStatus?: () => React.ReactNode;\n};\n\nconst DEFAULT_BUTTON_TEXT: string = 'View Proposal';\n\nconst ResponsiveEllipsis = responsiveHOC()(LinesEllipsis);\n\n/**\n * Shows a preview of a proposal's details\n *\n * @param {ProposalCardProps} props\n * @returns {JSX.Element}\n */\nexport default function ProposalCard(props: ProposalCardProps): JSX.Element {\n  const {\n    buttonText = DEFAULT_BUTTON_TEXT,\n    proposalOnClickId,\n    linkPath,\n    onClick,\n    name,\n    renderStatus,\n  } = props;\n\n  /**\n   * Their hooks\n   */\n\n  const {location} = useHistory();\n\n  /**\n   * Variables\n   */\n\n  const pathname: string = location.pathname === '/' ? '' : location.pathname;\n\n  const path: string =\n    typeof linkPath === 'function'\n      ? linkPath(proposalOnClickId)\n      : linkPath || `${pathname}/${proposalOnClickId}`;\n\n  /**\n   * Functions\n   */\n\n  function handleClick() {\n    onClick?.(proposalOnClickId);\n  }\n\n  function renderName(name: string) {\n    if (isEthAddressValid(name)) {\n      return truncateEthAddress(name, 7);\n    } else {\n      return (\n        <ResponsiveEllipsis\n          text={name}\n          maxLine={1}\n          ellipsis=\"...\"\n          trimRight\n          basedOn=\"letters\"\n        />\n      );\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Link className=\"proposalcard__link\" to={path} onClick={handleClick}>\n      <div className=\"proposalcard\">\n        {/* TITLE */}\n        <h3 className=\"proposalcard__title\">{renderName(name)}</h3>\n\n        {/* E.G. VOTING PROGRESS STATUS AND BAR */}\n        {renderStatus && renderStatus()}\n\n        {/**\n         * BUTTON (no click handler)\n         *\n         * @todo Set to a `<span>` as `<button>` is invalid as a descendent of `<a>`.\n         */}\n        <button className=\"proposalcard__button\">\n          {buttonText || DEFAULT_BUTTON_TEXT}\n        </button>\n      </div>\n    </Link>\n  );\n}\n","import React, {Fragment, useEffect, useState} from 'react';\n\nimport {AsyncStatus} from '../../util/types';\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {normalizeString} from '../../util/helpers';\nimport {OffchainVotingStatus} from '../proposals/voting';\nimport {ProposalData, VotingResult} from '../proposals/types';\nimport {ProposalHeaderNames} from '../../util/enums';\nimport {useGovernanceProposals} from './hooks';\nimport {useIsDefaultChain} from '../web3/hooks';\nimport {useOffchainVotingResults} from '../proposals/hooks';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport LoaderLarge from '../feedback/LoaderLarge';\nimport ProposalCard from '../proposals/ProposalCard';\n\ntype GovernanceProposalsListProps = {\n  /**\n   * The `actionId` to get proposals for in Snapshot Hub.\n   */\n  actionId?: string;\n  /**\n   * Optionally provide a click handler for `ProposalCard`.\n   * The proposal's id (in Snapshot) will be provided as an argument.\n   * Defaults to noop: `() => {}`\n   */\n  onProposalClick?: (id: string) => void;\n  /**\n   * The path to link to. Defaults to `${location.pathname}/${proposalOnClickId}`.\n   */\n  proposalLinkPath?: Parameters<typeof ProposalCard>['0']['linkPath'];\n  /**\n   * Optionally render a custom proposal card.\n   */\n  renderProposalCard?: (data: {\n    proposalData: ProposalData;\n    votingResult?: VotingResult;\n  }) => React.ReactNode;\n};\n\ntype FilteredProposals = {\n  failedProposals: ProposalData[];\n  passedProposals: ProposalData[];\n  votingProposals: ProposalData[];\n};\n\nexport default function GovernanceProposalsList(\n  props: GovernanceProposalsListProps\n): JSX.Element {\n  const {\n    actionId = BURN_ADDRESS,\n    onProposalClick = () => {},\n    proposalLinkPath,\n    renderProposalCard,\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [proposalsForVotingResults, setProposalsForVotingResults] = useState<\n    ProposalData['snapshotProposal'][]\n  >([]);\n  const [filteredProposals, setFilteredProposals] = useState<FilteredProposals>(\n    {\n      failedProposals: [],\n      passedProposals: [],\n      votingProposals: [],\n    }\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    governanceProposals,\n    governanceProposalsError,\n    governanceProposalsStatus,\n  } = useGovernanceProposals({\n    actionId,\n  });\n\n  const {\n    offchainVotingResults,\n    offchainVotingResultsError,\n    offchainVotingResultsStatus,\n  } = useOffchainVotingResults(proposalsForVotingResults);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const {failedProposals, passedProposals, votingProposals} = filteredProposals;\n\n  const isLoading: boolean =\n    governanceProposalsStatus === AsyncStatus.STANDBY ||\n    governanceProposalsStatus === AsyncStatus.PENDING ||\n    // Getting ready to fetch using `useOffchainVotingResults`; helps to show continuous loader.\n    (offchainVotingResultsStatus === AsyncStatus.STANDBY &&\n      proposalsForVotingResults.length > 0) ||\n    offchainVotingResultsStatus === AsyncStatus.PENDING;\n\n  const error: Error | undefined =\n    governanceProposalsError || offchainVotingResultsError || defaultChainError;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    setProposalsForVotingResults(\n      governanceProposals.map((gp) => gp.snapshotProposal)\n    );\n  }, [governanceProposals]);\n\n  // Separate proposals into categories: voting, passed, failed\n  useEffect(() => {\n    if (governanceProposalsStatus !== AsyncStatus.FULFILLED) return;\n\n    const filteredProposalsToSet: FilteredProposals = {\n      failedProposals: [],\n      passedProposals: [],\n      votingProposals: [],\n    };\n\n    governanceProposals.forEach((p) => {\n      const end = p.snapshotProposal?.msg.payload.end || 0;\n      const hasVoteEnded = end < Math.ceil(Date.now() / 1000);\n\n      // voting proposal\n      if (!hasVoteEnded) {\n        filteredProposalsToSet.votingProposals.push(p);\n\n        return;\n      }\n\n      const offchainResult = offchainVotingResults.find(\n        ([proposalHash, _result]) =>\n          normalizeString(proposalHash) ===\n          normalizeString(p.snapshotProposal?.idInSnapshot || '')\n      )?.[1];\n\n      if (!offchainResult) return;\n\n      const didPass = didPassSimpleMajority(offchainResult);\n\n      // passed proposal\n      if (didPass) {\n        filteredProposalsToSet.passedProposals.push(p);\n\n        return;\n      }\n\n      // failed proposal\n      if (!didPass) {\n        filteredProposalsToSet.failedProposals.push(p);\n\n        return;\n      }\n    });\n\n    setFilteredProposals((prevState) => ({\n      ...prevState,\n      ...filteredProposalsToSet,\n    }));\n  }, [governanceProposals, governanceProposalsStatus, offchainVotingResults]);\n\n  /**\n   * Functions\n   */\n\n  function didPassSimpleMajority(offchainVoteResult: VotingResult): boolean {\n    return offchainVoteResult.Yes.units > offchainVoteResult.No.units;\n  }\n\n  function renderProposalCards(\n    proposals: ProposalData[]\n  ): React.ReactNode | null {\n    return proposals.map((proposal) => {\n      const proposalId = proposal.snapshotProposal?.idInSnapshot;\n      const proposalName = proposal.snapshotProposal?.msg.payload.name || '';\n\n      if (!proposalId) return null;\n\n      const offchainResult = offchainVotingResults.find(\n        ([proposalHash, _result]) =>\n          normalizeString(proposalHash) === normalizeString(proposalId)\n      )?.[1];\n\n      if (renderProposalCard) {\n        return (\n          <Fragment key={proposalId}>\n            {renderProposalCard({\n              proposalData: proposal,\n              votingResult: offchainResult,\n            })}\n          </Fragment>\n        );\n      }\n\n      return (\n        <ProposalCard\n          key={proposalId}\n          name={proposalName}\n          linkPath={proposalLinkPath}\n          onClick={onProposalClick}\n          proposalOnClickId={proposalId}\n          renderStatus={() => (\n            <OffchainVotingStatus\n              proposal={proposal}\n              votingResult={offchainResult}\n            />\n          )}\n        />\n      );\n    });\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <div className=\"loader--large-container\">\n        <LoaderLarge />\n      </div>\n    );\n  }\n\n  // Render no proposals\n  if (\n    !governanceProposals.length &&\n    !Object.values(filteredProposals).flatMap((p) => p).length &&\n    governanceProposalsStatus === AsyncStatus.FULFILLED\n  ) {\n    return <p className=\"text-center\">No proposals, yet!</p>;\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <div className=\"text-center\">\n        <ErrorMessageWithDetails\n          error={error}\n          renderText=\"Something went wrong while getting the proposals.\"\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"grid--fluid grid-container\">\n      {/* VOTING PROPOSALS */}\n      {votingProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.VOTING}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(votingProposals)}\n          </div>\n        </>\n      )}\n\n      {/* PASSED PROPOSALS */}\n      {passedProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.PASSED}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(passedProposals)}\n          </div>\n        </>\n      )}\n\n      {/* FAILED PROPOSALS */}\n      {failedProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.FAILED}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(failedProposals)}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {\n  SnapshotProposalResponse,\n  SnapshotType,\n} from '@openlaw/snapshot-js-erc712';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {BURN_ADDRESS} from '../../../util/constants';\nimport {ProposalData} from '../../proposals/types';\nimport {SNAPSHOT_HUB_API_URL, SPACE} from '../../../config';\nimport {useIsMounted} from '../../../hooks';\n\ntype UseGovernanceProposalsReturn = {\n  governanceProposals: ProposalData[];\n  governanceProposalsStatus: AsyncStatus;\n  governanceProposalsError: Error | undefined;\n};\n\n/**\n * useGovernanceProposals\n *\n * Provides an array of id->proposal tuples of governance-style proposals which are not submitted on-chain.\n *\n * @param {{actionId : string}}\n *   - `actionId`: Name of the ERC-712 `actionId` to get Governance proposals by. Defaults to `BURN_ADDRESS`.\n * @returns `UseGovernanceProposalsReturn` An object with the governance proposals, and the current async status.\n */\nexport function useGovernanceProposals({\n  actionId = BURN_ADDRESS,\n}: {\n  actionId?: string;\n}): UseGovernanceProposalsReturn {\n  /**\n   * State\n   */\n\n  const [governanceProposals, setGovernanceProposals] = useState<\n    ProposalData[]\n  >([]);\n  const [governanceProposalsError, setGovernanceProposalsError] =\n    useState<Error>();\n  const [governanceProposalsStatus, setGovernanceProposalsStatus] =\n    useState<AsyncStatus>(AsyncStatus.STANDBY);\n\n  /**\n   * Our hooks\n   */\n\n  const {isMountedRef} = useIsMounted();\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleGetProposalsCached = useCallback(handleGetProposals, [\n    actionId,\n    isMountedRef,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    handleGetProposalsCached();\n  }, [handleGetProposalsCached]);\n\n  /**\n   * Functions\n   */\n\n  /**\n   * Gets Proposals from Snapshot Hub\n   */\n  async function getSnapshotProposalsByActionId(\n    actionId: string\n  ): Promise<ProposalData[]> {\n    try {\n      const baseURL = `${SNAPSHOT_HUB_API_URL}/api/${SPACE}`;\n\n      const proposals = await fetch(\n        `${baseURL}/proposals/${actionId}?includeVotes=true`\n      );\n\n      if (!proposals.ok) {\n        throw new Error(\n          'Something went wrong while fetching the Snapshot proposals.'\n        );\n      }\n\n      const proposalsJSON: SnapshotProposalResponse = await proposals.json();\n\n      /**\n       * @note The id of the proposal is used and we do not consider any Draft id,\n       *   as we do for Snapshot->on-chain proposals.\n       *\n       * @todo Fix type of return so we don't need to add so many empty key/value pairs.\n       */\n      return Object.entries(proposalsJSON).map(\n        ([id, snapshotProposal]): ProposalData => ({\n          daoProposal: undefined,\n          snapshotDraft: undefined,\n          snapshotProposal: {\n            ...snapshotProposal,\n            idInSnapshot: id,\n            idInDAO: '',\n          },\n          getCommonSnapshotProposalData: () => undefined,\n          refetchProposalOrDraft: () => undefined,\n          snapshotType: SnapshotType.proposal,\n        })\n      );\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async function handleGetProposals() {\n    try {\n      setGovernanceProposalsStatus(AsyncStatus.PENDING);\n\n      const snapshotProposalEntries = await getSnapshotProposalsByActionId(\n        actionId\n      );\n\n      if (!isMountedRef.current) return;\n\n      setGovernanceProposalsStatus(AsyncStatus.FULFILLED);\n      setGovernanceProposals(snapshotProposalEntries);\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setGovernanceProposalsStatus(AsyncStatus.REJECTED);\n      setGovernanceProposals([]);\n      setGovernanceProposalsError(error);\n    }\n  }\n\n  return {\n    governanceProposals,\n    governanceProposalsError,\n    governanceProposalsStatus,\n  };\n}\n","import React from 'react';\nimport {useHistory} from 'react-router-dom';\n\nimport {BURN_ADDRESS} from '../../util/constants';\nimport FadeIn from '../../components/common/FadeIn';\nimport GovernanceProposalsList from '../../components/governance/GovernanceProposalsList';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function GovernanceProposals() {\n  /**\n   * Functions\n   */\n\n  function proposalLinkPath(id: string) {\n    return `/governance/${id}`;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <RenderWrapper>\n      <GovernanceProposalsList\n        actionId={BURN_ADDRESS}\n        proposalLinkPath={proposalLinkPath}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToNewProposal(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/governance-proposal');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Governance</h2>\n          <button className=\"titlebar__action\" onClick={goToNewProposal}>\n            New Proposal\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useLazyQuery} from '@apollo/react-hooks';\nimport {useSelector} from 'react-redux';\nimport {AbiItem, toBN, toChecksumAddress} from 'web3-utils';\n\nimport {AsyncStatus} from '../../../util/types';\nimport {GET_MEMBERS} from '../../../gql';\nimport {Member} from '../types';\nimport {multicall, MulticallTuple} from '../../../components/web3/helpers';\nimport {normalizeString} from '../../../util/helpers';\nimport {StoreState} from '../../../store/types';\nimport {SubgraphNetworkStatus} from '../../../store/subgraphNetworkStatus/types';\nimport {UNITS_ADDRESS} from '../../../config';\nimport {useWeb3Modal} from '../../../components/web3/hooks';\n\ntype UseMembersReturn = {\n  members: Member[];\n  membersError: Error | undefined;\n  membersStatus: AsyncStatus;\n};\n\n/**\n * useMembers\n *\n * Gets DAO members from subgraph with direct onchain fallback.\n *\n * @returns {UseMembersReturn} An object with the members and the current async status.\n */\nexport default function useMembers(): UseMembersReturn {\n  /**\n   * Selectors\n   */\n\n  const DaoRegistryContract = useSelector(\n    (state: StoreState) => state.contracts.DaoRegistryContract\n  );\n  const BankExtensionContract = useSelector(\n    (state: StoreState) => state.contracts.BankExtensionContract\n  );\n  const subgraphNetworkStatus = useSelector(\n    (state: StoreState) => state.subgraphNetworkStatus.status\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {web3Instance} = useWeb3Modal();\n\n  /**\n   * GQL Query\n   */\n\n  const [getMembersFromSubgraphResult, {called, loading, data, error}] =\n    useLazyQuery(GET_MEMBERS, {\n      variables: {\n        daoAddress: DaoRegistryContract?.contractAddress.toLowerCase(),\n      },\n    });\n\n  /**\n   * State\n   */\n\n  const [members, setMembers] = useState<Member[]>([]);\n  const [membersStatus, setMembersStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n  const [membersError, setMembersError] = useState<Error>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const getMembersFromRegistryCached = useCallback(getMembersFromRegistry, [\n    BankExtensionContract,\n    DaoRegistryContract,\n    web3Instance,\n  ]);\n\n  const getMembersFromSubgraphCached = useCallback(getMembersFromSubgraph, [\n    data,\n    error,\n    getMembersFromRegistryCached,\n    loading,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!called) {\n      getMembersFromSubgraphResult();\n    }\n  }, [called, getMembersFromSubgraphResult]);\n\n  useEffect(() => {\n    if (subgraphNetworkStatus === SubgraphNetworkStatus.OK) {\n      if (!loading && DaoRegistryContract?.contractAddress) {\n        getMembersFromSubgraphCached();\n      }\n    } else {\n      // If there is a subgraph network error fallback to fetching members info\n      // directly from smart contracts\n      getMembersFromRegistryCached();\n    }\n  }, [\n    DaoRegistryContract?.contractAddress,\n    getMembersFromRegistryCached,\n    getMembersFromSubgraphCached,\n    loading,\n    subgraphNetworkStatus,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function getMembersFromSubgraph() {\n    try {\n      setMembersStatus(AsyncStatus.PENDING);\n\n      if (!loading && data) {\n        // extract members from gql data\n        const {members} = data.tributeDaos[0] as Record<string, any>;\n        // Filter out any member that has fully ragequit (no positive balance in\n        // UNITS)\n        const filteredMembers = members.filter(\n          (member: Record<string, any>) => !member.didFullyRagequit\n        );\n        const filteredMembersWithDetails = filteredMembers.map(\n          (member: Record<string, any>) => {\n            // remove gql data that is no longer needed\n            const {createdAt, didFullyRagequit, ...parsedMember} = member;\n\n            return {\n              ...parsedMember,\n              // use formatted addresses\n              address: toChecksumAddress(member.address),\n              delegateKey: toChecksumAddress(member.delegateKey),\n            };\n          }\n        );\n\n        setMembersStatus(AsyncStatus.FULFILLED);\n        setMembers(filteredMembersWithDetails);\n      } else {\n        if (error) {\n          throw new Error(error.message);\n        }\n      }\n    } catch (error) {\n      // If there is a subgraph query error fallback to fetching members info\n      // directly from smart contracts\n      console.log(`subgraph query error: ${error.message}`);\n      getMembersFromRegistryCached();\n    }\n  }\n\n  async function getMembersFromRegistry() {\n    if (!DaoRegistryContract || !BankExtensionContract || !web3Instance) {\n      return;\n    }\n\n    try {\n      setMembersStatus(AsyncStatus.PENDING);\n\n      const {\n        abi: daoRegistryABI,\n        contractAddress: daoRegistryAddress,\n        instance: {methods: daoRegistryMethods},\n      } = DaoRegistryContract;\n\n      const nbMembers = await daoRegistryMethods.getNbMembers().call();\n\n      if (Number(nbMembers) > 0) {\n        // Build calls to get list of member addresses\n        const getMemberAddressABI = daoRegistryABI.find(\n          (item) => item.name === 'getMemberAddress'\n        );\n        const getMemberAddressCalls = [...Array(Number(nbMembers)).keys()].map(\n          (index): MulticallTuple => [\n            daoRegistryAddress,\n            getMemberAddressABI as AbiItem,\n            [index.toString()],\n          ]\n        );\n        const memberAddresses: string[] = await multicall({\n          calls: getMemberAddressCalls,\n          web3Instance,\n        });\n\n        // Build calls to get list of member addresses by delegated key\n        const memberAddressesByDelegatedKeyABI = daoRegistryABI.find(\n          (item) => item.name === 'memberAddressesByDelegatedKey'\n        );\n        const memberAddressesByDelegatedKeyCalls = memberAddresses.map(\n          (address): MulticallTuple => [\n            daoRegistryAddress,\n            memberAddressesByDelegatedKeyABI as AbiItem,\n            [address],\n          ]\n        );\n        const memberAddressesByDelegatedKey: string[] = await multicall({\n          calls: memberAddressesByDelegatedKeyCalls,\n          web3Instance,\n        });\n\n        // Build calls to get member balances in UNITS\n        const {abi: bankABI, contractAddress: bankAddress} =\n          BankExtensionContract;\n\n        const balanceOfABI = bankABI.find((item) => item.name === 'balanceOf');\n        const unitsBalanceOfCalls = memberAddressesByDelegatedKey.map(\n          (address): MulticallTuple => [\n            bankAddress,\n            balanceOfABI as AbiItem,\n            [address, UNITS_ADDRESS],\n          ]\n        );\n        const unitsBalances: string[] = await multicall({\n          calls: unitsBalanceOfCalls,\n          web3Instance,\n        });\n\n        const membersWithDetails = memberAddresses.map((address, index) => ({\n          address,\n          delegateKey: memberAddressesByDelegatedKey[index],\n          isDelegated:\n            normalizeString(address) !==\n            normalizeString(memberAddressesByDelegatedKey[index]),\n          units: unitsBalances[index],\n        }));\n\n        // Filter out any member addresses that don't have a positive balance in\n        // UNITS\n        const filteredMembersWithDetails = membersWithDetails\n          .filter((member) => toBN(member.units).gt(toBN(0)))\n          // display in descending order of when the member joined (e.g., newest\n          // member first)\n          .reverse();\n\n        setMembers(filteredMembersWithDetails);\n      }\n\n      setMembersStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      setMembersStatus(AsyncStatus.REJECTED);\n      setMembers([]);\n      setMembersError(error);\n    }\n  }\n\n  return {members, membersError, membersStatus};\n}\n","import {useState, useEffect, useCallback} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {useForm} from 'react-hook-form';\nimport {toChecksumAddress} from 'web3-utils';\n\nimport {\n  useWeb3Modal,\n  useContractSend,\n  useETHGasPrice,\n} from '../../components/web3/hooks';\nimport {Web3TxStatus} from '../../components/web3/types';\nimport {TX_CYCLE_MESSAGES} from '../../components/web3/config';\nimport EtherscanURL from '../../components/web3/EtherscanURL';\nimport {FormFieldErrors} from '../../util/enums';\nimport {isEthAddressValid} from '../../util/validation';\nimport {getValidationError, truncateEthAddress} from '../../util/helpers';\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {getConnectedMember} from '../../store/actions';\nimport {ReduxDispatch, StoreState} from '../../store/types';\nimport {CheckboxSize} from '../../components/common/Checkbox';\nimport Loader from '../../components/feedback/Loader';\nimport CycleMessage from '../../components/feedback/CycleMessage';\nimport Modal from '../../components/common/Modal';\nimport TimesSVG from '../../assets/svg/TimesSVG';\nimport UserSVG from '../../assets/svg/UserSVG';\nimport FadeIn from '../../components/common/FadeIn';\nimport InputError from '../../components/common/InputError';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\n\nenum DelegationStatus {\n  DELEGATE_VOTES = 'Delegate Votes',\n  REVOKE_DELEGATION = 'Revoke Delegation',\n}\n\nenum DelegationStep {\n  SET_DELEGATION = 'setDelegation',\n  REVOKE_DELEGATION = 'revokeDelegation',\n}\n\nenum Fields {\n  delegateAddress = 'delegateAddress',\n  confirmDelegation = 'confirmDelegation',\n}\n\ntype Steps = 'setDelegation' | 'revokeDelegation';\n\ntype StepsType = {[S in Steps]: () => JSX.Element};\n\ntype FormInputs = {\n  delegateAddress: string;\n  confirmDelegation: boolean;\n};\n\ntype UpdateDelegateKeyArguments = [\n  string, // `dao`\n  string // `delegateKey`\n];\n\ntype DelegationModalProps = {\n  isOpen: boolean;\n  closeHandler: () => void;\n  currentStep: string;\n};\n\nfunction DelegationModal({\n  isOpen,\n  closeHandler,\n  currentStep,\n}: DelegationModalProps): JSX.Element {\n  /**\n   * Selectors\n   */\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n  const daoRegistryAdapterContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryAdapterContract\n  );\n  const connectedMember = useSelector((s: StoreState) => s.connectedMember);\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {fast: fastGasPrice} = useETHGasPrice();\n  const {txError, txEtherscanURL, txIsPromptOpen, txSend, txStatus} =\n    useContractSend();\n\n  /**\n   * Their hooks\n   */\n\n  const form = useForm<FormInputs>({\n    mode: 'onBlur',\n    reValidateMode: 'onChange',\n  });\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Variables\n   */\n\n  const {errors, getValues, register, trigger, watch} = form;\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n  const delegateError = submitError || txError;\n\n  const delegateAddressValue = watch(Fields.delegateAddress);\n  const confirmDelegationValue = watch(Fields.confirmDelegation);\n  const isFormFieldEmpty = !delegateAddressValue || !confirmDelegationValue;\n  const steps: StepsType = {\n    setDelegation: renderSetDelegation,\n    revokeDelegation: renderRevokeDelegation,\n  };\n\n  /**\n   * Functions\n   */\n\n  function renderCurrentStep() {\n    return steps[currentStep]();\n  }\n\n  function renderSetDelegation() {\n    return (\n      <>\n        {/* TITLE */}\n        <div className=\"modal__title\">Delegate</div>\n\n        <p>Transfer your voting rights</p>\n        <div className=\"delegation-modal__arrow-down\">&darr;</div>\n        <form className=\"form\" onSubmit={(e) => e.preventDefault()}>\n          {/* DELEGATE ADDRESS */}\n          <div className=\"form__input-row\">\n            <div className=\"form__input-row-fieldwrap\">\n              <input\n                aria-describedby={`error-${Fields.delegateAddress}`}\n                aria-invalid={errors.delegateAddress ? 'true' : 'false'}\n                name={Fields.delegateAddress}\n                ref={register({\n                  validate: (delegateAddress: string): string | boolean => {\n                    return !delegateAddress\n                      ? FormFieldErrors.REQUIRED\n                      : !isEthAddressValid(delegateAddress) ||\n                        delegateAddress === BURN_ADDRESS\n                      ? FormFieldErrors.INVALID_ETHEREUM_ADDRESS\n                      : true;\n                  },\n                })}\n                type=\"text\"\n                disabled={isInProcessOrDone}\n                placeholder=\"Enter delegate address\"\n              />\n\n              {getValidationError(Fields.delegateAddress, errors).includes(\n                'invalid'\n              ) && (\n                <InputError\n                  error={getValidationError(Fields.delegateAddress, errors)}\n                  id={`error-${Fields.delegateAddress}`}\n                />\n              )}\n            </div>\n          </div>\n\n          {/* CONFIRM DELEGATION */}\n          <div className=\"form__input-row\" style={{marginTop: 0}}>\n            <div className=\"form__input-row-fieldwrap\">\n              <input\n                className=\"checkbox-input\"\n                aria-describedby={`error-${Fields.confirmDelegation}`}\n                aria-invalid={errors.confirmDelegation ? 'true' : 'false'}\n                id={Fields.confirmDelegation}\n                name={Fields.confirmDelegation}\n                ref={register({\n                  required: FormFieldErrors.REQUIRED,\n                })}\n                type=\"checkbox\"\n                disabled={isInProcessOrDone}\n              />\n\n              <label\n                className=\"checkbox-label\"\n                htmlFor={Fields.confirmDelegation}>\n                <span className={`checkbox-box ${CheckboxSize.SMALL}`}></span>\n                <span className=\"checkbox-text\">\n                  Confirm delegation to the above address. You can revoke this\n                  at any time from your profile.\n                </span>\n              </label>\n            </div>\n          </div>\n\n          {/* SUBMIT */}\n          <button\n            aria-label={isInProcess ? 'Updating your delegate key...' : ''}\n            className=\"button\"\n            disabled={isInProcessOrDone || isFormFieldEmpty}\n            onClick={async () => {\n              if (isInProcessOrDone) return;\n\n              if (!(await trigger())) {\n                return;\n              }\n\n              handleConfirmDelegation(getValues());\n            }}\n            type=\"submit\">\n            {isInProcess ? <Loader /> : isDone ? 'Done' : 'Confirm'}\n          </button>\n\n          {/* SUBMIT STATUS */}\n          {isInProcessOrDone && (\n            <div className=\"form__submit-status-container\">\n              {renderSubmitStatus()}\n            </div>\n          )}\n\n          {/* SUBMIT ERROR */}\n          {delegateError && (\n            <div className=\"form__submit-error-container\">\n              <ErrorMessageWithDetails\n                renderText=\"Something went wrong with your delegation.\"\n                error={delegateError}\n              />\n            </div>\n          )}\n        </form>\n      </>\n    );\n  }\n\n  function renderRevokeDelegation() {\n    if (connectedMember) {\n      return (\n        <>\n          {/* TITLE */}\n          <div className=\"modal__title\">Revoke Delegation</div>\n\n          <p>{truncateEthAddress(connectedMember.delegateKey, 7)}</p>\n          <div className=\"delegation-modal__arrow-down\">&darr;</div>\n          <p>\n            <UserSVG />\n            Back to you\n          </p>\n          <div className=\"delegation-modal__text\">\n            You&apos;ll be able to resume voting from your account. You can\n            delegate again at any time from your profile.\n          </div>\n\n          {/* SUBMIT */}\n          <button\n            aria-label={isInProcess ? 'Updating your delegate key...' : ''}\n            className=\"button\"\n            disabled={isInProcessOrDone}\n            onClick={handleRevokeDelegation}>\n            {isInProcess ? <Loader /> : isDone ? 'Done' : 'Confirm'}\n          </button>\n\n          {/* SUBMIT STATUS */}\n          {isInProcessOrDone && (\n            <div className=\"form__submit-status-container\">\n              {renderSubmitStatus()}\n            </div>\n          )}\n\n          {/* SUBMIT ERROR */}\n          {delegateError && (\n            <div className=\"form__submit-error-container\">\n              <ErrorMessageWithDetails\n                renderText=\"Something went wrong with your revocation.\"\n                error={delegateError}\n              />\n            </div>\n          )}\n        </>\n      );\n    }\n\n    return <></>;\n  }\n\n  async function handleConfirmDelegation(values: FormInputs) {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!daoRegistryAdapterContract) {\n        throw new Error('No DAO Registry Adapter contract was found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const {delegateAddress} = values;\n\n      const updateDelegateKeyArguments: UpdateDelegateKeyArguments = [\n        daoRegistryContract.contractAddress,\n        toChecksumAddress(delegateAddress),\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      // Execute contract call for `updateDelegateKey`\n      const tx = await txSend(\n        'updateDelegateKey',\n        daoRegistryAdapterContract.instance.methods,\n        updateDelegateKeyArguments,\n        txArguments\n      );\n\n      if (tx) {\n        setTimeout(async () => {\n          // re-fetch member\n          await dispatch(\n            getConnectedMember({\n              account,\n              daoRegistryContract,\n              web3Instance,\n            })\n          );\n\n          closeHandler();\n        }, 2000);\n      }\n    } catch (error) {\n      console.log(error);\n      let parsedError = error;\n\n      if (\n        error.message.includes('cannot overwrite existing delegated keys') ||\n        error.message.includes('address already taken as delegated key')\n      ) {\n        parsedError = new Error(\n          'The provided address cannot be another member or already in use as a delegate.'\n        );\n      }\n\n      setSubmitError(parsedError);\n    }\n  }\n\n  async function handleRevokeDelegation() {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!daoRegistryAdapterContract) {\n        throw new Error('No DAO Registry Adapter contract was found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const updateDelegateKeyArguments: UpdateDelegateKeyArguments = [\n        daoRegistryContract.contractAddress,\n        toChecksumAddress(account),\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      // Execute contract call for `updateDelegateKey`\n      const tx = await txSend(\n        'updateDelegateKey',\n        daoRegistryAdapterContract.instance.methods,\n        updateDelegateKeyArguments,\n        txArguments\n      );\n\n      if (tx) {\n        setTimeout(async () => {\n          // re-fetch member\n          await dispatch(\n            getConnectedMember({\n              account,\n              daoRegistryContract,\n              web3Instance,\n            })\n          );\n\n          closeHandler();\n        }, 2000);\n      }\n    } catch (error) {\n      console.log(error);\n\n      setSubmitError(error);\n    }\n  }\n\n  function renderSubmitStatus(): React.ReactNode {\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return 'Awaiting your confirmation\\u2026';\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Modal\n      keyProp=\"delegation\"\n      isOpen={isOpen}\n      // Require user to click on close button to avoid accidental modal close\n      // during transaction\n      isOpenHandler={() => {}}\n      modalClassNames=\"delegation-modal\">\n      {/* MODEL CLOSE BUTTON */}\n      <span\n        className=\"modal__close-button\"\n        onClick={() => {\n          closeHandler();\n        }}>\n        <TimesSVG />\n      </span>\n      {renderCurrentStep()}\n    </Modal>\n  );\n}\n\nexport default function Delegation() {\n  /**\n   * Selectors\n   */\n\n  const connectedMember = useSelector((s: StoreState) => s.connectedMember);\n\n  /**\n   * State\n   */\n\n  const [currentStep, setCurrentStep] = useState<string>(\n    DelegationStep.SET_DELEGATION\n  );\n  const [delegationStatus, setDelegationStatus] = useState<string>('');\n  const [showDelegationModal, setShowDelegationModal] =\n    useState<boolean>(false);\n\n  /**\n   * Cached callbacks\n   */\n\n  const fetchDelegationInfoCached = useCallback(fetchDelegationInfo, [\n    connectedMember,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    fetchDelegationInfoCached();\n  }, [fetchDelegationInfoCached]);\n\n  /**\n   * Functions\n   */\n\n  async function fetchDelegationInfo() {\n    try {\n      if (!connectedMember) {\n        throw new Error('No connected account found.');\n      }\n\n      const currentStep = connectedMember.isAddressDelegated\n        ? DelegationStep.REVOKE_DELEGATION\n        : DelegationStep.SET_DELEGATION;\n      setCurrentStep(currentStep);\n\n      const delegationStatus = connectedMember.isAddressDelegated\n        ? DelegationStatus.REVOKE_DELEGATION\n        : DelegationStatus.DELEGATE_VOTES;\n      setDelegationStatus(delegationStatus);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  if (connectedMember) {\n    return (\n      <>\n        {delegationStatus !== '' && (\n          <>\n            <div className=\"memberprofile__action-description\">\n              {connectedMember.isAddressDelegated ? (\n                // CURRENT DELEGATION\n                <>\n                  Your voting rights have been delegated to{' '}\n                  <span className=\"delegation__delegate-address-text\">\n                    {truncateEthAddress(connectedMember.delegateKey, 7)}\n                  </span>\n                  . You can revoke this at any time.\n                </>\n              ) : (\n                <>\n                  You can delegate your voting rights to a different ETH\n                  address. The address cannot be another member or already in\n                  use as a delegate.\n                </>\n              )}\n            </div>\n\n            {/* OPEN DELEGATION MODAL BUTTON */}\n            <button\n              className=\"memberprofile__action-button\"\n              onClick={() => setShowDelegationModal(true)}>\n              {delegationStatus}\n            </button>\n          </>\n        )}\n\n        {showDelegationModal && (\n          <DelegationModal\n            isOpen={showDelegationModal}\n            closeHandler={() => {\n              setShowDelegationModal(false);\n            }}\n            currentStep={currentStep}\n          />\n        )}\n      </>\n    );\n  }\n\n  return <></>;\n}\n","import {SVGAttributes} from 'react';\n\nexport default function CheckSVG(props: SVGAttributes<HTMLOrSVGElement>) {\n  return (\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      data-icon=\"copy\"\n      role=\"img\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 448 512\"\n      {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z\"></path>\n    </svg>\n  );\n}\n","import React from 'react';\n\nexport default function ArrowsSVG(props: React.SVGAttributes<SVGElement>) {\n  return (\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      data-icon=\"wallet\"\n      role=\"img\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 512 512\"\n      {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M461.2 128H80c-8.84 0-16-7.16-16-16s7.16-16 16-16h384c8.84 0 16-7.16 16-16 0-26.51-21.49-48-48-48H64C28.65 32 0 60.65 0 96v320c0 35.35 28.65 64 64 64h397.2c28.02 0 50.8-21.53 50.8-48V176c0-26.47-22.78-48-50.8-48zM416 336c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z\"></path>\n    </svg>\n  );\n}\n","import {truncateEthAddress} from '../../util/helpers/truncateEthAddress';\nimport CopySVG from '../../assets/svg/CopySVG';\nimport WalletSVG from '../../assets/svg/WalletSVG';\n\nexport type ERC20RegisterDetails = {\n  address: string;\n  symbol: string;\n  decimals: number;\n  image: string;\n};\n\ntype DaoTokenProps = {\n  daoTokenDetails?: ERC20RegisterDetails;\n};\n\nexport default function DaoToken({\n  daoTokenDetails,\n}: DaoTokenProps): JSX.Element {\n  /**\n   * Functions\n   */\n\n  async function addTokenToWallet() {\n    if (!daoTokenDetails) return;\n\n    try {\n      await window.ethereum.request({\n        method: 'wallet_watchAsset',\n        params: {\n          type: 'ERC20',\n          options: daoTokenDetails,\n        },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  function copyAddressToClipboard() {\n    if (!daoTokenDetails) return;\n\n    const copyText = document.createElement('input');\n    document.body.appendChild(copyText);\n    copyText.setAttribute('value', daoTokenDetails.address);\n    copyText.select();\n    document.execCommand('copy');\n    document.body.removeChild(copyText);\n\n    const tooltip = document.getElementById('copyTooltip');\n    (tooltip as HTMLElement).innerHTML = 'copied!';\n  }\n\n  function resetCopyTooltip() {\n    const tooltip = document.getElementById('copyTooltip');\n    (tooltip as HTMLElement).innerHTML = 'copy address';\n  }\n\n  /**\n   * Render\n   */\n\n  if (daoTokenDetails) {\n    return (\n      <div>\n        Token: <span>{truncateEthAddress(daoTokenDetails.address, 7)}</span>\n        <div className=\"daotoken__tooltip\">\n          <button\n            className=\"daotoken__button\"\n            onClick={copyAddressToClipboard}\n            onMouseLeave={resetCopyTooltip}>\n            <span className=\"daotoken__tooltiptext\" id=\"copyTooltip\">\n              copy address\n            </span>\n            <CopySVG />\n          </button>\n        </div>\n        <div className=\"daotoken__tooltip\">\n          <button className=\"daotoken__button\" onClick={addTokenToWallet}>\n            <span className=\"daotoken__tooltiptext\">add to wallet</span>\n            <WalletSVG />\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return <></>;\n}\n","import {SVGAttributes} from 'react';\n\nexport default function UserSVG(props: SVGAttributes<HTMLOrSVGElement>) {\n  return (\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      data-icon=\"user\"\n      role=\"img\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 448 512\"\n      {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M313.6 304c-28.7 0-42.5 16-89.6 16-47.1 0-60.8-16-89.6-16C60.2 304 0 364.2 0 438.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-25.6c0-74.2-60.2-134.4-134.4-134.4zM400 464H48v-25.6c0-47.6 38.8-86.4 86.4-86.4 14.6 0 38.3 16 89.6 16 51.7 0 74.9-16 89.6-16 47.6 0 86.4 38.8 86.4 86.4V464zM224 288c79.5 0 144-64.5 144-144S303.5 0 224 0 80 64.5 80 144s64.5 144 144 144zm0-240c52.9 0 96 43.1 96 96s-43.1 96-96 96-96-43.1-96-96 43.1-96 96-96z\"></path>\n    </svg>\n  );\n}\n","import {useEffect, useState} from 'react';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {AsyncStatus} from '../../util/types';\nimport {Member} from './types';\nimport {\n  truncateEthAddress,\n  normalizeString,\n  formatNumber,\n} from '../../util/helpers';\nimport {useIsDefaultChain, useWeb3Modal} from '../../components/web3/hooks';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport useMembers from './hooks/useMembers';\nimport Wrap from '../../components/common/Wrap';\nimport {useDaoTokenDetails} from '../../components/dao-token/hooks';\nimport DaoToken from '../../components/dao-token/DaoToken';\nimport {useDaoTotalUnits} from '../../hooks';\nimport Delegation from './Delegation';\n\nexport default function MemberProfile() {\n  /**\n   * Our hooks\n   */\n\n  const {members, membersError, membersStatus} = useMembers();\n  const {defaultChainError} = useIsDefaultChain();\n  const {account} = useWeb3Modal();\n  const {daoTokenDetails, daoTokenDetailsStatus} = useDaoTokenDetails();\n  const {totalUnits, totalUnitsStatus} = useDaoTotalUnits();\n\n  /**\n   * Their hooks\n   */\n\n  // Get ethereumAddress for fetching the member.\n  const {ethereumAddress} = useParams<{ethereumAddress: string}>();\n\n  /**\n   * State\n   */\n\n  const [memberDetails, setMemberDetails] = useState<Member>();\n  const [memberNotFound, setMemberNotFound] = useState<boolean>(false);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (membersStatus !== AsyncStatus.FULFILLED) return;\n\n    const activeMember = members.find(\n      (member) =>\n        normalizeString(member.address) === normalizeString(ethereumAddress)\n    );\n\n    setMemberDetails(activeMember);\n    if (!activeMember) {\n      setMemberNotFound(true);\n    }\n  }, [ethereumAddress, members, membersStatus]);\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean =\n    membersStatus === AsyncStatus.STANDBY ||\n    membersStatus === AsyncStatus.PENDING ||\n    daoTokenDetailsStatus === AsyncStatus.STANDBY ||\n    daoTokenDetailsStatus === AsyncStatus.PENDING ||\n    totalUnitsStatus === AsyncStatus.STANDBY ||\n    totalUnitsStatus === AsyncStatus.PENDING;\n  const isLoadingDone: boolean = membersStatus === AsyncStatus.FULFILLED;\n  const error: Error | undefined = membersError || defaultChainError;\n  const isCurrentMemberConnected: boolean =\n    account &&\n    memberDetails &&\n    normalizeString(account) === normalizeString(memberDetails.address)\n      ? true\n      : false;\n  const votingWeight =\n    memberDetails && typeof totalUnits === 'number'\n      ? ((Number(memberDetails.units) / totalUnits) * 100).toFixed(2)\n      : '';\n\n  /**\n   * Functions\n   */\n\n  function renderMemberInfo() {\n    if (!memberDetails) return;\n\n    return (\n      <div>\n        <div className=\"memberprofile__info-item\">\n          {daoTokenDetails ? (\n            <>\n              <div>DAO Tokens</div>\n              <div>{`${formatNumber(memberDetails.units)} ${\n                daoTokenDetails.symbol || 'tokens'\n              }`}</div>\n              {isCurrentMemberConnected && (\n                <small>\n                  <DaoToken daoTokenDetails={daoTokenDetails} />\n                </small>\n              )}\n            </>\n          ) : (\n            <>\n              <div>Membership Units</div>\n              <div>{formatNumber(memberDetails.units)}</div>\n            </>\n          )}\n        </div>\n        <div className=\"memberprofile__info-item\">\n          <div>Voting Weight</div>\n          <div>{`${votingWeight}%`}</div>\n        </div>\n      </div>\n    );\n  }\n\n  function renderMemberActions() {\n    if (isCurrentMemberConnected) {\n      return (\n        <div>\n          <div className=\"memberprofile__action\">\n            <div className=\"memberprofile__action-header\">Delegation</div>\n            <Delegation />\n          </div>\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"memberprofile__actions-unavailable\">\n          Connect your wallet with this member address to view available\n          actions.\n        </div>\n      );\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong while getting the member.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render no member found\n  if (memberNotFound && isLoadingDone) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center error-message\">\n          <p>Member not found.</p>\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      {memberDetails ? (\n        <>\n          <div className=\"memberprofile__header\">Member Profile</div>\n          <div className=\"proposaldetails\">\n            {/* LEFT COLUMN */}\n\n            <div className=\"memberprofile__left-column\">\n              {/* MEMBER ADDRESS */}\n              <h3>{truncateEthAddress(memberDetails.address, 7)}</h3>\n\n              {/* MEMBER INFO */}\n              {renderMemberInfo()}\n            </div>\n\n            {/* RIGHT COLUMN */}\n            <div className=\"memberprofile__right-column\">\n              {/* MEMBER ACTIONS */}\n              {renderMemberActions()}\n            </div>\n          </div>\n        </>\n      ) : (\n        // Render nothing. Should never reach this case.\n        <></>\n      )}\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function viewAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/members');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Members</h2>\n          <button className=\"titlebar__action\" onClick={viewAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {Link} from 'react-router-dom';\nimport {Member} from './types';\n\nimport {truncateEthAddress} from '../../util/helpers';\nimport {useWeb3Modal} from '../../components/web3/hooks';\n\ntype MemberCardProps = {\n  member: Member;\n  to?: string;\n};\n\nconst DEFAULT_CARD_LINK: string = '#';\n\n/**\n * Shows a preview of a members's profile\n *\n * @param {MemberCardProps} props\n * @returns {JSX.Element}\n */\nexport default function MemberCard(props: MemberCardProps): JSX.Element {\n  const {member, to = DEFAULT_CARD_LINK} = props;\n\n  /**\n   * Our hooks\n   */\n\n  const {account} = useWeb3Modal();\n\n  /**\n   * Render\n   */\n\n  return (\n    <Link className={'membercard__link'} to={to}>\n      <div\n        className={`membercard ${\n          account && account.toLowerCase() === member.address.toLowerCase()\n            ? `membercard--connected-account`\n            : ''\n        }`}>\n        {/* TITLE */}\n        <h3 className=\"membercard__title\">\n          {truncateEthAddress(member.address, 7)}\n        </h3>\n      </div>\n    </Link>\n  );\n}\n","import {AsyncStatus} from '../../util/types';\nimport {Member} from './types';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport MemberCard from './MemberCard';\nimport useMembers from './hooks/useMembers';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function Members() {\n  /**\n   * Our hooks\n   */\n\n  const {members, membersError, membersStatus} = useMembers();\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean =\n    membersStatus === AsyncStatus.STANDBY ||\n    membersStatus === AsyncStatus.PENDING;\n\n  const isLoadingDone: boolean = membersStatus === AsyncStatus.FULFILLED;\n\n  const error: Error | undefined = membersError || defaultChainError;\n\n  /**\n   * Functions\n   */\n\n  function renderMemberCards(members: Member[]) {\n    return members.map((member) => {\n      return (\n        <MemberCard\n          key={member.address}\n          to={`/members/${member.address}`}\n          member={member}\n        />\n      );\n    });\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong while getting the members.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render no members\n  if (!Object.values(members).length && isLoadingDone) {\n    return (\n      <RenderWrapper>\n        <p className=\"text-center\">No members, yet!</p>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <div className=\"grid--fluid grid-container\">\n        {/* ACTIVE MEMBERS */}\n        <div>\n          <div className=\"grid__header\">Active Members</div>\n          <div className=\"grid__cards\">{renderMemberCards(members)}</div>\n        </div>\n      </div>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Members</h2>\n        </div>\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React, {Fragment, useEffect, useState} from 'react';\n\nimport {\n  DaoAdapterConstants,\n  VotingAdapterName,\n} from '../adapters-extensions/enums';\nimport {AsyncStatus} from '../../util/types';\nimport {BURN_ADDRESS} from '../../util/constants';\nimport {normalizeString} from '../../util/helpers';\nimport {OffchainVotingStatus} from './voting';\nimport {ProposalData, ProposalFlag, VotingResult} from './types';\nimport {proposalHasFlag, proposalHasVotingState} from './helpers';\nimport {ProposalHeaderNames} from '../../util/enums';\nimport {useIsDefaultChain} from '../web3/hooks';\nimport {useProposals, useOffchainVotingResults} from './hooks';\nimport {VotingState} from './voting/types';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport LoaderLarge from '../feedback/LoaderLarge';\nimport ProposalCard from './ProposalCard';\n\ntype ProposalsProps = {\n  adapterName: DaoAdapterConstants;\n  /**\n   * Optionally provide a click handler for `ProposalCard`.\n   * The proposal's id (in the DAO) will be provided as an argument.\n   * Defaults to noop: `() => {}`\n   */\n  onProposalClick?: (id: string) => void;\n  /**\n   * The path to link to. Defaults to `${location.pathname}/${proposalOnClickId}`.\n   */\n  proposalLinkPath?: Parameters<typeof ProposalCard>['0']['linkPath'];\n  /**\n   * Optionally render a custom proposal card.\n   */\n  renderProposalCard?: (data: {proposalData: ProposalData}) => React.ReactNode;\n  /**\n   * To handle proposal types where the first step is creating a snapshot\n   * draft/offchain proposal only (no onchain proposal exists)\n   */\n  includeProposalsExistingOnlyOffchain?: boolean;\n};\n\ntype FilteredProposals = {\n  failedProposals: ProposalData[];\n  nonsponsoredProposals: ProposalData[];\n  passedProposals: ProposalData[];\n  votingProposals: ProposalData[];\n};\n\nexport default function Proposals(props: ProposalsProps): JSX.Element {\n  const {\n    adapterName,\n    onProposalClick = () => {},\n    proposalLinkPath,\n    renderProposalCard,\n    includeProposalsExistingOnlyOffchain = false,\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [proposalsForVotingResults, setProposalsForVotingResults] = useState<\n    ProposalData['snapshotProposal'][]\n  >([]);\n\n  const [filteredProposals, setFilteredProposals] = useState<FilteredProposals>(\n    {\n      failedProposals: [],\n      nonsponsoredProposals: [],\n      passedProposals: [],\n      votingProposals: [],\n    }\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {proposals, proposalsError, proposalsStatus} = useProposals({\n    adapterName,\n    includeProposalsExistingOnlyOffchain,\n  });\n\n  const {\n    offchainVotingResults,\n    offchainVotingResultsError,\n    offchainVotingResultsStatus,\n  } = useOffchainVotingResults(proposalsForVotingResults);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const {\n    failedProposals,\n    nonsponsoredProposals,\n    passedProposals,\n    votingProposals,\n  } = filteredProposals;\n\n  const isLoading: boolean =\n    proposalsStatus === AsyncStatus.STANDBY ||\n    proposalsStatus === AsyncStatus.PENDING ||\n    // Getting ready to fetch using `useOffchainVotingResults`; helps to show\n    // continuous loader.\n    (offchainVotingResultsStatus === AsyncStatus.STANDBY &&\n      proposalsForVotingResults.length > 0) ||\n    offchainVotingResultsStatus === AsyncStatus.PENDING;\n\n  const error: Error | undefined =\n    proposalsError || offchainVotingResultsError || defaultChainError;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    setProposalsForVotingResults(proposals.map((p) => p.snapshotProposal));\n  }, [proposals]);\n\n  // Separate proposals into categories: non-sponsored, voting, passed, failed\n  useEffect(() => {\n    if (proposalsStatus !== AsyncStatus.FULFILLED) return;\n\n    const filteredProposalsToSet: FilteredProposals = {\n      failedProposals: [],\n      nonsponsoredProposals: [],\n      passedProposals: [],\n      votingProposals: [],\n    };\n\n    proposals.forEach((p) => {\n      const {\n        daoProposal,\n        daoProposalVotingState: voteState,\n        daoProposalVotes: votesData,\n      } = p;\n\n      if (!daoProposal) return;\n\n      const noSnapshotVotes: boolean = p.snapshotProposal?.votes?.length === 0;\n\n      const offchainResultNotYetSubmitted: boolean =\n        voteState !== undefined &&\n        (proposalHasVotingState(VotingState.GRACE_PERIOD, voteState) ||\n          proposalHasVotingState(VotingState.TIE, voteState)) &&\n        proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags) &&\n        votesData?.OffchainVotingContract?.reporter === BURN_ADDRESS;\n\n      // Non-sponsored proposal\n      if (voteState === undefined) {\n        if (includeProposalsExistingOnlyOffchain) {\n          filteredProposalsToSet.nonsponsoredProposals.push(p);\n        } else if (proposalHasFlag(ProposalFlag.EXISTS, daoProposal.flags)) {\n          filteredProposalsToSet.nonsponsoredProposals.push(p);\n        }\n\n        return;\n      }\n\n      // Passed proposal\n      if (\n        voteState !== undefined &&\n        proposalHasVotingState(VotingState.PASS, voteState) &&\n        (proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags) ||\n          proposalHasFlag(ProposalFlag.PROCESSED, daoProposal.flags))\n      ) {\n        filteredProposalsToSet.passedProposals.push(p);\n\n        return;\n      }\n\n      const offchainResult = offchainVotingResults.find(\n        ([proposalHash, _result]) =>\n          normalizeString(proposalHash) ===\n          normalizeString(p.snapshotProposal?.idInDAO || '')\n      )?.[1];\n\n      if (!offchainResult) return;\n\n      const didPass = didPassSimpleMajority(offchainResult);\n\n      /**\n       * Voting proposal: voting has ended, off-chain result was not submitted,\n       * and there are votes with a passing result (need to submit to get true\n       * \"passed\" result).\n       *\n       * @note For now, we can assume across all adapters that if the vote did\n       * not pass then the result does not need to be submitted (proposal would\n       * fall back to \"failed\" logic).\n       * @note Should be placed before \"failed\" logic.\n       */\n      if (\n        offchainResultNotYetSubmitted &&\n        noSnapshotVotes === false &&\n        didPass\n      ) {\n        filteredProposalsToSet.votingProposals.push(p);\n\n        return;\n      }\n\n      // Failed proposal\n      if (\n        voteState !== undefined &&\n        (proposalHasVotingState(VotingState.NOT_PASS, voteState) ||\n          proposalHasVotingState(VotingState.TIE, voteState)) &&\n        (proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags) ||\n          proposalHasFlag(ProposalFlag.PROCESSED, daoProposal.flags))\n      ) {\n        filteredProposalsToSet.failedProposals.push(p);\n\n        return;\n      }\n\n      // Failed proposal: no Snapshot votes\n      if (\n        voteState !== undefined &&\n        offchainResultNotYetSubmitted &&\n        noSnapshotVotes\n      ) {\n        filteredProposalsToSet.failedProposals.push(p);\n\n        return;\n      }\n\n      // Failed proposal: result not submitted; vote did not pass\n      if (\n        voteState !== undefined &&\n        offchainResultNotYetSubmitted &&\n        !didPass\n      ) {\n        filteredProposalsToSet.failedProposals.push(p);\n\n        return;\n      }\n\n      // Voting proposal\n      if (\n        voteState !== undefined &&\n        (proposalHasVotingState(VotingState.GRACE_PERIOD, voteState) ||\n          proposalHasVotingState(VotingState.IN_PROGRESS, voteState)) &&\n        proposalHasFlag(ProposalFlag.SPONSORED, daoProposal.flags)\n      ) {\n        filteredProposalsToSet.votingProposals.push(p);\n\n        return;\n      }\n    });\n\n    setFilteredProposals((prevState) => ({\n      ...prevState,\n      ...filteredProposalsToSet,\n    }));\n  }, [\n    includeProposalsExistingOnlyOffchain,\n    offchainVotingResults,\n    proposals,\n    proposalsStatus,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function didPassSimpleMajority(offchainVoteResult: VotingResult): boolean {\n    return offchainVoteResult.Yes.units > offchainVoteResult.No.units;\n  }\n\n  function renderProposalCards(\n    proposals: ProposalData[]\n  ): React.ReactNode | null {\n    return proposals.map((proposal) => {\n      const proposalId =\n        proposal.snapshotDraft?.idInDAO || proposal.snapshotProposal?.idInDAO;\n      const proposalName =\n        proposal.snapshotDraft?.msg.payload.name ||\n        proposal.snapshotProposal?.msg.payload.name ||\n        '';\n\n      if (!proposalId) return null;\n\n      if (renderProposalCard) {\n        return (\n          <Fragment key={proposalId}>\n            {renderProposalCard({proposalData: proposal})}\n          </Fragment>\n        );\n      }\n\n      return (\n        <ProposalCard\n          key={proposalId}\n          linkPath={proposalLinkPath}\n          name={proposalName}\n          onClick={onProposalClick}\n          proposalOnClickId={proposalId}\n          renderStatus={() => {\n            switch (proposal.daoProposalVotingAdapter?.votingAdapterName) {\n              case VotingAdapterName.OffchainVotingContract:\n                return <OffchainVotingStatus proposal={proposal} />;\n              // @todo On-chain Voting\n              // case VotingAdapterName.VotingContract:\n              //   return <></>\n              default:\n                return <></>;\n            }\n          }}\n        />\n      );\n    });\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <div className=\"loader--large-container\">\n        <LoaderLarge />\n      </div>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <div className=\"text-center\">\n        <ErrorMessageWithDetails\n          error={error}\n          renderText=\"Something went wrong while getting the proposals.\"\n        />\n      </div>\n    );\n  }\n\n  // Render no proposals\n  if (\n    !Object.values(filteredProposals).flatMap((p) => p).length &&\n    proposalsStatus === AsyncStatus.FULFILLED\n  ) {\n    return <p className=\"text-center\">No proposals, yet!</p>;\n  }\n\n  // Render proposals\n  return (\n    <div className=\"grid--fluid grid-container\">\n      {/* VOTING PROPOSALS */}\n      {votingProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.VOTING}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(votingProposals)}\n          </div>\n        </>\n      )}\n\n      {/* PENDING PROPOSALS (DRAFTS, NOT SPONSORED) */}\n      {nonsponsoredProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.REQUESTS}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(nonsponsoredProposals)}\n          </div>\n        </>\n      )}\n\n      {/* PASSED PROPOSALS */}\n      {passedProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.PASSED}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(passedProposals)}\n          </div>\n        </>\n      )}\n\n      {/* FAILED PROPOSALS */}\n      {failedProposals.length > 0 && (\n        <>\n          <div className=\"grid__header\">{ProposalHeaderNames.FAILED}</div>\n          <div className=\"grid__cards\">\n            {renderProposalCards(failedProposals)}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport {useHistory} from 'react-router-dom';\n\nimport {DaoAdapterConstants} from '../../components/adapters-extensions/enums';\nimport FadeIn from '../../components/common/FadeIn';\nimport Proposals from '../../components/proposals/Proposals';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function Membership() {\n  /**\n   * Functions\n   */\n\n  function proposalLinkPath(id: string) {\n    return `/membership/${id}`;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <RenderWrapper>\n      <Proposals\n        adapterName={DaoAdapterConstants.ONBOARDING}\n        proposalLinkPath={proposalLinkPath}\n        includeProposalsExistingOnlyOffchain={true}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function viewMembers(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/members');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Membership</h2>\n          <button className=\"titlebar__action\" onClick={viewMembers}>\n            View members\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {useState, useRef, useEffect, useCallback} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\n\nimport {CycleEllipsis} from '../feedback';\nimport {useDaoTokenDetails} from '../dao-token/hooks';\nimport {getConnectedMember} from '../../store/actions';\nimport {ProposalData, SnapshotProposal} from './types';\nimport {ReduxDispatch, StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../web3/config';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {Web3TxStatus} from '../web3/types';\nimport CycleMessage from '../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../web3/EtherscanURL';\nimport FadeIn from '../common/FadeIn';\nimport Loader from '../feedback/Loader';\n\ntype ProcessArguments = [\n  string, // `dao`\n  string // `proposalId`\n];\n\ntype ProcessActionMembershipProps = {\n  disabled?: boolean;\n  proposal: ProposalData;\n};\n\ntype ActionDisabledReasons = {\n  notProposerMessage: string;\n};\n\n/**\n * Cached outside the component to prevent infinite re-renders.\n *\n * The same can be accomplished inside the component using\n * `useState`, `useRef`, etc., depending on the use case.\n */\nconst useMemberActionDisabledProps = {\n  // Anyone can process a proposal - it's just a question of gas payment.\n  skipIsActiveMemberCheck: true,\n};\n\nexport default function ProcessActionMembership(\n  props: ProcessActionMembershipProps\n) {\n  const {\n    disabled: propsDisabled,\n    proposal: {snapshotProposal},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n  const [membershipProposalAmount, setMembershipProposalAmount] =\n    useState<string>();\n\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    notProposerMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const OnboardingContract = useSelector(\n    (s: StoreState) => s.contracts?.OnboardingContract\n  );\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled(useMemberActionDisabledProps);\n  const {fast: fastGasPrice} = useETHGasPrice();\n  const {daoTokenDetails} = useDaoTokenDetails();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n  const areSomeDisabled = isDisabled || isInProcessOrDone || propsDisabled;\n\n  /**\n   * Cached callbacks\n   */\n\n  const getMembershipProposalAmountCached = useCallback(\n    getMembershipProposalAmount,\n    [OnboardingContract, daoRegistryContract?.contractAddress, snapshotProposal]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getMembershipProposalAmountCached();\n  }, [getMembershipProposalAmountCached]);\n\n  useEffect(() => {\n    // 1. Determine and set reasons why action would be disabled\n\n    // Reason: For some proposal types, a passed proposal can only be\n    // processed by its original proposer (e.g., the owner of the asset to be\n    // transferred)\n\n    // Proposals with this restriction will have this value stored in its\n    // snapshot metadata.\n    const {accountAuthorizedToProcessPassedProposal} = (\n      snapshotProposal as SnapshotProposal\n    ).msg.payload.metadata;\n\n    if (accountAuthorizedToProcessPassedProposal && account) {\n      actionDisabledReasonsRef.current = {\n        ...actionDisabledReasonsRef.current,\n        notProposerMessage:\n          accountAuthorizedToProcessPassedProposal.toLowerCase() !==\n          account.toLowerCase()\n            ? 'Only the original proposer can process the proposal.'\n            : '',\n      };\n    }\n\n    // 2. Set reasons\n    setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n  }, [account, setOtherDisabledReasons, snapshotProposal]);\n\n  /**\n   * Functions\n   */\n\n  async function getMembershipProposalAmount() {\n    try {\n      if (!snapshotProposal || !OnboardingContract) return;\n\n      const proposalDetails = await OnboardingContract.instance.methods\n        .proposals(\n          daoRegistryContract?.contractAddress,\n          snapshotProposal.idInDAO\n        )\n        .call();\n\n      setMembershipProposalAmount(proposalDetails.amount);\n    } catch (error) {\n      console.error(error);\n      setMembershipProposalAmount(undefined);\n    }\n  }\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!snapshotProposal) {\n        throw new Error('No Snapshot proposal was found.');\n      }\n\n      if (!OnboardingContract) {\n        throw new Error('No OnboardingContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const processArguments: ProcessArguments = [\n        daoRegistryContract.contractAddress,\n        snapshotProposal.idInDAO,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        value: membershipProposalAmount,\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      const tx = await txSend(\n        'processProposal',\n        OnboardingContract.instance.methods,\n        processArguments,\n        txArguments\n      );\n\n      if (tx) {\n        // re-fetch member\n        await dispatch(\n          getConnectedMember({\n            account,\n            daoRegistryContract,\n            web3Instance,\n          })\n        );\n\n        // if connected account is the applicant (the address that will receive\n        // the membership units) suggest adding DAO token to wallet\n        if (\n          account.toLowerCase() ===\n          snapshotProposal.msg.payload.metadata.submitActionArgs[0].toLowerCase()\n        ) {\n          await addTokenToWallet();\n        }\n      }\n    } catch (error) {\n      setSubmitError(error);\n    }\n  }\n\n  async function addTokenToWallet() {\n    if (!daoTokenDetails) return;\n\n    try {\n      await window.ethereum.request({\n        method: 'wallet_watchAsset',\n        params: {\n          type: 'ERC20',\n          options: daoTokenDetails,\n        },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  function renderSubmitStatus(): React.ReactNode {\n    // process proposal transaction statuses\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Confirm to process the proposal\n            <CycleEllipsis />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Proposal submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={areSomeDisabled}\n          onClick={areSomeDisabled ? () => {} : handleSubmit}>\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Process'}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is processing disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is processing disabled?\" />\n    </>\n  );\n}\n","import {lazy, Suspense} from 'react';\nimport {useSelector} from 'react-redux';\n\nimport {ContractAdapterNames} from '../web3/types';\nimport {CycleEllipsis} from '../feedback';\nimport {ProposalData, RenderActionPropArguments} from './types';\nimport {StoreState} from '../../store/types';\nimport {VotingAdapterName} from '../adapters-extensions/enums';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\n\ntype ProposalActionsProps = {\n  adapterName: ContractAdapterNames;\n  proposal: ProposalData;\n  /**\n   * A render prop which can render any action desired.\n   * It is passed inner state and data from\n   * the child action wrapper component.\n   *\n   * - If it renders `null`, it will fall back to the component's actions.\n   * - If it renders `<></>` (`React.Fragment`) then nothing is shown in the UI.\n   */\n  renderAction?: (data: RenderActionPropArguments) => React.ReactNode;\n};\n\n/**\n * Lazy load action component tree\n */\nconst ProposalWithOffchainVoteActions = lazy(\n  () => import('./ProposalWithOffchainVoteActions')\n);\n\nconst fadeInProps = {duration: 150};\nconst cycleEllipsisStyles = {\n  display: 'inline-block',\n  width: '100%',\n  fontSize: '1.5rem',\n};\n\n/**\n * ProposalActions\n *\n * A container for various propsal action flows.\n * Which flow is chosen is determined by either the proposal's,\n * or the DAO's, voting adapter name.\n *\n * @param {ProposalActionsProps} props\n * @returns {JSX.Element}\n */\nexport default function ProposalActions(\n  props: ProposalActionsProps\n): JSX.Element {\n  const {adapterName, proposal, renderAction} = props;\n\n  /**\n   * Selectors\n   */\n\n  const daoVotingAdapterName = useSelector(\n    (s: StoreState) => s.contracts.VotingContract?.adapterOrExtensionName\n  ) as VotingAdapterName | undefined;\n\n  /**\n   * Variables\n   */\n\n  // Use the proposal's voting adapter (has been sponsored), or fall back to the DAO's (not-yet-sponsored).\n  const votingAdapterName: VotingAdapterName | undefined =\n    proposal.daoProposalVotingAdapter?.votingAdapterName ||\n    daoVotingAdapterName;\n\n  /**\n   * Functions\n   */\n\n  function renderActions() {\n    if (!votingAdapterName) {\n      return <></>;\n    }\n\n    switch (votingAdapterName) {\n      case VotingAdapterName.OffchainVotingContract:\n        return (\n          <ProposalWithOffchainVoteActions\n            adapterName={adapterName}\n            proposal={proposal}\n            renderAction={renderAction}\n          />\n        );\n\n      // @todo On-chain Voting\n      case VotingAdapterName.VotingContract:\n        return <></>;\n\n      default:\n        return (\n          <ErrorMessageWithDetails\n            error={\n              new Error(\n                `\"${votingAdapterName}\" is not a valid voting adapter name.`\n              )\n            }\n            renderText=\"Something went wrong\"\n          />\n        );\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Suspense\n      fallback={\n        <span className=\"text-center\" style={cycleEllipsisStyles}>\n          <CycleEllipsis intervalMs={200} fadeInProps={fadeInProps} />\n        </span>\n      }>\n      {renderActions()}\n    </Suspense>\n  );\n}\n","type ProposalAmountProps = {\n  amount: string;\n  amountUnit: string;\n  amount2?: string;\n  amount2Unit?: string;\n};\n\nexport default function ProposalAmount(props: ProposalAmountProps) {\n  const {amount, amountUnit, amount2, amount2Unit} = props;\n\n  /**\n   * Render\n   */\n\n  return (\n    <div className=\"proposaldetails__amount\">\n      <span>\n        {`${amount} ${amountUnit}`}\n        {/* assumes second amount is value requested from the DAO */}\n        {amount2 && (\n          <>\n            <br />\n            <small>for</small>\n            <br />\n            {`${amount2} ${amount2Unit}`}\n          </>\n        )}\n      </span>\n    </div>\n  );\n}\n","import React from 'react';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {\n  ProposalFlowStatus,\n  RenderActionPropArguments,\n} from '../../components/proposals/types';\nimport {AsyncStatus} from '../../util/types';\nimport {ContractAdapterNames} from '../../components/web3/types';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport {useProposalOrDraft} from '../../components/proposals/hooks';\nimport {VotingState} from '../../components/proposals/voting/types';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport NotFound from '../subpages/NotFound';\nimport ProcessActionMembership from '../../components/proposals/ProcessActionMembership';\nimport ProposalActions from '../../components/proposals/ProposalActions';\nimport SubmitAction from '../../components/proposals/SubmitAction';\nimport ProposalAmount from '../../components/proposals/ProposalAmount';\nimport ProposalDetails from '../../components/proposals/ProposalDetails';\nimport Wrap from '../../components/common/Wrap';\n\nconst PLACEHOLDER = '\\u2014'; /* em dash */\n\nexport default function MembershipDetails() {\n  /**\n   * @todo\n   *\n   * 1. Fetch proposal by ID from the subgraph.\n   * 2. Determine if sponsored\n   * 3. Get Snapshot data\n   *   3.1 If sponsored, get data about proposal from Snapshot (use flag to also search by draft hash).\n   *   3.2 If not sponsored, get data about draft from Snapshot.\n   */\n\n  /**\n   * Their hooks\n   */\n\n  // Get hash for fetching the proposal.\n  const {proposalId} = useParams<{proposalId: string}>();\n\n  /**\n   * @todo Get subgraph proposal and determine if it has been sponsored\n   *   so we know how to search snapshot-hub.\n   */\n\n  // ...\n\n  /**\n   * Our hooks\n   */\n\n  // @todo Use dynamic `SnapshotType` depending on subgraph data for `type` arg.\n  const {proposalData, proposalError, proposalNotFound, proposalStatus} =\n    useProposalOrDraft(proposalId);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean = proposalStatus === AsyncStatus.PENDING;\n  const error: Error | undefined = proposalError || defaultChainError;\n\n  /**\n   * Functions\n   */\n\n  // Render any adapter-specific actions\n  function renderAction(data: RenderActionPropArguments): React.ReactNode {\n    const {\n      OffchainVotingContract: {daoProposalVoteResult, proposal, status},\n    } = data;\n\n    // Submit/Sponsor button (for proposals that have not been submitted onchain yet)\n    if (status === ProposalFlowStatus.Submit) {\n      const {snapshotDraft} = proposal;\n      const applicant = snapshotDraft?.msg.payload.metadata.submitActionArgs[0];\n\n      return <SubmitAction checkApplicant={applicant} proposal={proposal} />;\n    }\n\n    // Process button\n    if (\n      status === ProposalFlowStatus.Process ||\n      status === ProposalFlowStatus.OffchainVotingGracePeriod\n    ) {\n      if (\n        daoProposalVoteResult &&\n        VotingState[daoProposalVoteResult] !== VotingState[VotingState.PASS]\n      ) {\n        // Return a React.Fragment to hide the process button if proposal failed.\n        return <></>;\n      }\n\n      return (\n        <ProcessActionMembership\n          // Show during DAO proposal grace period, but set to disabled\n          disabled={status === ProposalFlowStatus.OffchainVotingGracePeriod}\n          proposal={proposal}\n        />\n      );\n    }\n\n    // Return `null` to signal to use default actions\n    return null;\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render 404 no proposal found\n  if (proposalNotFound) {\n    return (\n      <RenderWrapper>\n        <NotFound />\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong while getting the proposal.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render proposal\n  if (proposalData) {\n    const commonData = proposalData.getCommonSnapshotProposalData();\n\n    // Handle just in case metadata was not properly set\n    let tributeAmount = PLACEHOLDER;\n    let tributeAmountUnit = '';\n    try {\n      ({tributeAmount, tributeAmountUnit} =\n        commonData?.msg.payload.metadata.proposalAmountValues);\n    } catch (error) {\n      tributeAmount = PLACEHOLDER;\n      tributeAmountUnit = '';\n    }\n\n    return (\n      <RenderWrapper>\n        <ProposalDetails\n          proposal={proposalData}\n          renderAmountBadge={() => (\n            <ProposalAmount\n              amount={tributeAmount}\n              amountUnit={tributeAmountUnit}\n            />\n          )}\n          renderActions={() => (\n            <ProposalActions\n              adapterName={ContractAdapterNames.onboarding}\n              proposal={proposalData}\n              renderAction={renderAction}\n            />\n          )}\n        />\n      </RenderWrapper>\n    );\n  }\n\n  // Render nothing. Should never reach this case.\n  return <></>;\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n\n    history.push('/membership');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Membership</h2>\n          <button className=\"titlebar__action\" onClick={goToAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {useState, useEffect} from 'react';\n\ntype LoaderWithEmojiProps = {\n  emoji: string;\n  // Show waiting effect after some time has elapsed. Prevents the \"sudden\n  // spinner\" UI/UX no-no. Esp. if we could have cached data.\n  showAfterMs?: number;\n};\n\nexport default function LoaderWithEmoji(props: LoaderWithEmojiProps) {\n  const {showAfterMs} = props;\n  const [showLoaderAfterMs, setShowLoaderAfterMs] = useState<boolean>(false);\n\n  useEffect(() => {\n    /* 200ms is approx. the time a user will notice a stalled, blank screen */\n    const timeoutId =\n      showAfterMs && setTimeout(() => setShowLoaderAfterMs(true), showAfterMs);\n\n    return function cleanup() {\n      timeoutId && clearTimeout(timeoutId);\n    };\n  }, [showAfterMs]);\n\n  return !showAfterMs || (showAfterMs && showLoaderAfterMs) ? (\n    <div className=\"loader--emoji\">\n      <span role=\"img\" aria-label=\"Loading content...\">\n        {props.emoji}\n      </span>\n    </div>\n  ) : null;\n}\n","import {useRef, useEffect} from 'react';\nimport {toChecksumAddress} from 'web3-utils';\n\nimport {CycleEllipsis} from '../../components/feedback/CycleEllipsis';\nimport CycleMessage from '../../components/feedback/CycleMessage';\nimport EtherscanURL from '../../components/web3/EtherscanURL';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport Loader from '../../components/feedback/Loader';\nimport DaoToken, {\n  ERC20RegisterDetails,\n} from '../../components/dao-token/DaoToken';\nimport {useCheckApplicant} from '../../components/proposals/hooks';\nimport {useRedeemCoupon, FetchStatus} from '../../hooks/useRedeemCoupon';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {formatNumber, truncateEthAddress} from '../../util/helpers';\nimport {Web3TxStatus} from '../../components/web3/types';\nimport {TX_CYCLE_MESSAGES} from '../../components/web3/config';\nimport {AsyncStatus} from '../../util/types';\n\ntype RedeemManagerProps = {\n  redeemables: Record<string, any>;\n  daoTokenDetails?: ERC20RegisterDetails;\n};\n\ntype RedeemCardProps = {\n  redeemable: Record<string, any>;\n  daoTokenDetails?: ERC20RegisterDetails;\n};\n\ntype ActionDisabledReasons = {\n  invalidApplicantMessage: string;\n};\n\n/**\n * Cached outside the component to prevent infinite re-renders.\n *\n * The same can be accomplished inside the component using\n * `useState`, `useRef`, etc., depending on the use case.\n */\nconst useMemberActionDisabledProps = {\n  // Anyone can process a proposal - it's just a question of gas payment.\n  skipIsActiveMemberCheck: true,\n};\n\nexport default function RedeemManager({\n  redeemables,\n  daoTokenDetails,\n}: RedeemManagerProps) {\n  /**\n   *  Render\n   */\n\n  // show the redeem card, if only one coupon available\n  return (\n    <RenderWrapper>\n      <RedeemCard\n        redeemable={redeemables[0]}\n        daoTokenDetails={daoTokenDetails}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RedeemCard({redeemable, daoTokenDetails}: RedeemCardProps) {\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    invalidApplicantMessage: '',\n  });\n\n  /**\n   * Our hooks\n   */\n\n  const {\n    redeemCoupon,\n    submitStatus,\n    submitError,\n    txStatus,\n    txEtherscanURL,\n    txIsPromptOpen,\n  } = useRedeemCoupon();\n\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled(useMemberActionDisabledProps);\n\n  const {\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n  } = useCheckApplicant(redeemable.recipient);\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    submitStatus === FetchStatus.PENDING ||\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n  const isDone =\n    submitStatus === FetchStatus.FULFILLED ||\n    txStatus === Web3TxStatus.FULFILLED ||\n    redeemable.isRedeemd;\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (redeemable.recipient) {\n      // 1. Determine and set reasons why action would be disabled\n\n      // Reason: If the applicant address is invalid (see `useCheckApplicant`\n      // hook for reasons) the `submitProposal` smart contract transaction will\n      // fail.\n      if (checkApplicantError) {\n        console.warn(\n          `Error checking if the applicant address '${redeemable.recipient}' is valid: ${checkApplicantError.message}`\n        );\n      }\n\n      if (\n        checkApplicantStatus === AsyncStatus.FULFILLED &&\n        !isApplicantValid &&\n        checkApplicantInvalidMsg\n      ) {\n        actionDisabledReasonsRef.current = {\n          ...actionDisabledReasonsRef.current,\n          invalidApplicantMessage: checkApplicantInvalidMsg,\n        };\n      }\n\n      // 2. Set reasons\n      setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n    }\n  }, [\n    checkApplicantError,\n    checkApplicantInvalidMsg,\n    checkApplicantStatus,\n    isApplicantValid,\n    redeemable.recipient,\n    setOtherDisabledReasons,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  function renderSubmitStatus(): React.ReactNode {\n    // Only for chain tx\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Awaiting your confirmation\n            <CycleEllipsis />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message: string) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>{'Finalized!'}</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      <div\n        className={`redeemcard redeemcard__content ${\n          isDone ? 'fireworks' : ''\n        } `}>\n        <p className=\"redeemcard__recipient\">\n          Recipient:{' '}\n          {truncateEthAddress(toChecksumAddress(redeemable.recipient), 7)}\n        </p>\n        <p className=\"redeemcard__unit\">\n          {formatNumber(redeemable.amount)}\n          <sup>\n            <small>{daoTokenDetails?.symbol || 'tokens'}</small>\n          </sup>\n        </p>\n\n        <DaoToken daoTokenDetails={daoTokenDetails} />\n\n        {isDone && (\n          <p className=\"redeemcard__redeemed\">\n            <span\n              className=\"pulse\"\n              role=\"img\"\n              aria-label=\"Redeemed!\"\n              style={{display: 'inline-block'}}>\n              \n            </span>\n          </p>\n        )}\n\n        <button\n          className=\"button\"\n          style={{marginTop: isDone ? '1rem' : '1.5rem'}}\n          onClick={async () => {\n            await redeemCoupon(redeemable, daoTokenDetails);\n          }}\n          disabled={isDisabled || isInProcessOrDone}>\n          {isInProcess ? <Loader /> : isDone ? 'Redeemed!' : 'Redeem'}\n        </button>\n\n        {/* SUBMIT STATUS */}\n        {isInProcessOrDone && !redeemable.isRedeemd && (\n          <div\n            className=\"form__submit-status-container\"\n            style={{marginTop: '1rem'}}>\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}\n            style={{margin: '1rem auto 0'}}>\n            Why is redeeming disabled?\n          </button>\n        )}\n\n        {/* SUBMIT ERROR */}\n        {submitError && (\n          <div className=\"form__submit-error-container\">\n            <ErrorMessageWithDetails\n              renderText=\"Something went wrong while redeeming the coupon.\"\n              error={submitError}\n            />\n          </div>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is redeeming disabled?\" />\n    </>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  return (\n    <FadeIn>\n      <div className=\"grid--fluid grid-container\">\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </div>\n    </FadeIn>\n  );\n}\n","import {useCallback, useEffect, useState} from 'react';\nimport {useLocation} from 'react-router-dom';\n\nimport {AsyncStatus} from '../../util/types';\nimport {COUPON_API_URL} from '../../config';\nimport {useAbortController} from '../../hooks';\nimport {useIsDefaultChain, useWeb3Modal} from '../../components/web3/hooks';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderWithEmoji from '../../components/feedback/LoaderWithEmoji';\nimport RedeemManager from './RedeemManager';\nimport Wrap from '../../components/common/Wrap';\nimport {useDaoTokenDetails} from '../../components/dao-token/hooks';\n\ntype RedeemCouponType = {\n  amount: number;\n  dao: {daoAddress: string};\n  isRedeemed: boolean;\n  nonce: number;\n  recipient: string;\n  signature: string;\n};\n\nexport default function RedeemCoupon() {\n  /**\n   * State\n   */\n\n  const [redeemableCoupon, setReedemableCoupon] = useState<RedeemCouponType[]>(\n    []\n  );\n  const [couponStatus, setCouponStatus] = useState<AsyncStatus>(\n    AsyncStatus.STANDBY\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {connected, account} = useWeb3Modal();\n  const {defaultChainError} = useIsDefaultChain();\n  const {abortController, isMountedRef} = useAbortController();\n  const {daoTokenDetails, daoTokenDetailsStatus} = useDaoTokenDetails();\n\n  /**\n   * Their hooks\n   */\n\n  const location = useLocation<{coupon: string}>();\n\n  /**\n   * Variables\n   */\n\n  const coupon = new URLSearchParams(location.search).get('coupon');\n\n  const isInProcess =\n    couponStatus === AsyncStatus.STANDBY ||\n    couponStatus === AsyncStatus.PENDING ||\n    daoTokenDetailsStatus === AsyncStatus.STANDBY ||\n    daoTokenDetailsStatus === AsyncStatus.PENDING;\n\n  /**\n   * Cached callbacks\n   */\n\n  const checkBySigOrAddrCached = useCallback(checkBySigOrAddr, [\n    abortController?.signal,\n    coupon,\n    isMountedRef,\n  ]);\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    if (!account || !connected || defaultChainError) return;\n\n    checkBySigOrAddrCached();\n  }, [account, connected, checkBySigOrAddrCached, defaultChainError]);\n\n  /**\n   * Functions\n   */\n\n  // check using signature or eth addr\n  async function checkBySigOrAddr() {\n    try {\n      if (!abortController?.signal) return;\n\n      setCouponStatus(AsyncStatus.PENDING);\n\n      // handle adding new authorized user to thee `auth` tbl\n      const response = await fetch(`${COUPON_API_URL}/api/coupon/redeem`, {\n        method: 'POST',\n        body: JSON.stringify({\n          signature: coupon,\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        signal: abortController.signal,\n      });\n\n      if (!isMountedRef.current) return;\n\n      const coupons = await response.json();\n\n      setReedemableCoupon(coupons);\n      setCouponStatus(AsyncStatus.FULFILLED);\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setCouponStatus(AsyncStatus.REJECTED);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  // check if user doesn't have a connected wallet\n  if (!connected) {\n    return (\n      <RenderWrapper>\n        <p className=\"color-brightsalmon\">\n          Connect your wallet to view the coupon.\n        </p>\n      </RenderWrapper>\n    );\n  }\n\n  if (defaultChainError) {\n    return (\n      <RenderWrapper>\n        <p className=\"color-brightsalmon\">{defaultChainError.message}</p>\n      </RenderWrapper>\n    );\n  }\n\n  if (connected && isInProcess) {\n    return (\n      <RenderWrapper>\n        <LoaderWithEmoji emoji={''} />\n        <p>Checking&hellip; please wait.</p>\n      </RenderWrapper>\n    );\n  }\n\n  if (coupon === undefined || !coupon) {\n    return (\n      <RenderWrapper>\n        <p className=\"color-brightsalmon\">Coupon signature missing.</p>\n      </RenderWrapper>\n    );\n  }\n\n  if (!redeemableCoupon || !redeemableCoupon.length) {\n    return (\n      <RenderWrapper>\n        <p className=\"color-brightsalmon\">Coupon not found.</p>\n      </RenderWrapper>\n    );\n  }\n\n  return (\n    <RenderWrapper>\n      <RedeemManager\n        daoTokenDetails={daoTokenDetails}\n        redeemables={redeemableCoupon}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Redeem Coupon</h2>\n        </div>\n\n        <div className=\"form-wrapper\">\n          <div className=\"form__description\">\n            <p>Redeem coupon to issue the membership tokens.</p>\n          </div>\n\n          {/* RENDER CHILDREN */}\n          {props.children}\n        </div>\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React, {useEffect, useState, useRef} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\n\nimport {CycleEllipsis} from '../feedback';\nimport {getConnectedMember} from '../../store/actions';\nimport {ProposalData, DistributionStatus} from './types';\nimport {ReduxDispatch, StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../web3/config';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {Web3TxStatus} from '../web3/types';\nimport CycleMessage from '../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../web3/EtherscanURL';\nimport FadeIn from '../common/FadeIn';\nimport Loader from '../feedback/Loader';\n\ntype DistributeArguments = [\n  string, // `dao`\n  string // `toIndex`\n];\n\ntype PostProcessActionTransferProps = {\n  proposal: ProposalData;\n};\n\ntype ActionDisabledReasons = {\n  alreadyCompletedMessage: string;\n};\n\nexport default function PostProcessActionTransfer(\n  props: PostProcessActionTransferProps\n) {\n  const {\n    proposal: {snapshotProposal},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    alreadyCompletedMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const DistributeContract = useSelector(\n    (s: StoreState) => s.contracts?.DistributeContract\n  );\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled();\n  const {fast: fastGasPrice} = useETHGasPrice();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING;\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n  const isInProcessOrDone = isInProcess || isDone || txIsPromptOpen;\n  const areSomeDisabled = isDisabled || isInProcessOrDone;\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    async function getActionDisabledReasons() {\n      // 1. Determine and set reasons why action would be disabled\n\n      // Reason: distribution already completed\n      try {\n        if (!snapshotProposal) {\n          throw new Error('No Snapshot proposal was found.');\n        }\n        if (!daoRegistryContract) {\n          throw new Error('No DAO Registry contract was found.');\n        }\n        if (!DistributeContract) {\n          throw new Error('No DistributeContract found.');\n        }\n\n        const distributeProposal = await DistributeContract.instance.methods\n          .distributions(\n            daoRegistryContract.contractAddress,\n            snapshotProposal.idInDAO\n          )\n          .call();\n\n        actionDisabledReasonsRef.current = {\n          ...actionDisabledReasonsRef.current,\n          alreadyCompletedMessage:\n            DistributionStatus[distributeProposal.status] !==\n            DistributionStatus[DistributionStatus.IN_PROGRESS]\n              ? 'The transfer has already been completed.'\n              : '',\n        };\n      } catch (error) {\n        console.error(error);\n      }\n\n      // 2. Set reasons\n      setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n    }\n\n    getActionDisabledReasons();\n  }, [\n    DistributeContract,\n    daoRegistryContract,\n    setOtherDisabledReasons,\n    snapshotProposal,\n  ]);\n\n  /**\n   * Functions\n   */\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!snapshotProposal) {\n        throw new Error('No Snapshot proposal was found.');\n      }\n\n      if (!DistributeContract) {\n        throw new Error('No DistributeContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      let toIndexArg = '0';\n      const isTypeAllMembers =\n        snapshotProposal?.msg.payload.metadata.isTypeAllMembers;\n      if (isTypeAllMembers) {\n        try {\n          const nbMembers = await daoRegistryContract.instance.methods\n            .getNbMembers()\n            .call();\n          toIndexArg = nbMembers.toString();\n        } catch (error) {\n          throw new Error('Error while retrieving number of DAO members');\n        }\n      }\n\n      const distributeArguments: DistributeArguments = [\n        daoRegistryContract.contractAddress,\n        toIndexArg,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      const tx = await txSend(\n        'distribute',\n        DistributeContract.instance.methods,\n        distributeArguments,\n        txArguments\n      );\n\n      if (tx) {\n        // re-fetch member\n        await dispatch(\n          getConnectedMember({\n            account,\n            daoRegistryContract,\n            web3Instance,\n          })\n        );\n      }\n    } catch (error) {\n      setSubmitError(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  function renderSubmitStatus(): React.ReactNode {\n    // distribute transaction statuses\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Confirm to transfer assets\n            <CycleEllipsis />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Assets transferred!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={areSomeDisabled}\n          onClick={areSomeDisabled ? () => {} : handleSubmit}>\n          {isInProcess ? (\n            <Loader />\n          ) : isDone ? (\n            'Transfer done'\n          ) : (\n            'Transfer assets'\n          )}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is action disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is transfer disabled?\" />\n    </>\n  );\n}\n","import React from 'react';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {\n  ProposalFlowStatus,\n  RenderActionPropArguments,\n} from '../../components/proposals/types';\nimport {AsyncStatus} from '../../util/types';\nimport {ContractAdapterNames} from '../../components/web3/types';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport {useProposalOrDraft} from '../../components/proposals/hooks';\nimport {VotingState} from '../../components/proposals/voting/types';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport NotFound from '../subpages/NotFound';\nimport PostProcessActionTransfer from '../../components/proposals/PostProcessActionTransfer';\nimport ProposalActions from '../../components/proposals/ProposalActions';\nimport ProposalAmount from '../../components/proposals/ProposalAmount';\nimport ProposalDetails from '../../components/proposals/ProposalDetails';\nimport Wrap from '../../components/common/Wrap';\n\nconst PLACEHOLDER = '\\u2014'; /* em dash */\n\nexport default function TransferDetails() {\n  /**\n   * @todo\n   *\n   * 1. Fetch proposal by ID from the subgraph.\n   * 2. Determine if sponsored\n   * 3. Get Snapshot data\n   *   3.1 If sponsored, get data about proposal from Snapshot (use flag to also search by draft hash).\n   *   3.2 If not sponsored, get data about draft from Snapshot.\n   */\n\n  /**\n   * Their hooks\n   */\n\n  // Get hash for fetching the proposal.\n  const {proposalId} = useParams<{proposalId: string}>();\n\n  /**\n   * @todo Get subgraph proposal and determine if it has been sponsored\n   *   so we know how to search snapshot-hub.\n   */\n\n  // ...\n\n  /**\n   * Our hooks\n   */\n\n  // @todo Use dynamic `SnapshotType` depending on subgraph data for `type` arg.\n  const {proposalData, proposalError, proposalNotFound, proposalStatus} =\n    useProposalOrDraft(proposalId);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean = proposalStatus === AsyncStatus.PENDING;\n  const error: Error | undefined = proposalError || defaultChainError;\n\n  /**\n   * Functions\n   */\n\n  // Render any adapter-specific actions\n  function renderAction(data: RenderActionPropArguments): React.ReactNode {\n    const {\n      OffchainVotingContract: {daoProposalVoteResult, proposal, status},\n    } = data;\n\n    //  The Distribute adapter has an additional action after a passed proposal\n    //  is processed to handle the actual asset distribution.\n    if (\n      status === ProposalFlowStatus.Completed &&\n      daoProposalVoteResult &&\n      VotingState[daoProposalVoteResult] === VotingState[VotingState.PASS]\n    ) {\n      return <PostProcessActionTransfer proposal={proposal} />;\n    }\n\n    // Return `null` to signal to use default actions\n    return null;\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render 404 no proposal found\n  if (proposalNotFound) {\n    return (\n      <RenderWrapper>\n        <NotFound />\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render proposal\n  if (proposalData) {\n    const commonData = proposalData.getCommonSnapshotProposalData();\n\n    // Handle just in case metadata was not properly set\n    let transferAmount = PLACEHOLDER;\n    let transferAmountUnit = '';\n    try {\n      ({transferAmount, transferAmountUnit} =\n        commonData?.msg.payload.metadata.proposalAmountValues);\n    } catch (error) {\n      transferAmount = PLACEHOLDER;\n      transferAmountUnit = '';\n    }\n\n    return (\n      <RenderWrapper>\n        <ProposalDetails\n          proposal={proposalData}\n          renderAmountBadge={() => (\n            <ProposalAmount\n              amount={transferAmount}\n              amountUnit={transferAmountUnit}\n            />\n          )}\n          renderActions={() => (\n            <ProposalActions\n              adapterName={ContractAdapterNames.distribute}\n              proposal={proposalData}\n              renderAction={renderAction}\n            />\n          )}\n        />\n      </RenderWrapper>\n    );\n  }\n\n  // Render nothing. Should never reach this case.\n  return <></>;\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n\n    history.push('/transfers');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Transfers</h2>\n          <button className=\"titlebar__action\" onClick={goToAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React from 'react';\nimport {useHistory} from 'react-router-dom';\n\nimport {DaoAdapterConstants} from '../../components/adapters-extensions/enums';\nimport FadeIn from '../../components/common/FadeIn';\nimport Proposals from '../../components/proposals/Proposals';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function Transfers() {\n  /**\n   * Functions\n   */\n\n  function proposalLinkPath(id: string) {\n    return `/transfers/${id}`;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <RenderWrapper>\n      <Proposals\n        adapterName={DaoAdapterConstants.DISTRIBUTE}\n        proposalLinkPath={proposalLinkPath}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToNewProposal(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/transfer');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Transfers</h2>\n          <button className=\"titlebar__action\" onClick={goToNewProposal}>\n            Make Transfer\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {useState, useRef, useEffect, useCallback} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {toBN, AbiItem} from 'web3-utils';\n\nimport {CycleEllipsis} from '../feedback';\nimport {useDaoTokenDetails} from '../dao-token/hooks';\nimport {getConnectedMember} from '../../store/actions';\nimport {ProposalData, SnapshotProposal} from './types';\nimport {ReduxDispatch, StoreState} from '../../store/types';\nimport {TX_CYCLE_MESSAGES} from '../web3/config';\nimport {useContractSend, useETHGasPrice, useWeb3Modal} from '../web3/hooks';\nimport {useMemberActionDisabled} from '../../hooks';\nimport {Web3TxStatus} from '../web3/types';\nimport CycleMessage from '../feedback/CycleMessage';\nimport ErrorMessageWithDetails from '../common/ErrorMessageWithDetails';\nimport EtherscanURL from '../web3/EtherscanURL';\nimport FadeIn from '../common/FadeIn';\nimport Loader from '../feedback/Loader';\n\ntype ProcessArguments = [\n  string, // `dao`\n  string // `proposalId`\n];\n\ntype TokenApproveArguments = [\n  string, // `spender`\n  string // `value`\n];\n\ntype TributeProposalDetails = {\n  tokenAddress: string;\n  tributeAmount: string;\n};\n\ntype ProcessActionTributeProps = {\n  disabled?: boolean;\n  proposal: ProposalData;\n};\n\ntype ActionDisabledReasons = {\n  notProposerMessage: string;\n};\n\n/**\n * Cached outside the component to prevent infinite re-renders.\n *\n * The same can be accomplished inside the component using\n * `useState`, `useRef`, etc., depending on the use case.\n */\nconst useMemberActionDisabledProps = {\n  // Anyone can process a proposal - it's just a question of gas payment.\n  skipIsActiveMemberCheck: true,\n};\n\nexport default function ProcessActionTribute(props: ProcessActionTributeProps) {\n  const {\n    disabled: propsDisabled,\n    proposal: {snapshotProposal},\n  } = props;\n\n  /**\n   * State\n   */\n\n  const [submitError, setSubmitError] = useState<Error>();\n  const [tributeProposalDetails, setTributeProposalDetails] =\n    useState<TributeProposalDetails>();\n\n  /**\n   * Refs\n   */\n\n  const actionDisabledReasonsRef = useRef<ActionDisabledReasons>({\n    notProposerMessage: '',\n  });\n\n  /**\n   * Selectors\n   */\n\n  const TributeContract = useSelector(\n    (s: StoreState) => s.contracts?.TributeContract\n  );\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {txEtherscanURL, txIsPromptOpen, txSend, txStatus} = useContractSend();\n  const {\n    txEtherscanURL: txEtherscanURLTokenApprove,\n    txIsPromptOpen: txIsPromptOpenTokenApprove,\n    txSend: txSendTokenApprove,\n    txStatus: txStatusTokenApprove,\n  } = useContractSend();\n  const {\n    isDisabled,\n    openWhyDisabledModal,\n    WhyDisabledModal,\n    setOtherDisabledReasons,\n  } = useMemberActionDisabled(useMemberActionDisabledProps);\n  const {fast: fastGasPrice} = useETHGasPrice();\n  const {daoTokenDetails} = useDaoTokenDetails();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Variables\n   */\n\n  const isInProcess =\n    txStatus === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatus === Web3TxStatus.PENDING ||\n    txStatusTokenApprove === Web3TxStatus.AWAITING_CONFIRM ||\n    txStatusTokenApprove === Web3TxStatus.PENDING;\n  const isDone = txStatus === Web3TxStatus.FULFILLED;\n  const isInProcessOrDone =\n    isInProcess || isDone || txIsPromptOpen || txIsPromptOpenTokenApprove;\n  const areSomeDisabled = isDisabled || isInProcessOrDone || propsDisabled;\n\n  /**\n   * Cached callbacks\n   */\n\n  const getTributeProposalDetailsCached = useCallback(\n    getTributeProposalDetails,\n    [TributeContract, daoRegistryContract?.contractAddress, snapshotProposal]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    getTributeProposalDetailsCached();\n  }, [getTributeProposalDetailsCached]);\n\n  useEffect(() => {\n    // 1. Determine and set reasons why action would be disabled\n\n    // Reason: For some proposal types, a passed proposal can only be\n    // processed by its original proposer (e.g., the owner of the asset to be\n    // transferred)\n\n    // Proposals with this restriction will have this value stored in its\n    // snapshot metadata.\n    const {accountAuthorizedToProcessPassedProposal} = (\n      snapshotProposal as SnapshotProposal\n    ).msg.payload.metadata;\n\n    if (accountAuthorizedToProcessPassedProposal && account) {\n      actionDisabledReasonsRef.current = {\n        ...actionDisabledReasonsRef.current,\n        notProposerMessage:\n          accountAuthorizedToProcessPassedProposal.toLowerCase() !==\n          account.toLowerCase()\n            ? 'Only the original proposer can process the proposal.'\n            : '',\n      };\n    }\n\n    // 2. Set reasons\n    setOtherDisabledReasons(Object.values(actionDisabledReasonsRef.current));\n  }, [account, setOtherDisabledReasons, snapshotProposal]);\n\n  /**\n   * Functions\n   */\n\n  async function getTributeProposalDetails() {\n    try {\n      if (!snapshotProposal || !TributeContract) return;\n\n      const proposalDetails = await TributeContract.instance.methods\n        .proposals(\n          daoRegistryContract?.contractAddress,\n          snapshotProposal.idInDAO\n        )\n        .call();\n      const {token: tokenAddress, tributeAmount} = proposalDetails;\n\n      setTributeProposalDetails({tokenAddress, tributeAmount});\n    } catch (error) {\n      console.error(error);\n      setTributeProposalDetails(undefined);\n    }\n  }\n\n  async function handleSubmitTokenApprove() {\n    try {\n      if (!tributeProposalDetails) {\n        throw new Error('No Tribute proposal details found.');\n      }\n\n      if (!TributeContract) {\n        throw new Error('No TributeContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      const {tokenAddress, tributeAmount} = tributeProposalDetails;\n\n      const {default: lazyERC20ABI} = await import(\n        '../../truffle-contracts/ERC20.json'\n      );\n      const erc20Contract: AbiItem[] = lazyERC20ABI as any;\n      const erc20Instance = new web3Instance.eth.Contract(\n        erc20Contract,\n        tokenAddress\n      );\n\n      // Value to check if adapter is allowed to spend amount of tribute tokens\n      // on behalf of owner. If allowance is not sufficient, the owner will approve the adapter to spend the amount of\n      // tokens needed for the owner to provide the full tribute amount.\n      const allowance = await erc20Instance.methods\n        .allowance(account, TributeContract.contractAddress)\n        .call();\n\n      const tributeAmountBN = toBN(tributeAmount);\n      const allowanceBN = toBN(allowance);\n\n      if (tributeAmountBN.gt(allowanceBN)) {\n        try {\n          const difference = tributeAmountBN.sub(allowanceBN);\n          const approveValue = allowanceBN.add(difference);\n          const tokenApproveArguments: TokenApproveArguments = [\n            TributeContract.contractAddress,\n            approveValue.toString(),\n          ];\n          const txArguments = {\n            from: account || '',\n            ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n          };\n\n          // Execute contract call for `approve`\n          await txSendTokenApprove(\n            'approve',\n            erc20Instance.methods,\n            tokenApproveArguments,\n            txArguments\n          );\n        } catch (error) {\n          throw error;\n        }\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async function handleSubmit() {\n    try {\n      if (!daoRegistryContract) {\n        throw new Error('No DAO Registry contract was found.');\n      }\n\n      if (!snapshotProposal) {\n        throw new Error('No Snapshot proposal was found.');\n      }\n\n      if (!TributeContract) {\n        throw new Error('No TributeContract found.');\n      }\n\n      if (!account) {\n        throw new Error('No account found.');\n      }\n\n      if (!web3Instance) {\n        throw new Error('No Web3 instance was found.');\n      }\n\n      await handleSubmitTokenApprove();\n\n      const processArguments: ProcessArguments = [\n        daoRegistryContract.contractAddress,\n        snapshotProposal.idInDAO,\n      ];\n\n      const txArguments = {\n        from: account || '',\n        ...(fastGasPrice ? {gasPrice: fastGasPrice} : null),\n      };\n\n      const tx = await txSend(\n        'processProposal',\n        TributeContract.instance.methods,\n        processArguments,\n        txArguments\n      );\n\n      if (tx) {\n        // re-fetch member\n        await dispatch(\n          getConnectedMember({\n            account,\n            daoRegistryContract,\n            web3Instance,\n          })\n        );\n\n        // if connected account is the applicant (the address that will receive\n        // the membership units) suggest adding DAO token to wallet\n        if (\n          account.toLowerCase() ===\n          snapshotProposal.msg.payload.metadata.submitActionArgs[0].toLowerCase()\n        ) {\n          await addTokenToWallet();\n        }\n      }\n    } catch (error) {\n      setSubmitError(error);\n    }\n  }\n\n  async function addTokenToWallet() {\n    if (!daoTokenDetails) return;\n\n    try {\n      await window.ethereum.request({\n        method: 'wallet_watchAsset',\n        params: {\n          type: 'ERC20',\n          options: daoTokenDetails,\n        },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  /**\n   * Render\n   */\n\n  function renderSubmitStatus(): React.ReactNode {\n    // token approve transaction statuses\n    if (txStatusTokenApprove === Web3TxStatus.AWAITING_CONFIRM) {\n      return (\n        <>\n          Confirm to transfer your tokens\n          <CycleEllipsis />\n        </>\n      );\n    }\n\n    if (txStatusTokenApprove === Web3TxStatus.PENDING) {\n      return (\n        <>\n          <div>\n            Approving your tokens for transfer\n            <CycleEllipsis />\n          </div>\n          <EtherscanURL url={txEtherscanURLTokenApprove} isPending />\n        </>\n      );\n    }\n\n    // process proposal transaction statuses\n    switch (txStatus) {\n      case Web3TxStatus.AWAITING_CONFIRM:\n        return (\n          <>\n            Confirm to process the proposal\n            <CycleEllipsis />\n          </>\n        );\n      case Web3TxStatus.PENDING:\n        return (\n          <>\n            <CycleMessage\n              intervalMs={2000}\n              messages={TX_CYCLE_MESSAGES}\n              useFirstItemStart\n              render={(message) => {\n                return <FadeIn key={message}>{message}</FadeIn>;\n              }}\n            />\n\n            <EtherscanURL url={txEtherscanURL} isPending />\n          </>\n        );\n      case Web3TxStatus.FULFILLED:\n        return (\n          <>\n            <div>Proposal submitted!</div>\n\n            <EtherscanURL url={txEtherscanURL} />\n          </>\n        );\n      default:\n        return null;\n    }\n  }\n\n  return (\n    <>\n      <div>\n        <button\n          className=\"proposaldetails__button\"\n          disabled={areSomeDisabled}\n          onClick={areSomeDisabled ? () => {} : handleSubmit}>\n          {isInProcess ? <Loader /> : isDone ? 'Done' : 'Process'}\n        </button>\n\n        <ErrorMessageWithDetails\n          error={submitError}\n          renderText=\"Something went wrong\"\n        />\n\n        {/* SUBMIT STATUS */}\n\n        {isInProcessOrDone && (\n          <div className=\"form__submit-status-container\">\n            {renderSubmitStatus()}\n          </div>\n        )}\n\n        {isDisabled && (\n          <button\n            className=\"button--help-centered\"\n            onClick={openWhyDisabledModal}>\n            Why is processing disabled?\n          </button>\n        )}\n      </div>\n\n      <WhyDisabledModal title=\"Why is processing disabled?\" />\n    </>\n  );\n}\n","import React from 'react';\nimport {useHistory, useParams} from 'react-router-dom';\n\nimport {\n  RenderActionPropArguments,\n  ProposalFlowStatus,\n} from '../../components/proposals/types';\nimport {AsyncStatus} from '../../util/types';\nimport {ContractAdapterNames} from '../../components/web3/types';\nimport {useIsDefaultChain} from '../../components/web3/hooks';\nimport {useProposalOrDraft} from '../../components/proposals/hooks';\nimport {VotingState} from '../../components/proposals/voting/types';\nimport ErrorMessageWithDetails from '../../components/common/ErrorMessageWithDetails';\nimport FadeIn from '../../components/common/FadeIn';\nimport LoaderLarge from '../../components/feedback/LoaderLarge';\nimport NotFound from '../subpages/NotFound';\nimport ProcessActionTribute from '../../components/proposals/ProcessActionTribute';\nimport ProposalActions from '../../components/proposals/ProposalActions';\nimport SubmitAction from '../../components/proposals/SubmitAction';\nimport ProposalAmount from '../../components/proposals/ProposalAmount';\nimport ProposalDetails from '../../components/proposals/ProposalDetails';\nimport Wrap from '../../components/common/Wrap';\n\nconst PLACEHOLDER = '\\u2014'; /* em dash */\n\nexport default function TributeDetails() {\n  /**\n   * @todo\n   *\n   * 1. Fetch proposal by ID from the subgraph.\n   * 2. Determine if sponsored\n   * 3. Get Snapshot data\n   *   3.1 If sponsored, get data about proposal from Snapshot (use flag to also search by draft hash).\n   *   3.2 If not sponsored, get data about draft from Snapshot.\n   */\n\n  /**\n   * Their hooks\n   */\n\n  // Get hash for fetching the proposal.\n  const {proposalId} = useParams<{proposalId: string}>();\n\n  /**\n   * @todo Get subgraph proposal and determine if it has been sponsored\n   *   so we know how to search snapshot-hub.\n   */\n\n  // ...\n\n  /**\n   * Our hooks\n   */\n\n  // @todo Use dynamic `SnapshotType` depending on subgraph data for `type` arg.\n  const {proposalData, proposalError, proposalNotFound, proposalStatus} =\n    useProposalOrDraft(proposalId);\n\n  const {defaultChainError} = useIsDefaultChain();\n\n  /**\n   * Variables\n   */\n\n  const isLoading: boolean = proposalStatus === AsyncStatus.PENDING;\n  const error: Error | undefined = proposalError || defaultChainError;\n\n  /**\n   * Functions\n   */\n\n  // Render any adapter-specific actions\n  function renderAction(data: RenderActionPropArguments): React.ReactNode {\n    const {\n      OffchainVotingContract: {daoProposalVoteResult, proposal, status},\n    } = data;\n\n    // Submit/Sponsor button (for proposals that have not been submitted onchain yet)\n    if (status === ProposalFlowStatus.Submit) {\n      const {snapshotDraft} = proposal;\n      const applicant = snapshotDraft?.msg.payload.metadata.submitActionArgs[0];\n\n      return <SubmitAction checkApplicant={applicant} proposal={proposal} />;\n    }\n\n    // Process button\n    if (\n      status === ProposalFlowStatus.Process ||\n      status === ProposalFlowStatus.OffchainVotingGracePeriod\n    ) {\n      if (\n        daoProposalVoteResult &&\n        VotingState[daoProposalVoteResult] !== VotingState[VotingState.PASS]\n      ) {\n        // Return a React.Fragment to hide the process button if proposal failed.\n        return <></>;\n      }\n\n      return (\n        <ProcessActionTribute\n          // Show during DAO proposal grace period, but set to disabled\n          disabled={status === ProposalFlowStatus.OffchainVotingGracePeriod}\n          proposal={proposal}\n        />\n      );\n    }\n\n    // Return `null` to signal to use default actions\n    return null;\n  }\n\n  /**\n   * Render\n   */\n\n  // Render loading\n  if (isLoading && !error) {\n    return (\n      <RenderWrapper>\n        <div className=\"loader--large-container\">\n          <LoaderLarge />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render 404 no proposal found\n  if (proposalNotFound) {\n    return (\n      <RenderWrapper>\n        <NotFound />\n      </RenderWrapper>\n    );\n  }\n\n  // Render error\n  if (error) {\n    return (\n      <RenderWrapper>\n        <div className=\"text-center\">\n          <ErrorMessageWithDetails\n            error={error}\n            renderText=\"Something went wrong.\"\n          />\n        </div>\n      </RenderWrapper>\n    );\n  }\n\n  // Render proposal\n  if (proposalData) {\n    const commonData = proposalData.getCommonSnapshotProposalData();\n\n    // Handle just in case metadata was not properly set\n    let tributeAmount = PLACEHOLDER;\n    let tributeAmountUnit = '';\n    let requestAmount = PLACEHOLDER;\n    let requestAmountUnit = '';\n    try {\n      ({tributeAmount, tributeAmountUnit, requestAmount, requestAmountUnit} =\n        commonData?.msg.payload.metadata.proposalAmountValues);\n    } catch (error) {\n      tributeAmount = PLACEHOLDER;\n      tributeAmountUnit = '';\n      requestAmount = PLACEHOLDER;\n      requestAmountUnit = '';\n    }\n\n    return (\n      <RenderWrapper>\n        <ProposalDetails\n          proposal={proposalData}\n          renderAmountBadge={() => (\n            <ProposalAmount\n              amount={tributeAmount}\n              amountUnit={tributeAmountUnit}\n              amount2={requestAmount}\n              amount2Unit={requestAmountUnit}\n            />\n          )}\n          renderActions={() => (\n            <ProposalActions\n              adapterName={ContractAdapterNames.tribute}\n              proposal={proposalData}\n              renderAction={renderAction}\n            />\n          )}\n        />\n      </RenderWrapper>\n    );\n  }\n\n  // Render nothing. Should never reach this case.\n  return <></>;\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToAll(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n\n    history.push('/tributes');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Tributes</h2>\n          <button className=\"titlebar__action\" onClick={goToAll}>\n            View all\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React from 'react';\nimport {useHistory} from 'react-router-dom';\n\nimport {DaoAdapterConstants} from '../../components/adapters-extensions/enums';\nimport FadeIn from '../../components/common/FadeIn';\nimport Proposals from '../../components/proposals/Proposals';\nimport Wrap from '../../components/common/Wrap';\n\nexport default function Tributes() {\n  /**\n   * Functions\n   */\n\n  function proposalLinkPath(id: string) {\n    return `/tributes/${id}`;\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <RenderWrapper>\n      <Proposals\n        adapterName={DaoAdapterConstants.TRIBUTE}\n        proposalLinkPath={proposalLinkPath}\n        includeProposalsExistingOnlyOffchain={true}\n      />\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Their hooks\n   */\n\n  const history = useHistory();\n\n  /**\n   * Functions\n   */\n\n  function goToNewProposal(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault();\n    history.push('/tribute');\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Tributes</h2>\n          <button className=\"titlebar__action\" onClick={goToNewProposal}>\n            Provide Tribute\n          </button>\n        </div>\n\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import React, {useState, useCallback, useEffect} from 'react';\n// import {useHistory} from 'react-router-dom';\nimport Web3 from 'web3';\nimport {Contract as Web3Contract} from 'web3-eth-contract/types';\n\nimport {AbiItem} from 'web3-utils';\n\nimport FadeIn from '../../components/common/FadeIn';\nimport Wrap from '../../components/common/Wrap';\n// import {DAO_REGISTRY_CONTRACT_ADDRESS} from '../../config';\nimport {DEFAULT_CHAIN, WATER_CONTRACT_ADDRESS} from '../../config';\nimport {ETHEREUM_PROVIDER_URL} from '../../config';\n\nconst web3 = new Web3(Web3.givenProvider || ETHEREUM_PROVIDER_URL);\n\nexport default function Water() {\n  /**\n   * Their hooks\n   */\n\n  // const {account, web3Instance} = useWeb3Modal();\n\n  const [waterContract, setWaterContract] = useState<Web3Contract>();\n  const [irrigationStatus, setIrrigationStatus] = useState<String>(\n    ' Error: Cannot determine status.'\n  );\n  const [renderStatus, setRenderStatus] = useState<String>();\n\n  const waterAddressValue: string = WATER_CONTRACT_ADDRESS[DEFAULT_CHAIN];\n\n  /**\n   * Functions\n   */\n\n  const getWaterContractCached = useCallback(getWaterContract, [\n    waterAddressValue,\n  ]);\n\n  const getIrrigationStatusCached = useCallback(getIrrigationStatus, [\n    waterContract,\n    irrigationStatus,\n  ]);\n\n  useEffect(() => {\n    getWaterContractCached();\n  }, [getWaterContractCached]);\n\n  useEffect(() => {\n    getIrrigationStatusCached();\n  }, [getIrrigationStatusCached]);\n\n  async function getWaterContract() {\n    if (!web3 || !waterAddressValue) {\n      setWaterContract(undefined);\n      console.log('water contract not found');\n      return;\n    }\n\n    try {\n      const {default: lazyWaterABI} = await import(\n        '../../truffle-contracts/WaterContract.json'\n      );\n      const waterContract: AbiItem[] = lazyWaterABI as any;\n      const instance = new web3.eth.Contract(waterContract, waterAddressValue);\n      setWaterContract(instance);\n      console.log('water contract set: ' + instance);\n      console.log('methods: ' + instance.methods);\n      var method;\n\n      for (method in instance.methods) {\n        console.log(method);\n      }\n\n      return instance;\n    } catch (error) {\n      console.error(error);\n      setWaterContract(undefined);\n    }\n  }\n\n  async function getIrrigationStatus() {\n    if (!waterContract) {\n      console.log('error getting irrigation status');\n      return;\n    }\n\n    try {\n      const result = await waterContract.methods.getIrrigation().call();\n      setIrrigationStatus(String(result));\n      console.log('Result ' + result);\n\n      if (irrigationStatus) {\n        setRenderStatus(' The pump is running.');\n      } else if (!irrigationStatus) {\n        setRenderStatus(' The pump is not running.');\n      } else {\n        setRenderStatus(' Error: Cannot determine status.');\n      }\n    } catch (error) {\n      console.error(error);\n      setIrrigationStatus('');\n      setRenderStatus(' Error: Cannot determine status.');\n    }\n  }\n\n  return (\n    <RenderWrapper>\n      <button className=\"titlebar__action\" onClick={getIrrigationStatus}>\n        Get Status\n      </button>\n      <p>{renderStatus}</p>\n    </RenderWrapper>\n  );\n}\n\nfunction RenderWrapper(props: React.PropsWithChildren<any>): JSX.Element {\n  /**\n   * Render\n   */\n\n  return (\n    <Wrap className=\"section-wrapper\">\n      <FadeIn>\n        <div className=\"titlebar\">\n          <h2 className=\"titlebar__title\">Water</h2>\n        </div>\n        {/* RENDER CHILDREN */}\n        {props.children}\n      </FadeIn>\n    </Wrap>\n  );\n}\n","import {Route, Switch} from 'react-router-dom';\n\nimport AdapterOrExtensionManager from './components/adapters-extensions/AdapterOrExtensionManager';\nimport CreateGovernanceProposal from './pages/governance/CreateGovernanceProposal';\nimport CreateMembershipProposal from './pages/membership/CreateMembershipProposal';\nimport CreateTransferProposal from './pages/transfers/CreateTransferProposal';\nimport CreateTributeProposal from './pages/tributes/CreateTributeProposal';\nimport GetStarted from './pages/start/GetStarted';\nimport GovernanceProposalDetails from './pages/governance/GovernanceProposalDetails';\nimport GovernanceProposals from './pages/governance/GovernanceProposals';\nimport MemberProfile from './pages/members/MemberProfile';\nimport Members from './pages/members/Members';\nimport Membership from './pages/membership/Membership';\nimport MembershipDetails from './pages/membership/MembershipDetails';\nimport NotFound from './pages/subpages/NotFound';\nimport Redeem from './pages/redeem/Redeem';\nimport TransferDetails from './pages/transfers/TransferDetails';\nimport Transfers from './pages/transfers/Transfers';\nimport TributeDetails from './pages/tributes/TributeDetails';\nimport Tributes from './pages/tributes/Tributes';\nimport Water from './pages/water/Water';\n\nconst proposalIdParameter: string = ':proposalId';\n\nexport default function Routes() {\n  return (\n    <Switch>\n      {[\n        // Index page\n        <Route key=\"splash\" exact path=\"/\" render={() => <GetStarted />} />,\n        <Route\n          key=\"join\"\n          exact\n          path=\"/join\"\n          render={() => <CreateMembershipProposal />}\n        />,\n        <Route\n          key=\"membership\"\n          exact\n          path=\"/membership\"\n          render={() => <Membership />}\n        />,\n        <Route\n          key=\"membership-details\"\n          exact\n          path={`/membership/${proposalIdParameter}`}\n          render={() => <MembershipDetails />}\n        />,\n        <Route\n          key=\"transfer\"\n          exact\n          path=\"/transfer\"\n          render={() => <CreateTransferProposal />}\n        />,\n        <Route\n          key=\"transfers\"\n          exact\n          path=\"/transfers\"\n          render={() => <Transfers />}\n        />,\n        <Route\n          key=\"transfer-details\"\n          exact\n          path={`/transfers/${proposalIdParameter}`}\n          render={() => <TransferDetails />}\n        />,\n        <Route\n          key=\"tribute\"\n          exact\n          path=\"/tribute\"\n          render={() => <CreateTributeProposal />}\n        />,\n        <Route\n          key=\"tributes\"\n          exact\n          path=\"/tributes\"\n          render={() => <Tributes />}\n        />,\n        <Route\n          key=\"tribute-details\"\n          exact\n          path={`/tributes/${proposalIdParameter}`}\n          render={() => <TributeDetails />}\n        />,\n        <Route key=\"water\" exact path=\"/water\" render={() => <Water />} />,\n        <Route\n          key=\"governance-proposal\"\n          exact\n          path=\"/governance-proposal\"\n          render={() => <CreateGovernanceProposal />}\n        />,\n        <Route\n          key=\"governance-proposals\"\n          exact\n          path=\"/governance\"\n          render={() => <GovernanceProposals />}\n        />,\n        <Route\n          key=\"governance-proposal-details\"\n          exact\n          path={`/governance/${proposalIdParameter}`}\n          render={() => <GovernanceProposalDetails />}\n        />,\n        <Route\n          key=\"members\"\n          exact\n          path=\"/members\"\n          render={() => <Members />}\n        />,\n        <Route\n          key=\"member-profile\"\n          exact\n          path=\"/members/:ethereumAddress\"\n          render={() => <MemberProfile />}\n        />,\n        <Route\n          key=\"dao-manager\"\n          exact\n          path=\"/dao-manager\"\n          render={() => <AdapterOrExtensionManager />}\n        />,\n        <Route key=\"redeem\" exact path=\"/redeem\" render={() => <Redeem />} />,\n        // 404 component (note: does not redirect to a route to maintain original path)\n        <Route key=\"no-match\" component={NotFound} />,\n      ]}\n    </Switch>\n  );\n}\n","import React, {useCallback, useEffect, useState} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {getApiStatus as getSnapshotAPIStatus} from '@openlaw/snapshot-js-erc712';\n\nimport {AsyncStatus} from './util/types';\nimport {getConnectedMember} from './store/actions';\nimport {ReduxDispatch, StoreState} from './store/types';\nimport {SNAPSHOT_HUB_API_URL} from './config';\nimport {useInitContracts, useIsDefaultChain} from './components/web3/hooks';\nimport {useIsMounted} from './hooks';\nimport {useWeb3Modal} from './components/web3/hooks';\n\ntype InitPropsRenderProps = {\n  error: Error | undefined;\n  isInitComplete: boolean;\n};\n\ntype InitProps = {\n  render: (p: InitPropsRenderProps) => React.ReactElement | null;\n};\n\n/**\n * Register any new async process names here.\n * It is mainly to check their progress before rendering.\n *\n * If the app is not dependent on a process before starting\n * do not add it here.\n */\nenum ProcessName {\n  initSnapshotAPI = 'initSnapshotAPI',\n}\n\n/**\n * Init Component\n *\n * Init will run any designated sync/async\n * setup processes and then render any child component\n * upon completion.\n *\n * In our case the children prop component to render is our app.\n *\n * @param {InitProps} props\n */\nexport default function Init(props: InitProps) {\n  const {render} = props;\n\n  /**\n   * Selectors\n   */\n\n  const daoRegistryContract = useSelector(\n    (s: StoreState) => s.contracts.DaoRegistryContract\n  );\n\n  /**\n   * State\n   */\n\n  const [error, setError] = useState<Error>();\n  const [isInitComplete, setIsInitComplete] = useState<boolean>(false);\n  const [processReadyMap, setProcessReadyMap] = useState<\n    Record<ProcessName, AsyncStatus>\n  >({\n    [ProcessName.initSnapshotAPI]: AsyncStatus.STANDBY,\n  });\n\n  /**\n   * Our hooks\n   */\n\n  const {account, web3Instance} = useWeb3Modal();\n  const {isDefaultChain} = useIsDefaultChain();\n  const {isMountedRef} = useIsMounted();\n  const initContracts = useInitContracts();\n\n  /**\n   * Their hooks\n   */\n\n  const dispatch = useDispatch<ReduxDispatch>();\n\n  /**\n   * Cached callbacks\n   */\n\n  const handleInitContractsCached = useCallback(handleInitContracts, [\n    initContracts,\n    isDefaultChain,\n    web3Instance,\n  ]);\n\n  const handleGetMemberCached = useCallback(handleGetMember, [\n    account,\n    daoRegistryContract,\n    dispatch,\n    isDefaultChain,\n    web3Instance,\n  ]);\n\n  const handleGetSnapshotAPIStatusCached = useCallback(\n    handleGetSnapshotAPIStatus,\n    [isMountedRef]\n  );\n\n  /**\n   * Effects\n   */\n\n  useEffect(() => {\n    setIsInitComplete(\n      Object.values(processReadyMap).every((fs) => fs === AsyncStatus.FULFILLED)\n    );\n  }, [processReadyMap]);\n\n  useEffect(() => {\n    handleInitContractsCached();\n  }, [handleInitContractsCached, web3Instance]);\n\n  useEffect(() => {\n    handleGetMemberCached();\n  }, [handleGetMemberCached]);\n\n  useEffect(() => {\n    handleGetSnapshotAPIStatusCached();\n  }, [handleGetSnapshotAPIStatusCached]);\n\n  /**\n   * Functions\n   */\n\n  async function handleGetSnapshotAPIStatus() {\n    try {\n      if (!SNAPSHOT_HUB_API_URL) {\n        throw new Error('No Snapshot Hub API URL was found.');\n      }\n\n      const {data} = await getSnapshotAPIStatus(SNAPSHOT_HUB_API_URL);\n\n      // Choosing a slice of the data to make sure we have a response, not just 200 OK.\n      if (!data.version) {\n        throw new Error('Snapshot API is not ready.');\n      }\n\n      if (!isMountedRef.current) return;\n\n      setProcessReadyMap((p) => ({\n        ...p,\n        [ProcessName.initSnapshotAPI]: AsyncStatus.FULFILLED,\n      }));\n    } catch (error) {\n      if (!isMountedRef.current) return;\n\n      setError(new Error('Snapshot API is not responding.'));\n    }\n  }\n\n  async function handleInitContracts() {\n    try {\n      if (!isDefaultChain || !web3Instance) {\n        return;\n      }\n\n      await initContracts({web3Instance});\n    } catch (error) {\n      setError(error);\n    }\n  }\n\n  async function handleGetMember() {\n    try {\n      if (\n        !account ||\n        !daoRegistryContract ||\n        !isDefaultChain ||\n        !web3Instance\n      ) {\n        return;\n      }\n\n      await dispatch(\n        getConnectedMember({\n          account,\n          daoRegistryContract,\n          web3Instance,\n        })\n      );\n    } catch (error) {\n      setError(error);\n    }\n  }\n\n  // Render children\n  return render({error, isInitComplete});\n}\n","import {useLocation} from 'react-router-dom';\n\nimport Footer from './components/Footer';\nimport GlobalConnectWalletModal from './GlobalConnectWalletModal';\nimport Head from './Head';\nimport Header from './components/Header';\nimport Routes from './Routes';\n\ntype AppProps = {\n  /**\n   * Optionally provide a component to render for the main content.\n   */\n  renderMainContent?: () => React.ReactNode;\n};\n\nexport default function App(props?: AppProps) {\n  /**\n   * Their hooks\n   */\n\n  const {pathname} = useLocation();\n\n  /**\n   * Variables\n   */\n\n  const {renderMainContent} = props || {};\n\n  const mainContent: React.ReactNode = (\n    <main>{renderMainContent ? renderMainContent() : <Routes />}</main>\n  );\n\n  /**\n   * Functions\n   */\n\n  function renderContent() {\n    // The index path has its own template\n    if (pathname === '/') {\n      return <>{mainContent}</>;\n    }\n\n    // Render default template\n    return (\n      <>\n        <Header />\n        {mainContent}\n        <Footer />\n      </>\n    );\n  }\n\n  /**\n   * Render\n   */\n\n  return (\n    <>\n      {/* HTML `<head>` (react-helmet) */}\n      <Head />\n\n      {/* CONTENT */}\n      {renderContent()}\n\n      {/* GLOBAL MODALS */}\n      <GlobalConnectWalletModal />\n    </>\n  );\n}\n","import ErrorMessageWithDetails from './components/common/ErrorMessageWithDetails';\nimport FadeIn from './components/common/FadeIn';\n\ntype InitErrorProps = {\n  error: Error;\n};\n\n/**\n * InitError\n *\n * An error component that is meant to be used if the <Init /> component\n * could not complete any of its processes to provide the app with vital data.\n *\n * @param {InitErrorProps} props\n */\nexport default function InitError(props: InitErrorProps) {\n  const {error} = props;\n\n  return (\n    <FadeIn>\n      <div\n        style={{\n          padding: '2em 1em 1em',\n          textAlign: 'center',\n        }}>\n        <h1 style={{fontSize: '2rem'}}>\n          <span\n            className=\"pulse\"\n            role=\"img\"\n            aria-label=\"Emoji with eyes crossed out.\"\n            style={{display: 'inline-block'}}>\n            \n          </span>{' '}\n          Oops, something went wrong.\n        </h1>\n      </div>\n\n      <div\n        style={{\n          textAlign: 'center',\n          maxWidth: 600,\n          display: 'block',\n          margin: '0 auto',\n        }}>\n        <ErrorMessageWithDetails error={error} renderText=\"\" />\n      </div>\n    </FadeIn>\n  );\n}\n","import {ReportHandler} from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import {render} from 'react-dom';\nimport {Store} from 'redux';\nimport {Provider} from 'react-redux';\nimport {BrowserRouter} from 'react-router-dom';\nimport {ApolloProvider} from '@apollo/react-hooks';\nimport {\n  ApolloClient,\n  concat,\n  InMemoryCache,\n  NormalizedCacheObject,\n  HttpLink,\n} from '@apollo/client';\n\nimport {\n  ENVIRONMENT,\n  GRAPH_API_URL,\n  WALLETCONNECT_PROVIDER_OPTIONS,\n} from './config';\nimport {clearConnectedMember, clearContracts} from './store/actions';\nimport {disableReactDevTools} from './util/helpers';\nimport {handleSubgraphError} from './gql';\nimport {store} from './store';\nimport App from './App';\nimport Init from './Init';\nimport InitError from './InitError';\nimport reportWebVitals from './reportWebVitals';\nimport Web3ModalManager from './components/web3/Web3ModalManager';\n\nimport './assets/scss/style.scss';\n\nconst root = document.getElementById('root');\n\n// disable React dev tools for production\nENVIRONMENT === 'production' && disableReactDevTools();\n\n// will be deprecated eventually, for now we set it to false to silence the\n// console warning\nwindow.ethereum &&\n  window.ethereum.autoRefreshOnNetworkChange &&\n  (window.ethereum.autoRefreshOnNetworkChange = false);\n\n// Create `ApolloClient`\nexport const getApolloClient = (\n  store: Store\n): ApolloClient<NormalizedCacheObject> =>\n  new ApolloClient({\n    link: concat(\n      handleSubgraphError(store),\n      new HttpLink({\n        uri: ({operationName}) => `${GRAPH_API_URL}?${operationName}`,\n      })\n    ),\n    cache: new InMemoryCache({\n      // Cache data may be lost when replacing the `adapters|extensions`\n      // field of a Query object. To address this problem\n      // (which is not a bug in Apollo Client), define a custom\n      // merge function for the Query.adapters|extensions field, so\n      // InMemoryCache can safely merge these objects\n      // https://www.apollographql.com/docs/react/caching/cache-field-behavior/#the-merge-function\n      typePolicies: {\n        Adapter: {\n          fields: {\n            adapters: {\n              merge(existing = [], incoming: any[]) {\n                return [...existing, ...incoming];\n              },\n            },\n          },\n        },\n        Extension: {\n          fields: {\n            extensions: {\n              merge(existing = [], incoming: any[]) {\n                return [...existing, ...incoming];\n              },\n            },\n          },\n        },\n      },\n    }),\n  });\n\nif (root !== null) {\n  render(\n    <Provider store={store}>\n      <BrowserRouter>\n        <Web3ModalManager\n          onBeforeDisconnect={() => {\n            // Clear out `connectedMember` and `contracts` Redux state\n            store.dispatch(clearConnectedMember());\n            store.dispatch(clearContracts());\n          }}\n          onBeforeConnect={() => {\n            // Clear out `contracts` Redux state\n            store.dispatch(clearContracts());\n          }}\n          providerOptions={WALLETCONNECT_PROVIDER_OPTIONS}>\n          <ApolloProvider client={getApolloClient(store)}>\n            <Init\n              render={({error, isInitComplete}) =>\n                error ? (\n                  <App renderMainContent={() => <InitError error={error} />} />\n                ) : isInitComplete ? (\n                  <App />\n                ) : null\n              }\n            />\n          </ApolloProvider>\n        </Web3ModalManager>\n      </BrowserRouter>\n    </Provider>,\n    root\n  );\n}\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import {useContext} from 'react';\n\nimport {Web3ModalContextValue, Web3ModalContext} from '../Web3ModalManager';\n\n/**\n * useWeb3Modal(): Web3ModalContextValue\n *\n * Internal hook to access wallet connectivity and connected state.\n *\n * @example\n * const {account, connected, networkId, ...} = useWeb3Modal();\n */\nexport function useWeb3Modal(): Web3ModalContextValue {\n  return useContext(Web3ModalContext);\n}\n"],"sourceRoot":""}